/*

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 MIT

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2017 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Copyright 2016 Google Inc.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(n,e,b){if(b.get||b.set)throw new TypeError("ES3 does not support getters and setters.");n!=Array.prototype&&n!=Object.prototype&&(n[e]=b.value)};$jscomp.getGlobal=function(n){return"undefined"!=typeof window&&window===n?n:"undefined"!=typeof global&&null!=global?global:n};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(n){return $jscomp.SYMBOL_PREFIX+(n||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var n=$jscomp.global.Symbol.iterator;n||(n=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[n]&&$jscomp.defineProperty(Array.prototype,n,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(n){var e=0;return $jscomp.iteratorPrototype(function(){return e<n.length?{done:!1,value:n[e++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(n){$jscomp.initSymbolIterator();n={next:n};n[$jscomp.global.Symbol.iterator]=function(){return this};return n};$jscomp.makeIterator=function(n){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var e=n[Symbol.iterator];return e?e.call(n):$jscomp.arrayIterator(n)};$jscomp.arrayFromIterator=function(n){for(var e,b=[];!(e=n.next()).done;)b.push(e.value);return b};$jscomp.arrayFromIterable=function(n){return n instanceof Array?n:$jscomp.arrayFromIterator($jscomp.makeIterator(n))};
$jscomp.polyfill=function(n,e,b,m){if(e){b=$jscomp.global;n=n.split(".");for(m=0;m<n.length-1;m++){var u=n[m];u in b||(b[u]={});b=b[u]}n=n[n.length-1];m=b[n];e=e(m);e!=m&&null!=e&&$jscomp.defineProperty(b,n,{configurable:!0,writable:!0,value:e})}};$jscomp.polyfill("Object.setPrototypeOf",function(n){return n?n:"object"!=typeof"".__proto__?null:function(e,b){e.__proto__=b;if(e.__proto__!==b)throw new TypeError(e+" is not extensible");return e}},"es6","es5");
$jscomp.polyfill("Number.isNaN",function(n){return n?n:function(e){return"number"===typeof e&&isNaN(e)}},"es6-impl","es3");$jscomp.polyfill("Number.isFinite",function(n){return n?n:function(e){return"number"!==typeof e?!1:!isNaN(e)&&Infinity!==e&&-Infinity!==e}},"es6-impl","es3");$jscomp.array=$jscomp.array||{};
$jscomp.iteratorFromArray=function(n,e){$jscomp.initSymbolIterator();n instanceof String&&(n+="");var b=0,m={next:function(){if(b<n.length){var u=b++;return{value:e(u,n[u]),done:!1}}m.next=function(){return{done:!0,value:void 0}};return m.next()}};m[Symbol.iterator]=function(){return m};return m};$jscomp.polyfill("Array.prototype.keys",function(n){return n?n:function(){return $jscomp.iteratorFromArray(this,function(e){return e})}},"es6-impl","es3");
$jscomp.polyfill("Number.isInteger",function(n){return n?n:function(e){return Number.isFinite(e)?e===Math.floor(e):!1}},"es6-impl","es3");$jscomp.polyfill("Array.from",function(n){return n?n:function(e,b,m){$jscomp.initSymbolIterator();b=null!=b?b:function(a){return a};var u=[],r=e[Symbol.iterator];if("function"==typeof r)for(e=r.call(e);!(r=e.next()).done;)u.push(b.call(m,r.value));else for(var r=e.length,a=0;a<r;a++)u.push(b.call(m,e[a]));return u}},"es6-impl","es3");
$jscomp.owns=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)};
$jscomp.polyfill("WeakMap",function(n){function e(a){$jscomp.owns(a,m)||$jscomp.defineProperty(a,m,{value:{}})}function b(a){var b=Object[a];b&&(Object[a]=function(a){e(a);return b(a)})}if(function(){if(!n||!Object.seal)return!1;try{var a=Object.seal({}),b=Object.seal({}),l=new n([[a,2],[b,3]]);if(2!=l.get(a)||3!=l.get(b))return!1;l.delete(a);l.set(b,4);return!l.has(a)&&4==l.get(b)}catch(p){return!1}}())return n;var m="$jscomp_hidden_"+Math.random().toString().substring(2);b("freeze");b("preventExtensions");
b("seal");var u=0,r=function(a){this.id_=(u+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};r.prototype.set=function(a,b){e(a);if(!$jscomp.owns(a,m))throw Error("WeakMap key fail: "+a);a[m][this.id_]=b;return this};r.prototype.get=function(a){return $jscomp.owns(a,m)?a[m][this.id_]:void 0};r.prototype.has=function(a){return $jscomp.owns(a,m)&&$jscomp.owns(a[m],this.id_)};r.prototype.delete=
function(a){return $jscomp.owns(a,m)&&$jscomp.owns(a[m],this.id_)?delete a[m][this.id_]:!1};return r},"es6-impl","es3");$jscomp.ASSUME_NO_NATIVE_MAP=!1;
$jscomp.polyfill("Map",function(n){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!n||!n.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),b=new n($jscomp.makeIterator([[a,"s"]]));if("s"!=b.get(a)||1!=b.size||b.get({x:4})||b.set({x:4},"t")!=b||2!=b.size)return!1;var p=b.entries(),w=p.next();if(w.done||w.value[0]!=a||"s"!=w.value[1])return!1;w=p.next();return w.done||4!=w.value[0].x||"t"!=w.value[1]||!p.next().done?!1:!0}catch(v){return!1}}())return n;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var e=new WeakMap,b=function(a){this.data_={};this.head_=r();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};b.prototype.set=function(a,b){var c=m(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=b:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:b},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};b.prototype.delete=
function(a){a=m(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};b.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=r();this.size=0};b.prototype.has=function(a){return!!m(this,a).entry};b.prototype.get=function(a){return(a=m(this,a).entry)&&a.value};b.prototype.entries=function(){return u(this,function(a){return[a.key,
a.value]})};b.prototype.keys=function(){return u(this,function(a){return a.key})};b.prototype.values=function(){return u(this,function(a){return a.value})};b.prototype.forEach=function(a,b){for(var c=this.entries(),l;!(l=c.next()).done;)l=l.value,a.call(b,l[1],l[0],this)};b.prototype[Symbol.iterator]=b.prototype.entries;var m=function(b,l){var c;c=l&&typeof l;"object"==c||"function"==c?e.has(l)?c=e.get(l):(c=""+ ++a,e.set(l,c)):c="p_"+l;var w=b.data_[c];if(w&&$jscomp.owns(b.data_,c))for(b=0;b<w.length;b++){var v=
w[b];if(l!==l&&v.key!==v.key||l===v.key)return{id:c,list:w,index:b,entry:v}}return{id:c,list:w,index:-1,entry:void 0}},u=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},r=function(){var a={};return a.previous=a.next=a.head=a},a=0;return b},"es6-impl","es3");
$jscomp.checkStringArgs=function(n,e,b){if(null==n)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");return n+""};
$jscomp.polyfill("String.prototype.startsWith",function(n){return n?n:function(e,b){var m=$jscomp.checkStringArgs(this,e,"startsWith");e+="";var u=m.length,r=e.length;b=Math.max(0,Math.min(b|0,m.length));for(var a=0;a<r&&b<u;)if(m[b++]!=e[a++])return!1;return a>=r}},"es6-impl","es3");$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.polyfill("Set",function(n){if(!$jscomp.ASSUME_NO_NATIVE_SET&&function(){if(!n||!n.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),e=new n($jscomp.makeIterator([b]));if(!e.has(b)||1!=e.size||e.add(b)!=e||1!=e.size||e.add({x:4})!=e||2!=e.size)return!1;var u=e.entries(),r=u.next();if(r.done||r.value[0]!=b||r.value[1]!=b)return!1;r=u.next();return r.done||r.value[0]==b||4!=r.value[0].x||r.value[1]!=r.value[0]?!1:u.next().done}catch(a){return!1}}())return n;
$jscomp.initSymbol();$jscomp.initSymbolIterator();var e=function(b){this.map_=new Map;if(b){b=$jscomp.makeIterator(b);for(var e;!(e=b.next()).done;)this.add(e.value)}this.size=this.map_.size};e.prototype.add=function(b){this.map_.set(b,b);this.size=this.map_.size;return this};e.prototype.delete=function(b){b=this.map_.delete(b);this.size=this.map_.size;return b};e.prototype.clear=function(){this.map_.clear();this.size=0};e.prototype.has=function(b){return this.map_.has(b)};e.prototype.entries=function(){return this.map_.entries()};
e.prototype.values=function(){return this.map_.values()};e.prototype[Symbol.iterator]=e.prototype.values;e.prototype.forEach=function(b,e){var m=this;this.map_.forEach(function(r){return b.call(e,r,r,m)})};return e},"es6-impl","es3");$jscomp.polyfill("Object.assign",function(n){return n?n:function(e,b){for(var m=1;m<arguments.length;m++){var u=arguments[m];if(u)for(var r in u)$jscomp.owns(u,r)&&(e[r]=u[r])}return e}},"es6-impl","es3");
$jscomp.polyfill("WeakSet",function(n){if(function(){if(!n||!Object.seal)return!1;try{var b=Object.seal({}),e=Object.seal({}),u=new n([b]);if(!u.has(b)||u.has(e))return!1;u.delete(b);u.add(e);return!u.has(b)&&u.has(e)}catch(r){return!1}}())return n;var e=function(b){this.map_=new WeakMap;if(b){$jscomp.initSymbol();$jscomp.initSymbolIterator();b=$jscomp.makeIterator(b);for(var e;!(e=b.next()).done;)this.add(e.value)}};e.prototype.add=function(b){this.map_.set(b,!0);return this};e.prototype.has=function(b){return this.map_.has(b)};
e.prototype.delete=function(b){return this.map_.delete(b)};return e},"es6-impl","es3");$jscomp.findInternal=function(n,e,b){n instanceof String&&(n=String(n));for(var m=n.length,u=0;u<m;u++){var r=n[u];if(e.call(b,r,u,n))return{i:u,v:r}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(n){return n?n:function(e,b){return $jscomp.findInternal(this,e,b).v}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.values",function(n){return n?n:function(){return $jscomp.iteratorFromArray(this,function(e,b){return b})}},"es6","es3");$jscomp.polyfill("Math.log2",function(n){return n?n:function(e){return Math.log(e)/Math.LN2}},"es6-impl","es3");
$jscomp.polyfill("String.prototype.repeat",function(n){return n?n:function(e){var b=$jscomp.checkStringArgs(this,null,"repeat");if(0>e||1342177279<e)throw new RangeError("Invalid count value");e|=0;for(var m="";e;)if(e&1&&(m+=b),e>>>=1)b+=b;return m}},"es6-impl","es3");$jscomp.EXPOSE_ASYNC_EXECUTOR=!0;$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(n){function e(){this.batch_=null}if(n&&!$jscomp.FORCE_POLYFILL_PROMISE)return n;e.prototype.asyncExecute=function(b){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(b);return this};e.prototype.asyncExecuteBatch_=function(){var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})};var b=$jscomp.global.setTimeout;e.prototype.asyncExecuteFunction=function(e){b(e,0)};e.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var b=
this.batch_;this.batch_=[];for(var a=0;a<b.length;++a){var c=b[a];delete b[a];try{c()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};e.prototype.asyncThrow_=function(b){this.asyncExecuteFunction(function(){throw b;})};var m=function(b){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{b(a.resolve,a.reject)}catch(c){a.reject(c)}};m.prototype.createResolveAndReject_=function(){function b(b){return function(l){c||(c=!0,b.call(a,l))}}var a=this,c=
!1;return{resolve:b(this.resolveTo_),reject:b(this.reject_)}};m.prototype.resolveTo_=function(b){if(b===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(b instanceof m)this.settleSameAsPromise_(b);else{var a;a:switch(typeof b){case "object":a=null!=b;break a;case "function":a=!0;break a;default:a=!1}a?this.resolveToNonPromiseObj_(b):this.fulfill_(b)}};m.prototype.resolveToNonPromiseObj_=function(b){var a=void 0;try{a=b.then}catch(c){this.reject_(c);return}"function"==
typeof a?this.settleSameAsThenable_(a,b):this.fulfill_(b)};m.prototype.reject_=function(b){this.settle_(2,b)};m.prototype.fulfill_=function(b){this.settle_(1,b)};m.prototype.settle_=function(b,a){if(0!=this.state_)throw Error("Cannot settle("+b+", "+a|"): Promise already settled in state"+this.state_);this.state_=b;this.result_=a;this.executeOnSettledCallbacks_()};m.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var b=this.onSettledCallbacks_,a=0;a<b.length;++a)b[a].call(),
b[a]=null;this.onSettledCallbacks_=null}};var u=new e;m.prototype.settleSameAsPromise_=function(b){var a=this.createResolveAndReject_();b.callWhenSettled_(a.resolve,a.reject)};m.prototype.settleSameAsThenable_=function(b,a){var c=this.createResolveAndReject_();try{b.call(a,c.resolve,c.reject)}catch(l){c.reject(l)}};m.prototype.then=function(b,a){function c(a,b){return"function"==typeof a?function(b){try{l(a(b))}catch(g){p(g)}}:b}var l,p,e=new m(function(a,b){l=a;p=b});this.callWhenSettled_(c(b,l),
c(a,p));return e};m.prototype.catch=function(b){return this.then(void 0,b)};m.prototype.callWhenSettled_=function(b,a){function c(){switch(l.state_){case 1:b(l.result_);break;case 2:a(l.result_);break;default:throw Error("Unexpected state: "+l.state_);}}var l=this;null==this.onSettledCallbacks_?u.asyncExecute(c):this.onSettledCallbacks_.push(function(){u.asyncExecute(c)})};m.resolve=function(b){return b instanceof m?b:new m(function(a,c){a(b)})};m.reject=function(b){return new m(function(a,c){c(b)})};
m.race=function(b){return new m(function(a,c){for(var l=$jscomp.makeIterator(b),p=l.next();!p.done;p=l.next())m.resolve(p.value).callWhenSettled_(a,c)})};m.all=function(b){var a=$jscomp.makeIterator(b),c=a.next();return c.done?m.resolve([]):new m(function(b,p){function l(a){return function(g){v[a]=g;k--;0==k&&b(v)}}var v=[],k=0;do v.push(void 0),k++,m.resolve(c.value).callWhenSettled_(l(v.length-1),p),c=a.next();while(!c.done)})};$jscomp.EXPOSE_ASYNC_EXECUTOR&&(m.$jscomp$new$AsyncExecutor=function(){return new e});
return m},"es6-impl","es3");$jscomp.polyfill("Array.prototype.entries",function(n){return n?n:function(){return $jscomp.iteratorFromArray(this,function(e,b){return[e,b]})}},"es6-impl","es3");$jscomp.polyfill("Math.sign",function(n){return n?n:function(e){e=Number(e);return 0===e||isNaN(e)?e:0<e?1:-1}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.fill",function(n){return n?n:function(e,b,m){var u=this.length||0;0>b&&(b=Math.max(0,u+b));if(null==m||m>u)m=u;m=Number(m);0>m&&(m=Math.max(0,u+m));for(b=Number(b||0);b<m;b++)this[b]=e;return this}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.copyWithin",function(n){return n?n:function(e,b,m){var u=this.length;e=Number(e);b=Number(b);m=Number(null!=m?m:u);if(e<b)for(m=Math.min(m,u);b<m;)b in this?this[e++]=this[b++]:(delete this[e++],b++);else for(m=Math.min(m,u+b-e),e+=m-b;m>b;)--m in this?this[--e]=this[m]:delete this[e];return this}},"es6-impl","es3");
(function(n){function e(m){if(b[m])return b[m].exports;var u=b[m]={i:m,l:!1,exports:{}};n[m].call(u.exports,u,u.exports,e);u.l=!0;return u.exports}var b={};e.m=n;e.c=b;e.i=function(b){return b};e.d=function(b,u,r){e.o(b,u)||Object.defineProperty(b,u,{configurable:!1,enumerable:!0,get:r})};e.n=function(b){var m=b&&b.__esModule?function(){return b["default"]}:function(){return b};e.d(m,"a",m);return m};e.o=function(b,e){return Object.prototype.hasOwnProperty.call(b,e)};e.p="";return e(e.s=227)})([function(n,
e,b){function m(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function u(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function r(a,b,c,k){a.addEventListener(b,c,k);return function(){return a.removeEventListener(b,
c,k)}}b.d(e,"a",function(){return r});b.d(e,"b",function(){return c});b.d(e,"c",function(){return l});var a=function(){function a(a,b){for(var c=0;c<b.length;c++){var h=b[c];h.enumerable=h.enumerable||!1;h.configurable=!0;"value"in h&&(h.writable=!0);Object.defineProperty(a,h.key,h)}}return function(b,c,k){c&&a(b.prototype,c);k&&a(b,k);return b}}(),c=function(){function b(){u(this,b);this.refCount=1}a(b,[{key:"addRef",value:function(){++this.refCount;return this}},{key:"dispose",value:function(){0===
--this.refCount&&this.refCountReachedZero()}},{key:"refCountReachedZero",value:function(){this.disposed();var a=this.disposers;if(null!=a){for(var b=a.length;0<b;--b){var c=a[b-1];"object"===typeof c?c.dispose():c.call(this)}this.disposers=void 0}this.wasDisposed=!0}},{key:"disposed",value:function(){}},{key:"registerDisposer",value:function(a){var b=this.disposers;null==b?this.disposers=[a]:b.push(a);return a}},{key:"unregisterDisposer",value:function(a){var b=this.disposers;if(null!=b){var c=b.indexOf(a);
-1!==c&&b.splice(c,1)}return a}},{key:"registerEventListener",value:function(a,b,c,h){this.registerDisposer(r(a,b,c,h))}},{key:"registerCancellable",value:function(a){this.registerDisposer(function(){a.cancel()});return a}}]);return b}(),l=function(a){function b(a){u(this,b);var c;c=(b.__proto__||Object.getPrototypeOf(b)).call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");c=!c||"object"!==typeof c&&"function"!==typeof c?this:c;c.value=a;return c}
m(b,a);return b}(c)},function(n,e,b){function m(a,b){var c=Math.abs(a[b]),p=Math.abs(a[b+1]),e=Math.abs(a[b+2]),v=Math.max(c,p,e);1E-4>c/v&&(a[b]=0);1E-4>p/v&&(a[b+1]=0);1E-4>e/v&&(a[b+2]=0)}b.d(e,"p",function(){return r});e.b=function(a){return a[0]*a[1]*a[2]};e.o=function(a){return a[0]+","+a[1]+","+a[2]};e.d=function(a){m(a,0);m(a,4);m(a,8)};e.f=function(a,b,l){var c=b[0],e=b[1];b=b[2];a[0]=l[0]*c+l[4]*e+l[8]*b;a[1]=l[1]*c+l[5]*e+l[9]*b;a[2]=l[2]*c+l[6]*e+l[10]*b;return a};e.i=function(a,b){var c=
b[0],p=b[1],e=b[2],v=b[4],k=b[5],h=b[6],g=b[8],d=b[9];b=b[10];a[0]=Math.sqrt(c*c+p*p+e*e);a[1]=Math.sqrt(v*v+k*k+h*h);a[2]=Math.sqrt(g*g+d*d+b*b);return a};e.r=function(a,b,l,p,e){a[0]=p[0];a[1]=p[1];a[2]=p[2]*e;return u.b.fromRotationTranslationScale(a,l,b,a)};var u=b(99);n=b(11);b.d(e,"l",function(){return u.d});b.d(e,"c",function(){return u.b});b.d(e,"k",function(){return u.c});b.d(e,"a",function(){return u.a});b.d(e,"m",function(){return u.e});b=u.b.create();e.h=b;e.n=["x","y","z"];var r=function c(b,
p){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.lower=b;this.upper=p};b=[u.a.fromValues(1,0,0),u.a.fromValues(0,1,0),u.a.fromValues(0,0,1)];e.g=b;b=u.a.fromValues(0,0,0);e.e=b;b=u.a.fromValues(1,1,1);e.q=b;b=u.a.fromValues(Infinity,Infinity,Infinity);e.j=b;u.c.create();new n.a(1227133513,306783378);new n.a(3272356035,818089008);new n.a(251719695,4027515120);new n.a(4278190335,16711680);new n.a(65535,16711680);new n.a(2097151,0)},function(n,e,b){function m(a){var d=
typeof a;if("number"===d||"string"===d)if(d=parseFloat(""+a),!Number.isNaN(d))return d;throw Error("Expected floating-point number, but received: "+JSON.stringify(a)+".");}function u(a){a=m(a);if(Number.isFinite(a))return a;throw Error("Expected finite floating-point number, but received: "+a+".");}function r(a){a=u(a);if(0<a)return a;throw Error("Expected positive finite floating-point number, but received: "+a+".");}function a(d){if("object"===typeof d){if(null===d)return"null";if(Array.isArray(d)){var b=
"[",f=d.length,g=0;if(g<f)for(b+=a(d[g]);++g<f;)b+=",",b+=a(d[g]);return b+"]"}var b="{",f=Object.keys(d).sort(),g=0,c=f.length;if(g<c)for(var q=f[g],b=b+JSON.stringify(q),b=b+":"+a(d[q]);++g<c;)b+=",",q=f[g],b+=JSON.stringify(q),b+=":",b+=a(d[q]);return b+"}"}return JSON.stringify(d)}function c(a){return a.replace(/['"]/g,function(a){return'"'===a?"'":'"'})}function l(a){if("object"===typeof a){if(null===a)return"null";var d=a.toJSON;if("function"===typeof d)return l(d.call(a));if(Array.isArray(a)){var d=
"[",b=a.length,f=0;if(f<b)for(d+=l(a[f]);++f<b;)d+="_",d+=l(a[f]);return d+"]"}for(var d="{",f=Object.keys(a),b=!0,f=$jscomp.makeIterator(f),g=f.next();!g.done;g=f.next()){var g=g.value,q=a[g];void 0!==q&&(q=l(q))&&(b?b=!1:d+="_",d+=c(JSON.stringify(c(g))),d+=":",d+=q)}return d+"}"}return"string"===typeof a?c(JSON.stringify(c(a))):JSON.stringify(a)}function p(a,d,b){var f=/[&_,]/g,g,c,h;'"'===b?(g="'",c=F,h=q):(g='"',c=C,h=x);for(var k="";0<a.length;){var z=a.match(h),v;if(null===z)v=a,z=a="";else{v=
a.substr(0,z.index);a=a.substr(z.index+z[0].length);var l=z[1];if(void 0!==l){var B=l,E=g,z=b,l=c;if(2<=B.length&&B.charAt(0)===E&&B.charAt(B.length-1)===E){B=B.substr(1,B.length-2);for(E=z;0<B.length;){var p=B.match(l);if(null===p){E+=B;break}E+=p[1];E+="\\";E+=z;B=B.substr(p.index+p[0].length)}z=E+z}else z=B}else z=z[2]}k+=v.replace(f,d);k+=z}return k}function w(a){return JSON.parse(p(a,",",'"'))}function v(a,d,b){var f=a.length;if(!Array.isArray(d)||d.length!==f)throw Error("Expected length "+
f+" array, but received: "+JSON.stringify(d)+".");for(var g=0;g<f;++g)a[g]=b(d[g],g);return a}function k(a){if("object"!==typeof a||null==a||Array.isArray(a))throw Error("Expected JSON object, but received: "+JSON.stringify(a)+".");return a}function h(a){var d=parseInt(a,10);if(!Number.isInteger(d))throw Error("Expected integer, but received: "+JSON.stringify(a)+".");return d}function g(a){a=h(a);if(0>=a)throw Error("Expected positive integer, but received: "+a+".");return a}function d(a){if("string"!==
typeof a)throw Error("Expected string, but received: "+JSON.stringify(a)+".");return a}e.r=m;e.j=u;e.o=r;e.A=function(a,d,b){b=void 0===b?m:b;k(d);var f=Object.keys(d);f.sort();if(3!==f.length||"x"!==f[0]||"y"!==f[1]||"z"!==f[2])throw Error("Expected object to have keys ['x', 'y', 'z'], but received: "+JSON.stringify(d)+".");a[0]=b(d.x);a[1]=b(d.y);a[2]=b(d.z);return a};e.g=function(a,d){var b=a.length;if(!Array.isArray(d)||d.length!==b)throw Error("Incompatible sizes");for(var f=0;f<b;++f)if(!Number.isFinite(parseFloat(d[f])))throw Error("Non-finite value.");
for(f=0;f<b;++f)a[f]=parseFloat(d[f]);return a};e.p=function(a,d){var b=a.length;if(!Array.isArray(d)||d.length!==b)throw Error("Incompatible sizes.");for(var f=0;f<b;++f){var g=parseInt(d[f],void 0);if(!Number.isInteger(g))throw Error("Non-integer value.");}for(f=0;f<b;++f)a[f]=parseInt(d[f],void 0);return a};e.f=a;e.b=l;e.c=w;e.k=function(a,d){if(!Array.isArray(a))throw Error("Expected array, but received: "+JSON.stringify(a)+".");return a.map(d)};e.i=v;e.a=k;e.x=h;e.q=g;e.v=function(a,d){var b=
d.get(a);if(void 0===b)throw Error("Expected one of "+JSON.stringify(Array.from(d.keys()))+", "+("but received: "+JSON.stringify(a)+"."));return b};e.h=d;e.e=function(a){if(void 0!==a)return d(a)};e.s=function(a){if(void 0!==a)return h(a)};e.t=function(a){if(void 0!==a){if("boolean"===typeof a)return a;if("true"===a)return!0;if("false"===a)return!1;throw Error("Expected string or boolean but received: "+JSON.stringify(a));}};e.d=function(a,d,b){a=a.hasOwnProperty(d)?a[d]:void 0;try{return b(a)}catch(y){throw Error("Error parsing "+
JSON.stringify(d)+" property: "+y.message);}};e.w=function(a,d){k(a);for(var b=new Map,f=$jscomp.makeIterator(Object.keys(a)),g=f.next();!g.done;g=f.next()){g=g.value;try{b.set(g,d(a[g]))}catch(G){throw Error("Error parsing value associated with key "+JSON.stringify(g)+": "+G.message);}}return b};e.m=function(a){if("number"!==typeof a||!Number.isFinite(a)||0>a||1<a)throw Error("Expected floating point number in [0,1], but received: "+JSON.stringify(a)+".");return a};e.u=function(a){if(""===a)return{};
if(a.startsWith("{"))return w(a);var d={};a=a.split(/[&;]/);a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next()){var b=b.value,f=b.match(/^([^=&;]+)=([^&;]*)$/);if(null===f)throw Error("Invalid query string part: "+JSON.stringify(b)+".");d[f[1]]=decodeURIComponent(f[2])}return d};e.n=function(a,d){if("string"===typeof a&&null!==a.match(/^[a-zA-Z]/)&&(a=a.toUpperCase(),d.hasOwnProperty(a)))return d[a];throw Error("Invalid enum value: "+JSON.stringify(a)+".");};e.l=function(a){return v(f.a.create(),
a,u)};e.y=function(a){return v(f.a.create(),a,r)};e.z=function(a){return v(f.a.create(),a,g)};var f=b(1);n=/('(?:[^'\\]|(?:\\.))*')/;e=/("(?:[^'\\]|(?:\\.))*")/;var q=new RegExp(n.source+"|"+e.source),x=new RegExp(e.source+"|"+n.source),F=/^((?:[^"'\\]|(?:\\.))*)"/,C=/^((?:[^"'\\]|(?:\\.))*)'/},function(n,e,b){function m(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,
enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function u(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}b.d(e,"b",function(){return a});b.d(e,"a",function(){return c});var r=function(){function a(a,b){for(var c=0;c<b.length;c++){var k=b[c];k.enumerable=k.enumerable||!1;k.configurable=!0;"value"in k&&(k.writable=!0);Object.defineProperty(a,k.key,k)}}return function(b,c,v){c&&a(b.prototype,c);v&&
a(b,v);return b}}(),a=function(){function a(){u(this,a);this.handlers=new Set;this.count=0;var b=this;this.dispatch=function(){var a=this,c=arguments;++b.count;b.handlers.forEach(function(b){b.apply(a,c)})}}r(a,[{key:"add",value:function(a){var b=this;this.handlers.add(a);return function(){return b.remove(a)}}},{key:"remove",value:function(a){return this.handlers.delete(a)}},{key:"dispose",value:function(){this.handlers=void 0}}]);return a}(),c=function(a){function b(){u(this,b);var a=(b.__proto__||
Object.getPrototypeOf(b)).apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!==typeof a&&"function"!==typeof a?this:a}m(b,a);return b}(a)},function(n,e,b){function m(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?
Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return l});b.d(e,"d",function(){return p});var u=b(40),r=b(28),a=b(1);b.d(e,"b",function(){return r.b});var c=function(){function a(a,b){for(var c=0;c<b.length;c++){var g=b[c];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(a,g.key,g)}}return function(b,c,h){c&&a(b.prototype,c);h&&a(b,h);return b}}(),l;(function(a){a[a.UNKNOWN=0]="UNKNOWN";a[a.IMAGE=1]="IMAGE";a[a.SEGMENTATION=2]="SEGMENTATION"})(l||
(l={}));var p=function(e){function v(c){if(!(this instanceof v))throw new TypeError("Cannot call a class as a function");var h;h=(v.__proto__||Object.getPrototypeOf(v)).call(this,c);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");h=!h||"object"!==typeof h&&"function"!==typeof h?this:h;var g=h.dataType=c.dataType,d=h.numChannels=c.numChannels;h.chunkBytes=b.i(a.b)(c.chunkDataSize)*r.a[g]*d;h.compressedSegmentationBlockSize=c.compressedSegmentationBlockSize;
return h}m(v,e);c(v,[{key:"toObject",value:function(){return{transform:this.chunkLayout.transform,numChannels:this.numChannels,chunkDataSize:this.chunkDataSize,voxelSize:this.voxelSize,dataType:this.dataType,lowerVoxelBound:this.lowerVoxelBound,upperVoxelBound:this.upperVoxelBound,lowerClipBound:this.lowerClipBound,upperClipBound:this.upperClipBound,baseVoxelOffset:this.baseVoxelOffset,compressedSegmentationBlockSize:this.compressedSegmentationBlockSize}}}],[{key:"make",value:function(a){return new v(Object.assign({},
a,{transform:b.i(u.a)(a.transform,a.volumeSourceOptions)}))}},{key:"fromObject",value:function(a){return new v(a)}},{key:"withDefaultCompression",value:function(a){var c=a.compressedSegmentationBlockSize,g=a.dataType,d=a.voxelSize,f=a.transform,q=a.lowerVoxelBound,k=a.upperVoxelBound,f=b.i(u.a)(f,a.volumeSourceOptions);void 0!==c||a.volumeType!==l.SEGMENTATION||g!==r.b.UINT32&&g!==r.b.UINT64||(c=b.i(u.b)({voxelSize:d,transform:f,lowerVoxelBound:q,upperVoxelBound:k,maxVoxelsPerChunkLog2:9}));return new v(Object.assign({},
a,{compressedSegmentationBlockSize:c,transform:f}))}},{key:"getDefaults",value:function(a){var c=Object.assign({},a,{transform:b.i(u.a)(a.transform,a.volumeSourceOptions)});return(void 0===a.chunkDataSizes?b.i(u.c)(c):a.chunkDataSizes).map(function(b){return v.withDefaultCompression(Object.assign({},a,{chunkDataSize:b}))})}}]);return v}(u.d);e.c="volume/RenderLayer"},function(n,e,b){b.d(e,"a",function(){return r});e.b=function(a){return(a[3]+1/256*a[2]+1/65536*a[1]+1/16777216*a[0])/256};b.d(e,"q",
function(){return a});b.d(e,"c",function(){return p});b.d(e,"p",function(){return w});b.d(e,"o",function(){return v});e.m=function(a,b){for(var g=0;4>g;++g)a[g]=(b>>8*g&255)/255;return a};e.d=function(a,b){b=void 0===b?1:b;switch(a){case m.b.FLOAT32:if(1===b)return"float";if(1<b&&4>b)return"vec"+b;break;case m.b.UINT8:if(1===b)return"uint8_t";if(1<b&&4>b)return"uint8x"+b+"_t";break;case m.b.UINT16:if(1===b)return"uint16_t";if(2===b)return"uint16x2_t";break;case m.b.UINT32:if(1===b)return"uint32_t";
break;case m.b.UINT64:if(1===b)return"uint64_t"}throw Error("No shader type for "+m.b[a]+"["+b+"].");};var m=b(28),u=b(164),r="\nvec4 packFloat01ToFixedPoint(const float value) {\n  const vec4 shift = vec4(256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0);\n  const vec4 mask = vec4(0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0);\n  vec4 result = fract(value * shift);\n  result -= result.xxyz * mask;\n  return result * 256.0 / 255.0;\n}\n",a="\nvec3 hueToRgb(float hue) {\n  float hue6 = hue * 6.0;\n  float r = abs(hue6 - 3.0) - 1.0;\n  float g = 2.0 - abs(hue6 - 2.0);\n  float b = 2.0 - abs(hue6 - 4.0);\n  return clamp(vec3(r, g, b), 0.0, 1.0);\n}\nvec3 hsvToRgb(vec3 c) {\n  vec3 hueRgb = hueToRgb(c.x);\n  return c.z * ((hueRgb - 1.0) * c.y + 1.0);\n}\n";
n=["float","vec2","vec3","vec4"].map(function(a){return"\n"+a+" unnormalizeUint8("+a+" value) {\n  return floor(value * 255.0 + 0.5);\n}\n"}).join("");e.f=n;var c=[n,"\nfloat uintleToFloat(float v) {\n  return unnormalizeUint8(v);\n}\nfloat uintleToFloat(vec2 v) {\n  v = unnormalizeUint8(v);\n  return v.x + v.y * 256.0;\n}\nfloat uintleToFloat(vec3 v) {\n  v = unnormalizeUint8(v);\n  return v.x + v.y * 256.0 + v.z * 256.0 * 256.0;\n}\n"];e.g=c;var l=[n,"\nfloat uintbeToFloat(float v) {\n  return unnormalizeUint8(v);\n}\nfloat uintbeToFloat(vec2 v) {\n  v = unnormalizeUint8(v);\n  return v.y + v.x * 256.0;\n}\nfloat uintbeToFloat(vec3 v) {\n  v = unnormalizeUint8(v);\n  return v.z + v.y * 256.0 + v.x * 256.0 * 256.0;\n}\n"];
(function(){var a=u.a===u.b.BIG?"be":"le";return[u.a===u.b.BIG?l:c,"\nfloat uintToFloat(float v) {\n  return uint"+a+"ToFloat(v);\n}\nfloat uintToFloat(vec2 v) {\n  return uint"+a+"ToFloat(v);\n}\nfloat uintToFloat(vec3 v) {\n  return uint"+a+"ToFloat(v);\n}\n"]})();e.e="\nstruct uint64_t {\n  vec4 low, high;\n};\nuint64_t toUint64(uint64_t x) { return x; }\n";e.h=[n,"\nstruct uint64_t {\n  vec4 low, high;\n};\nuint64_t toUint64(uint64_t x) { return x; }\n","\nstruct uint8_t {\n  float value;\n};\nstruct uint8x2_t {\n  vec2 value;\n};\nstruct uint8x3_t {\n  vec3 value;\n};\nstruct uint8x4_t {\n  vec4 value;\n};\nfloat toRaw(uint8_t x) { return unnormalizeUint8(x.value); }\nfloat toNormalized(uint8_t x) { return x.value; }\nvec2 toRaw(uint8x2_t x) { return unnormalizeUint8(x.value); }\nvec2 toNormalized(uint8x2_t x) { return x.value; }\nvec3 toRaw(uint8x3_t x) { return unnormalizeUint8(x.value); }\nvec3 toNormalized(uint8x3_t x) { return x.value; }\nvec4 toRaw(uint8x4_t x) { return unnormalizeUint8(x.value); }\nvec4 toNormalized(uint8x4_t x) { return x.value; }\nuint64_t toUint64(uint8_t x) {\n  uint64_t result;\n  result.low = vec4(x.value, 0.0, 0.0, 0.0);\n  result.high = vec4(0.0, 0.0, 0.0, 0.0);\n  return result;\n}\n"];
e.k="\nfloat toRaw(float x) { return x; }\nfloat toNormalized(float x) { return x; }\nvec2 toRaw(vec2 x) { return x; }\nvec2 toNormalized(vec2 x) { return x; }\nvec3 toRaw(vec3 x) { return x; }\nvec3 toNormalized(vec3 x) { return x; }\nvec4 toRaw(vec4 x) { return x; }\nvec4 toNormalized(vec4 x) { return x; }\n";e.i=["\nstruct uint64_t {\n  vec4 low, high;\n};\nuint64_t toUint64(uint64_t x) { return x; }\n",c,"\nstruct uint16_t {\n  vec2 value;\n};\nstruct uint16x2_t {\n  vec4 value;\n};\nfloat toRaw(uint16_t x) { return uintleToFloat(x.value); }\nfloat toNormalized(uint16_t x) { return toRaw(x) / 65535.0; }\nvec2 toRaw(uint16x2_t x) { return vec2(uintleToFloat(x.value.xy), uintleToFloat(x.value.zw)); }\nvec2 toNormalized(uint16x2_t x) { return toRaw(x) / 65535.0; }\nuint64_t toUint64(uint16_t x) {\n  uint64_t result;\n  result.low = vec4(x.value, 0.0, 0.0);\n  result.high = vec4(0.0, 0.0, 0.0, 0.0);\n  return result;\n}\n"];
n=["\nstruct uint64_t {\n  vec4 low, high;\n};\nuint64_t toUint64(uint64_t x) { return x; }\n","\nstruct uint32_t {\n  vec4 value;\n};\nuint64_t toUint64(uint32_t x) {\n  uint64_t result;\n  result.low = x.value;\n  result.high = vec4(0.0, 0.0, 0.0, 0.0);\n  return result;\n}\n"];e.j=n;var p=["\nvec3 getSubscriptsFromNormalized(vec3 normalizedPosition, vec3 size) {\n  return floor(min(normalizedPosition * size, size - 1.0));\n}\n","\nfloat getFortranOrderIndex(vec3 subscripts, vec3 size) {\n  return subscripts.x + size.x * (subscripts.y + size.y * subscripts.z);\n}\n",
"\nfloat getFortranOrderIndexFromNormalized(vec3 normalizedPosition, vec3 size) {\n  return getFortranOrderIndex(getSubscriptsFromNormalized(normalizedPosition, size), size);\n}\n"],w="\nfloat imod(float x, float y) {\n  return x - y * floor(x / y);\n}\n",v="\nfloat exactDot(vec4 a, vec4 b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n}\nfloat exactDot(vec3 a, vec3 b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n";e.l=[n,"\nuint32_t add(uint32_t a, uint32_t b) {\n  uint32_t result;\n  float partial = 0.0;\n\n  partial += a.value.x * 255.0 + b.value.x * 255.0;\n  {\n    float byte0 = mod(partial, 256.0);\n    result.value.x = byte0 / 255.0;\n    partial = (partial - byte0) / 256.0;\n  }\n\n  partial += a.value.y * 255.0 + b.value.y * 255.0;\n  {\n    float byte1 = mod(partial, 256.0);\n    result.value.y = byte1 / 255.0;\n    partial = (partial - byte1) / 256.0;\n  }\n\n  partial += a.value.z * 255.0 + b.value.z * 255.0;\n  {\n    float byte2 = mod(partial, 256.0);\n    result.value.z = byte2 / 255.0;\n    partial = (partial - byte2) / 256.0;\n  }\n\n  partial += a.value.w * 255.0 + b.value.w * 255.0;\n  {\n    float byte3 = mod(partial, 256.0);\n    result.value.w = byte3 / 255.0;\n    partial = (partial - byte3) / 256.0;\n  }\n  return result;\n}\n"];
e.n=[n,"\nfloat divmod(uint32_t dividend, float divisor, out uint32_t quotient) {\n\n  float partial = dividend.value.w * 255.0;\n  float remainder;\n\n  remainder = mod(partial, divisor);\n  quotient.value.w = (partial - remainder) / divisor / 255.0;\n  partial = remainder * 256.0 + dividend.value.z * 255.0;\n\n  remainder = mod(partial, divisor);\n  quotient.value.z = (partial - remainder) / divisor / 255.0;\n  partial = remainder * 256.0 + dividend.value.y * 255.0;\n\n  remainder = mod(partial, divisor);\n  quotient.value.y = (partial - remainder) / divisor / 255.0;\n  partial = remainder * 256.0 + dividend.value.x * 255.0;\n\n  remainder = mod(partial, divisor);\n  quotient.value.x = (partial - remainder) / divisor / 255.0;\n\n  return remainder;\n}\n"]},
function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,
configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function a(a,b){w.set(a,b)}e.e=a;e.g=function(b,d){a(b,function(a){var b=this,f=a.id,g=new c.a;a=d.call(this,a,g);this.set(f,{promise:a,cancellationToken:g});a.then(function(a){var d=a.value;a=a.transfers;b.delete(f);b.invoke("rpc.promise.response",{id:f,value:d},a)},function(a){b.delete(f);b.invoke("rpc.promise.response",{id:f,error:a.message,errorName:a.name})})})};b.d(e,"a",function(){return k});b.d(e,"b",function(){return h});
b.d(e,"c",function(){return g});e.f=function(a){return function(b){b.prototype.RPC_TYPE_ID=a}};e.d=function(a){return function(b){if(void 0!==a)b.prototype.RPC_TYPE_ID=a;else if(a=b.prototype.RPC_TYPE_ID,void 0===a)throw Error("RPC_TYPE_ID should have already been defined");d.set(a,b)}};var c=b(13);n=b(0);var l=function q(a,b,d){null===a&&(a=Function.prototype);var g=Object.getOwnPropertyDescriptor(a,b);if(void 0===g){if(a=Object.getPrototypeOf(a),null!==a)return q(a,b,d)}else{if("value"in g)return g.value;
b=g.get;return void 0===b?void 0:b.call(d)}},p=function(){function a(a,b){for(var d=0;d<b.length;d++){var g=b[d];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(a,g.key,g)}}return function(b,d,g){d&&a(b.prototype,d);g&&a(b,g);return b}}(),w=new Map,v=function(a){function b(a,d){m(this,b);var g=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,d));g.name=a;g.message=d;return g}r(b,a);return b}(Error);a("rpc.promise.cancel",function(a){this.get(a.id).cancellationToken.cancel()});
a("rpc.promise.response",function(a){var b=a.id,d=this.get(b),g=d.resolve,d=d.reject;this.delete(b);a.hasOwnProperty("value")?g(a.value):a.errorName===c.b.name?d(c.b):d(new v(a.errorName,a.error))});var k=function(){function a(b){var d=this;m(this,a);this.target=b;this.objects=new Map;this.nextId=0;b.onmessage=function(a){a=a.data;w.get(a.functionName).call(d,a)}}p(a,[{key:"set",value:function(a,b){this.objects.set(a,b)}},{key:"delete",value:function(a){this.objects.delete(a)}},{key:"get",value:function(a){return this.objects.get(a)}},
{key:"getRef",value:function(a){var b=this.get(a.id);b.referencedGeneration=a.gen;b.addRef();return b}},{key:"invoke",value:function(a,b,d){b.functionName=a;this.target.postMessage(b,d)}},{key:"promiseInvoke",value:function(a,d,g,q){g=void 0===g?c.c:g;var h=this;return b.i(c.d)(g,function(b,g,c){var k=d.id=h.newId();h.set(k,{resolve:b,reject:g});h.invoke(a,d,q);c.add(function(){h.invoke("rpc.promise.cancel",{id:k})})})}},{key:"newId",value:function(){return this.nextId++}},{key:"numObjects",get:function(){return this.objects.size}}]);
return a}(),h=function(a){function b(){m(this,b);var a=u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));a.rpc=null;a.rpcId=null;return a}r(b,a);p(b,[{key:"initializeSharedObject",value:function(a,b){b=void 0===b?a.newId():b;this.rpc=a;this.rpcId=b;this.isOwner=!1;a.set(b,this)}},{key:"initializeCounterpart",value:function(a,b){b=void 0===b?{}:b;this.initializeSharedObject(a);this.referencedGeneration=this.unreferencedGeneration=0;this.isOwner=!0;b.id=this.rpcId;b.type=this.RPC_TYPE_ID;
a.invoke("SharedObject.new",b)}},{key:"dispose",value:function(){l(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"dispose",this).call(this)}},{key:"addCounterpartRef",value:function(){return{id:this.rpcId,gen:++this.referencedGeneration}}},{key:"refCountReachedZero",value:function(){!0===this.isOwner?this.referencedGeneration===this.unreferencedGeneration&&this.ownerDispose():!1===this.isOwner?this.rpc.invoke("SharedObject.refCountReachedZero",{id:this.rpcId,gen:this.referencedGeneration}):
l(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"refCountReachedZero",this).call(this)}},{key:"ownerDispose",value:function(){var a=this.rpc,d=this.rpcId;l(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"refCountReachedZero",this).call(this);a.delete(d);a.invoke("SharedObject.dispose",{id:d})}},{key:"counterpartRefCountReachedZero",value:function(a){this.unreferencedGeneration=a;0===this.refCount&&a===this.referencedGeneration&&this.ownerDispose()}}]);return b}(n.b),g=function(a){function b(a,
d){d=void 0===d?{}:d;m(this,b);var g=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));d=void 0===d?{}:d;null!=a&&g.initializeSharedObject(a,d.id);return g}r(b,a);return b}(h);a("SharedObject.dispose",function(a){a=this.get(a.id);if(0!==a.refCount)throw Error("Attempted to dispose object with non-zero reference count.");a.disposed();this.delete(a.rpcId);a.rpcId=null;a.rpc=null});a("SharedObject.refCountReachedZero",function(a){this.get(a.id).counterpartRefCountReachedZero(a.gen)});var d=
new Map;a("SharedObject.new",function(a){--(new (d.get(a.type))(this,a)).refCount})},function(n,e,b){function m(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function u(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");
}b.d(e,"a",function(){return c});b.d(e,"b",function(){return l});var r=b(3),a=function(){function a(a,b){for(var c=0;c<b.length;c++){var h=b[c];h.enumerable=h.enumerable||!1;h.configurable=!0;"value"in h&&(h.writable=!0);Object.defineProperty(a,h.key,h)}}return function(b,c,k){c&&a(b.prototype,c);k&&a(b,k);return b}}(),c=function(){function b(a){u(this,b);this.value_=a;this.changed=new r.a}a(b,[{key:"value",get:function(){return this.value_},set:function(a){a!==this.value_&&(this.value_=a,this.changed.dispatch())}}]);
return b}(),l=function(b){function c(a,b,h){h=void 0===h?a:h;u(this,c);a=(c.__proto__||Object.getPrototypeOf(c)).call(this,a);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");a=!a||"object"!==typeof a&&"function"!==typeof a?this:a;a.validator=b;a.defaultValue=h;return a}m(c,b);a(c,[{key:"toJSON",value:function(){if(this.value_!==this.defaultValue)return this.value_}},{key:"reset",value:function(){this.value=this.defaultValue}},{key:"restoreState",value:function(a){if(void 0!==
a){var b=this.validator;try{this.value=b(a);return}catch(h){}}this.value=this.defaultValue}}]);return c}(c)},function(n,e,b){e.b=function(b){for(;;){var e=b.firstElementChild;if(!e)break;b.removeChild(e)}};e.a=function(b){var e=b.parentElement;return e?(e.removeChild(b),!0):!1}},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&
null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function r(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}b.d(e,"d",function(){return d});b.d(e,"a",function(){return f});b.d(e,"b",function(){return q});b.d(e,"c",function(){return x});e.e=
function(a,d){a=function(a){function b(a){for(var d=[],f=0;f<arguments.length;++f)d[f-0]=arguments[f];r(this,b);var g,f=m(this,(g=b.__proto__||Object.getPrototypeOf(b)).call.apply(g,[].concat([this],$jscomp.arrayFromIterable(d))));f.parameters=d[1].parameters;return f}u(b,a);h(b,[{key:"initializeCounterpart",value:function(a,d){d.parameters=this.parameters;k(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"initializeCounterpart",this).call(this,a,d)}}],[{key:"encodeOptions",value:function(a){var d=
k(b.__proto__||Object.getPrototypeOf(b),"encodeOptions",this).call(this,a);d.parameters=a.parameters;return d}}]);return b}(a);return a=g([b.i(v.f)(d.RPC_ID)],a)};var a=b(18),c=b(2),l=b(50),p=b(20),w=b(3),v=b(6),k=function C(a,b,d){null===a&&(a=Function.prototype);var f=Object.getOwnPropertyDescriptor(a,b);if(void 0===f){if(a=Object.getPrototypeOf(a),null!==a)return C(a,b,d)}else{if("value"in f)return f.value;b=f.get;return void 0===b?void 0:b.call(d)}},h=function(){function a(a,b){for(var d=0;d<
b.length;d++){var f=b[d];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(a,f.key,f)}}return function(b,d,f){d&&a(b.prototype,d);f&&a(b,f);return b}}(),g=this&&this.__decorate||function(a,b,d,f){var g=arguments.length,c=3>g?b:null===f?f=Object.getOwnPropertyDescriptor(b,d):f,q;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)c=Reflect.decorate(a,b,d,f);else for(var h=a.length-1;0<=h;h--)if(q=a[h])c=(3>g?q(c):3<g?q(b,d,c):q(b,d))||
c;return 3<g&&c&&Object.defineProperty(b,d,c),c},d=function(){function b(d){r(this,b);this.source=d;this.state=a.b.SYSTEM_MEMORY}h(b,[{key:"copyToGPU",value:function(b){this.state=a.b.GPU_MEMORY}},{key:"freeGPUMemory",value:function(b){this.state=a.b.SYSTEM_MEMORY}},{key:"gl",get:function(){return this.source.gl}}]);return b}(),f=function(b){function d(a,b,f){r(this,d);var g=m(this,(d.__proto__||Object.getPrototypeOf(d)).call(this));g.gl=b;g.visibleChunksChanged=new w.a;g.pendingChunkUpdates=null;
g.pendingChunkUpdatesTail=null;g.chunkUpdateDeadline=null;g.chunkUpdateDelay=30;g.initializeCounterpart(a,{gpuMemoryCapacity:f.gpuMemory.toObject(),systemMemoryCapacity:f.systemMemory.toObject(),downloadCapacity:f.download.toObject()});return g}u(d,b);h(d,[{key:"scheduleChunkUpdate",value:function(){var a=this.chunkUpdateDeadline,a=null===a||Date.now()<a?0:this.chunkUpdateDelay;setTimeout(this.processPendingChunkUpdates.bind(this),a)}},{key:"processPendingChunkUpdates",value:function(){var b=this.chunkUpdateDeadline;
if(null!==b&&Date.now()>b)setTimeout(this.processPendingChunkUpdates.bind(this),this.chunkUpdateDelay);else{var b=this.pendingChunkUpdates,d=this.rpc.get(b.source),f=b.state;if(f===a.b.EXPIRED)d.deleteChunk(b.id);else{var g,c=b.id;b["new"]?(g=d.getChunk(b),d.addChunk(c,g)):g=d.chunks.get(c);if(f!==g.state)switch(f){case a.b.GPU_MEMORY:g.copyToGPU(this.gl);this.visibleChunksChanged.dispatch();break;case a.b.SYSTEM_MEMORY:g.freeGPUMemory(this.gl);break;default:throw Error("INTERNAL ERROR: Invalid chunk state: "+
a.b[f]);}}null!=(this.pendingChunkUpdates=b.nextUpdate)?this.scheduleChunkUpdate():this.pendingChunkUpdatesTail=null}}}]);return d}(v.b),f=g([b.i(v.f)(a.c)],f);b.i(v.e)("Chunk.update",function(a){var b=this.get(a.source).chunkManager.chunkQueueManager,d=b.pendingChunkUpdatesTail;null==d?(b.pendingChunkUpdates=a,b.pendingChunkUpdatesTail=a,b.scheduleChunkUpdate()):(d.nextUpdate=a,b.pendingChunkUpdatesTail=a)});var q=function(a){function d(a){r(this,d);var b=m(this,(d.__proto__||Object.getPrototypeOf(d)).call(this));
b.chunkQueueManager=a;b.memoize=new l.a;b.registerDisposer(a.addRef());b.initializeCounterpart(a.rpc,{chunkQueueManager:a.rpcId});return b}u(d,a);h(d,[{key:"getChunkSource",value:function(a,d){var f=this,g=a.encodeOptions(d);g.constructorId=b.i(p.a)(a);g=b.i(c.f)(g);return this.memoize.get(g,function(){var b=new a(f,d);b.initializeCounterpart(f.rpc,{});return b})}},{key:"gl",get:function(){return this.chunkQueueManager.gl}}]);return d}(v.b),q=g([b.i(v.f)(a.d)],q),x=function(a){function b(a,d){r(this,
b);d=m(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));d.chunkManager=a;d.chunks=new Map;return d}u(b,a);h(b,[{key:"initializeCounterpart",value:function(a,d){d.chunkManager=this.chunkManager.rpcId;k(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"initializeCounterpart",this).call(this,a,d)}},{key:"deleteChunk",value:function(a){this.chunks.delete(a)}},{key:"addChunk",value:function(a,b){this.chunks.set(a,b)}},{key:"getChunk",value:function(a){throw Error("Not implemented.");}},
{key:"gl",get:function(){return this.chunkManager.chunkQueueManager.gl}}],[{key:"encodeOptions",value:function(a){return{}}}]);return b}(v.b)},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"f",function(){return f});b.d(e,"g",function(){return q});b.d(e,"i",function(){return x});b.d(e,"h",function(){return F});b.d(e,"d",function(){return C});b.d(e,"b",function(){return B});b.d(e,"a",function(){return z});b.d(e,"c",function(){return E});e.e=function(a,b,d){return d.registerDisposer(new y(a,b,function(a){var b=
a.redrawNeeded.add(function(){return d.scheduleRedraw()});d.scheduleRedraw();return function(){b();d.scheduleRedraw()}},d.visibility))};n=b(22);var a=b.n(n);n=b(222);var c=b.n(n),l=b(132);n=b(0);var p=b(1),w=b(3),v=b(173),k=b(11),h=b(37),g=function G(a,b,d){null===a&&(a=Function.prototype);var f=Object.getOwnPropertyDescriptor(a,b);if(void 0===f){if(a=Object.getPrototypeOf(a),null!==a)return G(a,b,d)}else{if("value"in f)return f.value;b=f.get;return void 0===b?void 0:b.call(d)}},d=function(){function a(a,
b){for(var d=0;d<b.length;d++){var f=b[d];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(a,f.key,f)}}return function(b,d,f){d&&a(b.prototype,d);f&&a(b,f);return b}}(),f=function(a){function b(){m(this,b);var a=u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));a.ready=!1;a.layerChanged=new w.a;a.redrawNeeded=new w.a;a.readyStateChanged=new w.a;a.voxelSize=null;a.boundingBox=null;return a}r(b,a);d(b,[{key:"setReady",value:function(a){this.ready=
a;this.readyStateChanged.dispatch();this.layerChanged.dispatch()}},{key:"handleAction",value:function(a){}},{key:"getValueAt",value:function(a){}},{key:"transformPickedValue",value:function(a,b){return a}},{key:"updateMouseState",value:function(a,b,d){}}]);return b}(n.b),q=function(a){function b(){m(this,b);var a=u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));a.visibility=new h.b;return a}r(b,a);return b}(f),x=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,
arguments))}r(b,a);d(b,[{key:"onShow",value:function(){}},{key:"onHide",value:function(){}}]);return b}(n.b),F=function(a){function b(a){a=void 0===a?[]:a;m(this,b);var d=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));d.layersChanged=new w.a;d.readyStateChanged=new w.a;d.specificationChanged=new w.a;d.renderLayers=[];a.forEach(d.addRenderLayer.bind(d));return d}r(b,a);d(b,[{key:"addRenderLayer",value:function(a){this.renderLayers.push(a);var b=this.layersChanged,d=this.readyStateChanged;
this.registerDisposer(a);this.registerDisposer(a.layerChanged.add(b.dispatch));this.registerDisposer(a.readyStateChanged.add(d.dispatch));d.dispatch();b.dispatch()}},{key:"getValueAt",value:function(a,b){var d,f=this.renderLayers,g=b.pickedRenderLayer;if(null!==g&&-1!==f.indexOf(g))return d=g.transformPickedValue(b.pickedValue,b.pickedOffset),this.transformPickedValue(d);b=$jscomp.makeIterator(f);for(f=b.next();!f.done&&(f=f.value,!f.ready||(d=f.getValueAt(a),void 0===d));f=b.next());return this.transformPickedValue(d)}},
{key:"transformPickedValue",value:function(a){return a}},{key:"toJSON",value:function(){return null}},{key:"makeDropdown",value:function(a){}},{key:"handleAction",value:function(a){}}]);return b}(n.b),C=function(a){function b(a,d,f){d=void 0===d?null:d;f=void 0===f?!0:f;m(this,b);var g=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));g.name=a;g.visible=f;g.readyStateChanged=new w.a;g.layerChanged=new w.a;g.specificationChanged=new w.a;g.wasDisposed=!1;g.layer_=null;g.layer=d;return g}r(b,
a);d(b,[{key:"handleLayerChanged",value:function(){this.visible&&this.layerChanged.dispatch()}},{key:"setVisible",value:function(a){a!==this.visible&&(this.visible=a,this.layerChanged.dispatch())}},{key:"disposed",value:function(){this.wasDisposed=!0;this.layer=null;g(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"disposed",this).call(this)}},{key:"layer",get:function(){return this.layer_},set:function(a){var b=this,d=this.layer_;null!=d&&(this.unregisterUserLayer(),d.dispose());this.layer_=
a;if(null!=a){var f=[a.layersChanged.add(function(){return b.handleLayerChanged()}),a.readyStateChanged.add(this.readyStateChanged.dispatch),a.specificationChanged.add(this.specificationChanged.dispatch)];this.unregisterUserLayer=function(){f.forEach(function(a){return a()})};this.readyStateChanged.dispatch();this.handleLayerChanged()}}}]);return b}(n.b),B=function(f){function c(){m(this,c);var a=u(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments));a.managedLayers=[];a.layersChanged=
new w.a;a.readyStateChanged=new w.a;a.specificationChanged=new w.a;a.boundPositions=new WeakSet;return a}r(c,f);d(c,[{key:"updateSignalBindings",value:function(a,b){b(a.layerChanged,this.layersChanged.dispatch);b(a.readyStateChanged,this.readyStateChanged.dispatch);b(a.specificationChanged,this.specificationChanged.dispatch)}},{key:"addManagedLayer",value:function(a){this.updateSignalBindings(a,v.a);this.managedLayers.push(a);this.layersChanged.dispatch();this.readyStateChanged.dispatch();return a}},
{key:"addUserLayer",value:function(a,b,d){a=new C(a,b,d);return this.addManagedLayer(a)}},{key:"readyRenderLayers",value:function(){function a(a,l){for(;;)switch(b){case 0:h=$jscomp.makeIterator(k.managedLayers),q=h.next();case 1:if(q.done){b=3;break}c=q.value;if(c.visible&&c.layer){b=4;break}b=2;break;case 4:g=$jscomp.makeIterator(c.layer.renderLayers),f=g.next();case 5:if(f.done){b=7;break}d=f.value;if(d.ready){b=8;break}b=6;break;case 8:return b=9,{value:d,done:!1};case 9:if(void 0===l){b=10;break}b=
-1;throw l;case 10:case 6:f=g.next();b=5;break;case 7:case 2:q=h.next();b=1;break;case 3:b=-1;default:return{value:void 0,done:!0}}}var b=0,d,f,g,c,q,h,k=this,l={next:function(b){return a(b,void 0)},throw:function(b){return a(void 0,b)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();l[Symbol.iterator]=function(){return this};return l}},{key:"unbindManagedLayer",value:function(a){this.updateSignalBindings(a,v.b);a.dispose()}},{key:"clear",value:function(){for(var a=
$jscomp.makeIterator(this.managedLayers),b=a.next();!b.done;b=a.next())this.unbindManagedLayer(b.value);this.managedLayers.length=0;this.layersChanged.dispatch()}},{key:"removeManagedLayer",value:function(a){var b=this.managedLayers.indexOf(a);if(-1===b)throw Error("Internal error: invalid managed layer.");this.unbindManagedLayer(a);this.managedLayers.splice(b,1);this.layersChanged.dispatch()}},{key:"reorderManagedLayer",value:function(a,b){var d=this.managedLayers.length;a===b||0>a||a>=d||0>b||b>=
d||(a=$jscomp.makeIterator(this.managedLayers.splice(a,1)).next().value,this.managedLayers.splice(b,0,a),this.layersChanged.dispatch())}},{key:"disposed",value:function(){this.clear();g(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"disposed",this).call(this)}},{key:"getLayerByName",value:function(a){return this.managedLayers.find(function(b){return b.name===a})}},{key:"initializePosition",value:function(b){var d=this,f=this.boundPositions;f.has(b)||(f.add(b),f=a()(function(){d.updatePositionFromLayers(b)}),
this.readyStateChanged.add(f),b.changed.add(f),this.updatePositionFromLayers(b))}},{key:"updatePositionFromLayers",value:function(a){if(!a.valid)for(var b=$jscomp.makeIterator(this.managedLayers),d=b.next();!d.done;d=b.next())if(d=d.value.layer,null!=d)for(var d=$jscomp.makeIterator(d.renderLayers),f=d.next();!f.done;f=d.next())if(f=f.value,f.ready&&(a.voxelSize.valid||null==f.voxelSize||(p.a.copy(a.voxelSize.size,f.voxelSize),a.voxelSize.setValid()),!a.spatialCoordinatesValid&&!a.voxelCoordinatesValid&&
null!=f.boundingBox)){var f=f.boundingBox,g=a.spatialCoordinates;p.a.add(g,f.lower,f.upper);p.a.scale(g,g,.5);a.spatialCoordinatesValid=!0;a.changed.dispatch()}}},{key:"uniqueAction",value:function(a,d,f){if(d){var g=b.i(l.a)(d);f&&g&&g==this.editorLayer?g.handleEditorAction(a,f):d.handleAction(a);d=$jscomp.makeIterator(d.renderLayers);for(f=d.next();!f.done;f=d.next())f=f.value,f.ready&&f.handleAction(a)}}},{key:"invokeAction",value:function(a,b){for(var d=$jscomp.makeIterator(this.managedLayers),
f=d.next();!f.done;f=d.next())f=f.value,null!==f.layer&&f.visible&&this.uniqueAction(a,f.layer,b)}},{key:"editorLayer",get:function(){var a=[].concat($jscomp.arrayFromIterable(this.managedLayers)).reverse().find(function(a){return a.visible&&b.i(l.b)(a.layer)}),a=a?a.layer:{};return b.i(l.a)(a)}},{key:"renderLayers",get:function(){var a=this;$jscomp.initSymbol();$jscomp.initSymbolIterator();var b={};return b[Symbol.iterator]=function(){function b(b,l){for(;;)switch(d){case 0:k=$jscomp.makeIterator(a.managedLayers),
h=k.next();case 1:if(h.done){d=3;break}q=h.value;if(null!==q.layer){d=4;break}d=2;break;case 4:c=$jscomp.makeIterator(q.layer.renderLayers),g=c.next();case 5:if(g.done){d=7;break}f=g.value;d=8;return{value:f,done:!1};case 8:if(void 0===l){d=9;break}d=-1;throw l;case 9:case 6:g=c.next();d=5;break;case 7:case 2:h=k.next();d=1;break;case 3:d=-1;default:return{value:void 0,done:!0}}}var d=0,f,g,c,q,h,k,l={next:function(a){return b(a,void 0)},throw:function(a){return b(void 0,a)},return:function(a){throw Error("Not yet implemented");
}};$jscomp.initSymbolIterator();l[Symbol.iterator]=function(){return this};return l},b}},{key:"visibleRenderLayers",get:function(){var a=this;$jscomp.initSymbol();$jscomp.initSymbolIterator();var b={};return b[Symbol.iterator]=function(){function b(b,l){for(;;)switch(d){case 0:k=$jscomp.makeIterator(a.managedLayers),h=k.next();case 1:if(h.done){d=3;break}q=h.value;if(null!==q.layer&&q.visible){d=4;break}d=2;break;case 4:c=$jscomp.makeIterator(q.layer.renderLayers),g=c.next();case 5:if(g.done){d=7;
break}f=g.value;d=8;return{value:f,done:!1};case 8:if(void 0===l){d=9;break}d=-1;throw l;case 9:case 6:g=c.next();d=5;break;case 7:case 2:h=k.next();d=1;break;case 3:d=-1;default:return{value:void 0,done:!0}}}var d=0,f,g,c,q,h,k,l={next:function(a){return b(a,void 0)},throw:function(a){return b(void 0,a)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();l[Symbol.iterator]=function(){return this};return l},b}}]);return c}(n.b),z=function(){function a(){var b=this;
m(this,a);this.changed=new w.a;this.position=p.a.create();this.active=!1;this.pickedRenderLayer=null;this.pickedValue=new k.a(0,0);this.pickedOffset=0;this.updater=void 0;this.stale=!1;this.triggerUpdate=c()(function(){b.update()},50,{leading:!0,trailing:!0})}d(a,[{key:"updateUnconditionally",value:function(){this.triggerUpdate.cancel();this.update();return this.active}},{key:"updateIfStale",value:function(){this.stale&&this.update()}},{key:"update",value:function(){var a=this.updater;this.stale=
!1;a?this.setActive(a(this)):this.setActive(!1)}},{key:"setActive",value:function(a){this.stale=!1;if(this.active!==a||!0===a)this.active=a,this.changed.dispatch()}}]);return a}(),E=function(a){function b(a,d){m(this,b);var f=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));f.layerManager=a;f.mouseState=d;f.values=new Map;f.changed=new w.a;f.needsUpdate=!0;f.registerDisposer(d.changed.add(function(){f.handleChange()}));f.registerDisposer(a.layersChanged.add(function(){f.handleLayerChange()}));
return f}r(b,a);d(b,[{key:"handleLayerChange",value:function(){this.mouseState.active&&this.handleChange()}},{key:"handleChange",value:function(){this.needsUpdate=!0;this.changed.dispatch()}},{key:"update",value:function(){if(this.needsUpdate){this.needsUpdate=!1;var a=this.values,b=this.mouseState;a.clear();if(b.active)for(var d=b.position,f=$jscomp.makeIterator(this.layerManager.managedLayers),g=f.next();!g.done;g=f.next()){var g=g.value,c=g.layer;g.visible&&c&&a.set(c,c.getValueAt(d,b))}}}},{key:"get",
value:function(a){this.update();return this.values.get(a)}},{key:"toJSON",value:function(){this.update();for(var a={},b=this.values,d=$jscomp.makeIterator(this.layerManager.managedLayers),f=d.next();!f.done;f=d.next()){var f=f.value,g=f.layer;g&&(g=b.get(g),void 0!==g&&(g instanceof k.a&&(g={t:"u64",v:g}),a[f.name]=g))}return a}}]);return b}(n.b),y=function(a){function b(a,d,f,g){m(this,b);var q=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));q.layerManager=a;q.renderLayerType=d;q.layerAdded=
f;q.visibility=g;q.visibleLayers=new Map;q.newVisibleLayers=new Set;q.throttledUpdateVisibleLayers=c()(function(){q.updateVisibleLayers()},0);q.registerDisposer(a.layersChanged.add(function(){q.handleLayersChanged()}));q.updateVisibleLayers();return q}r(b,a);d(b,[{key:"handleLayersChanged",value:function(){this.throttledUpdateVisibleLayers()}},{key:"disposed",value:function(){this.throttledUpdateVisibleLayers.cancel();this.visibleLayers.forEach(function(a){return a()});this.visibleLayers.clear();
g(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"disposed",this).call(this)}},{key:"updateVisibleLayers",value:function(){for(var a=this.visibleLayers,b=this.newVisibleLayers,d=this.renderLayerType,f=this.layerAdded,g={},c=$jscomp.makeIterator(this.layerManager.readyRenderLayers()),q=c.next();!q.done;g={disposer:g.disposer,visibilityDisposer:g.visibilityDisposer,typedLayer:g.typedLayer},q=c.next())q=q.value,q instanceof d&&(g.typedLayer=q,b.add(g.typedLayer),a.has(g.typedLayer)||(g.visibilityDisposer=
g.typedLayer.visibility.add(this.visibility),g.disposer=f(g.typedLayer),a.set(g.typedLayer.addRef(),function(a){return function(){a.disposer();a.visibilityDisposer();a.typedLayer.dispose()}}(g))));d=$jscomp.makeIterator(a);for(f=d.next();!f.done;f=d.next())g=$jscomp.makeIterator(f.value),f=g.next().value,g=g.next().value,b.has(f)||(a.delete(f),g());b.clear()}},{key:"getVisibleLayers",value:function(){this.throttledUpdateVisibleLayers.flush();return[].concat($jscomp.arrayFromIterable(this.visibleLayers.keys()))}}]);
return b}(n.b)},function(n,e,b){b.d(e,"a",function(){return p});var m=function(){function a(a,b){for(var c=0;c<b.length;c++){var g=b[c];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(a,g.key,g)}}return function(b,c,h){c&&a(b.prototype,c);h&&a(b,h);return b}}(),u=new Uint32Array(2),r=[];for(n=2;36>=n;++n){e=Math.floor(32/Math.log2(n));b=Math.pow(n,e);var a=Math.floor(e/2),c=Math.pow(n,a),a=Math.pow(n,e-a),l="^[0-"+String.fromCharCode(48+Math.min(9,
n-1));10<n&&(l+="a-"+String.fromCharCode(97+n-11),l+="A-"+String.fromCharCode(65+n-11));l+="]{1,"+Math.ceil(64/Math.log2(n))+"}$";r[n]={lowDigits:e,lowBase:b,lowBase1:c,lowBase2:a,pattern:new RegExp(l)}}var p=function(){function a(b,c){b=void 0===b?0:b;c=void 0===c?0:c;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.low=b;this.high=c}m(a,[{key:"clone",value:function(){return new a(this.low,this.high)}},{key:"assign",value:function(a){this.low=a.low;this.high=
a.high}},{key:"toString",value:function(a){a=void 0===a?10:a;var b=this.low,c=this.high;if(0===c)return b.toString(a);var c=4294967296*c,g=r[a],d=g.lowBase,g=g.lowDigits,f=c%d,c=Math.floor(c/d),b=b+f,c=c+Math.floor(b/d),b=(b%d).toString(a);return c.toString(a)+"0".repeat(g-b.length)+b}},{key:"tryParseString",value:function(a,b){b=void 0===b?10:b;var c=r[b],g=c.lowDigits,d=c.lowBase,f=c.lowBase1,q=c.lowBase2;if(!c.pattern.test(a))return!1;if(a.length<=g)return this.low=parseInt(a,b),this.high=0,!0;
g=a.length-g;c=parseInt(a.substr(g),b);a=parseInt(a.substr(0,g),b);d=Math.floor(a*d/4294967296);f=c+a%4294967296*f%4294967296*q%4294967296;4294967296<f&&(++d,f-=4294967296);if(f>>>0!==f||d>>>0!==d)return!1;this.low=f;this.high=d;return!0}},{key:"parseString",value:function(a,b){if(!this.tryParseString(a,void 0===b?10:b))throw Error("Failed to parse string as uint64 value: "+JSON.stringify(a)+".");return this}},{key:"valid",value:function(){var a=this.low,b=this.high;return a>>>0===a&&b>>>0===b}},
{key:"toJSON",value:function(){return this.toString()}},{key:"lshift",value:function(b){b&=63;if(0==b)return this.clone();var c=this.low,h=this.high;return 32>b?new a(c<<b,h<<b|c>>>32-b):new a(0,c<<b-32)}},{key:"rshift",value:function(b){b&=63;if(0==b)return this.clone();var c=this.low,h=this.high;return 32>b?new a(c>>>b|h<<32-b,h>>b):new a(h>>b-32,0<=h?0:-1)}},{key:"or",value:function(b){return new a(this.low|b.low,this.high|b.high)}},{key:"xor",value:function(b){return new a(this.low^b.low,this.high^
b.high)}},{key:"and",value:function(b){return new a(this.low&b.low,this.high&b.high)}}],[{key:"less",value:function(a,b){return a.high<b.high||a.high===b.high&&a.low<b.low}},{key:"compare",value:function(a,b){return a.high-b.high||a.low-b.low}},{key:"equal",value:function(a,b){return a.low===b.low&&a.high===b.high}},{key:"min",value:function(b,c){return a.less(b,c)?b:c}},{key:"random",value:function(){crypto.getRandomValues(u);return new a(u[0],u[1])}},{key:"parseString",value:function(b,c){c=void 0===
c?10:c;return(new a).parseString(b,c)}},{key:"encodeUint32Array",value:function(a){for(var b=new Uint32Array(2*a.length),c=0;c<a.length;c++){var g=a[c];b[2*c]=g.low;b[2*c+1]=g.high}return b}},{key:"decodeUint32Array",value:function(b){b instanceof ArrayBuffer&&(b=new Uint32Array(b));if(1===b.length%2)throw Error("Decode error. Length of input array was not even: "+b.length);for(var c=Array(b.length/2),h=0;h<c.length;h++)c[h]=new a(b[2*h],b[2*h+1]);return c}}]);return a}();p.ZERO=new p(0,0)},function(n,
e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});
b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function a(a,b,d,g){g=void 0===g?{}:g;return l.a.forPromise(new Promise(function(f){f(a.getVolume(b,d,g))}),{initialMessage:"Retrieving metadata for volume "+d+".",delay:!0,errorPrefix:"Error retrieving metadata for volume "+d+": "})}e.e=function(a,b){a=a.editorSource;l.a.showMessage(b+": "+a.channel+" at "+a.host)};e.f=function(a,b){var d=new Promise(function(d,f){a.editorSocket.send(d,f,b)}),f=a.editorSource,g=f.host;return l.a.forPromise(d,
{initialMessage:"Trying to write to "+g+".",delay:!0,errorPrefix:"Cannot write to "+f.channel+" at "+g+":"})};e.d=a;b.d(e,"b",function(){return k});b.d(e,"a",function(){return h});e.c=function(a,b){g.set(a,b)};e.g=function(a,b){d.set(a,b)};n=b(10);var c=b(4),l=b(24);e=b(0);var p=b(2),w=b(3),v=function(){function a(a,b){for(var d=0;d<b.length;d++){var f=b[d];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(a,f.key,f)}}return function(b,d,f){d&&a(b.prototype,
d);f&&a(b,f);return b}}(),k=function(a){function b(a,d,f){m(this,b);a=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));a.initialSpecification=d;a.manager=f;return a}r(b,a);v(b,[{key:"toJSON",value:function(){var a=this.layer;if(!a)return this.initialSpecification;a=a.toJSON();this.visible||(a.visible=!1);return a}}]);return b}(n.d),h=function(f){function q(a,b,d,f,g){m(this,q);var c=u(this,(q.__proto__||Object.getPrototypeOf(q)).call(this));c.dataSourceProvider=a;c.layerManager=b;c.chunkManager=
d;c.layerSelectedValues=f;c.voxelSize=g;c.changed=new w.a;c.voxelCoordinatesSet=new w.b;c.registerDisposer(b.layersChanged.add(c.changed.dispatch));c.registerDisposer(b.specificationChanged.add(c.changed.dispatch));return c}r(q,f);v(q,[{key:"reset",value:function(){this.layerManager.clear()}},{key:"restoreState",value:function(a){b.i(p.a)(a);this.layerManager.clear();for(var d=$jscomp.makeIterator(Object.keys(a)),f=d.next();!f.done;f=d.next())f=f.value,this.layerManager.addManagedLayer(this.getLayer(f,
a[f]))}},{key:"getLayer",value:function(f,q){var h=this,l=new k(f,q,this);"string"===typeof q&&(q={source:q});b.i(p.a)(q);f=b.i(p.d)(q,"type",p.e);l.visible=b.i(p.d)(q,"visible",function(a){if(void 0===a||!0===a)return!0;if(!1===a)return!1;throw Error("Expected boolean, but received: "+JSON.stringify(a)+".");});var x=l.sourceUrl=b.i(p.d)(q,"source",p.e);if(void 0===f){if(void 0===x)throw Error("Either layer 'type' or 'source' URL must be specified.");a(this.dataSourceProvider,this.chunkManager,x).then(function(a){if(-1!==
h.layerManager.managedLayers.indexOf(l)){var b=d.get(a.volumeType);if(void 0!==b)l.layer=new b(h,q);else throw Error("Unsupported volume type: "+c.a[a.volumeType]+".");}})}else if(x=g.get(f),void 0!==x)l.layer=new x(this,q);else throw Error("Unsupported layer type: "+JSON.stringify(f)+".");return l}},{key:"toJSON",value:function(){for(var a={},b=0,d=$jscomp.makeIterator(this.layerManager.managedLayers),f=d.next();!f.done;f=d.next())f=f.value,a[f.name]=f.toJSON(),++b;if(0!==b)return a}},{key:"setVoxelCoordinates",
value:function(a){this.voxelCoordinatesSet.dispatch(a)}},{key:"worker",get:function(){return this.chunkManager.rpc}},{key:"rpc",get:function(){return this.chunkManager.rpc}}]);return q}(e.b),g=new Map,d=new Map},function(n,e,b){function m(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?
Object.setPrototypeOf(a,b):a.__proto__=b)}function u(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}b.d(e,"a",function(){return l});b.d(e,"e",function(){return p});e.d=function(a,b){return new Promise(function(k,h){if(a===c)b(k,h,c);else{var g=new l,d=a.add(function(){g.cancel()});b(function(a){d();k(a)},function(a){d();h(a)},g)}})};var r=function(){function a(a,b){for(var c=0;c<b.length;c++){var g=b[c];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in
g&&(g.writable=!0);Object.defineProperty(a,g.key,g)}}return function(b,c,h){c&&a(b.prototype,c);h&&a(b,h);return b}}();n=new (function(){function a(){u(this,a);this.name="CancellationError";this.message="CANCELED"}r(a,[{key:"toString",value:function(){return"CANCELED"}}]);return a}());e.b=n;var a=function(){},c={isCanceled:!1,add:function(){return a},remove:a};e.c=c;var l=function(){function b(){u(this,b)}r(b,[{key:"cancel",value:function(){var a=this.handlers;if(null!==a&&(this.handlers=null,void 0!==
a))for(var a=$jscomp.makeIterator(a),b=a.next();!b.done;b=a.next())b=b.value,b()}},{key:"add",value:function(b){var c=this,h=this.handlers;if(null===h)return b(),a;void 0===h&&(h=this.handlers=new Set);h.add(b);return function(){c.remove(b)}}},{key:"remove",value:function(a){var b=this.handlers;null!=b&&b.delete(a)}},{key:"isCanceled",get:function(){return null===this.handlers}}]);return b}(),p=function(a){function b(){u(this,b);var a;a=(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments);
if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");a=!a||"object"!==typeof a&&"function"!==typeof a?this:a;a.consumers=new Set;return a}m(b,a);r(b,[{key:"addConsumer",value:function(a){a=void 0===a?c:a;var b=this,g=this.consumers;g.has(a)||a.isCanceled||(g.add(a),a.add(function(){g.delete(a);0===g.size&&b.cancel()}))}}]);return b}(l)},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,
b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function a(a,b){for(var d=$jscomp.makeIterator(v),
g=d.next();!g.done;g=d.next())if(g=g.value,g=g(a,b),null!=g)return g;throw Error("No chunk format handler found.");}e.a=function(a){v.push(a)};b.d(e,"c",function(){return k});b.d(e,"b",function(){return h});n=b(31);var c=b(1),l=function(){function a(a,b){for(var d=0;d<b.length;d++){var f=b[d];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(a,f.key,f)}}return function(b,f,g){f&&a(b.prototype,f);g&&a(b,g);return b}}(),p=c.a.create(),w=c.a.create(),
v=[],k=function(g){function d(b,g){m(this,d);g=u(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,b,g));g.chunkFormatHandler=g.registerDisposer(a(b.chunkQueueManager.gl,g.spec));return g}r(d,g);l(d,[{key:"getValueAt",value:function(a){var d=this.spec,f=d.chunkLayout,g=f.size;f.globalToLocalSpatial(w,a);for(a=0;3>a;++a)p[a]=Math.floor(w[a]/g[a]);a=b.i(c.o)(p);a=this.chunks.get(a);if(!a)return null;for(var f=d.voxelSize,h=0;3>h;++h)p[h]=Math.floor((w[h]-p[h]*g[h])/f[h]);g=a.chunkDataSize;for(f=
0;3>f;++f)if(p[f]>=g[f])return;d=d.numChannels;if(1===d)return a.getChannelValueAt(p,0);g=Array(d);for(f=0;f<d;++f)g[f]=a.getChannelValueAt(p,f);return g}},{key:"getChunk",value:function(a){return this.chunkFormatHandler.getChunk(this,a)}},{key:"chunkFormat",get:function(){return this.chunkFormatHandler.chunkFormat}}]);return d}(n.c),h=function(a){function b(a,d){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,d))}r(b,a);l(b,[{key:"chunkFormat",get:function(){return this.source.chunkFormat}}]);
return b}(n.d)},function(n,e,b){function m(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function u(a,b){var d="";b&1&&(d+="control+");b&2&&(d+="alt+");b&4&&(d+="meta+");b&8&&(d+="shift+");return d+a}function r(a){return"string"===typeof a?{action:a}:
a}function a(a){function b(b,g){for(;;)switch(d){case 0:h=a.indexOf(":");a:{var q=a.substring(h+1).split("+");b=void 0;for(var k=0,q=$jscomp.makeIterator(q),l=q.next();!l.done;l=q.next())switch(l=l.value,l){case "control":k|=1;break;case "alt":k|=2;break;case "meta":k|=4;break;case "shift":k|=8;break;default:if(void 0===b)b=l;else{c=void 0;break a}}c=void 0===b?void 0:u(b,k)}if(void 0!==c){d=1;break}d=-1;throw Error("Invalid event identifier: "+JSON.stringify(a));case 1:if(-1===h){d=2;break}f=a.substring(0,
h);if("at"===f||"bubble"===f){d=4;break}d=-1;throw Error("Invalid event phase: "+JSON.stringify(f));case 4:return d=5,{value:f+":"+c,done:!1};case 5:if(void 0===g){d=6;break}d=-1;throw g;case 6:d=3;break;case 2:return d=7,{value:"at:"+c,done:!1};case 7:if(void 0===g){d=8;break}d=-1;throw g;case 8:return d=9,{value:"bubble:"+c,done:!1};case 9:if(void 0===g){d=10;break}d=-1;throw g;case 10:case 3:d=-1;default:return{value:void 0,done:!0}}}var d=0,f,c,h,k={next:function(a){return b(a,void 0)},throw:function(a){return b(void 0,
a)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();k[Symbol.iterator]=function(){return this};return k}b.d(e,"a",function(){return v});e.c=function(a,b,d){a=k[b.eventPhase]+":"+u(a,(b.ctrlKey?1:0)|(b.altKey?2:0)|(b.metaKey?4:0)|(b.shiftKey?8:0));d=d.get(a);void 0!==d&&(!1!==d.stopPropagation&&b.stopPropagation(),a=new CustomEvent("action:"+d.action,{bubbles:!0,detail:b,cancelable:!0}),a=!b.target.dispatchEvent(a),(!1!==d.preventDefault||a)&&b.preventDefault())};
e.b=function(a,g,d,f){return b.i(c.a)(a,"action:"+g,d,f)};var c=b(0);n=b(168);var l=function(){function a(a,b){for(var d=0;d<b.length;d++){var g=b[d];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(a,g.key,g)}}return function(b,d,f){d&&a(b.prototype,d);f&&a(b,f);return b}}(),p=function g(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),null!==a)return g(a,b,c)}else{if("value"in
d)return d.value;b=d.get;return void 0===b?void 0:b.call(c)}},w;(function(a){a[a.CONTROL=1]="CONTROL";a[a.ALT=2]="ALT";a[a.META=4]="META";a[a.SHIFT=8]="SHIFT"})(w||(w={}));var v=function(b){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var a=(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!==typeof a&&"function"!==typeof a?this:
a}m(d,b);l(d,[{key:"setFromObject",value:function(a){for(var b=$jscomp.makeIterator(Object.keys(a)),d=b.next();!d.done;d=b.next())d=d.value,this.set(d,r(a[d]))}},{key:"set",value:function(b,g){g=r(g);b=$jscomp.makeIterator(a(b));for(var f=b.next();!f.done;f=b.next())f=f.value,p(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"set",this).call(this,f,g)}},{key:"delete",value:function(b){b=$jscomp.makeIterator(a(b));for(var f=b.next();!f.done;f=b.next())f=f.value,p(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),
"delete",this).call(this,f)}}],[{key:"fromObject",value:function(a,b){b=void 0===b?{}:b;var f=new d;f.label=b.label;if(void 0!==b.parents){b=$jscomp.makeIterator(b.parents);for(var g=b.next();!g.done;g=b.next()){var c=$jscomp.makeIterator(g.value),g=c.next().value,c=c.next().value;f.addParent(g,c)}}b=$jscomp.makeIterator(Object.keys(a));for(g=b.next();!g.done;g=b.next())g=g.value,f.set(g,r(a[g]));return f}}]);return d}(n.a),k=[];k[Event.AT_TARGET]="at";k[Event.CAPTURING_PHASE]="capture";k[Event.BUBBLING_PHASE]=
"bubble"},function(n,e,b){b.d(e,"a",function(){return r});var m=b(25),u=function(){function a(a,b){for(var c=0;c<b.length;c++){var l=b[c];l.enumerable=l.enumerable||!1;l.configurable=!0;"value"in l&&(l.writable=!0);Object.defineProperty(a,l.key,l)}}return function(b,l,e){l&&a(b.prototype,l);e&&a(b,e);return b}}(),r=function(){function a(b,l){l=void 0===l?m.c:l;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.gl=b;this.bufferType=l;this.gl=b;this.buffer=b.createBuffer()}
u(a,[{key:"bind",value:function(){this.gl.bindBuffer(this.bufferType,this.buffer)}},{key:"bindToVertexAttrib",value:function(a,b,e,w,v,k){e=void 0===e?m.e:e;w=void 0===w?!1:w;v=void 0===v?0:v;k=void 0===k?0:k;this.bind();this.gl.enableVertexAttribArray(a);this.gl.vertexAttribPointer(a,b,e,w,v,k)}},{key:"setData",value:function(a,b){b=void 0===b?m.d:b;var c=this.gl;this.bind();c.bufferData(this.bufferType,a,b)}},{key:"dispose",value:function(){this.gl.deleteBuffer(this.buffer);this.gl=this.buffer=
void 0}}],[{key:"fromData",value:function(b,l,e,w){b=new a(b,e);b.setData(l,w);return b}}]);return a}()},function(n,e,b){b.d(e,"a",function(){return m});e.c=1E-6;var m="undefined"!==typeof Float32Array?Float32Array:Array;e.b=Math.random},function(n,e,b){b.d(e,"b",function(){return u});b.d(e,"a",function(){return a});var m=function(){function a(a,b){for(var c=0;c<b.length;c++){var l=b[c];l.enumerable=l.enumerable||!1;l.configurable=!0;"value"in l&&(l.writable=!0);Object.defineProperty(a,l.key,l)}}
return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}(),u;(function(a){a[a.GPU_MEMORY=0]="GPU_MEMORY";a[a.SYSTEM_MEMORY=1]="SYSTEM_MEMORY";a[a.SYSTEM_MEMORY_WORKER=2]="SYSTEM_MEMORY_WORKER";a[a.DOWNLOADING=3]="DOWNLOADING";a[a.QUEUED=4]="QUEUED";a[a.NEW=5]="NEW";a[a.FAILED=6]="FAILED";a[a.EXPIRED=7]="EXPIRED"})(u||(u={}));var r;(function(a){a[a.FIRST_TIER=0]="FIRST_TIER";a[a.FIRST_ORDERED_TIER=0]="FIRST_ORDERED_TIER";a[a.VISIBLE=0]="VISIBLE";a[a.PREFETCH=1]="PREFETCH";a[a.LAST_ORDERED_TIER=
1]="LAST_ORDERED_TIER";a[a.RECENT=2]="RECENT";a[a.LAST_TIER=2]="LAST_TIER"})(r||(r={}));var a=function(){function a(b,c){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.itemCapacity=this.availableItems=b;this.sizeCapacity=this.availableSize=c}m(a,[{key:"adjust",value:function(a,b){this.availableItems+=a;this.availableSize+=b}},{key:"toString",value:function(){return this.availableItems+"/"+this.itemCapacity+" items, "+(this.availableSize+"/"+this.sizeCapacity+
" size")}},{key:"toObject",value:function(){return{itemCapacity:this.itemCapacity,sizeCapacity:this.sizeCapacity}}}],[{key:"fromObject",value:function(b){return new a(b.itemCapacity,b.sizeCapacity)}}]);return a}();a.INFINITE=new a(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);e.c="ChunkQueueManager";e.d="ChunkManager"},function(n,e,b){e.b=function(b,a){u.set(b,a)};e.a=function(b){for(var a=new m.a,c=$jscomp.makeIterator(u),l=c.next();!l.done;l=c.next()){var e=$jscomp.makeIterator(l.value),l=
e.next().value,e=e.next().value;a.register(l,e(b))}return a};var m=b(23),u=new Map},function(n,e,b){e.a=function(b){if(b instanceof Object){var a=b[m];void 0===a&&(a=b[m]=u++);return"o"+a}return""+JSON.stringify(b)};$jscomp.initSymbol();var m=Symbol("objectId"),u=0},function(n,e){},function(n,e,b){var m=b(59),u=b(221),r=b(223),a=Math.max,c=Math.min;n.exports=function(b,e,w){function l(a){var d=f,g=q;f=q=void 0;z=a;return p=b.apply(g,d)}function k(a){var b=a-B;a-=z;return void 0===B||b>=e||0>b||y&&
a>=x}function h(){var a=u();if(k(a))return g(a);var b=setTimeout,d;d=a-z;a=e-(a-B);d=y?c(a,x-d):a;C=b(h,d)}function g(a){C=void 0;if(H&&f)return l(a);f=q=void 0;return p}function d(){var a=u(),b=k(a);f=arguments;q=this;B=a;if(b){if(void 0===C)return z=a=B,C=setTimeout(h,e),E?l(a):p;if(y)return C=setTimeout(h,e),l(B)}void 0===C&&(C=setTimeout(h,e));return p}var f,q,x,p,C,B,z=0,E=!1,y=!1,H=!0;if("function"!=typeof b)throw new TypeError("Expected a function");e=r(e)||0;m(w)&&(E=!!w.leading,x=(y="maxWait"in
w)?a(r(w.maxWait)||0,e):x,H="trailing"in w?!!w.trailing:H);d.cancel=function(){void 0!==C&&clearTimeout(C);z=0;f=B=q=C=void 0};d.flush=function(){return void 0===C?p:g(u())};return d}},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&
null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function a(a,b){void 0===b&&(b=-1===a.indexOf("/")?":":"/");a=a.lastIndexOf(b);return-1===a?0:a+1}b.d(e,"b",function(){return w});b.d(e,"a",function(){return k});var c=b(13),l=b(34);n=b(0);var p=function(){function a(a,b){for(var d=
0;d<b.length;d++){var g=b[d];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(a,g.key,g)}}return function(b,d,f){d&&a(b.prototype,d);f&&a(b,f);return b}}(),w=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}r(b,a);return b}(n.b),v=/^(?:([a-zA-Z-+_]+):\/\/)?(.*)$/,k=function(h){function g(){m(this,g);var a=u(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments));a.dataSources=
new Map;return a}r(g,h);p(g,[{key:"register",value:function(a,b){this.dataSources.set(a,this.registerDisposer(b))}},{key:"getDataSource",value:function(a){a=a.match(v);if(null===a||void 0===a[1])throw Error('Data source URL must have the form "<protocol>://<path>".');var b=a[1],d=this.dataSources.get(b);if(void 0===d)throw Error("Unsupported data source: "+JSON.stringify(b)+".");return[d,a[2],b]}},{key:"getVolume",value:function(a,b,g,h){g=void 0===g?{}:g;h=void 0===h?c.c:h;b=$jscomp.makeIterator(this.getDataSource(b));
var d=b.next().value,f=b.next().value;return new Promise(function(b){b(d.getVolume(a,f,g,h))})}},{key:"getVectorGraphicsSource",value:function(a,b,g,h){g=void 0===g?{}:g;h=void 0===h?c.c:h;b=$jscomp.makeIterator(this.getDataSource(b));var d=b.next().value,f=b.next().value;return new Promise(function(b){b(d.getVectorGraphicsSource(a,f,g,h))})}},{key:"getMeshSource",value:function(a,b,g){g=void 0===g?c.c:g;b=$jscomp.makeIterator(this.getDataSource(b));var d=b.next().value,f=b.next().value;return new Promise(function(b){b(d.getMeshSource(a,
f,g))})}},{key:"getSkeletonSource",value:function(a,b,g){g=void 0===g?c.c:g;b=$jscomp.makeIterator(this.getDataSource(b));var d=b.next().value,f=b.next().value;return new Promise(function(b){b(d.getSkeletonSource(a,f,g))})}},{key:"volumeCompleter",value:function(a,f,g){g=void 0===g?c.c:g;var d=a.match(v),q=d[1];if(void 0===q){f=[];g=$jscomp.makeIterator(this.dataSources);for(d=g.next();!d.done;d=g.next()){var h=$jscomp.makeIterator(d.value),d=h.next().value,h=h.next().value,d=d+"://";d.startsWith(a)&&
f.push({value:d,description:h.description})}return Promise.resolve({offset:0,completions:f})}a=this.dataSources.get(q);return void 0!==a&&void 0!==a.volumeCompleter?a.volumeCompleter(d[2],f,g).then(function(a){return b.i(l.a)(q.length+3,a)}):Promise.reject(null)}},{key:"suggestLayerName",value:function(b){b=$jscomp.makeIterator(this.getDataSource(b));var d=b.next().value;b=b.next().value;d=d.suggestLayerName;if(void 0!==d)return d(b);d=a(b,void 0);return b.substring(d)}},{key:"findSourceGroup",value:function(b){var d=
$jscomp.makeIterator(this.getDataSource(b));b=d.next().value;var g=d.next().value,d=d.next().value;return(b.findSourceGroup||a)(g)+d.length+3}}]);return g}(n.b)},function(n,e,b){b.d(e,"a",function(){return a});var m=function(){function a(a,b){for(var c=0;c<b.length;c++){var l=b[c];l.enumerable=l.enumerable||!1;l.configurable=!0;"value"in l&&(l.writable=!0);Object.defineProperty(a,l.key,l)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}();b(197);var u=null,r=new Map,a=function(){function a(b){b=
void 0===b?!1:b;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");if(null===u){u=document.createElement("div");u.id="statusContainer";var c=document.createElement("button");c.addEventListener("click",a.disposeAll);c.textContent="Dismiss All";u.appendChild(c);document.body.appendChild(u)}this.element=c=document.createElement("div");!0===b&&(b=200);!1!==b?(this.setVisible(!1),this.timer=setTimeout(this.setVisible.bind(this,!0),b)):this.timer=null;r.set(this,this);u.appendChild(c)}
m(a,[{key:"dispose",value:function(){u.removeChild(this.element);this.element=void 0;null!==this.timer&&clearTimeout(this.timer);r.delete(this)}},{key:"setText",value:function(a,b){this.element.textContent=a;b&&this.setVisible(!0)}},{key:"setHTML",value:function(a,b){this.element.innerHTML=a;b&&this.setVisible(!0)}},{key:"setVisible",value:function(a){null!==this.timer&&(clearTimeout(this.timer),this.timer=null);this.element.style.display=a?"block":"none"}},{key:"makeDismissButton",value:function(){var a=
this,b=document.createElement("button");b.textContent="Dismiss";b.addEventListener("click",function(){a.dispose()});this.element.appendChild(b)}}],[{key:"disposeAll",value:function(){r.forEach(function(a){a.dispose()})}},{key:"forPromise",value:function(b,c){var l=new a(c.delay);l.setText(c.initialMessage);var e=l.dispose.bind(l);b.then(e,function(a){l.element.textContent=(void 0===c.errorPrefix?"":c.errorPrefix)+(a instanceof Error?a.message:""+a)+"  ";l.makeDismissButton();l.setVisible(!0)});return b}},
{key:"showMessage",value:function(b){var c=new a;c.element.textContent=b;c.makeDismissButton();c.setVisible(!0);return c}},{key:"showTemporaryMessage",value:function(a,b){b=void 0===b?2E3:b;var c=this.showMessage(a);setTimeout(function(){return c.dispose()},b);return c}}]);return a}()},function(n,e,b){e.c=34962;e.d=35044;e.k=3317;e.j=5121;e.e=5126;e.h=6407;e.i=6408;e.f=6409;e.g=6410;e.b=35632;e.a=35633},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");
}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function a(a,b,g){var d=
a.createShader(g);a.shaderSource(d,b);a.compileShader(d);if(!a.getShaderParameter(d,a.COMPILE_STATUS)){a=a.getShaderInfoLog(d)||"";var f;f=a.replace("\x00","");d=[];f=$jscomp.makeIterator(f.split("\n"));for(var c=f.next();!c.done;c=f.next()){var c=c.value,h=c.match(/^ERROR:\s*(\d+):(\d+)\s*(.+)$/);null!==h?d.push({message:h[3].trim(),file:parseInt(h[1],10),line:parseInt(h[2],10)}):(h=c.match(/^ERROR:\s*(.+)$/),null!==h?d.push({message:h[1]}):(c=c.trim())&&d.push({message:c}))}throw new w(g,b,a,d);
}return d}b.d(e,"a",function(){return g});n=b(0);var c=b(25),l=function(){function a(a,b){for(var d=0;d<b.length;d++){var f=b[d];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(a,f.key,f)}}return function(b,d,g){d&&a(b.prototype,d);g&&a(b,g);return b}}(),p;(function(a){a[a.VERTEX=c.a]="VERTEX";a[a.FRAGMENT=c.b]="FRAGMENT"})(p||(p={}));var w=function(a){function b(a,d,f,g){m(this,b);var c="Error compiling "+p[a].toLowerCase()+" shader: "+f,h=u(this,
(b.__proto__||Object.getPrototypeOf(b)).call(this,c));h.name="ShaderCompilationError";h.log=f;h.message=c;h.shaderType=a;h.source=d;h.errorMessages=g;return h}r(b,a);return b}(Error),v=function(a){function b(a,d,f){m(this,b);var g="Error linking shader: "+f,c=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,g));c.name="ShaderLinkError";c.log=f;c.message=g;c.vertexSource=a;c.fragmentSource=d;return c}r(b,a);return b}(Error),k=function(b){function d(b,f,g,c,h){m(this,d);var q=u(this,(d.__proto__||
Object.getPrototypeOf(d)).call(this));q.gl=b;q.vertexSource=f;q.fragmentSource=g;q.attributes=new Map;q.uniforms=new Map;var k=q.vertexShader=a(b,f,b.VERTEX_SHADER),l=q.fragmentShader=a(b,g,b.FRAGMENT_SHADER),e=b.createProgram();b.attachShader(e,k);b.attachShader(e,l);b.linkProgram(e);if(!b.getProgramParameter(e,b.LINK_STATUS))throw b=b.getProgramInfoLog(e)||"",new v(f,g,b);q.program=e;g=q.uniforms;f=q.attributes;if(c)for(c=$jscomp.makeIterator(c),k=c.next();!k.done;k=c.next())k=k.value,g.set(k,b.getUniformLocation(e,
k));if(h)for(h=$jscomp.makeIterator(h),k=h.next();!k.done;k=h.next())c=k.value,f.set(c,b.getAttribLocation(e,c));return q}r(d,b);l(d,[{key:"uniform",value:function(a){return this.uniforms.get(a)}},{key:"attribute",value:function(a){return this.attributes.get(a)}},{key:"textureUnit",value:function(a){return this.textureUnits.get(a)}},{key:"bind",value:function(){this.gl.useProgram(this.program)}},{key:"disposed",value:function(){var a=this.gl;a.deleteShader(this.vertexShader);this.vertexShader=void 0;
a.deleteShader(this.fragmentShader);this.fragmentShader=void 0;a.deleteProgram(this.program);this.uniforms=this.attributes=this.gl=this.program=void 0}}]);return d}(n.b),h=function(){function a(){m(this,a);this.code="";this.parts=new Set}l(a,[{key:"add",value:function(a){if(!this.parts.has(a))switch(this.parts.add(a),typeof a){case "string":this.code+=a;break;case "function":this.add(a());break;default:if(Array.isArray(a)){a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next())this.add(b.value)}else throw Error("Invalid code type");
}}},{key:"toString",value:function(){return this.code}}]);return a}(),g=function(){function a(b){m(this,a);this.gl=b;this.nextTextureUnit=this.nextSymbolID=0;this.varyingsCode=this.attributesCode=this.uniformsCode="";this.fragmentExtensionsSet=new Set;this.fragmentExtensions="";this.vertexCode=new h;this.vertexMain="";this.fragmentCode=new h;this.fragmentMain="";this.required=new Set;this.uniforms=[];this.attributes=[];this.initializers=[];this.textureUnits=new Map}l(a,[{key:"allocateTextureUnit",
value:function(a,b){b=void 0===b?1:b;if(this.textureUnits.has(a))throw Error("Duplicate texture unit symbol: "+a);var d=this.nextTextureUnit;this.nextTextureUnit+=b;this.textureUnits.set(a,d);return d}},{key:"addTextureSampler2D",value:function(a,b,d){var f=this.allocateTextureUnit(b,d);this.addUniform("highp sampler2D",a,d);this.addInitializer(function(b){if(d){for(var g=new Int32Array(d),c=0;c<d;++c)g[c]=c+f;b.gl.uniform1iv(b.uniform(a),g)}else b.gl.uniform1i(b.uniform(a),f)});return f}},{key:"symbol",
value:function(a){return a+this.nextSymbolID++}},{key:"addAttribute",value:function(a,b){this.attributes.push(b);this.attributesCode+="attribute "+a+" "+b+";\n";return b}},{key:"addVarying",value:function(a,b){this.varyingsCode+="varying "+a+" "+b+";\n"}},{key:"addUniform",value:function(a,b,d){this.uniforms.push(b);this.uniformsCode=null!=d?this.uniformsCode+("uniform "+a+" "+b+"["+d+"];\n"):this.uniformsCode+("uniform "+a+" "+b+";\n");return b}},{key:"addFragmentExtension",value:function(a){this.fragmentExtensionsSet.has(a)||
(this.fragmentExtensionsSet.add(a),this.fragmentExtensions+="#extension "+a+" : require\n")}},{key:"addVertexCode",value:function(a){this.vertexCode.add(a)}},{key:"addFragmentCode",value:function(a){this.fragmentCode.add(a)}},{key:"setVertexMain",value:function(a){this.vertexMain=a}},{key:"addVertexMain",value:function(a){this.vertexMain=(this.vertexMain||"")+a}},{key:"setFragmentMain",value:function(a){this.fragmentMain="void main() {\n"+a+"\n}\n"}},{key:"setFragmentMainFunction",value:function(a){this.fragmentMain=
a}},{key:"addInitializer",value:function(a){this.initializers.push(a)}},{key:"require",value:function(a){this.required.has(a)||(this.required.add(a),a(this))}},{key:"build",value:function(){var a=new k(this.gl,"\nprecision highp float;\n"+this.uniformsCode+"\n"+this.attributesCode+"\n"+this.varyingsCode+"\n"+this.vertexCode+"\nvoid main() {\n"+this.vertexMain+"\n}\n","\n"+this.fragmentExtensions+"\nprecision highp float;\n"+this.uniformsCode+"\n"+this.varyingsCode+"\n"+this.fragmentCode+"\n"+this.fragmentMain+
"\n",this.uniforms,this.attributes);a.textureUnits=this.textureUnits;var b=this.initializers;if(0<b.length){a.bind();for(var b=$jscomp.makeIterator(b),d=b.next();!d.done;d=b.next())d=d.value,d(a)}return a}}]);return a}()},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return p});b.d(e,"b",function(){return v});var r=b(49);n=b(0);var a=b(36),c=function(){function a(a,b){for(var d=0;d<b.length;d++){var f=b[d];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(a,f.key,f)}}return function(b,g,d){g&&a(b.prototype,g);
d&&a(b,d);return b}}(),l=function h(a,b,f){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),null!==a)return h(a,b,f)}else{if("value"in d)return d.value;b=d.get;return void 0===b?void 0:b.call(f)}};b(192);var p=0,w=a.a.fromObject({escape:{action:"close"}}),v=function(b){function g(){if(!(this instanceof g))throw new TypeError("Cannot call a class as a function");var b=m(this,(g.__proto__||Object.getPrototypeOf(g)).call(this));
b.keyMap=new a.a;b.keyMap.addParent(w,Number.NEGATIVE_INFINITY);++p;var f=b.container=document.createElement("div");f.className="overlay";var c=b.content=document.createElement("div");b.registerDisposer(new r.a(c));c.className="overlay-content";f.appendChild(c);document.body.appendChild(f);b.registerDisposer(new a.b(b.container,b.keyMap));b.registerEventListener(f,"action:close",function(){b.dispose()});c.focus();return b}u(g,b);c(g,[{key:"disposed",value:function(){--p;document.body.removeChild(this.container);
l(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"disposed",this).call(this)}}]);return g}(n.b)},function(n,e,b){b.d(e,"b",function(){return m});var m;(function(b){b[b.UINT8=0]="UINT8";b[b.UINT16=1]="UINT16";b[b.UINT32=2]="UINT32";b[b.UINT64=3]="UINT64";b[b.FLOAT32=4]="FLOAT32"})(m||(m={}));n=[];e.a=n;n[m.UINT8]=1;n[m.UINT16]=2;n[m.UINT32]=4;n[m.UINT64]=8;n[m.FLOAT32]=4},function(n,e,b){e.a=function(){return new m.a(void 0)};e.b=function(b){return new m.b(b,u.h)};var m=b(7),u=b(2)},function(n,
e,b){function m(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return r});n=b(10);var u=function(){function a(a,b){for(var c=0;c<b.length;c++){var l=b[c];l.enumerable=l.enumerable||!1;l.configurable=!0;"value"in l&&(l.writable=
!0);Object.defineProperty(a,l.key,l)}}return function(b,l,e){l&&a(b.prototype,l);e&&a(b,e);return b}}(),r=function(a){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var a=(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!==typeof a&&"function"!==typeof a?this:a}m(b,a);u(b,[{key:"draw",value:function(a){}},{key:"isTransparent",
get:function(){return!1}}]);return b}(n.g)},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,
{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return B});b.d(e,"c",function(){return z});b.d(e,"d",function(){return E});b.d(e,"b",function(){return y});var a=b(18);n=b(9);e=b(40);var c=b(47),l=b(0),p=b(1),w=b(20),v=b(3),k=b(37),h=b(52),g=b(26),d=b(54),f=b(6),q=function(){function a(a,b){for(var d=0;d<b.length;d++){var f=b[d];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=
!0);Object.defineProperty(a,f.key,f)}}return function(b,d,f){d&&a(b.prototype,d);f&&a(b,f);return b}}(),x=function G(a,b,d){null===a&&(a=Function.prototype);var f=Object.getOwnPropertyDescriptor(a,b);if(void 0===f){if(a=Object.getPrototypeOf(a),null!==a)return G(a,b,d)}else{if("value"in f)return f.value;b=f.get;return void 0===b?void 0:b.call(d)}},F=this&&this.__decorate||function(a,b,d,f){var g=arguments.length,c=3>g?b:null===f?f=Object.getOwnPropertyDescriptor(b,d):f,h;if("object"===typeof Reflect&&
"function"===typeof Reflect.decorate)c=Reflect.decorate(a,b,d,f);else for(var q=a.length-1;0<=q;q--)if(h=a[q])c=(3>g?h(c):3<g?h(b,d,c):h(b,d))||c;return 3<g&&c&&Object.defineProperty(b,d,c),c},C=p.c.create(),B=function(a){function d(a,f,g){m(this,d);var c=u(this,(d.__proto__||Object.getPrototypeOf(d)).call(this));c.chunkManager=a;c.layerManager=f;c.navigationState=g;c.gl=c.chunkManager.gl;c.dataToViewport=p.c.create();c.viewportToDevice=p.c.create();c.dataToDevice=p.c.create();c.visibleChunks=new Map;
c.viewChanged=new v.a;c.renderingStale=!0;c.visibleChunksStale=!0;c.visibleLayersStale=!1;c.visibleLayerList=[];c.newVisibleLayers=new Set;c.offscreenFramebuffer=c.registerDisposer(new h.a(c.gl,{colorBuffers:b.i(h.b)(c.gl,1),depthBuffer:new h.e(c.gl)}));p.c.identity(c.dataToViewport);c.initializeCounterpart(c.chunkManager.rpc,{chunkManager:a.rpcId});c.updateVisibleLayers();c.registerDisposer(g.changed.add(function(){c.updateViewportFromNavigationState()}));c.updateViewportFromNavigationState();c.registerDisposer(f.layersChanged.add(function(){!c.visibleLayersStale&&
c.hasValidViewport&&(c.visibleLayersStale=!0,setTimeout(c.updateVisibleLayers.bind(c),0))}));c.viewChanged.add(function(){c.renderingStale=!0});c.registerDisposer(a.chunkQueueManager.visibleChunksChanged.add(c.viewChanged.dispatch));c.updateViewportFromNavigationState();return c}r(d,a);q(d,[{key:"updateViewportFromNavigationState",value:function(){var a=this.navigationState;a.valid&&(a.toMat4(C),this.setViewportToDataMatrix(C))}},{key:"updateVisibleLayers",value:function(){if(!this.hasValidViewport)return!1;
this.visibleLayersStale=!1;var a=this.visibleLayers,b=this.rpc,d={id:this.rpcId},f=this.newVisibleLayers,g=!1,h=this.visibleLayerList;h.length=0;for(var q=$jscomp.makeIterator(this.layerManager.readyRenderLayers()),k=q.next();!k.done;k=q.next())k=k.value,k instanceof c.a&&(f.add(k),h.push(k),a.has(k)||(a.set(k.addRef(),[]),k.redrawNeeded.add(this.viewChanged.dispatch),d.layerId=k.rpcId,b.invoke("SliceView.addVisibleLayer",d),g=!0));h=$jscomp.makeIterator(a.keys());for(k=h.next();!k.done;k=h.next())q=
k.value,f.has(q)||(a.delete(q),q.redrawNeeded.remove(this.viewChanged.dispatch),d.layerId=q.rpcId,b.invoke("SliceView.removeVisibleLayer",d),q.dispose(),g=!0);f.clear();g&&(this.visibleSourcesStale=!0);this.viewChanged.dispatch();return g}},{key:"onViewportChanged",value:function(){var a=this.width,b=this.height,d=this.viewportToDevice,f=this.dataToViewport,g=this.dataToDevice;p.c.ortho(d,-a/2,a/2,b/2,-b/2,-10,10);p.c.multiply(g,d,f);this.visibleChunksStale=!0;this.viewChanged.dispatch()}},{key:"setViewportSize",
value:function(a,b){return x(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"setViewportSize",this).call(this,a,b)?(this.rpc.invoke("SliceView.updateView",{id:this.rpcId,width:a,height:b}),!0):!1}},{key:"onViewportToDataMatrixChanged",value:function(){var a=this.viewportToData,d=this.dataToViewport;p.c.invert(d,a);b.i(p.d)(d);this.rpc.invoke("SliceView.updateView",{id:this.rpcId,viewportToData:a})}},{key:"onHasValidViewport",value:function(){this.updateVisibleLayers()}},{key:"updateRendering",
value:function(){if(this.renderingStale&&this.hasValidViewport&&0!==this.width&&0!==this.height){this.renderingStale=!1;this.maybeUpdateVisibleChunks();var a=this.gl,b=this.offscreenFramebuffer;b.bind(this.width,this.height);a.disable(a.SCISSOR_TEST);a.clearStencil(0);a.clearColor(0,0,0,0);a.colorMask(!0,!0,!0,!0);a.clear(a.COLOR_BUFFER_BIT);a.enable(a.STENCIL_TEST);a.disable(a.DEPTH_TEST);a.stencilOpSeparate(a.FRONT_AND_BACK,a.KEEP,a.KEEP,a.REPLACE);for(var d=0,f=$jscomp.makeIterator(this.visibleLayerList),
g=f.next();!g.done;g=f.next())g=g.value,a.clear(a.STENCIL_BUFFER_BIT),a.stencilFuncSeparate(a.FRONT_AND_BACK,a.GREATER,1,1),1===d&&(a.enable(a.BLEND),a.blendFunc(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA)),g.draw(this),++d;a.disable(a.BLEND);a.disable(a.STENCIL_TEST);b.unbind()}}},{key:"maybeUpdateVisibleChunks",value:function(){if(!this.visibleChunksStale&&!this.visibleSourcesStale)return!1;this.visibleChunksStale=!1;this.updateVisibleChunks();return!0}},{key:"updateVisibleChunks",value:function(){var a=
this.visibleChunks;this.computeVisibleChunks(function(b){var d=a.get(b);void 0===d?(d=[],a.set(b,d)):d.length=0;return d},function(a,d,f){a=b.i(p.o)(f);d[d.length]=a})}},{key:"disposed",value:function(){for(var a=$jscomp.makeIterator(this.visibleLayers.keys()),b=a.next();!b.done;b=a.next())b.value.dispose();this.visibleLayers.clear();this.visibleLayerList.length=0}}]);return d}(b.i(k.c)(e.e)),B=F([b.i(f.f)(e.f)],B),z=function(a){function b(a,d){m(this,b);a=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,
a,d));a.spec=d.spec;return a}r(b,a);q(b,[{key:"initializeCounterpart",value:function(a,d){d.spec=this.spec.toObject();x(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"initializeCounterpart",this).call(this,a,d)}}],[{key:"encodeOptions",value:function(a){var d=x(b.__proto__||Object.getPrototypeOf(b),"encodeOptions",this).call(this,a);d.spec=a.spec.toObject();return d}}]);return b}(n.c),E=function(b){function d(b,f){m(this,d);var g=u(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,
b));g.chunkGridPosition=f.chunkGridPosition;g.chunkDataSize=f.chunkDataSize||b.spec.chunkDataSize;g.state=a.b.SYSTEM_MEMORY;return g}r(d,b);return d}(n.d),y=function(a){function f(a,c){m(this,f);var h=u(this,(f.__proto__||Object.getPrototypeOf(f)).call(this));h.gl=a;h.copyVertexPositionsBuffer=b.i(d.a)(h.gl);h.textureCoordinateAdjustment=new Float32Array(4);var q=new g.a(a);q.addVarying("vec2","vTexCoord");q.addUniform("sampler2D","uSampler");q.addInitializer(function(b){a.uniform1i(b.uniform("uSampler"),
0)});q.addUniform("vec4","uColorFactor");q.addUniform("vec4","uBackgroundColor");q.addUniform("mat4","uProjectionMatrix");q.addUniform("vec4","uTextureCoordinateAdjustment");q.require(c);q.setFragmentMain("\nvec4 sampledColor = texture2D(uSampler, vTexCoord);\nif (sampledColor.a == 0.0) {\n  sampledColor = uBackgroundColor;\n}\nemit(sampledColor * uColorFactor, vec4(0,0,0,0));\n");q.addAttribute("vec4","aVertexPosition");q.setVertexMain("\nvTexCoord = uTextureCoordinateAdjustment.xy + 0.5 * (aVertexPosition.xy + 1.0) * uTextureCoordinateAdjustment.zw;\ngl_Position = uProjectionMatrix * aVertexPosition;\n");
h.shader=h.registerDisposer(q.build());return h}r(f,a);q(f,[{key:"draw",value:function(a,b,d,f,g,c,h,q){var k=this.gl,l=this.shader,e=this.textureCoordinateAdjustment;e[0]=g;e[1]=c;e[2]=h-g;e[3]=q-c;l.bind();k.activeTexture(k.TEXTURE0);k.bindTexture(k.TEXTURE_2D,a);k.uniformMatrix4fv(l.uniform("uProjectionMatrix"),!1,b);k.uniform4fv(l.uniform("uColorFactor"),d);k.uniform4fv(l.uniform("uBackgroundColor"),f);k.uniform4fv(l.uniform("uTextureCoordinateAdjustment"),e);a=l.attribute("aVertexPosition");
this.copyVertexPositionsBuffer.bindToVertexAttrib(a,2);k.drawArrays(k.TRIANGLE_FAN,0,4);k.disableVertexAttribArray(a);k.bindTexture(k.TEXTURE_2D,null)}}],[{key:"get",value:function(a,d){return a.memoize.get("sliceview/SliceViewRenderHelper:"+b.i(w.a)(d),function(){return new f(a,d)})}}]);return f}(l.b)},function(n,e,b){e.a=function(b){return new m.b(void 0===b?.5:b,u.m)};var m=b(7),u=b(2)},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function r(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}b.d(e,"a",function(){return p});b.d(e,
"b",function(){return w});b.d(e,"c",function(){return v});n=b(0);var a=b(3),c=function h(a,b,f){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),null!==a)return h(a,b,f)}else{if("value"in d)return d.value;b=d.get;return void 0===b?void 0:b.call(f)}},l=function(){function a(a,b){for(var d=0;d<b.length;d++){var g=b[d];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(a,g.key,g)}}
return function(b,d,f){d&&a(b.prototype,d);f&&a(b,f);return b}}(),p=function(){function b(g,d){r(this,b);this.value_=g;this.defaultValue=d;this.changed=new a.a}l(b,[{key:"toggle",value:function(){this.value=!this.value}},{key:"toJSON",value:function(){if(this.value_!==this.defaultValue)return this.value_}},{key:"restoreState",value:function(a){this.value=!0===a||!1===a?a:this.defaultValue}},{key:"reset",value:function(){this.value=this.defaultValue}},{key:"value",get:function(){return this.value_},
set:function(a){a!==this.value_&&(this.value_=a,this.changed.dispatch())}}]);return b}(),w=function(a){function b(a){r(this,b);var d=m(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));d.model=a;d.element=document.createElement("input");var g=d.element;g.type="checkbox";d.registerDisposer(a.changed.add(function(){d.updateCheckbox()}));d.updateCheckbox();d.registerEventListener(g,"change",function(b){a.value=this.checked});g.addEventListener("mousedown",function(a){a.preventDefault()});return d}
u(b,a);l(b,[{key:"updateCheckbox",value:function(){this.element.checked=this.model.value}},{key:"disposed",value:function(){var a=this.element,f=a.parentElement;f&&f.removeChild(a);c(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"disposed",this).call(this)}}]);return b}(n.b),v=function(a){function b(a,f){r(this,b);var d=m(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));d.model=a;d.element=f;d.updateVisibility();d.registerDisposer(a.changed.add(function(){d.updateVisibility()}));
return d}u(b,a);l(b,[{key:"updateVisibility",value:function(){this.element.style.display=this.model.value?"":"none"}}]);return b}(n.b)},function(n,e,b){e.a=function(b,e){e.offset+=b;return e};e.c=function(b,e){var m=[];e=$jscomp.makeIterator(e);for(var a=e.next();!a.done;a=e.next())a=a.value,a.startsWith(b)&&m.push({value:a});return m};e.b=function(b,e,r,a){var c=[];e=$jscomp.makeIterator(e);for(var l=e.next();!l.done;l=e.next()){var l=l.value,p=r(l);p.startsWith(b)&&c.push({value:p,description:a(l)})}return c}},
function(n,e,b){function m(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"d",function(){return p});e.b=function(a,e,k){k=void 0===k?"GET":k;var h=new XMLHttpRequest;if(Array.isArray(a)){var g=a.length,g=1===g?0:Math.abs(b.i(r.a)(e))%g;a=
a[g]+e}else a+=e;h[l]=k;h[c]=a;h.open(k,a);return h};e.a=function(a,b,c){c=void 0===c?u.c:c;a.responseType=b;return new Promise(function(b,g){var d=function(){a.abort()};c.add(d);a.onloadend=function(){var f=this.status;c.remove(d);200<=f&&300>f?b(this.response):g(p.fromXhr(a))};a.send()})};e.c=function(a){var b=a.match(/^([^:\/]+):\/\/([^\/]+)(\/.*)?$/);if(null===b)throw Error("Invalid URL: "+JSON.stringify(a));return"gs"===b[1]?[["https://storage.googleapis.com/"+b[2]],b[3]]:[[a],""]};var u=b(13),
r=b(167),a=function(){function a(a,b){for(var c=0;c<b.length;c++){var g=b[c];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(a,g.key,g)}}return function(b,c,h){c&&a(b.prototype,c);h&&a(b,h);return b}}();$jscomp.initSymbol();var c=Symbol("url");$jscomp.initSymbol();var l=Symbol("method"),p=function(b){function e(a,b,g,d){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");var f=a+" "+JSON.stringify(b)+" resulted in HTTP error "+
g;d&&(f+=": "+d);var f=f+".",c;c=(e.__proto__||Object.getPrototypeOf(e)).call(this,f);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");c=!c||"object"!==typeof c&&"function"!==typeof c?this:c;c.name="HttpError";c.message=f;c.method=a;c.url=b;c.code=g;c.statusMessage=d;return c}m(e,b);a(e,null,[{key:"fromXhr",value:function(a){return new e(a[l],a[c],a.status,a.statusText)}}]);return e}(Error)},function(n,e,b){function m(a,b){if("function"!==typeof b&&null!==
b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"b",function(){return l});n=b(0);var u=b(15);b.d(e,"a",function(){return u.a});b.d(e,"c",function(){return u.b});var r=function(){function a(a,b){for(var c=0;c<b.length;c++){var h=b[c];h.enumerable=h.enumerable||!1;h.configurable=
!0;"value"in h&&(h.writable=!0);Object.defineProperty(a,h.key,h)}}return function(b,c,k){c&&a(b.prototype,c);k&&a(b,k);return b}}(),a=new Set("f1 f2 f3 f4 f5 f6 f7 f8 f9 f10 f11 f12 escape pause".split(" ")),c=new Set("color date datetime datetime-local email month number password search tel text time url week".split(" ")),l=function(e){function l(a,b){if(!(this instanceof l))throw new TypeError("Cannot call a class as a function");var c;c=(l.__proto__||Object.getPrototypeOf(l)).call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
c=!c||"object"!==typeof c&&"function"!==typeof c?this:c;c.target=a;c.eventMap=b;c.modifierShortcutsAreGlobal=!0;c.allShortcutsAreGlobal=!1;c.allowSpaceKeyOnButtons=!1;c.registerEventListener(a,"keydown",c.handleKeyDown.bind(c),!1);return c}m(l,e);r(l,[{key:"shouldIgnoreEvent",value:function(b,k){var h=k.target,g=h.tagName;if(h===this.target)return!1;var d="TEXTAREA"===g||"INPUT"===g||"BUTTON"===g||"SELECT"===g,f=!d&&(h.isContentEditable||h.ownerDocument&&"on"===h.ownerDocument.designMode);return!d&&
!f||this.allShortcutsAreGlobal||a.has(b)?!1:f||this.modifierShortcutsAreGlobal&&(k.altKey||k.ctrlKey||k.metaKey)?!0:"INPUT"===g&&c.has(h.type)?"enter"!==b:"INPUT"===g||"BUTTON"===g?this.allowSpaceKeyOnButtons?!1:"space"===b:!0}},{key:"handleKeyDown",value:function(a){var c=a.code.toLowerCase();this.shouldIgnoreEvent(c,a)||b.i(u.c)(c,a,this.eventMap)}}]);return l}(n.b)},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return p});b.d(e,"b",function(){return w});e.c=function(b){return function(b){function h(){m(this,h);var a=
u(this,(h.__proto__||Object.getPrototypeOf(h)).apply(this,arguments));a.visibility=new w;return a}r(h,b);l(h,[{key:"initializeCounterpart",value:function(b,d){d=void 0===d?{}:d;d.visibility=this.registerDisposer(a.a.makeFromExisting(b,this.visibility)).rpcId;c(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"initializeCounterpart",this).call(this,b,d)}}]);return h}(b)};var a=b(79);n=b(7);var c=function k(a,b,d){null===a&&(a=Function.prototype);var f=Object.getOwnPropertyDescriptor(a,b);
if(void 0===f){if(a=Object.getPrototypeOf(a),null!==a)return k(a,b,d)}else{if("value"in f)return f.value;b=f.get;return void 0===b?void 0:b.call(d)}},l=function(){function a(a,b){for(var d=0;d<b.length;d++){var f=b[d];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(a,f.key,f)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}(),p=function(a){function b(a){a=void 0===a?Number.NEGATIVE_INFINITY:a;m(this,b);return u(this,(b.__proto__||
Object.getPrototypeOf(b)).call(this,a))}r(b,a);l(b,[{key:"visible",get:function(){return this.value===Number.POSITIVE_INFINITY}},{key:"ignored",get:function(){return this.value===Number.NEGATIVE_INFINITY}}]);return b}(n.a);p.VISIBLE=Number.POSITIVE_INFINITY;p.IGNORED=Number.NEGATIVE_INFINITY;var w=function(a){function b(){m(this,b);var a=u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));a.contributors=new Map;return a}r(b,a);l(b,[{key:"add",value:function(a){var b=this,f=this.contributors,
c=a.changed.add(function(){b.update()}),g=function(){f.delete(g);c();b.update()};f.set(g,a);this.update();return g}},{key:"update",value:function(){for(var a=Number.NEGATIVE_INFINITY,b=$jscomp.makeIterator(this.contributors.values()),f=b.next();!f.done;f=b.next())a=Math.max(a,f.value.value);this.value=a}}]);return b}(p)},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function a(a){b.i(z.a)(a);var d=b.i(z.d)(a,"neariso_voxelres",function(a){return b.i(z.w)(a,z.y)}),f=b.i(z.d)(a,"neariso_imagesize",
function(a){return b.i(z.w)(a,z.z)}),c=b.i(z.d)(a,"neariso_offset",function(a){return b.i(z.w)(a,z.l)});return b.i(z.d)(a,"resolutions",function(a){return b.i(z.k)(a,z.x)}).map(function(a){var b=""+a,g=d.get(b),h=f.get(b),q=c.get(b);if(void 0===g||void 0===h||void 0===q)throw Error("Missing neariso_voxelres/neariso_imagesize/neariso_offset for resolution "+(a+"."));return{key:b,voxelSize:g,imageSize:h,voxelOffset:q}})}function c(a){a=y.get(a);void 0===a&&(a=q.a.UNKNOWN);return a}function l(a){b.i(z.a)(a);
var d=b.i(z.d)(a,"channel_type",z.h);return{channelType:d,description:b.i(z.d)(a,"description",z.h),volumeType:c(d),dataType:b.i(z.d)(a,"datatype",function(a){return b.i(z.n)(a,q.b)})}}function p(d){b.i(z.a)(d);return{channels:b.i(z.d)(d,"channels",function(a){return b.i(z.w)(a,l)}),scales:b.i(z.d)(d,"dataset",a)}}function w(a,d,f,c){return a.memoize.getUncounted({type:"ndstore:getTokenInfo",hostnames:d,token:f},function(){return b.i(B.a)(b.i(B.b)(d,c+"/"+f+"/info/"),"json").then(p)})}function v(a,
d,f,c){var g=f.match(D);if(null===g)throw Error("Invalid volume path "+JSON.stringify(f));var h=g[1],q=g[2],k=b.i(z.u)(g[3]||"");return a.memoize.getUncounted({type:"ndstore:MultiscaleVolumeChunkSource",hostnames:d,path:f},function(){return w(a,d,h,c).then(function(b){return new J(a,d,h,b,q,c,k)})})}function k(a,b){var d=b.match(S);if(null===d)throw Error("Invalid ndstore volume path: "+JSON.stringify(b));return v(a,[d[1]],d[2],f.c)}function h(a,d,f){return a.memoize.getUncounted({type:"dvid:getPublicTokens",
hostnames:d},function(){return b.i(B.a)(b.i(B.b)(d,f+"/public_tokens/"),"json").then(function(a){return b.i(z.k)(a,z.h)})})}function g(a,d,f,c){var g=f.match(/^(?:([^\/]+)(?:\/([^\/]*))?)?$/);if(null===g)return Promise.reject(null);if(void 0===g[2]){var k=g[1]||"";return h(a,d,c).then(function(a){return{offset:0,completions:b.i(F.b)(k,a,function(a){return a+"/"},function(){})}})}return w(a,d,g[1],c).then(function(a){a=b.i(F.b)(g[2],a.channels,function(a){return a[0]},function(a){return a[1].channelType+
" ("+q.b[a[1].dataType]+")"});return{offset:g[1].length+1,completions:a}})}function d(a,d){var c=a.match(S);return null===c?Promise.reject(null):g(d,[c[1]],c[2],f.c).then(function(a){return b.i(F.a)(c[1].length+1,a)})}Object.defineProperty(e,"__esModule",{value:!0});b.d(e,"getVolume",function(){return k});b.d(e,"volumeCompleter",function(){return d});b.d(e,"MultiscaleVolumeChunkSource",function(){return J});e.getTokenInfo=w;e.getShardedVolume=v;e.getPublicTokens=h;e.tokenAndChannelCompleter=g;b.d(e,
"NDStoreDataSource",function(){return I});b.d(e,"SingleServerDataSource",function(){return P});n=b(9);e=b(23);var f=b(70),q=b(4),x=b(14),F=b(34),C=b(1),B=b(35),z=b(2),E=function(){function a(a,b){for(var d=0;d<b.length;d++){var f=b[d];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(a,f.key,f)}}return function(b,d,f){d&&a(b.prototype,d);f&&a(b,f);return b}}(),y=new Map;y.set("image",q.a.IMAGE);y.set("annotation",q.a.SEGMENTATION);var H=new Set(["npz",
"raw","jpeg"]),G=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}r(b,a);return b}(b.i(n.e)(x.c,f.b)),J=function(){function a(d,c,g,h,k,e,l){m(this,a);this.chunkManager=d;this.baseUrls=c;this.key=g;this.tokenInfo=h;this.parameters=l;this.urlPrefix=f.c;this.neariso=!0;if(void 0===k){k=Array.from(h.channels.keys());if(1!==k.length)throw Error("Dataset contains multiple channels: "+JSON.stringify(k));k=k[0]}d=h.channels.get(k);if(void 0===
d)throw Error("Specified channel "+JSON.stringify(k)+" is not one of the supported "+("channels "+JSON.stringify(Array.from(h.channels.keys()))));this.channel=k;this.channelInfo=d;this.scales=h.scales;void 0!==e&&(this.urlPrefix=e);"false"===b.i(z.e)(l.neariso)&&(this.neariso=!1);h=b.i(z.e)(l.encoding);if(void 0===h)h=this.volumeType===q.a.IMAGE?"jpeg":"npz";else if(!H.has(h))throw Error("Invalid encoding: "+JSON.stringify(h)+".");this.encoding=h}E(a,[{key:"getSources",value:function(a){var b=this;
return this.scales.map(function(d){for(var f=d.voxelOffset,c=d.voxelSize,g=C.a.create(),h=0;3>h;++h)g[h]=Math.ceil(f[h]);return q.d.getDefaults({numChannels:b.numChannels,volumeType:b.volumeType,dataType:b.dataType,voxelSize:c,transform:C.c.fromTranslation(C.c.create(),C.a.multiply(C.a.create(),f,c)),baseVoxelOffset:g,upperVoxelBound:d.imageSize,volumeSourceOptions:a}).map(function(a){return b.chunkManager.getChunkSource(G,{spec:a,parameters:{baseUrls:b.baseUrls,urlPrefix:b.urlPrefix,key:b.key,channel:b.channel,
resolution:d.key,encoding:b.encoding,neariso:b.neariso}})})})}},{key:"getMeshSource",value:function(){return null}},{key:"dataType",get:function(){return this.channelInfo.dataType}},{key:"numChannels",get:function(){return 1}},{key:"volumeType",get:function(){return this.channelInfo.volumeType}}]);return a}(),D=/^([^\/?]+)(?:\/([^\/?]+))?(?:\?(.*))?$/,S=/^((?:http|https):\/\/[^\/?]+)\/(.*)$/,I=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}
r(b,a);E(b,[{key:"volumeCompleter",value:function(a,b){return d(a,b)}},{key:"getVolume",value:function(a,b){return k(a,b)}},{key:"description",get:function(){return"NDstore"}}]);return b}(e.b),P=function(a){function b(a,d,c){c=void 0===c?f.c:c;m(this,b);var g=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));g.description=a;g.hostnames=d;g.urlprefix=c;return g}r(b,a);E(b,[{key:"getVolume",value:function(a,b){return v(a,this.hostnames,b,this.urlprefix)}},{key:"volumeCompleter",value:function(a,
b){return g(b,this.hostnames,a,this.urlprefix)}}]);return b}(e.b)},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?
Object.setPrototypeOf(a,b):a.__proto__=b)}function r(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function a(a,b){var d=b.redrawNeeded.dispatch;b.registerDisposer(a.segmentColorHash.changed.add(d));b.registerDisposer(a.visibleSegments.changed.add(d));b.registerDisposer(a.segmentEquivalences.changed.add(d));b.registerDisposer(a.segmentSelectionState.changed.add(d))}b.d(e,"b",function(){return g});b.d(e,"a",function(){return d});e.g=a;e.c=function(b,d){a(b,d);
d.registerDisposer(b.objectAlpha.changed.add(d.redrawNeeded.dispatch));d.registerDisposer(b.objectToDataTransform.changed.add(d.redrawNeeded.dispatch))};e.f=function(a,b,d){d=void 0===d?1:d;var c=f;c[3]=d;a.segmentColorHash.compute(c,b);if(a.segmentSelectionState.isSelected(b))for(a=0;3>a;++a)c[a]=.5*c[a]+.5;c[0]*=d;c[1]*=d;c[2]*=d;return c};e.e=function(a,d,f){b.i(c.a)(a,function(g,h){var q=b.i(c.b)(g,a.clipBounds.value),q=d.get(q);void 0!==q&&f(h,g,q)})};b.d(e,"d",function(){return q});var c=b(139);
n=b(0);e=b(1);var l=b(3),p=b(11),w=b(37),v=b(6),k=function F(a,b,d){null===a&&(a=Function.prototype);var c=Object.getOwnPropertyDescriptor(a,b);if(void 0===c){if(a=Object.getPrototypeOf(a),null!==a)return F(a,b,d)}else{if("value"in c)return c.value;b=c.get;return void 0===b?void 0:b.call(d)}},h=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&a(b.prototype,
d);c&&a(b,c);return b}}(),g=function(){function a(b,d){r(this,a);this.key=b;this.value=d}h(a,[{key:"toString",value:function(){return this.key+"\u2192"+this.value}}]);return a}(),d=function(a){function b(){r(this,b);var a=m(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));a.selectedSegment=new p.a;a.hasSelectedSegment=!1;a.changed=new l.a;return a}u(b,a);h(b,[{key:"set",value:function(a){if(null==a)this.hasSelectedSegment&&(this.hasSelectedSegment=!1,this.changed.dispatch());else{var b=
this.selectedSegment;this.hasSelectedSegment&&a.low===b.low&&a.high===b.high||(b.low=a.low,b.high=a.high,this.hasSelectedSegment=!0,this.changed.dispatch())}}},{key:"isSelected",value:function(a){return this.hasSelectedSegment&&p.a.equal(a,this.selectedSegment)}},{key:"bindTo",value:function(a,b){var d=this,c=new p.a;this.registerDisposer(a.changed.add(function(){var f=a.get(b);"number"===typeof f?(c.low=f,c.high=0,f=c):f instanceof g&&(f=f.value);d.set(f)}))}}]);return b}(n.b),f=e.m.create(),q=function(a){function b(a,
d){r(this,b);var c=m(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));c.chunkManager=a;c.displayState=d;c.registerDisposer(d.clipBounds.changed.add(function(){return a.chunkQueueManager.scheduleChunkUpdate()}));return c}u(b,a);h(b,[{key:"initializeCounterpartWithChunkManager",value:function(a){var d=this.displayState;a.chunkManager=this.chunkManager.rpcId;a.visibleSegments=d.visibleSegments.rpcId;a.segmentEquivalences=d.segmentEquivalences.rpcId;a.clipBounds=d.clipBounds.rpcId;k(b.prototype.__proto__||
Object.getPrototypeOf(b.prototype),"initializeCounterpart",this).call(this,this.chunkManager.rpc,a)}}]);return b}(b.i(w.c)(v.b))},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?
Object.setPrototypeOf(a,b):a.__proto__=b)}function r(a,b,d){for(var c=0;3>c;++c)a[c]=Number.POSITIVE_INFINITY,b[c]=Number.NEGATIVE_INFINITY;d=$jscomp.makeIterator(d);for(c=d.next();!c.done;c=d.next())for(var f=c.value.spec,c=f.lowerChunkBound,f=f.upperChunkBound,g=0;3>g;++g)a[g]=Math.min(a[g],c[g]),b[g]=Math.max(b[g],f[g])}function a(a,b,c,f){for(var g=d.FULLY_INSIDE,h=0;3>h;++h){var q;q=a[h];var k=b[h],e=c[h],l=f[h];q=q>=l||k<=e?d.FULLY_OUTSIDE:q>=e&&k<=l?d.FULLY_INSIDE:d.PARTIALLY_INSIDE;switch(q){case d.FULLY_OUTSIDE:return q;
case d.PARTIALLY_INSIDE:g=q}}return g}function c(a,b){var d=b.length,c=0;if(1<d)for(var f=0,h=0;h<d;++h){var q=b[h].spec.chunkLayout,k;k=q.size;for(var q=q.globalToLocalSpatialVector(g,a),e=0,l=0,p=1,x=0;3>x;++x)var v=k[x],p=p*v,v=v*q[x],e=Math.min(e,v),l=Math.max(l,v);k=p/(l-e);k>f&&(f=k,c=h)}return b[c]}function l(a){var d=a.voxelSize,c=void 0===a.lowerVoxelBound?k.e:a.lowerVoxelBound,f=a.upperVoxelBound,g=void 0===a.maxVoxelsPerChunkLog2?18:a.maxVoxelsPerChunkLog2;a=void 0===a.transform?k.h:a.transform;
a=b.i(k.i)(k.a.create(),a);d=k.a.multiply(a,a,d);a=k.a.fromValues(1,1,1);var h;if(void 0===f)h=k.j;else{h=k.a.create();for(var q=0;3>q;++q)h[q]=Math.pow(2,Math.floor(Math.log2(f[q]-c[q])))}for(c=0;c<g;++c){for(var f=Infinity,q=-1,e=0;3>e;++e)if(!(a[e]>=h[e])){var l=a[e]*d[e];l<f&&(f=l,q=e)}f=q;if(-1===f)break;a[f]*=2}return a}b.d(e,"e",function(){return q});e.b=l;e.a=function(a,b){b=b.transform;return void 0===b?void 0===a?k.h:a:void 0===a?b:k.c.multiply(k.c.create(),b,a)};e.c=function(a){if(void 0!==
a.chunkDataSizes)return a.chunkDataSizes;var b=void 0===a.chunkLayoutPreference?x.ISOTROPIC:a.chunkLayoutPreference;switch(b){case x.ISOTROPIC:return[l(a)];case x.FLAT:for(var b=[],d=0;3>d;++d){var c=d,f;f=a.lowerVoxelBound;var h=a.upperVoxelBound,q=d,e=a.voxelSize,p=a.maxVoxelsPerChunkLog2,v=a.transform;k.a.subtract(g,void 0===h?k.j:h,void 0===f?k.e:f);g[q]=1;f=l({voxelSize:e,upperVoxelBound:g,maxVoxelsPerChunkLog2:p,transform:v});b[c]=f}b.push(l(a));return b}throw Error("Invalid chunk layout preference: "+
b+".");};b.d(e,"d",function(){return F});var p=b(145),w=b(87),v=b(162);b(28);var k=b(1);n=b(6);var h=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}(),g=k.a.create(),d;(function(a){a[a.FULLY_OUTSIDE=0]="FULLY_OUTSIDE";a[a.FULLY_INSIDE=1]="FULLY_INSIDE";a[a.PARTIALLY_INSIDE=2]="PARTIALLY_INSIDE"})(d||(d={}));
var f=[k.a.create(),k.a.create(),k.a.create(),k.a.create()],q=function(q){function e(){m(this,e);var a;a=(e.__proto__||Object.getPrototypeOf(e)).call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");a=!a||"object"!==typeof a&&"function"!==typeof a?this:a;a.width=-1;a.height=-1;a.hasViewportToData=!1;a.hasValidViewport=!1;a.viewportToData=k.c.create();a.viewportAxes=[k.a.create(),k.a.create(),k.a.create()];a.previousViewportAxes=[k.a.create(),k.a.create()];
a.centerDataPosition=k.a.create();a.viewportPlaneDistanceToOrigin=0;a.visibleChunkLayouts=new Map;a.visibleLayers=new Map;a.visibleSourcesStale=!0;a.pixelSize=0;k.c.identity(a.viewportToData);return a}u(e,q);h(e,[{key:"onViewportChanged",value:function(){}},{key:"maybeSetHasValidViewport",value:function(){!this.hasValidViewport&&-1!==this.width&&-1!==this.height&&this.hasViewportToData&&(this.hasValidViewport=!0,this.onHasValidViewport());if(this.hasValidViewport)this.onViewportChanged()}},{key:"onHasValidViewport",
value:function(){}},{key:"setViewportSize",value:function(a,b){return a!==this.width||b!==this.height?(this.width=a,this.height=b,this.maybeSetHasValidViewport(),!0):!1}},{key:"setViewportToDataMatrix",value:function(a){if(this.hasViewportToData&&k.c.equals(this.viewportToData,a))return!1;this.hasViewportToData=!0;var d=this.viewportToData;k.c.copy(d,a);b.i(k.d)(d);k.a.transformMat4(this.centerDataPosition,k.e,a);a=0;for(var c=this.viewportAxes,f=this.previousViewportAxes,g=0;3>g;++g){var h=c[g];
b.i(k.f)(h,k.g[g],d);0===g&&(a=k.a.length(h));k.a.normalize(h,h)}this.viewportAxes=c;this.previousViewportAxes=f;if(!b.i(v.a)(a,this.pixelSize)||.95>k.a.dot(c[0],f[0])||.95>k.a.dot(c[1],f[1]))k.a.copy(f[0],c[0]),k.a.copy(f[1],c[1]),this.visibleSourcesStale=!0,this.pixelSize=a;this.viewportPlaneDistanceToOrigin=k.a.dot(this.centerDataPosition,this.viewportAxes[2]);this.onViewportToDataMatrixChanged();this.maybeSetHasValidViewport();return!0}},{key:"onViewportToDataMatrixChanged",value:function(){}},
{key:"updateVisibleSources",value:function(){if(this.visibleSourcesStale){this.visibleSourcesStale=!1;var a=1.1*this.pixelSize,b=this.visibleChunkLayouts,d=this.viewportAxes[2],f=this.visibleLayers;b.clear();for(var g={},f=$jscomp.makeIterator(f),h=f.next();!h.done;g={smallestVoxelSize:g.smallestVoxelSize,visibleSources:g.visibleSources},h=f.next()){var h=$jscomp.makeIterator(h.value),q=h.next().value;g.visibleSources=h.next().value;g.visibleSources.length=0;var h=q.sources,k=h.length,q=void 0;g.smallestVoxelSize=
h[0][0].spec.voxelSize;for(var e=function(b){return function(d){for(var c=0;3>c;++c){var f=d[c];if(f>a&&f>b.smallestVoxelSize[c])return!0}return!1}}(g),l=function(a){return function(d,c){a.visibleSources[a.visibleSources.length++]=d;var f=d.spec.chunkLayout,g=b.get(f);void 0===g&&(g=new Map,b.set(f,g));g.set(d,c)}}(g),q=k-1;;){k=c(d,h[q]);l(k,q);if(0===q||!e(k.spec.voxelSize))break;--q}g.visibleSources.reverse()}}}},{key:"computeVisibleChunks",value:function(c,h){var q=this;this.updateVisibleSources();
for(var e=this.width,l=this.height,p=this.viewportToData,x=0;3>x;++x)f[0][x]=-k.g[0][x]*e/2-k.g[1][x]*l/2,f[1][x]=-k.g[0][x]*e/2+k.g[1][x]*l/2,f[2][x]=k.g[0][x]*e/2-k.g[1][x]*l/2,f[3][x]=k.g[0][x]*e/2+k.g[1][x]*l/2;for(e=0;4>e;++e)k.a.transformMat4(f[e],f[e],p);var z=k.a.create(),E=k.a.create(),v=k.a.create(),C=k.a.create(),F=k.a.create(),B=k.a.create(),m=[],u=[];this.visibleChunkLayouts.forEach(function(e,l){function y(){for(var a=0,b=0,d=0;3>d;++d)var c=B[d],f=z[d],g=E[d]-f,h=F[d]*g,a=a+c*(f+h),
b=b+c*(f+g-h);return a<G?!1:b<=G}function p(c){function f(){D=b.i(w.a)(m,0,v,function(b){var c=b.spec;switch(a(z,E,c.lowerChunkBound,c.upperChunkBound)){case d.PARTIALLY_INSIDE:return!0;case d.FULLY_INSIDE:u.push(b);default:return!1}})}if(0!==u.length||0!==D){for(var g=1,q=0;3>q;++q)g*=Math.max(0,E[q]-z[q]);if(0!==g&&y())if(1===g)h(l,x,z,u);else{for(var k;;)if(g=z[c],q=E[c],k=q-g,1===k)c=(c+1)%3;else break;k=g+Math.floor(.5*k);var e=(c+1)%3,H=u.length;E[c]=k;var v=D;f();p(e);u.length=H;D=v;E[c]=q;
z[c]=k;f();p(e);z[c]=g;u.length=H;D=v}}}var x=c(l);r(v,C,e.keys());k.a.set(z,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);k.a.set(E,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);l.globalToLocalSpatialVector(B,q.viewportAxes[2]);for(var H=0;3>H;++H)F[H]=0<B[H]?1:0;for(var G=k.a.dot(l.globalToLocalGrid(g,q.centerDataPosition),B),H=0;4>H;++H)for(var n=l.globalToLocalGrid(g,f[H]),J=0;3>J;++J)z[J]=Math.min(z[J],Math.floor(n[J])),E[J]=Math.max(E[J],
Math.floor(n[J])+1);k.a.max(z,z,v);k.a.min(E,E,C);u.length=0;m.length=0;e=$jscomp.makeIterator(e.keys());for(H=e.next();!H.done;H=e.next())switch(H=H.value,n=H.spec,a(z,E,n.lowerChunkBound,n.upperChunkBound)){case d.FULLY_INSIDE:u.push(H);break;case d.PARTIALLY_INSIDE:m.push(H)}var D=m.length;p(0)})}}]);return e}(n.b),x;(function(a){a[a.ISOTROPIC=0]="ISOTROPIC";a[a.FLAT=1]="FLAT"})(x||(x={}));var F=function B(a){m(this,B);var b=void 0===a.lowerVoxelBound?k.e:a.lowerVoxelBound,d=a.upperVoxelBound,
c=a.chunkDataSize,f=a.voxelSize,g=a.transform,h=void 0===a.baseVoxelOffset?k.e:a.baseVoxelOffset,q=void 0===a.lowerClipBound?k.a.multiply(k.a.create(),f,b):a.lowerClipBound,e=void 0===a.upperClipBound?k.a.multiply(k.a.create(),f,d):a.upperClipBound;this.voxelSize=f;this.chunkDataSize=c;this.chunkLayout=p.a.get(k.a.multiply(k.a.create(),a.chunkDataSize,f),g);this.lowerClipBound=q;this.upperClipBound=e;this.lowerVoxelBound=b;this.upperVoxelBound=d;this.baseVoxelOffset=h;a=this.lowerChunkBound=k.a.create();
f=this.upperChunkBound=k.a.create();for(g=0;3>g;++g)a[g]=Math.floor(b[g]/c[g]),f[g]=Math.floor((d[g]-1)/c[g]+1)};e.f="SliceView"},function(n,e,b){b.d(e,"a",function(){return c});var m=b(1),u=b(2),r=b(3),a=function(){function a(a,b){for(var c=0;c<b.length;c++){var k=b[c];k.enumerable=k.enumerable||!1;k.configurable=!0;"value"in k&&(k.writable=!0);Object.defineProperty(a,k.key,k)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}(),c=function(){function c(a){a=void 0===a?m.c.create():
a;if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.transform=a;this.changed=new r.a}a(c,[{key:"reset",value:function(){m.c.copy(this.transform,m.h);this.changed.dispatch()}},{key:"toJSON",value:function(){if(!m.c.equals(m.h,this.transform)){var a=this.transform;return[[a[0],a[4],a[8],a[12]],[a[1],a[5],a[9],a[13]],[a[2],a[6],a[10],a[14]],[a[3],a[7],a[11],a[15]]]}}},{key:"restoreState",value:function(a){if(null==a)this.reset();else if(Array.isArray(a))if(4===a.length)try{for(var c=
0;4>c;++c)b.i(u.g)(this.transform.subarray(4*c,4*(c+1)),a[c]);m.c.transpose(this.transform,this.transform)}catch(h){this.reset()}else if(16===a.length)try{b.i(u.g)(this.transform,a),m.c.transpose(this.transform,this.transform)}catch(h){this.reset()}else this.reset();else if("object"===typeof a){var c=m.k.create(),e=m.a.create(),k=m.a.fromValues(1,1,1);try{b.i(u.g)(c,a.rotation),m.k.normalize(c,c)}catch(h){m.k.identity(c)}try{b.i(u.g)(e,a.translation)}catch(h){m.a.copy(e,m.e)}try{b.i(u.g)(k,a.scale)}catch(h){m.a.copy(k,
m.q)}m.c.fromRotationTranslationScale(this.transform,c,e,k);this.changed.dispatch()}else this.reset()}},{key:"clone",value:function(){return new c(m.c.clone(this.transform))}}]);return c}()},function(n,e,b){e.b=function(e,a,c,l){l=void 0===l?m.c:l;var p=void 0;return new Promise(function(w,v){function k(g){null!==p&&(p=b.i(u.b)(e.serverUrls,c.path,c.method),p.responseType=c.responseType,p.setRequestHeader("Authorization",g.credentials.tokenType+" "+g.credentials.accessToken),p.onloadend=function(){if(null!==
p){var b=this.status;200<=b&&300>b?(l.remove(h),w(this.response)):401===b||504===b?a.get(g,l).then(k):(l.remove(h),v(u.d.fromXhr(this)))}},p.send(c.payload))}var h=function(){var a=p;p=null;null!=a&&a.abort();v(m.b)};l.add(h);a.get(void 0,l).then(k)})};var m=b(13),u=b(35);e.a="google-brainmaps"},function(n,e,b){b.d(e,"b",function(){return u});var m=function(){function b(a,b){for(var c=0;c<b.length;c++){var e=b[c];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,
e.key,e)}}return function(a,c,e){c&&b(a.prototype,c);e&&b(a,e);return a}}();e.a=4093;var u=function(){function b(a,c,e,p){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");this.a0=a;this.a1=c;this.b=e;this.c=p}m(b,[{key:"computeDotProduct",value:function(a,b){var c=this.a0,e=this.a1;return c[0]*(a&255)+c[1]*(a>>8&255)+c[2]*(a>>16&255)+c[3]*(a>>24&255)+(e[0]*(b&255)+e[1]*(b>>8&255)+e[2]*(b>>16&255)+e[3]*(b>>24&255))}},{key:"compute",value:function(a,b){var c=this.b,e=
this.c;a=this.computeDotProduct(a,b);return(a+a*a%4093*e+c)%4093}},{key:"toString",value:function(){return"new HashFunction(Float32Array.of("+this.a0+"), "+("Float32Array.of("+this.a1+"), "+this.b+", "+this.c+")")}}],[{key:"generate",value:function(){function a(){return Math.floor(4093*Math.random())}return new b(Float32Array.of(a(),a(),a(),a()),Float32Array.of(a(),a(),a(),a()),a(),a())}}]);return b}()},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function r(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}b.d(e,"c",function(){return g});b.d(e,
"a",function(){return F});var a=b(43),c=b(11),l=function B(a,b,d){null===a&&(a=Function.prototype);var c=Object.getOwnPropertyDescriptor(a,b);if(void 0===c){if(a=Object.getPrototypeOf(a),null!==a)return B(a,b,d)}else{if("value"in c)return c.value;b=c.get;return void 0===b?void 0:b.call(d)}},p=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&a(b.prototype,
d);c&&a(b,c);return b}}();e.b=3;var w=0,v=0,k=0,h=0;n=function(){function b(a){a=void 0===a?b.generateHashFunctions(3):a;r(this,b);this.loadFactor=.9;this.size=0;this.growFactor=1.2;this.maxHeight=8192;this.emptyHigh=this.emptyLow=4294967295;this.maxAttempts=this.maxRehashAttempts=5;this.maxWidth=4096/this.entryStride;this.generation=0;this.mungedEmptyKey=-1;this.hashFunctions=a;this.allocate(4,1)}p(b,[{key:"updateHashFunctions",value:function(a){this.hashFunctions=b.generateHashFunctions(a);this.mungedEmptyKey=
-1}},{key:"tableWithMungedEmptyKey",value:function(a){for(var b=this.hashFunctions.length,d=Array(b),c=0;c<b;++c)d[c]=this.getHash(c,this.emptyLow,this.emptyHigh);c=this.mungedEmptyKey;if(-1===c)a:for(;;){for(var c=16777216*Math.random()>>>0,f=0;f<b;++f)for(var g=this.getHash(f,c,c),h=0;h<b;++h)if(d[h]===g)continue a;this.mungedEmptyKey=c;break}for(var f=this.table,g=this.emptyLow,h=this.emptyHigh,q=0;q<b;++q){var k=d[q];f[k]===g&&f[k+1]===h&&(f[k]=c,f[k+1]=c)}try{a(f)}finally{for(a=0;a<b;++a)q=d[a],
f[q]===c&&f[q+1]===c&&(f[q]=g,f[q+1]=h)}}},{key:"getHash",value:function(a,b,d){a=this.hashFunctions[a];var c=this.width,f=this.height,c=a[0].compute(b,d)%c;b=a[1].compute(b,d)%f;return this.entryStride*(b*this.width+c)}},{key:"keys",value:function(a){function b(b,y){for(;;)switch(d){case 0:a=void 0===a?new c.a:a,v=z,p=v.emptyLow,x=v.emptyHigh,l=v.entryStride,e=z,k=e.table,q=0,h=k.length;case 1:if(!(q<h)){d=3;break}g=k[q];f=k[q+1];if(g===p&&f===x){d=4;break}a.low=g;a.high=f;d=5;return{value:a,done:!1};
case 5:if(void 0===y){d=6;break}d=-1;throw y;case 6:case 4:case 2:q+=l;d=1;break;case 3:d=-1;default:return{value:void 0,done:!0}}}var d=0,f,g,h,q,k,e,l,x,p,v,z=this,F={next:function(a){return b(a,void 0)},throw:function(a){return b(void 0,a)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();F[Symbol.iterator]=function(){return this};return F}},{key:"indexOfPair",value:function(a,b){var d=this.table,c=this.emptyHigh;if(a===this.emptyLow&&b===c)return-1;for(var c=
0,f=this.hashFunctions.length;c<f;++c){var g=this.getHash(c,a,b);if(d[g]===a&&d[g+1]===b)return g}return-1}},{key:"indexOf",value:function(a){return this.indexOfPair(a.low,a.high)}},{key:"chooseAnotherEmptyKey",value:function(){for(var a=this.emptyLow,b=this.emptyHigh,d=this.table,c=this.entryStride,f,g;f=4294967296*Math.random()>>>0,g=4294967296*Math.random()>>>0,f===a&&g===b||this.hasPair(f,g););this.emptyLow=f;this.emptyHigh=g;for(var h=0,q=d.length;h<q;h+=c)d[h]===a&&d[h+1]===b&&(d[h]=f,d[h+1]=
g)}},{key:"has",value:function(a){return-1!==this.indexOf(a)}},{key:"hasPair",value:function(a,b){return-1!==this.indexOfPair(a,b)}},{key:"delete",value:function(a){a=this.indexOf(a);if(-1!==a){var b=this.table;b[a]=this.emptyLow;b[a+1]=this.emptyHigh;++this.generation;this.size--;return!0}return!1}},{key:"clearTable",value:function(){for(var a=this.table,b=this.entryStride,d=this.emptyLow,c=this.emptyHigh,f=a.length,g=0;g<f;g+=b)a[g]=d,a[g+1]=c}},{key:"clear",value:function(){if(0===this.size)return!1;
this.size=0;++this.generation;this.clearTable();return!0}},{key:"swapPending",value:function(a,b){var d=w,c=v;this.storePending(a,b);a[b]=d;a[b+1]=c}},{key:"storePending",value:function(a,b){w=a[b];v=a[b+1]}},{key:"backupPending",value:function(){k=w;h=v}},{key:"restorePending",value:function(){w=k;v=h}},{key:"tryToInsert",value:function(){for(var a=0,b=this.emptyLow,d=this.emptyHigh,c=this.maxAttempts,f=this.table,g=this.hashFunctions.length,h=Math.floor(Math.random()*g);;){var q=this.getHash(h,
w,v);this.swapPending(f,q);if(w===b&&v===d)return!0;if(++a===c)break;h=(h+Math.floor(Math.random()*(g-1))+1)%g}return!1}},{key:"allocate",value:function(a,b){var d=a*b;this.width=a;this.height=b;this.table=new Uint32Array(d*this.entryStride);this.maxAttempts=d;this.clearTable();this.capacity=d*this.loadFactor;this.mungedEmptyKey=-1}},{key:"rehash",value:function(a,b,d){this.allocate(b,d);this.updateHashFunctions(this.hashFunctions.length);b=this.emptyLow;d=this.emptyHigh;for(var c=this.entryStride,
f=0,g=a.length;f<g;f+=c){var h=a[f+1];if(a[f]!==b||h!==d)if(this.storePending(a,f),!this.tryToInsert())return!1}return!0}},{key:"grow",value:function(a){for(var b=this.table,d=this.width,c=this.height,f=this.maxWidth,g=this.maxHeight;;){var h=d*c,d=Math.min(f,Math.ceil(a/this.height));d*c<a&&(c=Math.min(g,Math.ceil(a/d)));var q=d*c;if(q<a&&q===h)throw Error("Maximum table size exceeded");for(h=0;h<this.maxRehashAttempts;++h)if(this.rehash(b,d,c))return;a=Math.ceil(this.growFactor*a)}}},{key:"insertInternal",
value:function(){++this.generation;w===this.emptyLow&&v===this.emptyHigh&&this.chooseAnotherEmptyKey();++this.size>this.capacity&&(this.backupPending(),this.grow(Math.ceil(this.growFactor*this.width*this.height)),this.restorePending());for(;!this.tryToInsert();)this.backupPending(),this.grow(this.width*this.height),this.restorePending()}}],[{key:"generateHashFunctions",value:function(b){b=void 0===b?3:b;for(var d=[],c=0;c<b;++c){var f=[a.b.generate(),a.b.generate()];d.push(f)}return d}}]);return b}();
var g=function(a){function b(){r(this,b);return m(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}u(b,a);$jscomp.initSymbol();$jscomp.initSymbolIterator();p(b,[{key:"add",value:function(a){var b=a.low;a=a.high;if(this.hasPair(b,a))return!1;w=b;v=a;this.insertInternal();return!0}},{key:Symbol.iterator,value:function(){return this.keys()}}]);return b}(n);g.prototype.entryStride=2;var d=0,f=0,q=0,x=0,F=function(a){function b(){r(this,b);return m(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,
arguments))}u(b,a);$jscomp.initSymbol();$jscomp.initSymbolIterator();p(b,[{key:"set",value:function(a,b){var c=a.low;a=a.high;if(this.hasPair(c,a))return!1;w=c;v=a;d=b.low;f=b.high;this.insertInternal();return!0}},{key:"get",value:function(a,b){a=this.indexOf(a);if(-1===a)return!1;var d=this.table;b.low=d[a+2];b.high=d[a+3];return!0}},{key:"swapPending",value:function(a,c){var g=d,h=f;l(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"swapPending",this).call(this,a,c);a[c+2]=g;a[c+3]=h}},
{key:"storePending",value:function(a,c){l(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"storePending",this).call(this,a,c);d=a[c+2];f=a[c+3]}},{key:"backupPending",value:function(){l(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"backupPending",this).call(this);q=d;x=f}},{key:"restorePending",value:function(){l(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"restorePending",this).call(this);d=q;f=x}},{key:Symbol.iterator,value:function(){return this.entries()}},
{key:"entries",value:function(a){function b(b,y){for(;;)switch(d){case 0:a=void 0===a?[new c.a,new c.a]:a,z=w,F=z.emptyLow,E=z.emptyHigh,v=z.entryStride,p=w,x=p.table,l=$jscomp.makeIterator(a),e=l.next().value,k=l.next().value,q=0,h=x.length;case 1:if(!(q<h)){d=3;break}g=x[q];f=x[q+1];if(g===F&&f===E){d=4;break}e.low=g;e.high=f;k.low=x[q+2];k.high=x[q+3];d=5;return{value:a,done:!1};case 5:if(void 0===y){d=6;break}d=-1;throw y;case 6:case 4:case 2:q+=v;d=1;break;case 3:d=-1;default:return{value:void 0,
done:!0}}}var d=0,f,g,h,q,k,e,l,x,p,v,E,F,z,w=this,B={next:function(a){return b(a,void 0)},throw:function(a){return b(void 0,a)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();B[Symbol.iterator]=function(){return this};return B}}]);return b}(n);F.prototype.entryStride=4},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,
b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function r(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}b.d(e,"a",function(){return F});b.d(e,"b",function(){return B});var a=b(18);n=b(9);var c=b(137);e=b(30);
var l=b(39),p=b(1),w=b(20),v=b(16),k=b(26),h=b(5),g=b(6),d=function y(a,b,d){null===a&&(a=Function.prototype);var c=Object.getOwnPropertyDescriptor(a,b);if(void 0===c){if(a=Object.getPrototypeOf(a),null!==a)return y(a,b,d)}else{if("value"in c)return c.value;b=c.get;return void 0===b?void 0:b.call(d)}},f=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,
c){d&&a(b.prototype,d);c&&a(b,c);return b}}(),q=this&&this.__decorate||function(a,b,d,c){var f=arguments.length,g=3>f?b:null===c?c=Object.getOwnPropertyDescriptor(b,d):c,h;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)g=Reflect.decorate(a,b,d,c);else for(var q=a.length-1;0<=q;q--)if(h=a[q])g=(3>f?h(g):3<f?h(b,d,g):h(b,d))||g;return 3<f&&g&&Object.defineProperty(b,d,g),g},x=function(){function a(){r(this,a);this.tempLightVec=new Float32Array(4);this.tempPickID=new Float32Array(4)}
f(a,[{key:"defineShader",value:function(a){a.addAttribute("highp vec3","aVertexPosition");a.addAttribute("highp vec3","aVertexNormal");a.addVarying("highp vec4","vColor");a.addUniform("highp vec4","uLightDirection");a.addUniform("highp vec4","uColor");a.addUniform("highp mat4","uModelMatrix");a.addUniform("highp mat4","uProjection");a.addUniform("highp vec4","uPickID");a.setVertexMain("\ngl_Position = uProjection * (uModelMatrix * vec4(aVertexPosition, 1.0));\nvec3 normal = (uModelMatrix * vec4(aVertexNormal, 0.0)).xyz;\nfloat lightingFactor = abs(dot(normal, uLightDirection.xyz)) + uLightDirection.w;\nvColor = vec4(lightingFactor * uColor.rgb, uColor.a);\n");
a.setFragmentMain("emit(vColor, uPickID);")}},{key:"beginLayer",value:function(a,b,d){var c=d.dataToDevice,f=d.lightDirection,g=d.ambientLighting;d=d.directionalLighting;a.uniformMatrix4fv(b.uniform("uProjection"),!1,c);c=this.tempLightVec;p.a.scale(c,f,d);c[3]=g;a.uniform4fv(b.uniform("uLightDirection"),c)}},{key:"setColor",value:function(a,b,d){a.uniform4fv(b.uniform("uColor"),d)}},{key:"setPickID",value:function(a,d,c){a.uniform4fv(d.uniform("uPickID"),b.i(h.m)(this.tempPickID,c))}},{key:"beginObject",
value:function(a,b,d){a.uniformMatrix4fv(b.uniform("uModelMatrix"),!1,d)}},{key:"getShader",value:function(a,d){var c=this;return a.memoize.get("mesh/MeshShaderManager:"+b.i(w.a)(d),function(){var b=new k.a(a);b.require(d);c.defineShader(b);return b.build()})}},{key:"drawFragment",value:function(a,b,d){d.vertexBuffer.bindToVertexAttrib(b.attribute("aVertexPosition"),3);d.normalBuffer.bindToVertexAttrib(b.attribute("aVertexNormal"),3);d.indexBuffer.bind();a.drawElements(a.TRIANGLES,d.numIndices,a.UNSIGNED_INT,
0)}},{key:"endLayer",value:function(a,b){a.disableVertexAttribArray(b.attribute("aVertexPosition"));a.disableVertexAttribArray(b.attribute("aVertexNormal"))}}]);return a}(),F=function(d){function g(a,d,f){r(this,g);var h=m(this,(g.__proto__||Object.getPrototypeOf(g)).call(this));h.chunkManager=a;h.source=d;h.displayState=f;h.meshShaderManager=new x;h.shaders=new Map;b.i(l.c)(f,h);a=h.sharedObject=h.registerDisposer(new l.d(a,f));a.RPC_TYPE_ID=c.a;a.initializeCounterpartWithChunkManager({source:d.addCounterpartRef()});
h.setReady(!0);a.visibility.add(h.visibility);return h}u(g,d);f(g,[{key:"getShader",value:function(a){var b=this.shaders,d=b.get(a);void 0===d&&(d=this.registerDisposer(this.meshShaderManager.getShader(this.gl,a)),b.set(a,d));return d}},{key:"draw",value:function(d){var c=this;if(d.emitColor||!d.alreadyEmittedPickID){var f=this.gl,g=this.displayState,h=this.meshShaderManager,q=Math.min(1,g.objectAlpha.value);if(!(0>=q)){var k=this.getShader(d.emitter);k.bind();h.beginLayer(f,k,d);var e=this.source.fragmentSource.objectChunks,
x=d.pickIDs,y=this.displayState.objectToDataTransform.transform;b.i(l.e)(g,e,function(e,p,v){d.emitColor&&h.setColor(f,k,b.i(l.f)(g,e,q));d.emitPickID&&h.setPickID(f,k,x.registerUint64(c,p));h.beginObject(f,k,y);e=$jscomp.makeIterator(v);for(p=e.next();!p.done;p=e.next())p=p.value,p.state===a.b.GPU_MEMORY&&h.drawFragment(f,k,p)});h.endLayer(f,k)}}}},{key:"isTransparent",get:function(){return 1>this.displayState.objectAlpha.value}},{key:"gl",get:function(){return this.chunkManager.chunkQueueManager.gl}}]);
return g}(e.a),C=function(a){function b(a,d){r(this,b);a=m(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));a.objectKey=d.objectKey;a.vertexPositions=d.vertexPositions;var c=a.indices=d.indices;a.numIndices=c.length;a.vertexNormals=d.vertexNormals;return a}u(b,a);f(b,[{key:"copyToGPU",value:function(a){d(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"copyToGPU",this).call(this,a);this.vertexBuffer=v.a.fromData(a,this.vertexPositions,a.ARRAY_BUFFER,a.STATIC_DRAW);this.indexBuffer=
v.a.fromData(a,this.indices,a.ELEMENT_ARRAY_BUFFER,a.STATIC_DRAW);this.normalBuffer=v.a.fromData(a,this.vertexNormals,a.ARRAY_BUFFER,a.STATIC_DRAW)}},{key:"freeGPUMemory",value:function(a){d(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"freeGPUMemory",this).call(this,a);this.vertexBuffer.dispose();this.indexBuffer.dispose();this.normalBuffer.dispose()}}]);return b}(n.d),B=function(a){function b(){r(this,b);var a=m(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));a.fragmentSource=
a.registerDisposer(new z(a.chunkManager,a));return a}u(b,a);f(b,[{key:"initializeCounterpart",value:function(a,c){this.fragmentSource.initializeCounterpart(this.chunkManager.rpc,{});c.fragmentSource=this.fragmentSource.addCounterpartRef();d(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"initializeCounterpart",this).call(this,a,c)}}]);return b}(n.c),z=function(a){function b(a,d){r(this,b);a=m(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));a.meshSource=d;a.objectChunks=new Map;
return a}u(b,a);f(b,[{key:"addChunk",value:function(a,c){d(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"addChunk",this).call(this,a,c);a=this.objectChunks;var f=c.objectKey,g=a.get(f);void 0===g&&(g=new Set,a.set(f,g));g.add(c)}},{key:"deleteChunk",value:function(a){var c=this.chunks.get(a);d(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"deleteChunk",this).call(this,a);a=this.objectChunks;var f=c.objectKey,g=a.get(f);g.delete(c);0===g.size&&a.delete(f)}},{key:"getChunk",
value:function(a){return new C(this,a)}}]);return b}(n.c),z=q([b.i(g.f)(c.b)],z)},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=
Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function a(a){a.addFragmentCode("\nvoid emit(vec4 color, vec4 pickId) {\n  gl_FragColor = color;\n}\n")}function c(a){a.addFragmentCode("\nvoid emit(vec4 color, vec4 pickId) {\n  gl_FragColor = pickId;\n}\n")}b.d(e,"b",function(){return C});b.d(e,"a",function(){return B});var l=b(67),p=b(10),w=b(76);n=b(77);var v=b(31),k=b(33),h=b(15),
g=b(1),d=b(91),f=b(52),q=b(95),x=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}(),F;(function(a){a[a.COLOR=0]="COLOR";a[a.PICK=1]="PICK";a[a.NUM_TEXTURES=2]="NUM_TEXTURES"})(F||(F={}));var C=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}r(b,
a);x(b,[{key:"draw",value:function(a){}}]);return b}(p.g),B=function(e){function E(c,e,x,z){m(this,E);var y=u(this,(E.__proto__||Object.getPrototypeOf(E)).call(this,c,e,z));y.sliceView=x;y.axesLineHelper=y.registerDisposer(l.a.get(y.gl));y.sliceViewRenderHelper=y.registerDisposer(v.b.get(y.gl,a));y.colorFactor=g.m.fromValues(1,1,1,1);y.backgroundColor=g.m.fromValues(.5,.5,.5,1);y.pickIDs=new w.a;y.visibleLayerTracker=b.i(p.e)(y.viewer.layerManager,C,y);y.offscreenFramebuffer=y.registerDisposer(new f.a(y.gl,
{colorBuffers:b.i(f.b)(y.gl,F.NUM_TEXTURES)}));y.offscreenCopyHelper=y.registerDisposer(f.d.get(y.gl));y.scaleBarWidget=y.registerDisposer(new q.b);b.i(h.b)(e,"translate-via-mouse-drag",function(a){y.viewer.mouseState.updateUnconditionally()&&b.i(d.a)(a.detail,function(a,b,d){a=y.viewer.navigationState.position;var c=a.spatialCoordinates;g.a.set(c,b,d,0);g.a.transformMat4(c,c,y.sliceView.viewportToData);a.changed.dispatch()})});b.i(h.b)(e,"rotate-via-mouse-drag",function(a){var c=y.viewer.mouseState;
if(c.updateUnconditionally()){var f=g.a.clone(c.position);b.i(d.a)(a.detail,function(a,b,d){a=y.sliceView.viewportAxes;y.viewer.navigationState.pose.rotateAbsolute(a[1],b/4*Math.PI/180,f);y.viewer.navigationState.pose.rotateAbsolute(a[0],d/4*Math.PI/180,f)})}});y.registerDisposer(x);y.registerDisposer(x.visibility.add(y.visibility));y.registerDisposer(x.viewChanged.add(function(){y.visible&&c.scheduleRedraw()}));y.registerDisposer(z.showAxisLines.changed.add(function(){y.visible&&y.scheduleRedraw()}));
e=y.scaleBarWidget.element;y.registerDisposer(new k.c(z.showScaleBar,e));y.element.appendChild(e);return y}r(E,e);x(E,[{key:"draw",value:function(){var b=this.sliceView;if(b.hasValidViewport){this.onResize();b.updateRendering();var d=this.gl,f=b.width,h=b.height,q=b.dataToDevice;this.offscreenFramebuffer.bind(f,h);d.disable(d.SCISSOR_TEST);this.gl.clearColor(0,0,0,0);d.clear(d.COLOR_BUFFER_BIT);this.sliceViewRenderHelper.draw(b.offscreenFramebuffer.colorBuffers[0].texture,g.h,this.colorFactor,this.backgroundColor,
0,0,1,1);var k=this.visibleLayerTracker.getVisibleLayers(),e=this.pickIDs;e.clear();this.offscreenFramebuffer.bindSingle(F.COLOR);h={dataToDevice:q,pickIDs:e,emitter:a,emitColor:!0,emitPickID:!1,viewportWidth:f,viewportHeight:h};d.enable(d.BLEND);d.blendFunc(d.SRC_ALPHA,d.ONE_MINUS_SRC_ALPHA);e=$jscomp.makeIterator(k);for(q=e.next();!q.done;q=e.next())q.value.draw(h);d.disable(d.BLEND);this.offscreenFramebuffer.bindSingle(F.PICK);h.emitColor=!1;h.emitPickID=!0;h.emitter=c;d=$jscomp.makeIterator(k);
for(q=d.next();!q.done;q=d.next())q.value.draw(h);this.viewer.showAxisLines.value&&this.drawAxisLines(b);this.offscreenFramebuffer.unbind();this.setGLViewport();this.offscreenCopyHelper.draw(this.offscreenFramebuffer.colorBuffers[F.COLOR].texture);d=this.scaleBarWidget;k=d.dimensions;k.targetLengthInPixels=Math.min(f/4,100);k.nanometersPerPixel=b.pixelSize;d.update()}}},{key:"drawAxisLines",value:function(a){var b=a.width,d=a.height,c=a.dataToDevice,f=g.c.create();g.c.copy(f,c);for(c=0;3>c;++c)f[12+
c]=0;for(c=0;4>c;++c)f[2+4*c]=0;b=Math.min(b,d)/4*1.5;a=a.pixelSize;for(d=0;12>d;++d)f[d]=f[d]*b*a;this.offscreenFramebuffer.bindSingle(F.COLOR);this.axesLineHelper.draw(f)}},{key:"onResize",value:function(){this.sliceView.setViewportSize(this.element.clientWidth,this.element.clientHeight)}},{key:"updateMouseState",value:function(a){a.pickedRenderLayer=null;var b=this.sliceView;if(!b.hasValidViewport)return!1;var d=b.width,c=b.height,f=this.offscreenFramebuffer;if(!f.hasSize(d,c))return!1;var h=a.position,
q=this.mouseX,k=this.mouseY;g.a.set(h,q-d/2,k-c/2,0);g.a.transformMat4(h,h,b.viewportToData);b=c-k;d=this.viewer;c=d.layerManager;c.uniqueAction("edit",c.editorLayer,d.editorState);this.pickIDs.setMouseState(a,f.readPixelAsUint32(F.PICK,q,b));return!0}},{key:"zoomByMouse",value:function(a){var b=this.navigationState;if(b.valid){var d=this.sliceView,c=d.height,f=this.mouseX,h=this.mouseY,f=f-d.width/2,h=h-c/2,c=this.navigationState.zoomFactor.value;b.zoomBy(a);a=b.zoomFactor.value;var q=b.position.spatialCoordinates;
g.a.scaleAndAdd(q,q,d.viewportAxes[0],f*(c-a));g.a.scaleAndAdd(q,q,d.viewportAxes[1],h*(c-a));b.position.changed.dispatch()}}},{key:"navigationState",get:function(){return this.sliceView.navigationState}}]);return E}(n.a)},function(n,e,b){function m(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?
Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return w});n=b(10);var u=b(1),r=b(29),a=b(26),c=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,g){c&&a(b.prototype,c);g&&a(b,g);return b}}(),l=function k(a,b,d){null===a&&(a=Function.prototype);var c=Object.getOwnPropertyDescriptor(a,b);if(void 0===c){if(a=Object.getPrototypeOf(a),null!==
a)return k(a,b,d)}else{if("value"in c)return c.value;b=c.get;return void 0===b?void 0:b.call(d)}},p=u.a.create(),w=function(e){function h(a,d,c){c=void 0===c?{}:c;var f=void 0===c.shaderError?b.i(r.a)():c.shaderError;if(!(this instanceof h))throw new TypeError("Cannot call a class as a function");c=(h.__proto__||Object.getPrototypeOf(h)).call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");c=!c||"object"!==typeof c&&"function"!==typeof c?this:c;
c.sources=null;c.sourceIds=[];c.shader=void 0;c.shaderUpdated=!0;c.rpcId=null;c.shaderError=f;f.value=void 0;c.chunkManager=a;c.sources=d;a=$jscomp.makeIterator(d);for(d=a.next();!d.done;d=a.next()){f=d.value;d=[];c.sourceIds.push(d);for(var f=$jscomp.makeIterator(f),g=f.next();!g.done;g=f.next())d.push(g.value.rpcId)}a=c.sources[0][0].spec;d=a.chunkLayout;f=c.voxelSize=d.localSpatialVectorToGlobal(u.a.create(),a.voxelSize);for(g=0;3>g;++g)f[g]=Math.abs(f[g]);for(var f=c.boundingBox=new u.p(u.a.fromValues(Infinity,
Infinity,Infinity),u.a.fromValues(-Infinity,-Infinity,-Infinity)),g=u.a.create(),e=0;8>e;++e){for(var k=0;3>k;++k)p[k]=e&1<<k?a.upperClipBound[k]:a.lowerClipBound[k];d.localSpatialToGlobal(g,p);u.a.min(f.lower,f.lower,g);u.a.max(f.upper,f.upper,g)}c.setReady(!0);return c}m(h,e);c(h,[{key:"initializeShader",value:function(){if(this.shaderUpdated){this.shaderUpdated=!1;try{var a=this.getShader();this.disposeShader();this.shader=a;this.shaderError.value=null}catch(d){this.shaderError.value=d}}}},{key:"disposeShader",
value:function(){this.shader&&(this.shader.dispose(),this.shader=void 0)}},{key:"disposed",value:function(){l(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"disposed",this).call(this);this.disposeShader()}},{key:"getShaderKey",value:function(){return""}},{key:"getShader",value:function(){var a=this,b=this.getShaderKey();return this.gl.memoize.get(b,function(){return a.buildShader()})}},{key:"buildShader",value:function(){var b=new a.a(this.gl);this.defineShader(b);return b.build()}},{key:"gl",
get:function(){return this.chunkManager.chunkQueueManager.gl}}]);return h}(n.f)},function(n,e,b){function m(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return c});b.d(e,"c",function(){return l});var u=b(40),r=b(1),a=function(){function a(a,
b){for(var c=0;c<b.length;c++){var h=b[c];h.enumerable=h.enumerable||!1;h.configurable=!0;"value"in h&&(h.writable=!0);Object.defineProperty(a,h.key,h)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}(),c;(function(a){a[a.LINE=0]="LINE";a[a.POINT=1]="POINT"})(c||(c={}));var l=function(c){function e(a){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");a=(e.__proto__||Object.getPrototypeOf(e)).call(this,a);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!a||"object"!==typeof a&&"function"!==typeof a?this:a}m(e,c);a(e,[{key:"toObject",value:function(){return{transform:this.chunkLayout.transform,chunkDataSize:this.chunkDataSize,voxelSize:this.voxelSize,lowerVoxelBound:this.lowerVoxelBound,upperVoxelBound:this.upperVoxelBound,lowerClipBound:this.lowerClipBound,upperClipBound:this.upperClipBound,baseVoxelOffset:this.baseVoxelOffset}}}],[{key:"make",value:function(a){return new e(Object.assign({},a,{transform:b.i(u.a)(a.transform,a.vectorGraphicsSourceOptions)}))}},
{key:"fromObject",value:function(a){return new e(a)}},{key:"withDefaults",value:function(a){var c=a.transform,h=a.lowerVoxelBound,g=a.upperVoxelBound,d=a.chunkDataSize,c=b.i(u.a)(c,a.vectorGraphicsSourceOptions);if(void 0===d&&(d=r.a.clone(g),void 0!==h))for(g=0;3>g;g++)d[g]+=Math.abs(h[g]);console.log(d);console.log(a);return new e(Object.assign({},a,{transform:c,chunkDataSize:d}))}}]);return e}(u.d);e.b="vectorgraphics/RenderLayer"},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function r(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}b.d(e,"a",function(){return v});n=
b(22);n=b.n(n);e=b(0);var a=b(169),c=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}(),l=function h(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),null!==a)return h(a,b,c)}else{if("value"in d)return d.value;b=d.get;return void 0===
b?void 0:b.call(c)}},p=new function g(){r(this,g);a.a.initializeHead(this)},w=n()(function(){var b=document.activeElement;if(null===b||b===document.body)b=a.a.front(p),null!==b&&b.element.focus()});window.addEventListener("focus",function(){w()},!0);window.addEventListener("blur",function(){w()},!0);var v=function(b){function d(b){r(this,d);var c=m(this,(d.__proto__||Object.getPrototypeOf(d)).call(this));c.element=b;c.prev0=null;c.next0=null;b.tabIndex=-1;c.registerEventListener(b,"mouseenter",function(){void 0===
c.focusTimer&&(c.focusTimer=setTimeout(function(){return b.focus()},0))});c.registerEventListener(b,"mouseleave",function(){var a=c.focusTimer;void 0!==a&&(clearTimeout(a),c.focusTimer=void 0)});a.a.insertBefore(p,c);c.registerEventListener(b,"focus",function(){a.a.pop(c);a.a.insertAfter(p,c)});w();return c}u(d,b);c(d,[{key:"disposed",value:function(){a.a.pop(this);void 0!==this.focusTimer&&clearTimeout(this.focusTimer);l(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"disposed",this).call(this)}}]);
return d}(e.b)},function(n,e,b){function m(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function u(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}b.d(e,"b",function(){return p});b.d(e,"a",function(){return w});
var r=b(0),a=b(2),c=function k(a,b,d){null===a&&(a=Function.prototype);var c=Object.getOwnPropertyDescriptor(a,b);if(void 0===c){if(a=Object.getPrototypeOf(a),null!==a)return k(a,b,d)}else{if("value"in c)return c.value;b=c.get;return void 0===b?void 0:b.call(d)}},l=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}(),
p=function(){function a(){u(this,a);this.map=new Map}l(a,[{key:"get",value:function(a,b){var d=this.map,c=d.get(a);void 0===c?(c=b(),c.registerDisposer(function(){d.delete(a)}),d.set(a,c)):c.addRef();return c}}]);return a}(),w=function(e){function h(){u(this,h);var a=(h.__proto__||Object.getPrototypeOf(h)).apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!==typeof a&&"function"!==typeof a?this:a}m(h,e);l(h,[{key:"get",
value:function(g,d){"string"!==typeof g&&(g=b.i(a.f)(g));return c(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"get",this).call(this,g,d)}},{key:"getUncounted",value:function(a,b){return this.get(a,function(){return new r.c(b())}).value}}]);return h}(p)},function(n,e,b){function m(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,
writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function u(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function r(a){var b=v.get(a),c=a.changed.count;if(void 0!==b&&b.generation===c)return b;var d;if(a instanceof w){d=a.baseJSON();for(var f=$jscomp.makeIterator(a.children),q=f.next();!q.done;q=f.next()){var e=$jscomp.makeIterator(q.value),q=e.next().value,e=e.next().value;d[q]=r(e).value}}else d=a.toJSON();
void 0===b?(b={generation:c,value:d},v.set(a,b)):(b.generation=c,b.value=d);return b}b.d(e,"b",function(){return w});e.a=r;var a=b(2),c=b(3),l=function h(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),null!==a)return h(a,b,c)}else{if("value"in d)return d.value;b=d.get;return void 0===b?void 0:b.call(c)}},p=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;
"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}(),w=function(){function h(){u(this,h);this.children=new Map;this.changed=new c.a}p(h,[{key:"add",value:function(a,b){var d=this;if(this.children.has(a))throw Error("Key "+JSON.stringify(a)+" already registered.");this.children.set(a,b);b.changed.add(this.changed.dispatch);this.changed.dispatch();return function(){d.remove(a)}}},{key:"remove",value:function(a){var b=this.children;
if(b.has(a))throw Error("Key "+JSON.stringify(a)+" not registered.");b=b.get(a);this.children.delete(a);b.changed.remove(this.changed.dispatch);this.changed.dispatch()}},{key:"dispose",value:function(){for(var a=this.changed,b=$jscomp.makeIterator(this.children.values()),c=b.next();!c.done;c=b.next())c.value.changed.remove(a.dispatch);this.children=void 0}},{key:"toJSON",value:function(){for(var a=this.baseJSON(),b=$jscomp.makeIterator(this.children),c=b.next();!c.done;c=b.next()){var h=$jscomp.makeIterator(c.value),
c=h.next().value,h=h.next().value;a[c]=h.toJSON()}return a}},{key:"baseJSON",value:function(){return{}}},{key:"reset",value:function(){for(var a=$jscomp.makeIterator(this.children.values()),b=a.next();!b.done;b=a.next())b.value.reset()}},{key:"restoreState",value:function(c){b.i(a.a)(c);for(var d=$jscomp.makeIterator(this.children),f=d.next();!f.done;f=d.next()){var g=$jscomp.makeIterator(f.value),f=g.next().value,g=g.next().value;try{c.hasOwnProperty(f)&&g.restoreState(c[f])}catch(x){throw Error("Error restoring property "+
JSON.stringify(f)+": "+x.message);}}}}]);return h}();(function(c){function g(){u(this,g);var a;a=(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");a=!a||"object"!==typeof a&&"function"!==typeof a?this:a;a.lastState={};return a}m(g,c);p(g,[{key:"restoreState",value:function(d){b.i(a.a)(d);this.lastState=d;l(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"restoreState",this).call(this,
d)}},{key:"reset",value:function(){this.lastState={};l(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"reset",this).call(this)}},{key:"baseJSON",value:function(){for(var a=Object.assign(l(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"baseJSON",this).call(this),this.lastState),b=$jscomp.makeIterator(this.children.keys()),c=b.next();!c.done;c=b.next())delete a[c.value];return a}},{key:"toJSON",value:function(){var a=l(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),
"toJSON",this).call(this);return this.lastState=a}},{key:"add",value:function(a,b){var d=l(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"add",this).call(this,a,b);a=this.lastState[a];void 0!==a&&(b.reset(),b.restoreState(a));return d}}]);return g})(w);var v=new WeakMap},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"c",function(){return g});e.b=function(a,b,d,c){d=void 0===d?a.RGBA:d;c=void 0===c?a.UNSIGNED_BYTE:c;for(var f=[],g=0;g<b;++g)f[g]=
new q(a,d,c);return f};b.d(e,"a",function(){return F});b.d(e,"d",function(){return C});n=b(0);var a=b(1),c=b(20),l=b(54),p=b(55),w=b(93),v=function z(a,b,d){null===a&&(a=Function.prototype);var c=Object.getOwnPropertyDescriptor(a,b);if(void 0===c){if(a=Object.getPrototypeOf(a),null!==a)return z(a,b,d)}else{if("value"in c)return c.value;b=c.get;return void 0===b?void 0:b.call(d)}},k=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in
c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}(),h=function(a){function b(){m(this,b);var a=u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));a.width=Number.NaN;a.height=Number.NaN;return a}r(b,a);k(b,[{key:"hasSize",value:function(a,b){return this.width===a&&this.height===b}},{key:"resize",value:function(a,b){this.hasSize(a,b)||(this.width=a,this.height=b,this.performResize())}}]);return b}(n.b),g=function(a){function b(a,
d){d=void 0===d?!1:d;m(this,b);var c=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,d?a.DEPTH_STENCIL:a.DEPTH_COMPONENT16));c.gl=a;c.includeStencilBuffer=d;return c}r(b,a);k(b,[{key:"attachToFramebuffer",value:function(){var a=this.gl;v(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"attachToFramebuffer",this).call(this,this.includeStencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT)}}]);return b}(function(a){function b(a,d){m(this,b);var c=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));
c.gl=a;c.internalformat=d;c.renderbuffer=null;c.renderbuffer=a.createRenderbuffer();return c}r(b,a);k(b,[{key:"performResize",value:function(){var a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,this.renderbuffer);a.renderbufferStorage(a.RENDERBUFFER,this.internalformat,this.width,this.height);a.bindRenderbuffer(a.RENDERBUFFER,null)}},{key:"disposed",value:function(){this.gl.deleteRenderbuffer(this.renderbuffer)}},{key:"attachToFramebuffer",value:function(a){var b=this.gl;b.framebufferRenderbuffer(b.FRAMEBUFFER,
a,b.RENDERBUFFER,this.renderbuffer)}}]);return b}(h)),d=function(a){function b(a){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,!0))}r(b,a);return b}(g);e.e=d;var f=function(a){function b(a){m(this,b);var d=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));d.gl=a;d.framebuffer=d.gl.createFramebuffer();return d}r(b,a);k(b,[{key:"disposed",value:function(){this.gl.deleteFramebuffer(this.framebuffer)}},{key:"bind",value:function(){var a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,
this.framebuffer)}},{key:"unbind",value:function(){var a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,null)}}]);return b}(n.b),q=function(a){function d(a,b,c){m(this,d);var f=u(this,(d.__proto__||Object.getPrototypeOf(d)).call(this));f.gl=a;f.format=b;f.dataType=c;f.texture=a.createTexture();return f}r(d,a);k(d,[{key:"performResize",value:function(){b.i(p.a)(this.gl,this.texture,this.width,this.height,this.format,this.dataType)}},{key:"disposed",value:function(){this.gl.deleteTexture(this.texture)}},{key:"attachToFramebuffer",
value:function(a){var b=this.gl;b.framebufferTexture2D(b.FRAMEBUFFER,a,b.TEXTURE_2D,this.texture,0)}}]);return d}(h),x=new Uint8Array(4),F=function(a){function b(a,d){m(this,b);var c=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));c.gl=a;c.width=Number.NaN;c.height=Number.NaN;c.fullAttachmentList=[];c.attachmentVerified=!1;c.singleAttachmentList=[c.gl.COLOR_ATTACHMENT0];var g=void 0===d.framebuffer?new f(a):d.framebuffer,h=d.colorBuffers;d=d.depthBuffer;c.framebuffer=c.registerDisposer(g);
c.colorBuffers=h;c.depthBuffer=d;void 0!==d&&c.registerDisposer(d);var q=c.fullAttachmentList;h.forEach(function(b,d){c.registerDisposer(b);q[d]=a.COLOR_ATTACHMENT0+d});return c}r(b,a);k(b,[{key:"hasSize",value:function(a,b){return this.width===a&&this.height===b}},{key:"bind",value:function(a,b){this.width=a;this.height=b;this.framebuffer.bind();var d=this.gl,c=this.depthBuffer;void 0!==c&&(c.resize(a,b),c.attachToFramebuffer());this.colorBuffers.forEach(function(c,f){c.resize(a,b);c.attachToFramebuffer(d.COLOR_ATTACHMENT0+
f)});d.WEBGL_draw_buffers.drawBuffersWEBGL(this.fullAttachmentList);this.verifyAttachment();d.viewport(0,0,a,b)}},{key:"bindSingle",value:function(a){var b=this.gl;this.framebuffer.bind();0!==a&&b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0+a,b.TEXTURE_2D,null,0);b.bindTexture(b.TEXTURE_2D,null);this.colorBuffers[a].attachToFramebuffer(b.COLOR_ATTACHMENT0);b.WEBGL_draw_buffers.drawBuffersWEBGL(this.singleAttachmentList)}},{key:"unbind",value:function(){this.framebuffer.unbind()}},{key:"readPixel",
value:function(a,b,d){var c=this.gl;try{this.bindSingle(a),c.readPixels(b,d,1,1,c.RGBA,c.UNSIGNED_BYTE,x)}finally{this.framebuffer.unbind()}return x}},{key:"readPixelAsUint32",value:function(a,b,d){a=this.readPixel(a,b,d);return a[0]+(a[1]<<8)+(a[2]<<16)+(a[3]<<24)}},{key:"verifyAttachment",value:function(){if(!this.attachmentVerified){var a=this.gl;if(a.checkFramebufferStatus(a.FRAMEBUFFER)!==a.FRAMEBUFFER_COMPLETE)throw Error("Framebuffer configuration not supported");this.attachmentVerified=!0}}}]);
return b}(n.b),C=function(d){function f(a,d){m(this,f);var c=u(this,(f.__proto__||Object.getPrototypeOf(f)).call(this));c.gl=a;c.shader=d;c.copyVertexPositionsBuffer=b.i(l.a)(c.gl);c.copyTexCoordsBuffer=b.i(l.a)(c.gl,0,0,1,1);c.registerDisposer(d);return c}r(f,d);k(f,[{key:"draw",value:function(b){for(var d=[],c=0;c<arguments.length;++c)d[c-0]=arguments[c];var c=this.gl,f=this.shader;f.bind();for(var g=d.length,h=0;h<g;++h)c.activeTexture(c.TEXTURE0+h),c.bindTexture(c.TEXTURE_2D,d[h]);c.uniformMatrix4fv(f.uniform("uProjectionMatrix"),
!1,a.h);d=f.attribute("aVertexPosition");this.copyVertexPositionsBuffer.bindToVertexAttrib(d,2);f=f.attribute("aTexCoord");this.copyTexCoordsBuffer.bindToVertexAttrib(f,2);c.drawArrays(c.TRIANGLE_FAN,0,4);c.disableVertexAttribArray(d);c.disableVertexAttribArray(f);for(d=0;d<g;++d)c.activeTexture(c.TEXTURE0+d),c.bindTexture(c.TEXTURE_2D,null)}}],[{key:"get",value:function(a,d,g){d=void 0===d?w.a:d;g=void 0===g?1:g;return a.memoize.get("OffscreenCopyHelper:"+g+":"+b.i(c.a)(d),function(){return new f(a,
b.i(w.b)(a,d,g))})}}]);return f}(n.b)},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}b.d(e,"c",function(){return w});e.b=function(b,d,c){c=void 0===c?1:c;switch(d){case r.b.UINT8:if(1>c||4<c)break;b.texelsPerElement=1;b.textureFormat=v[c];b.texelType=a.j;b.arrayElementsPerTexel=c;b.arrayConstructor=Uint8Array;return b;case r.b.UINT16:if(1>c||2<c)break;b.texelsPerElement=1;b.textureFormat=v[2*c];b.texelType=a.j;b.arrayElementsPerTexel=
2*c;b.arrayConstructor=Uint8Array;return b;case r.b.UINT64:if(1!==c)break;b.texelsPerElement=2;b.textureFormat=a.i;b.texelType=a.j;b.arrayElementsPerTexel=4;b.arrayConstructor=Uint8Array;return b;case r.b.UINT32:if(1!==c)break;b.texelsPerElement=1;b.textureFormat=a.i;b.texelType=a.j;b.arrayElementsPerTexel=4;b.arrayConstructor=Uint8Array;return b;case r.b.FLOAT32:if(!(1>c||4<c))return b.texelsPerElement=1,b.textureFormat=v[c],b.texelType=a.e,b.arrayElementsPerTexel=c,b.arrayConstructor=Float32Array,
b}throw Error("No supported texture format for "+r.b[d]+"["+c+"].");};e.f=function(a,b,c,h,e,k){b=b.maxTextureSize;var d=h*e*k;if(!(c*h<=b&&e*k<=b))if(c*h*e<=b&&k<=b)h*=e;else if(h=Math.ceil(d/b),h*c>b)throw Error("Chunk data size exceeds maximum texture size: "+c+" * "+d);c=Math.ceil(d/h);a.dataWidth=h;a.textureHeight=c;a.textureAccessCoefficients=Float32Array.of(1/h,1/(h*c))};e.a=function(a,b,c,h){var d=b.maxTextureSize;b=Math.ceil(h/d);if(b*c>d)throw Error("Number of elements exceeds maximum texture size: "+
c+" * "+h);c=Math.ceil(h/b);a.dataWidth=b;a.textureHeight=c;a.textureAccessCoefficients=Float32Array.of(1/b,1/(b*c))};e.e=function(c,d,f,h){var g=f.arrayConstructor,e=f.textureFormat,q=f.texelsPerElement,k=d.dataWidth;d=d.textureHeight;var p=k*d*f.arrayElementsPerTexel*q;h.constructor!==g&&(h=new g(h.buffer,h.byteOffset,h.byteLength/g.BYTES_PER_ELEMENT));h=b.i(u.b)(h,p);c.pixelStorei(a.k,1);b.i(l.b)(c);c.texImage2D(c.TEXTURE_2D,0,e,k*q,d,0,e,f.texelType,h)};b.d(e,"d",function(){return h});var u=b(87),
r=b(28),a=b(25),c=b(5),l=b(55),p=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,c,g){c&&a(b.prototype,c);g&&a(b,g);return b}}(),w=function d(){m(this,d)},v=[-1,a.f,a.g,a.h,a.i],k=["","r","ra","rgb","rgba"],h=function(){function a(b){m(this,a);this.key=b;this.uniformName="uTextureAccessCoefficients_"+this.key;this.readTextureValue="readTextureValue_"+this.key}
p(a,[{key:"defineShader",value:function(a){a.addUniform("highp vec2",this.uniformName)}},{key:"getReadTextureValueCode",value:function(a){for(var b=this.uniformName,d="\nvoid "+this.readTextureValue+"(highp sampler2D sampler, float index",c=0;c<a;++c)d+=", out vec4 output"+c;d+=") {\n  index += "+.5/a+";\n  vec2 texCoords = vec2(fract(index * "+b+".x),\n                        index * "+b+".y);\n";for(c=0;c<a;++c)d+="\n  output"+c+" = texture2D(sampler,\n                        vec2(texCoords.x +\n                             "+
b+".x * "+(c/a).toFixed(8)+",\n                             texCoords.y));\n";return d+"\n}\n"}},{key:"getAccessor",value:function(a,d,h,e){e=void 0===e?1:e;var f=b.i(c.d)(h,e),q=[];q.push(this.getReadTextureValueCode(h===r.b.UINT64?2:1));a="\n"+f+" "+a+"(float index) {\n";switch(h){case r.b.UINT8:q.push(c.h);a+="\n  "+f+" result;\n  vec4 temp;\n  "+this.readTextureValue+"("+d+", index, temp);\n  result.value = temp."+k[e]+";\n  return result;\n";break;case r.b.UINT16:q.push(c.i);a+="\n  "+f+" result;\n  vec4 temp;\n  "+
this.readTextureValue+"("+d+", index, temp);\n  result.value = temp."+k[2*e]+";\n  return result;\n";break;case r.b.UINT32:q.push(c.j);a+="\n  "+f+" result;\n  "+this.readTextureValue+"("+d+", index, result.value);\n  return result;\n";break;case r.b.UINT64:q.push(c.e);a+="\n  "+f+" result;\n  "+this.readTextureValue+"("+d+", index, result.low, result.high);\n  return result;\n";break;case r.b.FLOAT32:q.push(c.k),a+="\n  vec4 temp;\n  "+this.readTextureValue+"("+d+", index, temp);\n  return temp."+
k[e]+";\n"}q.push(a+"\n}\n");return q}},{key:"setupTextureLayout",value:function(a,b,d){a.uniform2fv(b.uniform(this.uniformName),d.textureAccessCoefficients)}}]);return a}()},function(n,e,b){e.a=function(a,b,e,p,w){b=void 0===b?-1:b;e=void 0===e?-1:e;p=void 0===p?1:p;w=void 0===w?1:w;return a.memoize.get("SquareCornersBuffer:"+b+","+e+","+p+","+w,function(){return new m.c(u.a.fromData(a,new Float32Array([b,e,b,w,p,w,p,e]),r.c,r.d))}).value};var m=b(0),u=b(16),r=b(25)},function(n,e,b){function m(b){b.texParameteri(b.TEXTURE_2D,
b.TEXTURE_MIN_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE)}e.b=m;e.a=function(b,e,a,c,l,p){l=void 0===l?b.RGBA:l;p=void 0===p?b.UNSIGNED_BYTE:p;b.activeTexture(b.TEXTURE0+b.tempTextureUnit);b.bindTexture(b.TEXTURE_2D,e);m(b);b.texImage2D(b.TEXTURE_2D,0,l,a,c,0,l,p,null);b.bindTexture(b.TEXTURE_2D,null)}},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return l});n=b(0);var r=b(8),a=function(){function a(a,b){for(var c=0;c<b.length;c++){var h=b[c];h.enumerable=
h.enumerable||!1;h.configurable=!0;"value"in h&&(h.writable=!0);Object.defineProperty(a,h.key,h)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}(),c=function w(a,b,c){null===a&&(a=Function.prototype);var g=Object.getOwnPropertyDescriptor(a,b);if(void 0===g){if(a=Object.getPrototypeOf(a),null!==a)return w(a,b,c)}else{if("value"in g)return g.value;b=g.get;return void 0===b?void 0:b.call(c)}};b(203);var l=function(e){function l(a,b){var c=void 0===b?{}:b;b=void 0===c.min?0:c.min;var d=
void 0===c.max?1:c.max,c=void 0===c.step?.01:c.step;if(!(this instanceof l))throw new TypeError("Cannot call a class as a function");var f=m(this,(l.__proto__||Object.getPrototypeOf(l)).call(this));f.value=a;f.element=document.createElement("label");f.promptElement=document.createElement("span");f.inputElement=document.createElement("input");var h=f.element,e=f.promptElement,k=f.inputElement;h.className="range-slider";e.className="range-prompt";k.type="range";k.min=""+b;k.max=""+d;k.step=""+c;k.valueAsNumber=
f.value.value;h.appendChild(e);h.appendChild(k);var v=function(){f.value.value=f.inputElement.valueAsNumber};f.registerEventListener(k,"change",v);f.registerEventListener(k,"input",v);f.registerEventListener(k,"wheel",function(a){a=a.deltaY;0<a?(f.inputElement.stepUp(),v()):0>a&&(f.inputElement.stepDown(),v())});a.changed.add(function(){f.inputElement.valueAsNumber=f.value.value});return f}u(l,e);a(l,[{key:"disposed",value:function(){b.i(r.a)(this.element);c(l.prototype.__proto__||Object.getPrototypeOf(l.prototype),
"disposed",this).call(this)}}]);return l}(n.b)},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?
Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return w});n=b(185);b.n(n);n=b(96);var r=b.n(n);n=b(22);var a=b.n(n);n=b(0);var c=b(8),l=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,g){c&&a(b.prototype,c);g&&a(b,g);return b}}(),p=function k(a,b,d){null===a&&(a=Function.prototype);var c=Object.getOwnPropertyDescriptor(a,b);if(void 0===
c){if(a=Object.getPrototypeOf(a),null!==a)return k(a,b,d)}else{if("value"in c)return c.value;b=c.get;return void 0===b?void 0:b.call(d)}};b(206);b(187);b(186);b(214)(r.a);var w=function(e){function h(b){if(!(this instanceof h))throw new TypeError("Cannot call a class as a function");var d=m(this,(h.__proto__||Object.getPrototypeOf(h)).call(this));d.state=b;d.changingValue=!1;d.debouncedValueUpdater=a()(function(){d.changingValue=!0;try{d.state.fragmentMain.value=d.textEditor.getValue()}finally{d.changingValue=
!1}},500);d.textEditor=r()(function(a){},{value:d.state.fragmentMain.value,mode:"glsl",gutters:["CodeMirror-lint-markers"]});d.textEditor.on("change",function(){d.setValidState(void 0);d.debouncedValueUpdater()});d.registerDisposer(d.state.fragmentMain.changed.add(function(){d.changingValue||d.textEditor.setValue(d.state.fragmentMain.value)}));d.element.classList.add("neuroglancer-shader-code-widget");d.registerDisposer(d.state.shaderError.changed.add(function(){d.updateErrorState()}));d.updateErrorState();
return d}u(h,e);l(h,[{key:"updateErrorState",value:function(){var a=this,b=this.state.shaderError.value;void 0===b?this.setValidState(void 0):null!==b?(this.textEditor.setOption("lint",{getAnnotations:function(){if("ShaderCompilationError"===b.name){var d=b.source.split("\n").indexOf(a.state.fragmentMainStartLine)+2;return b.errorMessages.map(function(a){return{message:a.message,severity:"error",from:r.a.Pos(void 0===a.line?0:a.line-d)}})}return"ShaderLinkError"===b.name?[{message:b.log,severity:"error",
from:r.a.Pos(0)}]:[{message:b.message,severity:"error",from:r.a.Pos(0)}]}}),this.setValidState(!1)):(this.textEditor.setOption("lint",void 0),this.setValidState(!0))}},{key:"setValidState",value:function(a){var b=this.element;b.classList.remove("invalid-input");b.classList.remove("valid-input");!0===a?b.classList.add("valid-input"):!1===a&&b.classList.add("invalid-input")}},{key:"disposed",value:function(){this.debouncedValueUpdater.flush();this.debouncedValueUpdater=void 0;b.i(c.a)(this.element);
this.textEditor=void 0;p(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"disposed",this).call(this)}},{key:"element",get:function(){return this.textEditor.getWrapperElement()}}]);return h}(n.b)},function(n,e){},function(n,e){n.exports=function(b){var e=typeof b;return null!=b&&("object"==e||"function"==e)}},function(n,e){n.exports="\n\nvec3 colormapJet(float x) {\n  vec3 result;\n  result.r = x < 0.89 ? ((x - 0.35) / 0.31) : (1.0 - (x - 0.89) / 0.11 * 0.5);\n  result.g = x < 0.64 ? ((x - 0.125) * 4.0) : (1.0 - (x - 0.64) / 0.27);\n  result.b = x < 0.34 ? (0.5 + x * 0.5 / 0.11) : (1.0 - (x - 0.34) / 0.31);\n  return clamp(result, 0.0, 1.0);\n}\n"},
function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,
configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function a(a){var d=a.match(/^([^:?]+:[^:?]+:[^:?]+)(?::([^:?]+))?(?:\?(.*))?$/);if(null===d)throw Error("Invalid Brain Maps volume key: "+JSON.stringify(a)+".");var c;void 0!==d[2]&&(c={changeStackId:d[2]});a=b.i(B.u)(d[3]||"");return{volumeId:d[1],changeSpec:c,parameters:a}}function c(a){try{return b.i(B.a)(a),{id:b.i(B.d)(a,"id",B.h),label:b.i(B.d)(a,"label",B.h),description:b.i(B.d)(a,"description",B.e)}}catch(L){throw Error("Failed to parse project: "+
L.message);}}function l(a){try{return b.i(B.a)(a),b.i(B.d)(a,"project",function(a){return void 0===a?[]:b.i(B.k)(a,c)})}catch(L){throw Error("Error parsing project list: "+L.message);}}function p(a){return b.i(B.d)(a,"changeStackId",function(a){return void 0===a?void 0:b.i(B.k)(a,B.h)})}Object.defineProperty(e,"__esModule",{value:!0});b.d(e,"BrainmapsSkeletonSource",function(){return H});b.d(e,"VolumeInfo",function(){return J});b.d(e,"MeshInfo",function(){return D});b.d(e,"MultiscaleVolumeChunkSource",
function(){return S});e.parseVolumeKey=a;b.d(e,"VolumeList",function(){return P});e.parseChangeStackList=p;b.d(e,"BrainmapsDataSource",function(){return U});n=b(9);var w=b(123),v=b(23),k=b(42),h=b(126),g=b(45),d=b(80),f=b(4),q=b(14),x=b(24),F=b(34),C=b(1),B=b(2),z=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}(),
E=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}r(b,a);return b}(b.i(n.e)(b.i(w.a)()(q.c),h.a)),y=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}r(b,a);return b}(b.i(n.e)(b.i(w.a)()(g.b),h.b)),H=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}r(b,a);z(b,[{key:"skeletonVertexCoordinatesInVoxels",get:function(){return!1}}]);
return b}(b.i(n.e)(b.i(w.a)()(d.f),h.c)),G=new Map;G.set("UINT8",f.b.UINT8);G.set("FLOAT",f.b.FLOAT32);G.set("UINT64",f.b.UINT64);var J=function L(a){m(this,L);try{b.i(B.a)(a),this.numChannels=b.i(B.q)(a.channelCount),this.dataType=b.i(B.v)(a.channelType,G),this.voxelSize=b.i(B.A)(C.a.create(),a.pixelSize,B.o),this.upperVoxelBound=b.i(B.A)(C.a.create(),a.volumeSize,B.q)}catch(W){throw Error("Failed to parse BrainMaps volume geometry: "+W.message);}},D=function Q(a){m(this,Q);b.i(B.a)(a);this.name=
b.i(B.d)(a,"name",B.h);this.type=b.i(B.d)(a,"type",B.h)},S=function(){function a(d,c,g,h,e,q,k,l){m(this,a);this.chunkManager=d;this.instance=c;this.credentialsProvider=g;this.volumeId=h;this.changeSpec=e;this.encoding=l.encoding;try{b.i(B.a)(q);var x=this.scales=b.i(B.d)(q,"geometry",function(a){return b.i(B.k)(a,function(a){return new J(a)})});if(0===x.length)throw Error("Expected at least one scale.");var p=x[0],v=this.numChannels=p.numChannels,y=this.dataType=p.dataType;d=1;for(var C=x.length;d<
C;++d){var F=x[d];if(F.dataType!==y)throw Error("Scale "+d+" has data type "+f.b[F.dataType]+" "+("but scale 0 has data type "+f.b[y]+"."));if(F.numChannels!==v)throw Error("Scale "+d+" has "+F.numChannels+" channel(s) "+("but scale 0 has "+v+" channels."));}var z;if(1===v)switch(y){case f.b.UINT64:z=f.a.SEGMENTATION}void 0===z&&(z=void 0!==l.volumeType?l.volumeType:f.a.IMAGE);this.volumeType=z}catch(Sa){throw Error("Failed to parse BrainMaps multiscale volume specification: "+Sa.message);}try{b.i(B.a)(k),
this.meshes=b.i(B.d)(k,"meshes",function(a){return void 0===a?[]:b.i(B.k)(a,function(a){return new D(a)})})}catch(Sa){throw Error("Failed to parse BrainMaps meshes specification: "+Sa.message);}}z(a,[{key:"getSources",value:function(a){var b=this,d=h.d.RAW;this.dataType===f.b.UINT64?d=h.d.COMPRESSED_SEGMENTATION:this.volumeType===f.a.IMAGE&&this.dataType===f.b.UINT8&&1===this.numChannels&&this.encoding!==h.d.RAW&&(d=h.d.JPEG);return this.scales.map(function(c,g){return f.d.getDefaults({voxelSize:c.voxelSize,
dataType:c.dataType,numChannels:c.numChannels,upperVoxelBound:c.upperVoxelBound,volumeType:b.volumeType,volumeSourceOptions:a}).map(function(a){return b.chunkManager.getChunkSource(E,{credentialsProvider:b.credentialsProvider,spec:a,parameters:{instance:b.instance,volumeId:b.volumeId,changeSpec:b.changeSpec,scaleIndex:g,encoding:d}})})})}},{key:"getMeshSource",value:function(){var a=this.meshes.find(function(a){return"TRIANGLES"===a.type});return void 0===a?null:this.chunkManager.getChunkSource(y,
{credentialsProvider:this.credentialsProvider,parameters:{instance:this.instance,volumeId:this.volumeId,meshName:a.name,changeSpec:this.changeSpec}})}}]);return a}(),I=/^([^\/]+)\/(.*)$/,P=function W(a,d){m(this,W);this.projects=new Map;this.hierarchicalVolumeIds=new Map;var c=this.projects;a=$jscomp.makeIterator(l(a));for(var f=a.next();!f.done;f=a.next())f=f.value,c.set(f.id,f);try{b.i(B.a)(d);var g=this.volumeIds=b.i(B.d)(d,"volumeId",function(a){return void 0===a?[]:b.i(B.k)(a,B.h)});g.sort();
for(var h=new Map,e=$jscomp.makeIterator(g),q=e.next();!q.done;q=e.next()){var k=q.value;for(d=0;;){var x=k.indexOf(":",d);-1===x?x=void 0:++x;var p=k.substring(0,d),v=h.get(p);void 0===v&&(v=new Set,h.set(p,v));v.add(k.substring(d,x));if(void 0===x)break;d=x}}for(var y=this.hierarchicalVolumeIds,C=$jscomp.makeIterator(h),F=C.next();!F.done;F=C.next()){var z=$jscomp.makeIterator(F.value),w=z.next().value,E=z.next().value;y.set(w,Array.from(E))}}catch(sb){throw Error("Failed to parse Brain Maps volume list reply: "+
sb.message);}},U=function(d){function c(a,b){m(this,c);var d=u(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));d.instance=a;d.credentialsProvider=b;return d}r(c,d);z(c,[{key:"getMeshSource",value:function(a,b){return a.getChunkSource(y,{credentialsProvider:this.credentialsProvider,parameters:this.getMeshSourceParameters(b)})}},{key:"getMeshSourceParameters",value:function(b){var d=b.match(I);if(null===d)throw Error("Invalid Brainmaps mesh URL: "+b);b=a(d[1]);return{instance:this.instance,
volumeId:b.volumeId,changeSpec:b.changeSpec,meshName:d[2]}}},{key:"getSkeletonSource",value:function(a,b){return a.getChunkSource(H,{credentialsProvider:this.credentialsProvider,parameters:this.getMeshSourceParameters(b)})}},{key:"getVolume",value:function(d,c,f){var g=this;c=a(c);var e=c.volumeId,q=c.changeSpec,l=c.parameters;b.i(B.a)(l);c=b.i(B.d)(l,"encoding",function(a){return void 0===a?void 0:b.i(B.n)(l.encoding,h.d)});var x=Object.assign({},f,{encoding:c});return d.memoize.getUncounted({type:"brainmaps:getVolume",
instance:this.instance,volumeId:e,changeSpec:q,brainmapsOptions:x},function(){return Promise.all([b.i(k.b)(g.instance,g.credentialsProvider,{method:"GET",path:"/v1beta2/volumes/"+e,responseType:"json"}),b.i(k.b)(g.instance,g.credentialsProvider,{method:"GET",path:"/v1beta2/objects/"+e+"/meshes",responseType:"json"})]).then(function(a){var b=$jscomp.makeIterator(a);a=b.next().value;b=b.next().value;return new S(d,g.instance,g.credentialsProvider,e,q,a,b,x)})})}},{key:"getVolumeList",value:function(a){var d=
this;return a.memoize.getUncounted({instance:this.instance,type:"brainmaps:getVolumeList"},function(){var a=Promise.all([b.i(k.b)(d.instance,d.credentialsProvider,{method:"GET",path:"/v1beta2/projects",responseType:"json"}),b.i(k.b)(d.instance,d.credentialsProvider,{method:"GET",path:"/v1beta2/volumes",responseType:"json"})]).then(function(a){var b=$jscomp.makeIterator(a);a=b.next().value;b=b.next().value;return new P(a,b)}),c=d.instance.description+" volume list";x.a.forPromise(a,{delay:!0,initialMessage:"Retrieving "+
c+".",errorPrefix:"Error retrieving "+c+": "});return a})}},{key:"getChangeStackList",value:function(a,d){var c=this;return a.memoize.getUncounted({instance:this.instance,type:"brainmaps:getChangeStackList",volumeId:d},function(){var a=b.i(k.b)(c.instance,c.credentialsProvider,{method:"GET",path:"/v1beta2/changes/"+d+"/change_stacks",responseType:"json"}).then(function(a){return p(a)}),f="change stacks for "+d;x.a.forPromise(a,{delay:!0,initialMessage:"Retrieving "+f+".",errorPrefix:"Error retrieving "+
f+": "});return a})}},{key:"volumeCompleter",value:function(a,d){var c=this;return this.getVolumeList(d).then(function(f){var g=a.match(/^([^:]+:[^:]+:[^:]+):(.*)$/);if(null!==g){var h=g[1],e=g[2];return c.getChangeStackList(d,h).then(function(a){if(void 0===a)throw null;return{offset:h.length+1,completions:b.i(F.c)(e,a)}})}var q=a.lastIndexOf(":")+1,g=a.substring(0,q),q=a.substring(q),k=f.hierarchicalVolumeIds.get(g);if(void 0===k)throw null;return g?{offset:g.length,completions:b.i(F.c)(q,k)}:{offset:0,
completions:b.i(F.b)(q,k,function(a){return a},function(a){return(a=f.projects.get(a.substring(0,a.length-1)))&&a.label})}})}},{key:"description",get:function(){return this.instance.description}}]);return c}(v.b);e.productionInstance={description:"Google Brain Maps",serverUrls:["https://brainmaps.googleapis.com"]}},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,
b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function r(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function a(a,c,f){b.i(z.a)(a);var g=b.i(z.d)(a,"Base",function(a){return new H(a)});switch(g.typeName){case "uint8blk":case "grayscale8":return new D(a,
c,g,d.b.JPEG,f);case "imagetile":return new U(a,c,g);case "labels64":case "labelblk":return new D(a,c,g,d.b.COMPRESSED_SEGMENTATION,f);default:throw Error("DVID data type "+JSON.stringify(g.typeName)+" is not supported.");}}function c(a){try{for(var d=b.i(z.w)(a,function(a){return new V(a)}),c=new Map,f=$jscomp.makeIterator(d),g=f.next();!g.done;g=f.next()){var h=$jscomp.makeIterator(g.value),e=h.next().value,q=h.next().value;c.set(e,q);for(var k=$jscomp.makeIterator(q.vnodes),l=k.next();!l.done;l=
k.next()){var x=l.value;if(x!==e){var p=new V(q);c.set(x,p)}}}for(var v=$jscomp.makeIterator(c),y=v.next();!y.done;y=v.next()){var C=$jscomp.makeIterator(y.value),F=C.next().value;C.next().value.uuid=F}return c}catch(qa){throw Error("Failed to parse DVID repositories info: "+qa.message);}}function l(a,d){return a.memoize.getUncounted({type:"dvid:getServerInfo",baseUrls:d},function(){var a=b.i(B.a)(b.i(B.b)(d,"/api/repos/info","GET"),"json").then(function(a){return new L(a)}),c="repository info for DVID server "+
d[0];x.a.forPromise(a,{initialMessage:"Retrieving "+c+".",delay:!0,errorPrefix:"Error retrieving "+c+": "});return a})}function p(a,d,c,f){return a.memoize.getUncounted({type:"dvid:getInstanceDetails",baseUrls:d,nodeKey:c,name:f.name},function(){var a=b.i(B.a)(b.i(B.b)(d,"/api/node/"+c+"/"+f.name+"/info","GET"),"json"),g="datainstance info for node "+c+" and instance "+f.name+" "+("on DVID server "+d[0]);x.a.forPromise(a,{initialMessage:"Retrieving "+g+".",delay:!0,errorPrefix:"Error retrieving "+
g+": "});return a.then(function(a){a=b.i(z.d)(a,"Extended",z.a);f.lowerVoxelBound=b.i(z.d)(a,"MinPoint",function(a){return b.i(z.p)(C.a.create(),a)});f.upperVoxelBound=b.i(z.d)(a,"MaxPoint",function(a){return b.i(z.p)(C.a.create(),a)});return f})})}function w(a,b,d,c){return l(a,b).then(function(f){f=f.getNode(d);if(void 0===f)throw Error("Invalid node: "+JSON.stringify(d)+".");f=f.dataInstances.get(c);if(!(f instanceof D||f instanceof U))throw Error("Invalid data instance "+c+".");return p(a,b,d,
f)}).then(function(f){return a.memoize.getUncounted({type:"dvid:MultiscaleVolumeChunkSource",baseUrls:b,nodeKey:d,dataInstanceKey:c},function(){return new Q(a,b,d,c,f)})})}function v(a,b){var d=b.match(W);if(null===d)throw Error("Invalid DVID URL: "+JSON.stringify(b)+".");return w(a,[d[1]],d[2],d[3])}function k(a,d){return{offset:0,completions:b.i(F.b)(d,a.dataInstances.values(),function(a){return a.name},function(a){return""+a.base.typeName})}}function h(a,d){var c=d.match(/^(?:([^\/]+)(?:\/([^\/]*))?)?$/);
if(null===c)throw Error("Invalid DVID URL syntax.");if(void 0===c[2])return{offset:0,completions:b.i(F.b)(d,a.repositories.values(),function(a){return a.uuid+"/"},function(a){return a.alias+": "+a.description})};d=c[1];a=a.getNode(d);return b.i(F.a)(d.length+1,k(a,c[2]))}function g(a,d){a=a.match(/^((?:http|https):\/\/[^\/]+)\/(.*)$/);if(null===a)return Promise.reject(null);var c=a[1],f=a[2];return l(d,[c]).then(function(a){return b.i(F.a)(c.length+1,h(a,f))})}Object.defineProperty(e,"__esModule",
{value:!0});b.d(e,"getVolume",function(){return v});b.d(e,"volumeCompleter",function(){return g});b.d(e,"DataInstanceBaseInfo",function(){return H});b.d(e,"DataInstanceInfo",function(){return G});b.d(e,"VolumeDataInstanceInfo",function(){return D});b.d(e,"TileLevelInfo",function(){return S});b.d(e,"TileDataInstanceInfo",function(){return U});e.parseDataInstance=a;b.d(e,"RepositoryInfo",function(){return V});e.parseRepositoriesInfo=c;b.d(e,"ServerInfo",function(){return L});e.getServerInfo=l;e.getDataInstanceDetails=
p;b.d(e,"MultiscaleVolumeChunkSource",function(){return Q});e.getShardedVolume=w;e.completeInstanceName=k;e.completeNodeAndInstance=h;b.d(e,"DVIDDataSource",function(){return X});n=b(9);e=b(23);var d=b(128),f=b(4),q=b(14),x=b(24),F=b(34),C=b(1),B=b(35),z=b(2),E=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}(),
y=new Map;y.set("uint8",f.b.UINT8);y.set("uint32",f.b.UINT32);y.set("uint64",f.b.UINT64);var H=function(){function a(d){r(this,a);this.obj=d;b.i(z.a)(d);b.i(z.d)(d,"TypeName",z.h)}E(a,[{key:"typeName",get:function(){return this.obj.TypeName}}]);return a}(),G=function O(a,b,d){r(this,O);this.obj=a;this.name=b;this.base=d},J=function(a){function b(){r(this,b);return m(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}u(b,a);return b}(b.i(n.e)(q.c,d.a)),D=function(a){function c(a,d,
f,g,h){r(this,c);f=m(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,a,d,f));f.encoding=g;a=b.i(z.d)(a,"Extended",z.a);g=b.i(z.d)(a,"Values",function(a){return b.i(z.k)(a,z.a)});if(1>g.length)throw Error("Expected Extended.Values property to have length >= 1, but received: ${JSON.stringify(extendedValues)}.");f.numLevels=1;for(h=new Set(h);h.has(d+"_"+f.numLevels.toString());)f.numLevels+=1;f.dataType=b.i(z.d)(g[0],"DataType",function(a){return b.i(z.v)(a,y)});f.voxelSize=b.i(z.d)(a,"VoxelSize",
function(a){return b.i(z.i)(C.a.create(),a,z.o)});f.numChannels=1;return f}u(c,a);E(c,[{key:"getSources",value:function(a,b,c){for(var g=this.encoding,h=[],e={},q=0;q<this.numLevels;e={volParameters:e.volParameters},++q){for(var k=C.a.scale(C.a.create(),this.voxelSize,Math.pow(2,q)),l=C.a.create(),x=C.a.create(),p=0;3>p;++p)l[p]=Math.floor(this.voxelSize[p]/k[p]*this.lowerVoxelBound[p]),x[p]=Math.ceil(this.voxelSize[p]/k[p]*this.upperVoxelBound[p]);p=b.dataInstanceKey;0<q&&(p+="_"+q.toString());e.volParameters=
{baseUrls:b.baseUrls,nodeKey:b.nodeKey,dataInstanceKey:p,encoding:g};k=f.d.getDefaults({voxelSize:k,dataType:this.dataType,numChannels:this.numChannels,transform:C.c.fromTranslation(C.c.create(),C.a.multiply(C.a.create(),l,k)),baseVoxelOffset:l,upperVoxelBound:C.a.subtract(C.a.create(),x,l),volumeType:this.volumeType,volumeSourceOptions:c,compressedSegmentationBlockSize:g===d.b.COMPRESSED_SEGMENTATION?C.a.fromValues(8,8,8):void 0}).map(function(b){return function(d){return a.getChunkSource(J,{spec:d,
parameters:b.volParameters})}}(e));h.push(k)}return h}},{key:"volumeType",get:function(){return this.encoding===d.b.COMPRESSED_SEGMENTATION?f.a.SEGMENTATION:f.a.IMAGE}}]);return c}(G),S=function na(a){r(this,na);b.i(z.a)(a);this.resolution=b.i(z.d)(a,"Resolution",function(a){return b.i(z.i)(C.a.create(),a,z.o)});this.tileSize=b.i(z.d)(a,"TileSize",function(a){return b.i(z.i)(C.a.create(),a,z.q)})},I=[[0,1],[0,2],[1,2]],P=function(a){function b(){r(this,b);return m(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,
arguments))}u(b,a);return b}(b.i(n.e)(q.c,d.c)),U=function(a){function c(a,f,g){r(this,c);f=m(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,a,f,g));a=b.i(z.d)(a,"Extended",z.a);f.levels=b.i(z.d)(a,"Levels",function(a){return b.i(z.w)(a,function(a){return new S(a)})});g=f.levels.get("0");if(void 0===g)throw Error("Level 0 is not defined.");f.voxelSize=g.resolution;var h=b.i(z.d)(a,"MinTileCoord",function(a){return b.i(z.i)(C.a.create(),a,z.x)}),e=b.i(z.d)(a,"MaxTileCoord",function(a){return b.i(z.i)(C.a.create(),
a,z.x)});f.lowerVoxelBound=C.a.multiply(C.a.create(),g.tileSize,h);f.upperVoxelBound=C.a.multiply(C.a.create(),g.tileSize,e);a=b.i(z.d)(a,"Encoding",function(a){return a});switch(a){case 2:f.encoding=d.d.JPEG;break;default:throw Error("Unsupported tile encoding: "+JSON.stringify(a)+".");}return f}u(c,a);E(c,[{key:"dataType",get:function(){return f.b.UINT8}},{key:"volumeType",get:function(){return f.a.IMAGE}},{key:"numChannels",get:function(){return 1}}]);E(c,[{key:"getSources",value:function(a,b,
d){for(var c=this,g=[],h=this.numChannels,e=this.dataType,q=this.encoding,k={},l=$jscomp.makeIterator(this.levels),x=l.next();!x.done;k={levelInfo:k.levelInfo,level:k.level},x=l.next())x=$jscomp.makeIterator(x.value),k.level=x.next().value,k.levelInfo=x.next().value,x=I.map(function(g){return function(k){for(var l=C.a.clone(c.voxelSize),x=C.a.fromValues(1,1,1),p=0;2>p;++p)l[k[p]]=g.levelInfo.resolution[k[p]],x[k[p]]=g.levelInfo.tileSize[k[p]];for(var p=C.a.create(),v=C.a.create(),y=0;3>y;++y)p[y]=
Math.floor(c.voxelSize[y]/l[y]*c.lowerVoxelBound[y]),v[y]=Math.ceil(c.voxelSize[y]/l[y]*c.upperVoxelBound[y]);l=f.d.make({voxelSize:l,chunkDataSize:x,numChannels:h,dataType:e,lowerVoxelBound:p,upperVoxelBound:v,volumeSourceOptions:d});return a.getChunkSource(P,{spec:l,parameters:{baseUrls:b.baseUrls,nodeKey:b.nodeKey,dataInstanceKey:b.dataInstanceKey,encoding:q,level:g.level,dims:k[0]+"_"+k[1]}})}}(k)),g.push(x);return g}}]);return c}(G),V=function sa(d){r(this,sa);this.errors=[];this.dataInstances=
new Map;this.vnodes=new Set;if(d instanceof sa)this.alias=d.alias,this.description=d.description,this.errors=d.errors,this.dataInstances=d.dataInstances;else{b.i(z.a)(d);this.alias=b.i(z.d)(d,"Alias",z.h);this.description=b.i(z.d)(d,"Description",z.h);for(var c=b.i(z.d)(d,"DataInstances",z.a),f=Object.keys(c),g=$jscomp.makeIterator(f),h=g.next();!h.done;h=g.next()){h=h.value;try{this.dataInstances.set(h,a(c[h],h,f))}catch(Y){h="Failed to parse data instance "+JSON.stringify(h)+": "+Y.message,console.log(h),
this.errors.push(h)}}d=b.i(z.d)(d,"DAG",z.a);d=b.i(z.d)(d,"Nodes",z.a);d=$jscomp.makeIterator(Object.keys(d));for(h=d.next();!h.done;h=d.next())this.vnodes.add(h.value)}},L=function(){function a(b){r(this,a);this.repositories=c(b)}E(a,[{key:"getNode",value:function(a){for(var b=[],d=$jscomp.makeIterator(this.repositories.keys()),c=d.next();!c.done;c=d.next())c=c.value,c.startsWith(a)&&b.push(c);if(1!==b.length)throw Error("Node key "+JSON.stringify(a)+" matches "+JSON.stringify(b)+" nodes.");return this.repositories.get(b[0])}}]);
return a}(),Q=function(){function a(b,d,c,f,g){r(this,a);this.chunkManager=b;this.baseUrls=d;this.nodeKey=c;this.dataInstanceKey=f;this.info=g}E(a,[{key:"getSources",value:function(a){return this.info.getSources(this.chunkManager,{baseUrls:this.baseUrls,nodeKey:this.nodeKey,dataInstanceKey:this.dataInstanceKey},a)}},{key:"getMeshSource",value:function(){return null}},{key:"dataType",get:function(){return this.info.dataType}},{key:"numChannels",get:function(){return this.info.numChannels}},{key:"volumeType",
get:function(){return this.info.volumeType}}]);return a}(),W=/^((?:http|https):\/\/[^\/]+)\/([^\/]+)\/([^\/]+)$/,X=function(a){function b(){r(this,b);return m(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}u(b,a);E(b,[{key:"getVolume",value:function(a,b){return v(a,b)}},{key:"volumeCompleter",value:function(a,b){return g(a,b)}},{key:"description",get:function(){return"DVID"}}]);return b}(e.b)},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");
}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function a(a,b,d){return a.rpc.promiseInvoke(l.b,
{chunkManager:a.addCounterpartRef(),url:b},d)}function c(b,c){return b.memoize.getUncounted({type:"nifti/getVolume",url:c},function(){return a(b,c,v.c).then(function(a){return new d(b,c,a)})})}Object.defineProperty(e,"__esModule",{value:!0});b.d(e,"getVolume",function(){return c});b.d(e,"MultiscaleVolumeChunkSource",function(){return d});b.d(e,"NiftiDataSource",function(){return f});n=b(9);e=b(23);var l=b(129),p=b(4),w=b(14),v=b(13),k=b(1),h=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=
b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}(),g=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}r(b,a);return b}(b.i(n.e)(w.c,l.a)),d=function(){function a(b,d,c){m(this,a);this.chunkManager=b;this.url=d;this.info=c}h(a,[{key:"getSources",value:function(a){var d=this.info;a=p.d.withDefaultCompression({volumeType:d.volumeType,
chunkDataSize:d.volumeSize,dataType:d.dataType,voxelSize:d.voxelSize,numChannels:d.numChannels,upperVoxelBound:d.volumeSize,transform:b.i(k.r)(k.c.create(),d.qoffset,d.quatern,k.q,d.qfac),volumeSourceOptions:a});return[[this.chunkManager.getChunkSource(g,{spec:a,parameters:{url:this.url}})]]}},{key:"getMeshSource",value:function(){return null}},{key:"numChannels",get:function(){return this.info.numChannels}},{key:"dataType",get:function(){return this.info.dataType}},{key:"volumeType",get:function(){return this.info.volumeType}}]);
return a}(),f=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}r(b,a);h(b,[{key:"getVolume",value:function(a,b){return c(a,b)}},{key:"description",get:function(){return"Single NIfTI file"}}]);return b}(e.b)},function(n,e,b){function m(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,
writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(e,"__esModule",{value:!0});b.d(e,"OpenConnectomeDataSource",function(){return a});var u=b(70),r=["http://openconnecto.me","http://www.openconnecto.me"],a=function(a){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var a=(b.__proto__||Object.getPrototypeOf(b)).call(this,"NDstore server hosted at openconnecto.me",r,u.a);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!a||"object"!==typeof a&&"function"!==typeof a?this:a}m(b,a);return b}(b(38).SingleServerDataSource)},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function a(a,b){return a.getChunkSource(F,{parameters:b})}function c(a,c,f){return a.memoize.getUncounted({type:"precomputed:MultiscaleVolumeChunkSource",baseUrls:c,path:f},function(){return b.i(d.a)(b.i(d.b)(c,f+"/info"),"json").then(function(b){return new B(a,c,f,b)})})}function l(c,f){var g=$jscomp.makeIterator(b.i(d.c)(f));
f=g.next().value;g=g.next().value;return a(c,{baseUrls:f,path:g,lod:0})}function p(a,f){var g=$jscomp.makeIterator(b.i(d.c)(f));f=g.next().value;g=g.next().value;return c(a,f,g)}Object.defineProperty(e,"__esModule",{value:!0});b.d(e,"getMeshSource",function(){return l});b.d(e,"getVolume",function(){return p});b.d(e,"MultiscaleVolumeChunkSource",function(){return B});e.getShardedMeshSource=a;e.getShardedVolume=c;b.d(e,"PrecomputedDataSource",function(){return z});n=b(9);e=b(23);var w=b(130),v=b(45),
k=b(4),h=b(14),g=b(1),d=b(35),f=b(2),q=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}(),x=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}r(b,a);return b}(b.i(n.e)(h.c,w.a)),F=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,
arguments))}r(b,a);return b}(b.i(n.e)(v.b,w.b)),C=function y(a){m(this,y);b.i(f.a)(a);this.resolution=b.i(f.d)(a,"resolution",function(a){return b.i(f.i)(g.a.create(),a,f.o)});this.voxelOffset=b.i(f.d)(a,"voxel_offset",function(a){return b.i(f.p)(g.a.create(),a)});this.size=b.i(f.d)(a,"size",function(a){return b.i(f.i)(g.a.create(),a,f.q)});this.chunkSizes=b.i(f.d)(a,"chunk_sizes",function(a){return b.i(f.k)(a,function(a){return b.i(f.i)(g.a.create(),a,f.q)})});if(0===this.chunkSizes.length)throw Error("No chunk sizes specified.");
(this.encoding=b.i(f.d)(a,"encoding",function(a){return b.i(f.n)(a,w.c)}))===w.c.COMPRESSED_SEGMENTATION&&(this.compressedSegmentationBlockSize=b.i(f.d)(a,"compressed_segmentation_block_size",function(a){return b.i(f.i)(g.a.create(),a,f.q)}));this.key=b.i(f.d)(a,"key",f.h)},B=function(){function d(a,c,g,h){m(this,d);this.chunkManager=a;this.baseUrls=c;this.path=g;b.i(f.a)(h);this.dataType=b.i(f.d)(h,"data_type",function(a){return b.i(f.n)(a,k.b)});this.numChannels=b.i(f.d)(h,"num_channels",f.q);this.volumeType=
b.i(f.d)(h,"type",function(a){return b.i(f.n)(a,k.a)});this.mesh=b.i(f.d)(h,"mesh",f.e);this.scales=b.i(f.d)(h,"scales",function(a){return b.i(f.k)(a,function(a){return new C(a)})})}q(d,[{key:"getMeshSource",value:function(){var b=this.mesh;return void 0===b?null:a(this.chunkManager,{baseUrls:this.baseUrls,path:this.path+"/"+b,lod:0})}},{key:"getSources",value:function(a){var b=this;return this.scales.map(function(d){return k.d.getDefaults({voxelSize:d.resolution,dataType:b.dataType,numChannels:b.numChannels,
transform:g.c.fromTranslation(g.c.create(),g.a.multiply(g.a.create(),d.resolution,d.voxelOffset)),upperVoxelBound:d.size,volumeType:b.volumeType,chunkDataSizes:d.chunkSizes,baseVoxelOffset:d.voxelOffset,compressedSegmentationBlockSize:d.compressedSegmentationBlockSize,volumeSourceOptions:a}).map(function(a){return b.chunkManager.getChunkSource(x,{spec:a,parameters:{baseUrls:b.baseUrls,path:b.path+"/"+d.key,encoding:d.encoding}})})})}}]);return d}(),z=function(a){function b(){m(this,b);return u(this,
(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}r(b,a);q(b,[{key:"getVolume",value:function(a,b){return p(a,b)}},{key:"getMeshSource",value:function(a,b){return l(a,b)}},{key:"description",get:function(){return"Precomputed file-backed data source"}}]);return b}(e.b)},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function a(a){var d=b.i(D.k)(a,D.a);if(1>d.length)throw Error("No stacks found for owner object.");a=new Map;for(var f=b.i(D.d)(d[0],
"stackId",l),d=$jscomp.makeIterator(d),g=d.next();!g.done;g=d.next()){var h=g.value,g=b.i(D.d)(h,"stackId",c);b.i(D.a)(h);var e=b.i(D.d)(h,"state",D.h);if(V.has(e)){var e=b.i(D.d)(h,"stats",D.a),q;q=e;b.i(D.a)(q);q=b.i(D.d)(q,"stackBounds",D.a);var k=G.a.create();k[0]=b.i(D.d)(q,"minX",D.r);k[1]=b.i(D.d)(q,"minY",D.r);k[2]=b.i(D.d)(q,"minZ",D.r);q=k;k=e;b.i(D.a)(k);var k=b.i(D.d)(k,"stackBounds",D.a),x=G.a.create();x[0]=b.i(D.d)(k,"maxX",D.r);x[1]=b.i(D.d)(k,"maxY",D.r);x[2]=b.i(D.d)(k,"maxZ",D.r);
k=x;x=[];e.hasOwnProperty("channelNames")&&(x=p(e));e=b.i(D.d)(h,"currentVersion",w);h=b.i(D.d)(h,"stackId",v);h={lowerVoxelBound:q,upperVoxelBound:k,voxelResolution:e,project:h,channels:x}}else h=void 0;void 0!==h&&(e=h.project,q=a.get(e),void 0===q&&(q=new Map,a.set(e,{stacks:q}),q=a.get(e)),q.stacks.set(g,h))}return{owner:f,projects:a}}function c(a){b.i(D.a)(a);return b.i(D.d)(a,"stack",D.h)}function l(a){b.i(D.a)(a);return b.i(D.d)(a,"owner",D.h)}function p(a){b.i(D.a)(a);return b.i(D.d)(a,"channelNames",
function(a){return b.i(D.k)(a,D.h)})}function w(a){b.i(D.a)(a);var d=G.a.create();try{d[0]=b.i(D.d)(a,"stackResolutionX",D.r),d[1]=b.i(D.d)(a,"stackResolutionY",D.r),d[2]=b.i(D.d)(a,"stackResolutionZ",D.r)}catch(sa){d[0]=1,d[1]=1,d[2]=1}return d}function v(a){b.i(D.a)(a);return b.i(D.d)(a,"project",D.h)}function k(a,b){for(var d=0,c=0;2>c;c++)d<a.upperVoxelBound[c]&&(d=a.upperVoxelBound[c]);for(a=0;d>b;)d/=2,a++;return a}function h(d,c,f){return d.memoize.getUncounted({type:"render:getOwnerInfo",
hostnames:c,owner:f},function(){return b.i(J.a)(b.i(J.b)(c,"/render-ws/v1/owner/"+f+"/stacks"),"json").then(a)})}function g(a,d,c){var f=c.match(Q);if(null===f)throw Error("Invalid volume path "+JSON.stringify(c));var g=f[1],e=f[2],q=f[3],k=f[4],l=b.i(D.u)(f[5]||"");return a.memoize.getUncounted({type:"render:MultiscaleVolumeChunkSource",hostnames:d,path:c},function(){return h(a,d,g).then(function(b){return new L(a,d,b,q,e,k,l)})})}function d(a,b){var d=b.match(W);if(null===d)throw Error("Invalid render volume path: "+
JSON.stringify(b));b=d[1].split(",");return g(a,b,d[2])}function f(a,d,c){var f=c.match(/^(?:([^\/]+)(?:\/([^\/]*))?(?:\/([^\/]*))?(\/.*?)?)?$/);if(null===f||void 0===f[2])return Promise.reject(null);if(void 0===f[3]){var g=f[2]||"";return h(a,d,f[1]).then(function(a){a=b.i(H.b)(g,a.projects,function(a){return a[0]+"/"},function(){});return{offset:f[1].length+1,completions:a}})}if(void 0===f[4]){var e=f[3]||"";return h(a,d,f[1]).then(function(a){a=a.projects.get(f[2]);if(void 0===a)return Promise.reject(null);
a=b.i(H.b)(e,a.stacks,function(a){return a[0]+"/"},function(a){return"("+a[1].project+")"});return{offset:f[1].length+f[2].length+2,completions:a}})}var q=f[4].substr(1)||"";return h(a,d,f[1]).then(function(a){a=a.projects.get(f[2]);if(void 0===a)return Promise.reject(null);a=a.stacks.get(f[3]);if(void 0===a)return Promise.reject(null);a=a.channels;if(0===a.length)return Promise.reject(null);a=b.i(H.b)(q,a,function(a){return a},function(){});return{offset:f[1].length+f[2].length+f[3].length+3,completions:a}})}
function q(a,d){var c=a.match(W);if(null===c)return Promise.reject(null);a=c[1].split(",");return f(d,a,c[2]).then(function(a){return b.i(H.a)(c[1].length+1,a)})}function x(a,b){var d=b.match(W);if(null===d)throw Error("Invalid render point path: "+JSON.stringify(b));return F(a,[d[1]],d[2])}function F(a,d,c){var f=c.match(Q);if(null===f)throw Error("Invalid point path "+JSON.stringify(c));var g=f[1],e=f[2],q=f[3],k=b.i(D.u)(f[4]||"");return a.memoize.getUncounted({type:"render:MultiscaleVectorGraphicsChunkSource",
hostnames:d,path:c},function(){return h(a,d,g).then(function(b){return new X(a,d,b,q,e,k)})})}Object.defineProperty(e,"__esModule",{value:!0});b.d(e,"getVolume",function(){return d});b.d(e,"volumeCompleter",function(){return q});b.d(e,"MultiscaleVolumeChunkSource",function(){return L});e.computeStackHierarchy=k;e.getOwnerInfo=h;e.getShardedVolume=g;e.stackAndProjectCompleter=f;b.d(e,"MultiscaleVectorGraphicsChunkSource",function(){return X});e.getPointMatches=x;e.getShardedPointMatches=F;b.d(e,"RenderDataSource",
function(){return K});n=b(9);e=b(23);var C=b(131),B=b(48),z=b(83),E=b(4),y=b(14),H=b(34),G=b(1),J=b(35),D=b(2),S=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}(),I=new Set(["jpg"]),P=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}r(b,a);return b}(b.i(n.e)(y.c,
C.a)),U=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}r(b,a);return b}(b.i(n.e)(z.b,C.b)),V=new Set(["COMPLETE"]),L=function(){function a(d,c,f,g,h,e,q){m(this,a);this.chunkManager=d;this.baseUrls=c;this.ownerInfo=f;this.project=h;this.parameters=q;d=f.projects.get(h);if(void 0===d)throw Error("Specified project "+JSON.stringify(h)+" does not exist for "+("specified owner "+JSON.stringify(f.owner)));if(void 0===g){g=Array.from(d.stacks.keys());
if(1!==g.length)throw Error("Dataset contains multiple stacks: "+JSON.stringify(g));g=g[0]}f=d.stacks.get(g);if(void 0===f)throw Error("Specified stack "+JSON.stringify(g)+" is not one of the supported stacks: "+JSON.stringify(Array.from(d.stacks.keys())));this.stack=g;this.stackInfo=f;void 0!==e&&0<e.length&&(this.channel=e);this.minIntensity=b.i(D.s)(q.minIntensity);this.maxIntensity=b.i(D.s)(q.maxIntensity);this.maxTileSpecsToRender=b.i(D.s)(q.maxTileSpecsToRender);this.filter=b.i(D.t)(q.filter);
e=b.i(D.e)(q.encoding);if(void 0===e)e="jpg";else if(!I.has(e))throw Error("Invalid encoding: "+JSON.stringify(e)+".");this.encoding=e;this.numLevels=b.i(D.s)(q.numlevels);this.dims=G.a.create();q=b.i(D.s)(q.tilesize);void 0===q&&(q=1024);this.dims[0]=q;this.dims[1]=q;this.dims[2]=1}S(a,[{key:"getSources",value:function(a){var b=[],d=this.numLevels;void 0===d&&(d=k(this.stackInfo,this.dims[0]));for(var c=G.a.create(),f=G.a.create(),g=0;3>g;g++)c[g]=this.stackInfo.lowerVoxelBound[g]*this.stackInfo.voxelResolution[g],
f[g]=this.stackInfo.upperVoxelBound[g]*this.stackInfo.voxelResolution[g];for(g=0;g<d;g++){for(var h=G.a.clone(this.stackInfo.voxelResolution),e=G.a.fromValues(1,1,1),q=0;2>q;++q)h[q]*=Math.pow(2,g),e[q]=this.dims[q];for(var q=G.a.create(),l=G.a.create(),p=0;3>p;p++)q[p]=Math.floor(this.stackInfo.voxelResolution[p]/h[p]*this.stackInfo.lowerVoxelBound[p]),l[p]=Math.ceil(this.stackInfo.voxelResolution[p]/h[p]*this.stackInfo.upperVoxelBound[p]);h=E.d.make({voxelSize:h,chunkDataSize:e,numChannels:this.numChannels,
dataType:this.dataType,lowerClipBound:c,upperClipBound:f,lowerVoxelBound:q,upperVoxelBound:l,volumeSourceOptions:a});h=this.chunkManager.getChunkSource(P,{spec:h,parameters:{baseUrls:this.baseUrls,owner:this.ownerInfo.owner,project:this.stackInfo.project,stack:this.stack,channel:this.channel,minIntensity:this.minIntensity,maxIntensity:this.maxIntensity,maxTileSpecsToRender:this.maxTileSpecsToRender,filter:this.filter,dims:this.dims[0]+"_"+this.dims[1],level:g,encoding:this.encoding}});b.push([h])}return b}},
{key:"getMeshSource",value:function(){return null}},{key:"dataType",get:function(){return E.b.UINT8}},{key:"numChannels",get:function(){return 3}},{key:"volumeType",get:function(){return E.a.IMAGE}}]);return a}(),Q=/^([^\/?]+)(?:\/([^\/?]+))?(?:\/([^\/?]+))(?:\/([^\/?]*))?(?:\?(.*))?$/,W=/^((?:(?:(?:http|https):\/\/[^,\/]+)[^\/?])+)\/(.*)$/,X=function(){function a(d,c,f,g,h,e){m(this,a);this.chunkManager=d;this.baseUrls=c;this.ownerInfo=f;this.project=h;this.parameters=e;d=f.projects.get(h);if(void 0===
d)throw Error("Specified project "+JSON.stringify(h)+" does not exist for "+("specified owner "+JSON.stringify(f.owner)));if(void 0===g){g=Array.from(d.stacks.keys());if(1!==g.length)throw Error("Dataset contains multiple stacks: "+JSON.stringify(g));g=g[0]}f=d.stacks.get(g);if(void 0===f)throw Error("Specified stack "+JSON.stringify(g)+" is not one of the supported stacks: "+JSON.stringify(Array.from(d.stacks.keys())));this.stack=g;this.stackInfo=f;f=b.i(D.e)(e.matchCollection);void 0===f&&(f=g);
this.matchCollection=f;g=b.i(D.s)(e.zoffset);void 0===g&&(g=1);this.zoffset=g;this.dims=G.a.create();e=b.i(D.s)(e.tilesize);void 0===e&&(e=1024);this.dims[0]=e;this.dims[1]=e;this.dims[2]=1}S(a,[{key:"getSources",value:function(a){for(var b=G.a.clone(this.stackInfo.voxelResolution),d=G.a.create(),c=G.a.create(),f=0;3>f;f++)d[f]=Math.floor(this.stackInfo.voxelResolution[f]/b[f]*this.stackInfo.lowerVoxelBound[f]),c[f]=Math.ceil(this.stackInfo.voxelResolution[f]/b[f]*this.stackInfo.upperVoxelBound[f]);
f=G.a.clone(c);f[0]+=Math.abs(d[0]);f[1]+=Math.abs(d[1]);f[2]=1;a=B.c.make({voxelSize:b,lowerVoxelBound:d,upperVoxelBound:c,chunkDataSize:f,vectorGraphicsSourceOptions:a});return[[this.chunkManager.getChunkSource(U,{spec:a,parameters:{baseUrls:this.baseUrls,owner:this.ownerInfo.owner,project:this.stackInfo.project,stack:this.stack,encoding:"points",matchCollection:this.matchCollection,zoffset:this.zoffset}})]]}}]);return a}(),K=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,
arguments))}r(b,a);S(b,[{key:"getVolume",value:function(a,b){return d(a,b)}},{key:"volumeCompleter",value:function(a,b){return q(a,b)}},{key:"getVectorGraphicsSource",value:function(a,b){return x(a,b)}},{key:"description",get:function(){return"Render"}}]);return b}(e.b)},function(n,e,b){function m(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,
writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return c});n=b(0);var u=b(16),r=b(93),a=function(){function a(a,b){for(var c=0;c<b.length;c++){var e=b[c];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}(),c=function(c){function e(a){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");
var c;c=(e.__proto__||Object.getPrototypeOf(e)).call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");c=!c||"object"!==typeof c&&"function"!==typeof c?this:c;c.gl=a;c.vertexBuffer=c.registerDisposer(u.a.fromData(a,new Float32Array([0,0,0,1,1,0,0,1,0,0,0,1,0,1,0,1,0,0,0,1,0,0,1,1]),a.ARRAY_BUFFER,a.STATIC_DRAW));c.colorBuffer=c.registerDisposer(u.a.fromData(a,new Float32Array([1,0,0,.5,1,0,0,.5,0,1,0,.5,0,1,0,.5,0,0,1,.5,0,0,1,.5]),a.ARRAY_BUFFER,
a.STATIC_DRAW));c.trivialColorShader=c.registerDisposer(b.i(r.c)(a));return c}m(e,c);a(e,[{key:"draw",value:function(a,b){b=void 0===b?!0:b;var c=this.trivialColorShader,h=this.gl;c.bind();h.uniformMatrix4fv(c.uniform("uProjectionMatrix"),!1,a);a=c.attribute("aVertexPosition");this.vertexBuffer.bindToVertexAttrib(a,4);c=c.attribute("aColor");this.colorBuffer.bindToVertexAttrib(c,4);b&&(h.colorMask(!1,!1,!1,!0),h.clearColor(0,0,0,0),h.clear(h.COLOR_BUFFER_BIT),h.colorMask(!0,!0,!0,!0),h.enable(h.BLEND),
h.blendFunc(h.ONE_MINUS_DST_ALPHA,h.DST_ALPHA));h.lineWidth(1);h.drawArrays(h.LINES,0,6);b&&h.disable(h.BLEND);h.disableVertexAttribArray(a);h.disableVertexAttribArray(c)}}],[{key:"get",value:function(a){return a.memoize.get("SliceViewPanel:AxesLineHelper",function(){return new e(a)})}}]);return e}(n.b)},function(n,e,b){n=new (b(69).a);e.a=n},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function a(a){var b,d,f;return function(g,h){if(void 0!==d&&(void 0===b||void 0===g||b.generation!==g.generation))return void 0===
b&&f.addConsumer(h),d;b=void 0;f=new c.e;return d=a(g,f).then(function(a){b=a;f=void 0;return a},function(a){f.isCanceled&&(d=f=void 0);throw a;})}}b.d(e,"c",function(){return w});e.b=function(b){var c=0;return a(function(a,f){return b(f).then(function(a){return{generation:++c,credentials:a}})})};b.d(e,"a",function(){return k});var c=b(13);n=b(0);var l=b(50),p=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=
!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}(),w=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}r(b,a);return b}(n.b),v=function(){function a(){m(this,a);this.providers=new Map}p(a,[{key:"register",value:function(a,b){this.providers.set(a,b)}},{key:"getCredentialsProvider",value:function(a,b){var d=this.providers.get(a);if(void 0===d)throw Error("No registered credentials provider: "+
JSON.stringify(a));return d(b)}}]);return a}(),k=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,new v))}r(b,a);p(b,[{key:"register",value:function(a,b){this.base.register(a,b)}}]);return b}(function(a){function b(a){m(this,b);var d=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));d.base=a;d.memoize=new l.a;return d}r(b,a);p(b,[{key:"getCredentialsProvider",value:function(a,b){var d=this;return this.memoize.get({key:a,parameters:b},function(){return d.registerDisposer(d.base.getCredentialsProvider(a,
b).addRef())})}}]);return b}(n.b))},function(n,e,b){b.d(e,"b",function(){return m});e.a="/ocp/ca";e.c="/nd/sd";var m=function r(){if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");};m.RPC_ID="ndstore/VolumeChunkSource"},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&
"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"b",function(){return w});b.d(e,"a",function(){return v});n=b(0);var a=b(3),c=b(177),l=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];
c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}(),p=function h(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),null!==a)return h(a,b,c)}else{if("value"in d)return d.value;b=d.get;return void 0===b?void 0:b.call(c)}},w=function(a){function b(a,c,g){m(this,b);var d=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));
d.context=a;d.element=c;d.visibility=g;d.gl=a.gl;a.addPanel(d);return d}r(b,a);l(b,[{key:"scheduleRedraw",value:function(){this.context.scheduleRedraw()}},{key:"setGLViewport",value:function(){var a=this.element,b=a.offsetLeft+a.clientLeft,c=a.clientWidth,g=a.clientHeight,e=a.offsetTop+a.clientTop+g,a=this.gl;a.enable(a.SCISSOR_TEST);e=this.context.canvas.height-e;a.viewport(b,e,c,g);a.scissor(b,e,c,g)}},{key:"disposed",value:function(){this.context.removePanel(this);p(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),
"disposed",this).call(this)}},{key:"visible",get:function(){return this.visibility.visible}}]);return b}(n.b),v=function(e){function g(d){m(this,g);var f=u(this,(g.__proto__||Object.getPrototypeOf(g)).call(this));f.container=d;f.canvas=document.createElement("canvas");f.updateStarted=new a.a;f.updateFinished=new a.a;f.panels=new Set;f.updatePending=null;f.needsRedraw=!1;var e=f.canvas;d.style.position="relative";e.style.position="absolute";e.style.top="0px";e.style.left="0px";e.style.width="100%";
e.style.height="100%";e.style.zIndex="0";d.appendChild(e);f.gl=b.i(c.a)(e);f.registerEventListener(window,"resize",f.onResize.bind(f));return f}r(g,e);l(g,[{key:"makeCanvasOverlayElement",value:function(){var a=document.createElement("div");a.style.position="absolute";a.style.top="0px";a.style.left="0px";a.style.width="100%";a.style.height="100%";a.style.zIndex="2";this.container.appendChild(a);return a}},{key:"disposed",value:function(){null!=this.updatePending&&(cancelAnimationFrame(this.updatePending),
this.updatePending=null)}},{key:"addPanel",value:function(a){this.panels.add(a)}},{key:"removePanel",value:function(a){this.panels.delete(a);a.dispose()}},{key:"onResize",value:function(){this.scheduleRedraw();for(var a=$jscomp.makeIterator(this.panels),b=a.next();!b.done;b=a.next())b.value.onResize()}},{key:"scheduleUpdate",value:function(){null===this.updatePending&&(this.updatePending=requestAnimationFrame(this.update.bind(this)))}},{key:"scheduleRedraw",value:function(){this.needsRedraw||(this.needsRedraw=
!0,this.scheduleUpdate())}},{key:"update",value:function(){this.updatePending=null;this.updateStarted.dispatch();if(this.needsRedraw){this.needsRedraw=!1;var a=this.gl,b=this.canvas;b.width=b.offsetWidth;b.height=b.offsetHeight;this.gl.clearColor(0,0,0,0);a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT);for(var b=$jscomp.makeIterator(this.panels),c=b.next();!c.done;c=b.next()){var c=c.value,g=c.element;c.visible&&0!==g.clientWidth&&0!==g.clientHeight&&0!==g.offsetWidth&&0!==g.offsetHeight&&(c.setGLViewport(),
c.draw())}a.disable(a.SCISSOR_TEST);this.gl.clearColor(1,1,1,1);this.gl.colorMask(!1,!1,!1,!0);a.clear(a.COLOR_BUFFER_BIT);this.gl.colorMask(!0,!0,!0,!0)}this.updateFinished.dispatch()}}]);return g}(n.b)},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==
typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"b",function(){return h});b.d(e,"a",function(){return g});b.d(e,"c",function(){return d});var a=b(43),c=b(44);n=b(0);var l=b(5),p=b(55),w=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=
c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}(),v=function q(a,b,d){null===a&&(a=Function.prototype);var c=Object.getOwnPropertyDescriptor(a,b);if(void 0===c){if(a=Object.getPrototypeOf(a),null!==a)return q(a,b,d)}else{if("value"in c)return c.value;b=c.get;return void 0===b?void 0:b.call(d)}},k=[l.f,l.e,l.o,l.p,"\nfloat computeHash(uint64_t x, vec4 a0, vec4 a1, float b, float c, float modulus, float scalar) {\n  x.low = unnormalizeUint8(x.low);\n  x.high = unnormalizeUint8(x.high);\n  float dotResult = imod(exactDot(a0, x.low) + exactDot(a1, x.high), modulus);\n  float dotResult2 = imod(dotResult * dotResult, modulus);\n  float y = imod(dotResult2 * c, modulus);\n  float modResult = imod(dotResult + y + b, modulus);\n  return fract(modResult * scalar);\n}\n"];
e.d=k;var h=function(d){function c(a,b){m(this,c);var d=u(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));d.gl=a;d.hashTable=b;d.hashFunctions=null;d.generation=-1;d.texture=null;b=b.hashFunctions.length;d.a=new Float32Array(16*b);d.b=new Float32Array(4*b+5);d.texture=a.createTexture();return d}r(c,d);w(c,[{key:"computeCoefficients",value:function(){var b=this.hashTable,d=b.hashFunctions;if(this.hashFunctions!==d){this.hashFunctions=d;for(var c=this.a,g=this.b,e=d.length,h=b.width,q=[1/h,
1/b.height],k=0;2>k;++k)g[4*e+k]=a.a,g[4*e+3+k]=q[k];g[4*e+2]=1/(b.entryStride*h);for(h=0;h<e;++h)for(q=d[h],k=0;2>k;++k){var l=q[k],p=4*h+2*k,x=4*(4*h+2*k);g[p]=l.b+(0===k?.5/b.entryStride:.5);g[p+1]=l.c;for(p=0;4>p;++p)c[x+p]=l.a0[p],c[x+4+p]=l.a1[p]}}}},{key:"copyToGPU",value:function(){this.computeCoefficients();var a=this.hashTable,d=a.generation;if(this.generation!==d){this.generation=d;var c=a.width,g=a.height,e=this.gl,d=this.texture;e.activeTexture(e.TEXTURE0+e.tempTextureUnit);e.bindTexture(e.TEXTURE_2D,
d);e.pixelStorei(e.UNPACK_ALIGNMENT,1);b.i(p.b)(e);var h=e.RGBA;a.tableWithMungedEmptyKey(function(b){e.texImage2D(e.TEXTURE_2D,0,h,c*a.entryStride,g,0,h,e.UNSIGNED_BYTE,new Uint8Array(b.buffer))});e.bindTexture(e.TEXTURE_2D,null)}}},{key:"disposed",value:function(){this.gl.deleteTexture(this.texture);this.texture=null;this.hashTable=this.gl=void 0;this.hashFunctions=null;v(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"disposed",this).call(this)}}],[{key:"get",value:function(a,b){var d=
this;return a.memoize.get(b,function(){return new d(a,b)})}}]);return c}(n.b),g=function(){function a(b,d){d=void 0===d?c.b:d;m(this,a);this.prefix=b;this.numAlternatives=d;$jscomp.initSymbol();this.textureUnitSymbol=Symbol.for("gpuhashtable:"+this.prefix);this.aName=this.prefix+"_a";this.bName=this.prefix+"_b";this.samplerName=this.prefix+"_sampler"}w(a,[{key:"defineShader",value:function(a){var b=this.aName,d=this.bName,c=this.samplerName,g=this.numAlternatives;a.addUniform("highp vec4",b,4*g);
a.addUniform("highp float",d,4*g+5);a.addTextureSampler2D(c,this.textureUnitSymbol);a.addFragmentCode(k);for(var e="",h=0;h<g;++h){for(var q=0;2>q;++q)var l=4*h+2*q,p=4*h+2*q,e=e+("\nfloat "+this.prefix+"_computeHash_"+h+"_"+q+"(uint64_t x) {\n  float primeModulus = "+d+"["+(4*g+q)+"];\n  float scalar = "+d+"["+(4*g+3+q)+"];\n  return computeHash(x,\n                     "+b+"["+p+"], "+b+"["+(p+1)+"],\n                     "+d+"["+l+"], "+d+"["+(l+1)+"],\n                     primeModulus, scalar);\n}\n");
e+="\nvec2 "+this.prefix+"_computeHash_"+h+"(uint64_t x) {\n  vec2 v;\n  v[0] = "+this.prefix+"_computeHash_"+h+"_0(x);\n  v[1] = "+this.prefix+"_computeHash_"+h+"_1(x);\n  return v;\n}\n"}e+="\nbool "+this.hasFunctionName+"(uint64_t x) {\n  float highOffset = "+d+"["+(4*g+2)+"];\n";for(b=0;b<g;++b)e+="\n  {\n    vec2 v = "+this.prefix+"_computeHash_"+b+"(x);\n    vec4 lowResult = texture2D("+c+", v);\n    vec4 highResult = texture2D("+c+", vec2(v.x + highOffset, v.y));\n    if (lowResult == x.low && highResult == x.high) {\n      return true;\n    }\n  }\n";
a.addFragmentCode(e+"\n  return false;\n}\n")}},{key:"enable",value:function(a,b,d){d.copyToGPU();var c=b.textureUnit(this.textureUnitSymbol);a.activeTexture(a.TEXTURE0+c);a.bindTexture(a.TEXTURE_2D,d.texture);a.uniform4fv(b.uniform(this.aName),d.a);a.uniform1fv(b.uniform(this.bName),d.b)}},{key:"disable",value:function(a,b){b=b.textureUnit(this.textureUnitSymbol);a.activeTexture(a.TEXTURE0+b);a.bindTexture(a.TEXTURE_2D,null)}},{key:"hasFunctionName",get:function(){return this.prefix+"_has"}}]);return a}(),
d=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}r(b,a);w(b,[{key:"defineShader",value:function(a){v(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"defineShader",this).call(this,a);for(var d=this.samplerName,c=this.numAlternatives,g="\nbool "+this.getFunctionName+"(uint64_t x, out uint64_t value) {\n  float highOffset = "+this.bName+"["+(4*c+2)+"];\n",e=0;e<c;++e)g+="\n  {\n    vec2 v = "+this.prefix+"_computeHash_"+e+"(x);\n    vec4 lowResult = texture2D("+
d+", v);\n    vec4 highResult = texture2D("+d+", vec2(v.x + highOffset, v.y));\n    if (lowResult == x.low && highResult == x.high) {\n      value.low = texture2D("+d+", vec2(v.x + 2.0 * highOffset, v.y));\n      value.high = texture2D("+d+", vec2(v.x + 3.0 * highOffset, v.y));\n      return true;\n    }\n  }\n";a.addFragmentCode(g+"\n  return false;\n}\n")}},{key:"getFunctionName",get:function(){return this.prefix+"_get"}}]);return b}(g)},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return k});var r=b(12);n=b(27);var a=b(4),c=b(13),l=b(94),p=b(178),w=b(179),v=function(){function a(a,b){for(var d=
0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}();b(190);var k=function(e){function g(a,c){if(!(this instanceof g))throw new TypeError("Cannot call a class as a function");var d=m(this,(g.__proto__||Object.getPrototypeOf(g)).call(this));d.manager=a;d.existingLayer=c;d.statusElement=document.createElement("div");d.submitElement=document.createElement("button");
d.namePromptElement=document.createElement("label");d.nameInputElement=document.createElement("input");d.volumeCancellationSource=void 0;d.sourceValid=!1;d.nameValid=!0;var f=d.content;f.classList.add("add-layer-overlay");var e=document.createElement("form");e.className="source-form";d.registerEventListener(e,"submit",function(a){a.preventDefault();d.validateSource(!0)});var h=document.createElement("label");h.textContent="Source:";a=d.sourceInput=d.registerDisposer(new p.b({completer:function(a,
b){return d.manager.dataSourceProvider.volumeCompleter(a,d.manager.chunkManager,b).then(function(a){return{completions:a.completions,makeElement:p.a,offset:a.offset,showSingleResult:!0}})},delay:0}));a.element.classList.add("add-layer-source");a.inputElement.addEventListener("blur",function(){d.validateSource(!1)});d.submitElement.disabled=!0;a.inputChanged.add(function(){var a=d.volumeCancellationSource;void 0!==a&&(a.cancel(),d.volumeCancellationSource=void 0);d.sourceValid=!1;d.submitElement.disabled=
!0;d.statusElement.textContent=""});e.appendChild(h);e.appendChild(a.element);b.i(l.a)(h,a.inputElement);h=b.i(w.a)();e.appendChild(h);f.appendChild(e);var k=d.statusElement,v=d.namePromptElement,E=d.nameInputElement,e=d.submitElement;k.className="dialog-status";h=document.createElement("form");h.className="name-form";v.textContent="Name:";E.className="add-layer-name";E.autocomplete="off";E.spellcheck=!1;E.type="text";d.registerEventListener(E,"input",function(){d.validateName()});e.type="submit";
b.i(l.a)(v,E);h.appendChild(v);h.appendChild(E);h.appendChild(e);f.appendChild(h);f.appendChild(k);void 0!==c?(void 0!==c.sourceUrl?(a.value=c.sourceUrl,d.validateSource()):d.sourceValid=!0,a.disabled=!0,E.value=c.name,d.validateName(),e.textContent="Save",E.focus()):(c=d.manager.layerManager.managedLayers,0<c.length&&(c=c[c.length-1],c instanceof r.b&&(c=c.sourceUrl,void 0!==c&&(f=d.manager.dataSourceProvider.findSourceGroup(c),a.value=c.substring(0,f),a.inputElement.setSelectionRange(0,f)))),a.inputElement.focus(),
e.textContent="Add Layer");d.registerEventListener(h,"submit",function(a){a.preventDefault();d.submit()});return d}u(g,e);v(g,[{key:"isNameValid",value:function(){var a=this.nameInputElement.value;if(""===a)return!1;a=this.manager.layerManager.getLayerByName(a);return void 0===a||a===this.existingLayer}},{key:"submit",value:function(){this.sourceValid&&this.isNameValid()&&(this.existingLayer?(this.existingLayer.name=this.nameInputElement.value,this.manager.layerManager.layersChanged.dispatch()):this.manager.layerManager.addManagedLayer(this.manager.getLayer(this.nameInputElement.value,
this.sourceInput.value)),this.dispose())}},{key:"validateName",value:function(){var a=this.nameInputElement;(this.nameValid=this.isNameValid())?(a.classList.add("valid-input"),a.classList.remove("invalid-input")):(a.classList.remove("valid-input"),a.classList.add("invalid-input"));this.validityChanged()}},{key:"validityChanged",value:function(){this.submitElement.disabled=!(this.nameValid&&this.sourceValid)}},{key:"validateSource",value:function(b){b=void 0===b?!1:b;var d=this,g=this.sourceInput.value;
if(""!==g){try{var e=this.manager.dataSourceProvider.suggestLayerName(g),h=this.nameInputElement;if(""===this.nameInputElement.value){for(var k=e,l=0;void 0!==this.manager.layerManager.getLayerByName(k);)k=e+ ++l;h.value=k;h.setSelectionRange(0,k.length);this.validateName()}b&&h.focus()}catch(E){this.setError(E.message);return}this.setInfo("Validating volume source...");var p=this.volumeCancellationSource=new c.a;this.manager.dataSourceProvider.getVolume(this.manager.chunkManager,g,void 0,p).then(function(b){p.isCanceled||
(d.volumeCancellationSource=void 0,d.sourceValid=!0,d.setInfo(a.a[b.volumeType].toLowerCase()+": "+(b.numChannels+"-channel "+a.b[b.dataType].toLowerCase())),d.validityChanged())}).catch(function(a){p.isCanceled||(d.volumeCancellationSource=void 0,d.setError(a.message))})}}},{key:"setInfo",value:function(a){this.statusElement.className="dialog-status dialog-status-info";this.statusElement.textContent=a}},{key:"setError",value:function(a){this.statusElement.className="dialog-status dialog-status-error";
this.statusElement.textContent=a}}]);return g}(n.b)},function(n,e,b){e.a=function(b,e){return function(m){m.style.flex=b;e(m)}};e.b=function(b,e){return function(m){m.style.display="flex";m.style.flexDirection=b;for(var a=$jscomp.makeIterator(e),c=a.next();!c.done;c=a.next()){var c=c.value,l=m.ownerDocument.createElement("div");m.appendChild(l);c(l)}}}},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"c",function(){return g});b.d(e,"b",function(){return d});b.d(e,"a",function(){return q});n=b(0);var a=b(1),c=b(2),l=b(3),
p=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}(),w=function(d){function f(b){m(this,f);var d=u(this,(f.__proto__||Object.getPrototypeOf(f)).call(this));d.changed=new l.a;var c=!0;null==b&&(b=a.a.create(),c=!1);d.size=b;d.valid=c;return d}r(f,d);p(f,[{key:"reset",value:function(){this.valid=!1;this.changed.dispatch()}},
{key:"setValid",value:function(){this.valid||(this.valid=!0,this.changed.dispatch())}},{key:"toJSON",value:function(){if(this.valid)return Array.prototype.slice.call(this.size)}},{key:"restoreState",value:function(a){try{b.i(c.g)(this.size,a),this.valid=!0,this.changed.dispatch()}catch(B){this.valid=!1,this.changed.dispatch()}}},{key:"toString",value:function(){return this.valid?this.size.toString():null}},{key:"voxelFromSpatial",value:function(b,d){return a.a.divide(b,d,this.size)}},{key:"spatialFromVoxel",
value:function(b,d){return a.a.multiply(b,d,this.size)}}]);return f}(n.b),v=a.a.create(),k=a.k.create(),h=function(d){function f(b,d){m(this,f);var c=u(this,(f.__proto__||Object.getPrototypeOf(f)).call(this));c.voxelCoordinates=null;c.changed=new l.a;null==b&&(b=new w);c.voxelSize=b;var g=!0;null==d&&(d=a.a.create(),g=!1);c.spatialCoordinates=d;c.spatialCoordinatesValid=g;c.registerDisposer(b);c.registerDisposer(b.changed.add(function(){c.handleVoxelSizeChanged()}));return c}r(f,d);p(f,[{key:"reset",
value:function(){this.spatialCoordinatesValid=!1;this.voxelCoordinates=null;this.voxelSize.reset();this.changed.dispatch()}},{key:"getVoxelCoordinates",value:function(b){var d=this.voxelCoordinates;if(d)a.a.copy(b,d);else if(this.valid)this.voxelSize.voxelFromSpatial(b,this.spatialCoordinates);else return!1;return!0}},{key:"setVoxelCoordinates",value:function(b){var d=this.voxelSize;d.valid?(d.spatialFromVoxel(this.spatialCoordinates,b),this.markSpatialCoordinatesChanged()):(d=this.voxelCoordinates)?
a.a.copy(d,b):this.voxelCoordinates=a.a.clone(b);this.changed.dispatch()}},{key:"markSpatialCoordinatesChanged",value:function(){this.spatialCoordinatesValid=!0;this.voxelCoordinates=null;this.changed.dispatch()}},{key:"handleVoxelSizeChanged",value:function(){null==this.voxelCoordinates||this.spatialCoordinatesValid||(this.voxelSize.spatialFromVoxel(this.spatialCoordinates,this.voxelCoordinates),this.spatialCoordinatesValid=!0);this.voxelCoordinates=null;this.changed.dispatch()}},{key:"toJSON",value:function(){var a=
!0,b=this.voxelSize.toJSON(),d={};void 0!==b&&(a=!1,d.voxelSize=b);this.voxelCoordinatesValid?(this.getVoxelCoordinates(v),d.voxelCoordinates=Array.prototype.slice.call(v),a=!1):this.spatialCoordinatesValid&&(d.spatialCoordinates=Array.prototype.slice.call(this.spatialCoordinates),a=!1);if(!a)return d}},{key:"restoreState",value:function(d){var f=this;b.i(c.a)(d);b.i(c.d)(d,"voxelSize",function(a){void 0!==a&&f.voxelSize.restoreState(a)});this.spatialCoordinatesValid=!1;b.i(c.d)(d,"voxelCoordinates",
function(d){void 0!==d&&f.setVoxelCoordinates(b.i(c.g)(a.a.create(),d))});b.i(c.d)(d,"spatialCoordinates",function(a){void 0!==a&&(b.i(c.g)(f.spatialCoordinates,a),f.markSpatialCoordinatesChanged())})}},{key:"snapToVoxel",value:function(){if(this.valid){for(var a=this.spatialCoordinates,b=this.voxelSize.size,d=0;3>d;++d){var c=b[d];a[d]=Math.round(a[d]/c)*c}this.changed.dispatch()}else if(a=this.voxelCoordinates,null!=a){for(b=0;3>b;++b)a[b]=Math.round(a[b]);this.changed.dispatch()}}},{key:"valid",
get:function(){return this.spatialCoordinatesValid&&this.voxelSize.valid}},{key:"voxelCoordinatesValid",get:function(){return this.valid||null!=this.voxelCoordinates}}]);return f}(n.b),g=function(d){function f(b){m(this,f);var d=u(this,(f.__proto__||Object.getPrototypeOf(f)).call(this));d.changed=new l.a;null==b&&(b=a.k.create());d.orientation=b;return d}r(f,d);p(f,[{key:"toJSON",value:function(){var a=this.orientation;if(0!==a[0]||0!==a[1]||0!==a[2]||1!==a[3])return Array.prototype.slice.call(this.orientation)}},
{key:"restoreState",value:function(d){try{b.i(c.g)(this.orientation,d),a.k.normalize(this.orientation,this.orientation)}catch(B){a.k.identity(this.orientation)}this.changed.dispatch()}},{key:"reset",value:function(){a.k.identity(this.orientation);this.changed.dispatch()}},{key:"snap",value:function(){var b=a.l.create();a.l.fromQuat(b,this.orientation);for(var d=[!1,!1,!1],c=0;3>c;++c){for(var f=0,g=0,e=0;3>e;++e){var h=b[3*c+e];b[3*c+e]=0;!d[e]&&Math.abs(h)>Math.abs(f)&&(f=h,g=e)}b[3*c+g]=Math.sign(f);
d[g]=!0}a.k.fromMat3(this.orientation,b);this.changed.dispatch()}}],[{key:"makeRelative",value:function(b,d){var c=new f(a.k.multiply(a.k.create(),b.orientation,d)),g=!1;c.registerDisposer(b.changed.add(function(){g||(e=!0,a.k.multiply(c.orientation,b.orientation,d),c.changed.dispatch(),e=!1)}));var e=!1,h=a.k.invert(a.k.create(),d);c.registerDisposer(c.changed.add(function(){e||(g=!0,a.k.multiply(b.orientation,c.orientation,h),b.changed.dispatch(),g=!1)}));return c}}]);return f}(n.b),d=function(d){function f(a,
b){m(this,f);var d=u(this,(f.__proto__||Object.getPrototypeOf(f)).call(this));d.changed=new l.a;null==a&&(a=new h);d.position=a;null==b&&(b=new g);d.orientation=b;d.registerDisposer(d.position);d.registerDisposer(d.orientation);d.registerDisposer(d.position.changed.add(d.changed.dispatch));d.registerDisposer(d.orientation.changed.add(d.changed.dispatch));return d}r(f,d);p(f,[{key:"reset",value:function(){this.position.reset();this.orientation.reset()}},{key:"toMat4",value:function(b){a.c.fromRotationTranslation(b,
this.orientation.orientation,this.position.spatialCoordinates)}},{key:"toJSON",value:function(){var a=this.position.toJSON(),b=this.orientation.toJSON();if(void 0!==a||void 0!==b)return{position:a,orientation:b}}},{key:"restoreState",value:function(a){var d=this;b.i(c.a)(a);b.i(c.d)(a,"position",function(a){void 0!==a&&d.position.restoreState(a)});b.i(c.d)(a,"orientation",function(a){void 0!==a&&d.orientation.restoreState(a)})}},{key:"snap",value:function(){this.orientation.snap();this.position.snapToVoxel();
this.changed.dispatch()}},{key:"translateAbsolute",value:function(b){a.a.add(this.position.spatialCoordinates,this.position.spatialCoordinates,b);this.position.changed.dispatch()}},{key:"translateRelative",value:function(b){this.valid&&(a.a.transformQuat(v,b,this.orientation.orientation),a.a.add(this.position.spatialCoordinates,this.position.spatialCoordinates,v),this.position.changed.dispatch())}},{key:"translateVoxelsRelative",value:function(b){if(this.valid){var d=a.a.create();a.a.transformQuat(d,
b,this.orientation.orientation);a.a.multiply(d,d,this.position.voxelSize.size);a.a.add(this.position.spatialCoordinates,this.position.spatialCoordinates,d);this.position.changed.dispatch()}}},{key:"rotateRelative",value:function(b,d){var c=a.k.create();a.k.setAxisAngle(c,b,d);b=this.orientation.orientation;a.k.multiply(b,b,c);this.orientation.changed.dispatch()}},{key:"rotateAbsolute",value:function(b,d,c){var f=a.k.create();a.k.setAxisAngle(f,b,d);b=this.orientation.orientation;if(void 0!==c){d=
this.position.spatialCoordinates;var g=a.a.subtract(v,c,d),e=a.k.invert(k,b);a.a.transformQuat(g,g,e);a.k.multiply(b,f,b);a.a.transformQuat(d,g,b);a.a.subtract(d,c,d);this.position.changed.dispatch()}else a.k.multiply(b,f,b);this.orientation.changed.dispatch()}},{key:"valid",get:function(){return this.position.valid}}]);return f}(n.b),f=function(){function a(b,d){b=void 0===b?Number.NaN:b;d=void 0===d?b:d;m(this,a);this.value_=b;this.defaultValue=d;this.changed=new l.a}p(a,[{key:"toJSON",value:function(){var a=
this.value_,b=this.defaultValue;if(!(Number.isNaN(a)&&Number.isNaN(b)||a===b))return a}},{key:"restoreState",value:function(a){"number"===typeof a&&Number.isFinite(a)&&0<a?this.value=a:this.value=this.defaultValue}},{key:"reset",value:function(){this.value=this.defaultValue}},{key:"zoomBy",value:function(a){var b=this.value_;Number.isNaN(b)||(this.value=b*a)}},{key:"value",get:function(){return this.value_},set:function(a){a!==this.value_&&(this.value_=a,this.changed.dispatch())}}]);return a}(),q=
function(g){function e(a,b){a=void 0===a?new d:a;b=void 0===b?Number.NaN:b;m(this,e);var c=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));c.pose=a;c.changed=new l.a;c.zoomFactor="number"===typeof b?new f(b):b;c.registerDisposer(a);c.registerDisposer(c.pose.changed.add(function(){c.changed.dispatch()}));c.registerDisposer(c.zoomFactor.changed.add(function(){c.changed.dispatch()}));c.registerDisposer(c.voxelSize.changed.add(function(){c.handleVoxelSizeChanged()}));c.handleVoxelSizeChanged();
return c}r(e,g);p(e,[{key:"reset",value:function(){this.pose.reset();this.zoomFactor.reset()}},{key:"setZoomFactorFromVoxelSize",value:function(){this.voxelSize.valid&&(this.zoomFactor.value=Math.min.apply(null,this.voxelSize.size))}},{key:"handleVoxelSizeChanged",value:function(){Number.isNaN(this.zoomFactor.value)&&this.setZoomFactorFromVoxelSize()}},{key:"toMat4",value:function(b){this.pose.toMat4(b);var d=this.zoomFactor.value;a.c.scale(b,b,a.a.fromValues(d,d,d))}},{key:"toJSON",value:function(){var a=
this.pose.toJSON(),b=this.zoomFactor.toJSON();if(void 0!==a||void 0!==b)return{pose:a,zoomFactor:b}}},{key:"restoreState",value:function(a){var d=this;try{b.i(c.a)(a),b.i(c.d)(a,"pose",function(a){void 0!==a&&d.pose.restoreState(a)}),b.i(c.d)(a,"zoomFactor",function(a){void 0!==a&&d.zoomFactor.restoreState(a)}),this.handleVoxelSizeChanged(),this.changed.dispatch()}catch(z){this.reset()}}},{key:"zoomBy",value:function(a){this.zoomFactor.zoomBy(a)}},{key:"voxelSize",get:function(){return this.pose.position.voxelSize}},
{key:"position",get:function(){return this.pose.position}},{key:"valid",get:function(){return this.pose.valid}}]);return e}(n.b)},function(n,e,b){b.d(e,"a",function(){return u});var m=function(){function b(a,b){for(var c=0;c<b.length;c++){var e=b[c];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(a,c,e){c&&b(a.prototype,c);e&&b(a,e);return a}}(),u=function(){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");
this.renderLayers=[null];this.values=[0,0,0];this.nextPickID=1}m(b,[{key:"clear",value:function(){this.renderLayers.length=1;this.values.length=3;this.nextPickID=1}},{key:"registerUint64",value:function(a,b,e){return this.register(a,void 0===e?1:e,b.low,b.high)}},{key:"register",value:function(a,b,e,p){var c=this.renderLayers,l=this.values,k=this.nextPickID;this.nextPickID+=void 0===b?1:b;b=c.length;c[b]=a;a=3*b;l[a]=k;l[a+1]=void 0===e?0:e;l[a+2]=void 0===p?0:p;return k}},{key:"setMouseState",value:function(a,
b){for(var c=this.renderLayers,e=this.values,m=0,v=c.length-1;m<v;){var k=Math.ceil(m+(v-m)/2);e[3*k]>b?v=k-1:m=k}c=a.pickedRenderLayer=c[m];m*=3;b=a.pickedOffset=b-e[m];v=a.pickedValue;v.low=e[m+1];v.high=e[m+2];null!==c&&c.updateMouseState(a,v,b)}}]);return b}()},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return g});n=b(71);var r=b(49),a=b(15),c=b(1),l=b(36),p=b(90),w=b(174),v=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&a(b.prototype,d);c&&
a(b,c);return b}}(),k=function f(a,b,c){null===a&&(a=Function.prototype);var g=Object.getOwnPropertyDescriptor(a,b);if(void 0===g){if(a=Object.getPrototypeOf(a),null!==a)return f(a,b,c)}else{if("value"in g)return g.value;b=g.get;return void 0===b?void 0:b.call(c)}};b(194);b(21);var h=c.a.create(),g=function(f){function g(f,e,k){if(!(this instanceof g))throw new TypeError("Cannot call a class as a function");var q=m(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,f,e,k.visibility));q.viewer=
k;q.mouseX=0;q.mouseY=0;q.mouseStateUpdater=q.updateMouseState.bind(q);q.inputEventMap=k.inputEventMap;e.classList.add("neuroglancer-rendered-data-panel");e.classList.add("neuroglancer-panel");e.classList.add("neuroglancer-noselect");q.registerDisposer(new r.a(e));q.registerDisposer(new l.b(e,q.inputEventMap));q.registerDisposer(new p.a(e,q.inputEventMap));q.registerEventListener(e,"mousemove",q.onMousemove.bind(q));q.registerEventListener(e,"mouseleave",q.onMouseout.bind(q));b.i(a.b)(e,"snap",function(){q.navigationState.pose.snap()});
b.i(a.b)(e,"zoom-in",function(){q.navigationState.zoomBy(.5)});b.i(a.b)(e,"zoom-out",function(){q.navigationState.zoomBy(2)});for(f={axis:0};3>f.axis;f={axis:f.axis},++f.axis){k=c.n[f.axis];for(var v={},x=$jscomp.makeIterator([-1,1]),y=x.next();!y.done;v={sign:v.sign,tempOffset:v.tempOffset},y=x.next())v.sign=y.value,y=0>v.sign?"-":"+",b.i(a.b)(e,"rotate-relative-"+k+y,function(a,b){return function(){q.navigationState.pose.rotateRelative(c.g[a.axis],.1*b.sign)}}(f,v)),v.tempOffset=c.a.create(),b.i(a.b)(e,
""+k+y,function(a,b){return function(){var c=q.navigationState,f=a.tempOffset;f[0]=0;f[1]=0;f[2]=0;f[b.axis]=a.sign;c.pose.translateVoxelsRelative(f)}}(v,f))}b.i(a.b)(e,"zoom-via-wheel",function(a){a=a.detail;q.onMousemove(a);q.zoomByMouse(b.i(w.a)(a))});f={};k=$jscomp.makeIterator([1,10]);for(v=k.next();!v.done;f={amount:f.amount},v=k.next())f.amount=v.value,b.i(a.b)(e,"z+"+f.amount+"-via-wheel",function(a){return function(b){var c=b.detail;b=q.navigationState;c=0!==c.deltaY?c.deltaY:c.deltaX;h[0]=
0;h[1]=0;h[2]=(0<c?-1:1)*a.amount;b.pose.translateVoxelsRelative(h)}}(f));b.i(a.b)(e,"move-to-mouse-position",function(){var a=q.viewer.mouseState;if(a.updateUnconditionally()){var b=q.navigationState.pose.position;c.a.copy(b.spatialCoordinates,a.position);b.changed.dispatch()}});b.i(a.b)(e,"snap",function(){return q.navigationState.pose.snap()});return q}u(g,f);v(g,[{key:"onMouseout",value:function(a){a=this.viewer.mouseState;a.updater=void 0;a.setActive(!1)}},{key:"onMousemove",value:function(a){var b=
this.element;a.target===b&&(this.mouseX=a.offsetX-b.clientLeft,this.mouseY=a.offsetY-b.clientTop,a=this.viewer.mouseState,a.updater=this.mouseStateUpdater,a.triggerUpdate())}},{key:"disposed",value:function(){var a=this.viewer.mouseState;a.updater===this.mouseStateUpdater&&(a.updater=void 0,a.setActive(!1));k(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"disposed",this).call(this)}}]);return g}(n.b)},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");
}function u(a){return a-Math.floor(a)}b.d(e,"b",function(){return v});b.d(e,"a",function(){return g});var r=b(43),a=b(72),c=b(161),l=b(3),p=b(5),w=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}(),v=function(){function b(a){m(this,b);this.prefix=a;this.aName=this.prefix+"_a";this.bName=this.prefix+"_b"}w(b,
[{key:"defineShader",value:function(b){var d=this.aName,c=this.bName;b.addUniform("highp vec4",d,4);b.addUniform("highp float",c,4);b.addFragmentCode(p.e);b.addFragmentCode(a.d);b.addFragmentCode(p.q);for(var f="\nvec3 "+this.prefix+"(uint64_t x) {\n  vec2 v;\n  float primeModulus = float("+r.a+");\n",g=0;2>g;++g)var e=2*g,h=2*g,f=f+("\n  v["+g+"] = computeHash(x,\n                        "+d+"["+h+"], "+d+"["+(h+1)+"],\n                        "+c+"["+e+"], "+c+"["+(e+1)+"],\n                        primeModulus, 1.0 / 256.0);\n");
b.addFragmentCode(f+"\n  vec3 hsv = vec3(v.x, 0.5 + v.y * 0.5, 1.0);\n  return hsvToRgb(hsv);\n}\n")}},{key:"enable",value:function(a,b,d){a.uniform4fv(b.uniform(this.aName),d.a_);a.uniform1fv(b.uniform(this.bName),d.b_)}}]);return b}(),k=new Float32Array(2),h=new Float32Array(3),g=function(){function a(b){m(this,a);this.a_=new Float32Array(16);this.b_=new Float32Array(4);this.changed=new l.a;null==b?(this.hashFunctions=Array(2),this.randomize_()):this.hashFunctions=b;this.computeGPUCoefficients_()}
w(a,[{key:"compute",value:function(a,d){var f=d.low;d=d.high;for(var g=this.hashFunctions,e=0;2>e;++e)k[e]=u(g[e].compute(f,d)/256);b.i(c.a)(a,k[0],.5+.5*k[1],1);return a}},{key:"computeCssColor",value:function(a){this.compute(h,a);return"rgb("+100*h[0]+"%,"+100*h[1]+"%,"+100*h[2]+"%)"}},{key:"debugCompute",value:function(a,b){var d=b.low;b=b.high;for(var c=this.b_,f=r.a,g=0;2>g;++g){for(var e=2*g,h=2*g,k=new Float32Array(2),q=0;4>q;++q)k[0]+=this.a_[4*h+q]*(d>>8*q&255),k[1]+=this.a_[4*(h+1)+q]*(b>>
8*q&255);var h=(k[0]+k[1])%f,q=h*h%f,l=q*c[e+1]%f,p=(c[e]+h+l)%f;console.log("b = "+c[e]+", sums="+k[0]+" "+k[1]+", dotResult="+h+", "+("prod = "+h*h+" dotResult2="+q+", y="+l+", ")+("modResult="+p));a[g]=u(1/256*p)}return a}},{key:"randomize_",value:function(){for(var a=0;2>a;++a)this.hashFunctions[a]=r.b.generate()}},{key:"randomize",value:function(){this.randomize_();this.computeGPUCoefficients_();this.changed.dispatch()}},{key:"toString",value:function(){return"new SegmentColorHash(["+this.hashFunctions+
"])"}},{key:"computeGPUCoefficients_",value:function(){for(var a=this.hashFunctions,b=this.a_,d=this.b_,c=0;2>c;++c){var g=a[c],e=2*c,h=8*c;d[e]=1*g.b;d[e+1]=1*g.c;for(e=0;4>e;++e)b[h+e]=1*g.a0[e],b[h+4+e]=1*g.a1[e]}}}],[{key:"getDefault",value:function(){return new a([new r.b(Float32Array.of(609,2364,3749,2289),Float32Array.of(2840,1186,3660,1833),1718,1109),new r.b(Float32Array.of(3466,3835,3345,2040),Float32Array.of(3382,901,18,3444),1534,1432)])}}]);return a}()},function(n,e,b){function m(a,b){if("function"!==
typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return c});var u=b(7);n=b(6);var r=function(){function a(a,b){for(var c=0;c<b.length;c++){var e=b[c];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,
e.key,e)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}(),a=function w(a,b,c){null===a&&(a=Function.prototype);var g=Object.getOwnPropertyDescriptor(a,b);if(void 0===g){if(a=Object.getPrototypeOf(a),null!==a)return w(a,b,c)}else{if("value"in g)return g.value;b=g.get;return void 0===b?void 0:b.call(c)}};e=this&&this.__decorate||function(a,b,c,e){var g=arguments.length,d=3>g?b:null===e?e=Object.getOwnPropertyDescriptor(b,c):e,f;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)d=
Reflect.decorate(a,b,c,e);else for(var h=a.length-1;0<=h;h--)if(f=a[h])d=(3>g?f(d):3<g?f(b,c,d):f(b,c))||d;return 3<g&&d&&Object.defineProperty(b,c,d),d};var c=l=function(b){function c(a,b){b=void 0===b?{}:b;if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");var g;g=(c.__proto__||Object.getPrototypeOf(c)).call(this,a,b);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");g=!g||"object"!==typeof g&&"function"!==typeof g?this:
g;g.updatingValue_=!1;void 0!==a&&(g.base=new u.a(b.value),g.setupChangedHandler());return g}m(c,b);r(c,[{key:"initializeCounterpart",value:function(b,e){e=void 0===e?{}:e;e.value=this.value;a(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"initializeCounterpart",this).call(this,b,e)}},{key:"setupChangedHandler",value:function(){var a=this;this.registerDisposer(this.base.changed.add(function(){if(a.updatingValue_)a.updatingValue_=!1;else{var b=a.rpc;null!==b&&b.invoke("SharedWatchableValue.changed",
{id:a.rpcId,value:a.value})}}))}},{key:"value",get:function(){return this.base.value},set:function(a){this.base.value=a}},{key:"changed",get:function(){return this.base.changed}}],[{key:"makeFromExisting",value:function(a,b){var c=new l;c.base=b;c.setupChangedHandler();c.initializeCounterpart(a);return c}},{key:"make",value:function(a,b){return l.makeFromExisting(a,new u.a(b))}}]);return c}(n.c),c=l=e([b.i(n.d)("SharedWatchableValue")],c);b.i(n.e)("SharedWatchableValue.changed",function(a){var b=
this.get(a.id);b.updatingValue_=!0;b.base.value=a.value;b.updatingValue_=!1});var l},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);
a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function a(a){switch(a){case h.b.FLOAT32:return C.e;default:throw Error("Data type not supported by WebGL: ${DataType[dataType]}");}}e.a=function(a){return new k.b(void 0===a?"void main() {\n  emitDefault();\n}\n":a,f.h)};b.d(e,"b",function(){return S});b.d(e,"c",function(){return I});b.d(e,"d",function(){return P});b.d(e,"f",
function(){return Q});var c=b(18);n=b(9);var l=b(30),p=b(39),w=b(143),v=b(46),k=b(7),h=b(28),g=b(0),d=b(1),f=b(2),q=b(20),x=b(3),F=b(16),C=b(25),B=b(26),z=b(5),E=function X(a,b,d){null===a&&(a=Function.prototype);var c=Object.getOwnPropertyDescriptor(a,b);if(void 0===c){if(a=Object.getPrototypeOf(a),null!==a)return X(a,b,d)}else{if("value"in c)return c.value;b=c.get;return void 0===b?void 0:b.call(d)}},y=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||
!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}(),H=b(60),G=d.c.create(),J=new Float32Array(4);e.e="//NEUROGLANCER_SKELETON_LAYER_FRAGMENT_MAIN_START";var D=function(a){function c(a){m(this,c);var d=u(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));d.vertexAttributes=a;d.shaders=new Map;d.shaderGeneration=-1;d.vertexAttributesKey=b.i(f.f)(d.vertexAttributes);return d}r(c,a);y(c,[{key:"defineShader",
value:function(a,b){a.addUniform("highp vec4","uColor");a.addUniform("highp mat4","uProjection");a.addUniform("highp vec4","uPickID");var d="\ngl_Position = uProjection * vec4(aVertex0, 1.0);\n";a.addFragmentCode("\nvec4 segmentColor() {\n  return uColor;\n}\nvoid emitRGB(vec3 color) {\n  emit(vec4(color * uColor.a, uColor.a), uPickID);\n}\nvoid emitDefault() {\n  emit(uColor, uPickID);\n}\n");a.addFragmentCode(H);this.vertexAttributes.forEach(function(b,c){a.addAttribute("highp "+b.glslDataType,
"aVertex"+c);0!==c&&(a.addVarying("highp "+b.glslDataType,"vVertex"+c),d+="vVertex"+c+" = aVertex"+c+";\n",a.addFragmentCode("#define "+b.name+" vVertex"+c+"\n"))});a.setVertexMain(d);a.setFragmentMainFunction("//NEUROGLANCER_SKELETON_LAYER_FRAGMENT_MAIN_START\n"+b)}},{key:"beginLayer",value:function(a,b,c,f){c=d.c.multiply(G,c.dataToDevice,f);a.uniformMatrix4fv(b.uniform("uProjection"),!1,c)}},{key:"getShader",value:function(a,d,c){var f=this;return this.registerDisposer(a.memoize.get("skeleton/SkeletonShaderManager:"+
b.i(q.a)(d)+":"+this.vertexAttributesKey+":"+c,function(){var b=new B.a(a);b.require(d);f.defineShader(b,c);return b.build()}))}},{key:"setColor",value:function(a,b,d){a.uniform4fv(b.uniform("uColor"),d)}},{key:"setPickID",value:function(a,d,c){a.uniform4fv(d.uniform("uPickID"),b.i(z.m)(J,c))}},{key:"drawSkeleton",value:function(a,b,d){for(var c=this.vertexAttributes,f=c.length,g=d.vertexAttributeOffsets,e=0;e<f;++e){var h=c[e];d.vertexBuffer.bindToVertexAttrib(b.attribute("aVertex"+e),h.numComponents,
h.webglDataType,!1,0,g[e])}d.indexBuffer.bind();a.drawElements(a.LINES,d.numIndices,a.UNSIGNED_INT,0)}},{key:"endLayer",value:function(a,b){for(var d=this.vertexAttributes.length,c=0;c<d;++c)a.disableVertexAttribArray(b.attribute("aVertex"+c))}}]);return c}(g.b),S=function(f){function g(c,f,e,h){m(this,g);var k=u(this,(g.__proto__||Object.getPrototypeOf(g)).call(this));k.chunkManager=c;k.source=f;k.voxelSizeObject=e;k.displayState=h;k.tempMat=d.c.create();k.redrawNeeded=new x.a;k.fallbackFragmentMain=
"void main() {\n  emitDefault();\n}\n";b.i(p.c)(h,k);k.displayState.shaderError.value=void 0;k.registerDisposer(h.fragmentMain.changed.add(function(){k.displayState.shaderError.value=void 0;k.redrawNeeded.dispatch()}));c=k.sharedObject=k.registerDisposer(new p.d(c,h));c.RPC_TYPE_ID=w.a;c.initializeCounterpartWithChunkManager({source:f.addCounterpartRef()});c=k.vertexAttributes=[U];f=$jscomp.makeIterator(f.vertexAttributes);for(e=f.next();!e.done;e=f.next())h=$jscomp.makeIterator(e.value),e=h.next().value,
h=h.next().value,c.push({name:e,dataType:h.dataType,numComponents:h.numComponents,webglDataType:a(h.dataType),glslDataType:1<h.numComponents?"vec"+h.numComponents:"float"});return k}r(g,f);y(g,[{key:"getShader",value:function(a,b,d){var c=this.displayState.fragmentMain,f=c.changed.count,g=b.shaders;b.shaderGeneration!==f&&(g.clear(),b.shaderGeneration=f);f=g.get(d);if(void 0===f){f=null;try{f=b.getShader(a,d,c.value),this.fallbackFragmentMain=c.value,this.displayState.shaderError.value=null}catch(Fa){this.displayState.shaderError.value=
Fa;try{f=b.getShader(a,d,this.fallbackFragmentMain)}catch(pa){}}g.set(d,f)}return f}},{key:"draw",value:function(a,f,g,e){void 0===e&&(e=a.emitColor?1:5);var h=this.gl,k=this.source,q=this.displayState,l=Math.min(1,q.objectAlpha.value);if(!(0>=l)){var v=this.getShader(h,g,a.emitter);if(null!==v){v.bind();var x=this.tempMat;d.c.identity(x);k.skeletonVertexCoordinatesInVoxels&&d.c.scale(x,x,this.voxelSizeObject.size);d.c.multiply(x,this.displayState.objectToDataTransform.transform,x);g.beginLayer(h,
v,a,x);var k=k.chunks,y=a.pickIDs;h.lineWidth(e);b.i(p.e)(q,k,function(d,e,k){k.state===c.b.GPU_MEMORY&&(a.emitColor&&g.setColor(h,v,b.i(p.f)(q,d,l)),a.emitPickID&&g.setPickID(h,v,y.registerUint64(f,e)),g.drawSkeleton(h,v,k))});g.endLayer(h,v)}}}},{key:"visibility",get:function(){return this.sharedObject.visibility}},{key:"gl",get:function(){return this.chunkManager.chunkQueueManager.gl}}]);return g}(g.b),I=function(a){function b(a){m(this,b);var d=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));
d.base=a;d.renderHelper=d.registerDisposer(new D(d.base.vertexAttributes));d.registerDisposer(a);d.registerDisposer(a.redrawNeeded.add(function(){d.redrawNeeded.dispatch()}));d.setReady(!0);d.registerDisposer(a.visibility.add(d.visibility));return d}r(b,a);y(b,[{key:"draw",value:function(a){this.base.draw(a,this,this.renderHelper)}},{key:"gl",get:function(){return this.base.gl}},{key:"isTransparent",get:function(){return 1>this.base.displayState.objectAlpha.value}}]);return b}(l.a),P=function(a){function b(a){m(this,
b);var d=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));d.base=a;d.renderHelper=d.registerDisposer(new D(d.base.vertexAttributes));d.registerDisposer(a);d.registerDisposer(a.redrawNeeded.add(function(){d.redrawNeeded.dispatch()}));d.setReady(!0);d.registerDisposer(a.visibility.add(d.visibility));return d}r(b,a);y(b,[{key:"draw",value:function(a){this.base.draw(a,this,this.renderHelper,10)}},{key:"gl",get:function(){return this.base.gl}}]);return b}(v.b),U={dataType:h.b.FLOAT32,numComponents:3,
name:"",webglDataType:C.e,glslDataType:"vec3"},V=function(a){function b(a,d){m(this,b);a=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));a.vertexAttributes=d.vertexAttributes;var c=a.indices=d.indices;a.vertexAttributeOffsets=d.vertexAttributeOffsets;a.numIndices=c.length;return a}r(b,a);y(b,[{key:"copyToGPU",value:function(a){E(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"copyToGPU",this).call(this,a);this.vertexBuffer=F.a.fromData(a,this.vertexAttributes,a.ARRAY_BUFFER,
a.STATIC_DRAW);this.indexBuffer=F.a.fromData(a,this.indices,a.ELEMENT_ARRAY_BUFFER,a.STATIC_DRAW)}},{key:"freeGPUMemory",value:function(a){E(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"freeGPUMemory",this).call(this,a);this.vertexBuffer.dispose();this.indexBuffer.dispose()}}]);return b}(n.d),L=new Map,Q=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}r(b,a);y(b,[{key:"getChunk",value:function(a){return new V(this,a)}},
{key:"skeletonVertexCoordinatesInVoxels",get:function(){return!0}},{key:"vertexAttributes",get:function(){return L}}]);return b}(n.c)},function(n,e,b){e.a=function(b,e,r,a,c,l){for(var p=0,m=0,v=1,k=1,h=0;3>h;++h)var g=c[h],d=a[h],f=g%d,p=p+Math.floor(g/d)*v,v=v*Math.ceil(r[h]/d),m=m+f*k,k=k*d;a=e+2*p;r=b[a];a=b[a+1];c=r&16777215;r=r>>24&255;0<r&&(c+=l*(b[(e+a&16777215)+Math.floor(m*r/32)]>>m*r%32&(1<<r)-1));return c}},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");
}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return w});
b.d(e,"b",function(){return v});n=b(14);b=b(0);var a=function h(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),null!==a)return h(a,b,c)}else{if("value"in d)return d.value;b=d.get;return void 0===b?void 0:b.call(c)}},c=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&
a(b.prototype,d);c&&a(b,c);return b}}();$jscomp.initSymbol();var l=Symbol("SingleTextureVolumeChunk.textureUnit");$jscomp.initSymbol();var p=Symbol("SingleTextureVolumeChunk.textureLayout"),w=function(a){function b(a){m(this,b);var d=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));d.shaderKey=a;return d}r(b,a);c(b,[{key:"defineShader",value:function(a){a.addTextureSampler2D("uVolumeChunkSampler",l)}},{key:"beginDrawing",value:function(a,b){var d=b.textureUnit(l);a.activeTexture(a.TEXTURE0+
d);b[p]=null}},{key:"endDrawing",value:function(a,b){a.bindTexture(a.TEXTURE_2D,null);b[p]=null}},{key:"bindChunk",value:function(a,b,c){var d=c.textureLayout;b[p]!==d&&(b[p]=d,this.setupTextureLayout(a,b,d));a.bindTexture(a.TEXTURE_2D,c.texture)}},{key:"beginSource",value:function(a,b){}}]);return b}(b.b),v=function(b){function g(a,b){m(this,g);a=u(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,a,b));a.texture=null;a.data=b.data;return a}r(g,b);c(g,[{key:"copyToGPU",value:function(b){a(g.prototype.__proto__||
Object.getPrototypeOf(g.prototype),"copyToGPU",this).call(this,b);var d=this.texture=b.createTexture();b.bindTexture(b.TEXTURE_2D,d);this.setTextureData(b);b.bindTexture(b.TEXTURE_2D,null)}},{key:"freeGPUMemory",value:function(b){a(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"freeGPUMemory",this).call(this,b);b.deleteTexture(this.texture);this.texture=null;this.textureLayout.dispose();this.textureLayout=null}}]);return g}(n.b)},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");
}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return v});
b.d(e,"b",function(){return h});n=b(31);e=b(47);var a=b(48),c=b(16),l=b(6),p=function d(a,b,c){null===a&&(a=Function.prototype);var f=Object.getOwnPropertyDescriptor(a,b);if(void 0===f){if(a=Object.getPrototypeOf(a),null!==a)return d(a,b,c)}else{if("value"in f)return f.value;b=f.get;return void 0===b?void 0:b.call(c)}},w=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,
d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}(),v=function(b){function d(b,c){c=void 0===c?{}:c;c=void 0===c.sourceOptions?{}:c.sourceOptions;m(this,d);b=u(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,b.chunkManager,b.getSources(c)));b.shader=void 0;b.shaderUpdated=!0;b.rpcId=null;c=b.registerDisposer(new l.b);c.RPC_TYPE_ID=a.b;c.initializeCounterpart(b.chunkManager.rpc,{sources:b.sourceIds});b.rpcId=c.rpcId;return b}r(d,b);w(d,[{key:"defineShader",value:function(a){a.addFragmentCode("\nvoid emit(vec4 color) {\n  gl_FragColor = color;\n}\nvoid emitRGBA(vec4 rgba) {\n  emit(vec4(rgba.rgb, rgba.a * uOpacity));\n}\nvoid emitRGB(vec3 rgb) {\n  emit(vec4(rgb, uOpacity));\n}\nvoid emitGrayscale(float value) {\n  emit(vec4(value, value, value, uOpacity));\n}\nvoid emitTransparent() {\n  emit(vec4(0.0, 0.0, 0.0, 0.0));\n}\n")}},
{key:"beginSlice",value:function(a){a=this.shader;a.bind();return a}}]);return d}(e.a),k=function(a){function b(a,d){m(this,b);a=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,d));a.vertexPositions=d.vertexPositions;a.numPoints=Math.floor(a.vertexPositions.length/3);return a}r(b,a);w(b,[{key:"copyToGPU",value:function(a){p(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"copyToGPU",this).call(this,a);this.vertexBuffer=c.a.fromData(a,this.vertexPositions,a.ARRAY_BUFFER,a.STATIC_DRAW)}},
{key:"freeGPUMemory",value:function(a){p(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"freeGPUMemory",this).call(this,a);this.vertexBuffer.dispose()}}]);return b}(n.d),h=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}r(b,a);w(b,[{key:"getChunk",value:function(a){return new k(this,a)}},{key:"vectorGraphicsCoordinatesInVoxels",get:function(){return!0}}]);return b}(n.c)},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");
}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function a(a){for(var b=
0,d=0;3>d;++d)0>a[d]&&(b+=1<<d);return b}b.d(e,"a",function(){return C});var c=b(18);n=b(47);var l=b(4);e=b(0);var p=b(1),w=b(16),v=b(29),k=b(5),h=b(6),g=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}(),d=p.a.create(),f=p.a.create(),q=p.c.create(),x=function(a){function b(a){m(this,b);var d=u(this,(b.__proto__||
Object.getPrototypeOf(b)).call(this));d.outputVertexIndices=d.registerDisposer(w.a.fromData(a,new Float32Array([0,1,2,3,4,5]),a.ARRAY_BUFFER,a.STATIC_DRAW));d.vertexBasePositions=[0,0,0,1,0,0,0,1,0,1,1,0,0,0,1,1,0,1,0,1,1,1,1,1];a=[0,1,2,4,5,3,6,7];for(var c=[0,1,2,5,3,4,6,7],f=[0,1,1,4,4,7,4,7,1,5,0,1,1,4,4,7,0,2,2,5,5,7,5,7,2,6,0,2,2,5,5,7,0,3,3,6,6,7,6,7,3,4,0,3,3,6,6,7],g=[0,1,2,3,4,5,6,7,1,4,5,0,3,7,2,6,2,6,0,5,7,3,1,4,3,0,6,4,1,2,7,5,4,3,7,1,0,6,5,2,5,2,1,7,6,0,4,3,6,7,3,2,5,4,0,1,7,5,4,6,2,
1,3,0],e=[],h=0;8>h;++h)for(var k=0;k<f.length;++k)e.push(a[g[8*c[h]+f[k]]]);d.vertexIndices=new Int32Array(e);return d}r(b,a);g(b,null,[{key:"get",value:function(a){return a.memoize.get("SliceViewShaderBuffers",function(){return new b(a)})}}]);return b}(e.b),F=function(c){function e(a){m(this,e);var b=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));b.data=b.registerDisposer(x.get(a));return b}r(e,c);g(e,null,[{key:"get",value:function(a){return a.memoize.get("volume.VolumeSliceVertexComputationManager",
function(){return new e(a)})}}]);g(e,[{key:"defineShader",value:function(a){var b=this.data;a.addAttribute("highp float","aVertexIndexFloat");a.addUniform("highp vec3","uTranslation");a.addUniform("highp mat4","uProjectionMatrix");a.addUniform("highp vec3","uPlaneNormal");a.addUniform("highp float","uPlaneDistance");a.addUniform("highp ivec2","uVertexIndex",24);a.addUniform("highp vec3","uVertexBasePosition",8);a.addInitializer(function(a){a.gl.uniform3fv(a.uniform("uVertexBasePosition"),new Float32Array(b.vertexBasePositions))});
a.addUniform("highp vec3","uChunkDataSize");a.addUniform("highp vec3","uVoxelSize");a.addUniform("highp vec3","uLowerClipBound");a.addUniform("highp vec3","uUpperClipBound");a.addVarying("highp vec3","vChunkPosition");a.setVertexMain("\nvec3 chunkSize = uChunkDataSize * uVoxelSize;\nint vertexIndex = int(aVertexIndexFloat);\nfor (int e = 0; e < 4; ++e) {\n  highp ivec2 vidx = uVertexIndex[vertexIndex*4 + e];\n  highp vec3 v1 = max(uLowerClipBound, min(uUpperClipBound, chunkSize * uVertexBasePosition[vidx.x] + uTranslation));\n  highp vec3 v2 = max(uLowerClipBound, min(uUpperClipBound, chunkSize * uVertexBasePosition[vidx.y] + uTranslation));\n  highp vec3 vDir = v2 - v1;\n  highp float denom = dot(vDir, uPlaneNormal);\n  if (abs(denom) > 0.001) {\n    highp float lambda = (uPlaneDistance - dot(v1, uPlaneNormal)) / denom;\n    if ((lambda >= -0.001) && (lambda <= (1.0 + 0.001))) {\n      lambda = clamp(lambda, 0.0, 1.0);\n      highp vec3 position = v1 + lambda * vDir;\n      gl_Position = uProjectionMatrix * vec4(position, 1.0);\n      vChunkPosition = (position - uTranslation) / uVoxelSize + 0.001 * abs(uPlaneNormal);\n      break;\n    }\n  }\n}\n");
a.addFragmentCode("\nvec3 getPositionWithinChunk () {\n  return floor(min(vChunkPosition, uChunkDataSize - 1.0));\n}\n")}},{key:"computeVerticesDebug",value:function(d,c,f,g,e,h,k,l){d=p.a.multiply(p.a.create(),d,c);for(var q=a(h),q=this.data.vertexIndices.subarray(48*q,48*(q+1)),v=[0,0],m=[p.a.create(),p.a.create()],x=p.a.create(),y=p.a.create(),w=p.a.create(),r=p.a.create(),u=p.a.fromValues(Math.abs(h[0]),Math.abs(h[1]),Math.abs(h[2])),n=new Float32Array(this.data.vertexBasePositions),E=function(a){return n.subarray(3*
a,3*a+3)},C=0;6>C;++C)for(var z=0;4>z;++z){for(var F=0;2>F;++F)v[F]=q[2*(4*C+z)+F],p.a.multiply(m[F],d,E(v[F])),p.a.add(m[F],m[F],k),p.a.min(m[F],m[F],g),p.a.max(m[F],m[F],f);p.a.subtract(x,m[1],m[0]);F=p.a.dot(x,h);if(.001<Math.abs(F)){var B=(e-p.a.dot(m[0],h))/F;if(-.001<=B&&1.001>=B){B=Math.max(0,Math.min(1,B));p.a.scaleAndAdd(y,m[0],x,B);p.a.transformMat4(w,y,l);p.a.sub(r,y,k);p.a.divide(r,r,c);p.a.scaleAndAdd(r,r,u,.001);console.log("vertex "+C+", e = "+z+", at "+w+", "+("vChunkPosition = "+
r+", edge dir = "+x+", denom = "+F));break}else console.log("vertex "+C+", e = "+z+", skipped, deom = "+F+", "+("vDir = "+b.i(p.o)(x)+", ")+("uPlaneNormal = "+b.i(p.o)(h)+", ")+("lambda="+B))}else console.log("vertex "+C+", e = "+z+", skipped, deom = "+F+", "+("vDir = "+b.i(p.o)(x)+", uPlaneNormal = "+b.i(p.o)(h)))}}},{key:"beginSlice",value:function(a,b){a=b.attribute("aVertexIndexFloat");this.data.outputVertexIndices.bindToVertexAttrib(a,1)}},{key:"endSlice",value:function(a,b){b=b.attribute("aVertexIndexFloat");
a.disableVertexAttribArray(b)}},{key:"beginSource",value:function(b,c,g,e,h){var k=h.chunkLayout,l=k.globalToLocalSpatialVector(d,g.viewportAxes[2]);g=p.a.dot(k.globalToLocalSpatial(f,g.centerDataPosition),l);b.uniform3fv(c.uniform("uPlaneNormal"),l);b.uniform1f(c.uniform("uPlaneDistance"),g);l=a(l);b.uniform2iv(c.uniform("uVertexIndex"),this.data.vertexIndices.subarray(48*l,48*(l+1)));b.uniformMatrix4fv(c.uniform("uProjectionMatrix"),!1,p.c.multiply(q,e,k.transform));b.uniform3fv(c.uniform("uVoxelSize"),
h.voxelSize);b.uniform3fv(c.uniform("uLowerClipBound"),h.lowerClipBound);b.uniform3fv(c.uniform("uUpperClipBound"),h.upperClipBound)}},{key:"setupChunkDataSize",value:function(a,b,d){a.uniform3fv(b.uniform("uChunkDataSize"),d)}},{key:"drawChunk",value:function(a,b,d){a.uniform3fv(b.uniform("uTranslation"),d);a.drawArrays(a.TRIANGLE_FAN,0,6)}}]);return e}(e.b),C=function(a){function d(a,c){var f=void 0===c?{}:c;c=void 0===f.shaderError?b.i(v.a)():f.shaderError;f=void 0===f.sourceOptions?{}:f.sourceOptions;
m(this,d);a=u(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,a.chunkManager,a.getSources(f),{shaderError:c}));a.vertexComputationManager=F.get(a.gl);c=a.registerDisposer(new h.b);c.RPC_TYPE_ID=l.c;c.initializeCounterpart(a.chunkManager.rpc,{sources:a.sourceIds});a.rpcId=c.rpcId;return a}r(d,a);g(d,[{key:"getValueAt",value:function(a){for(var b=$jscomp.makeIterator(this.sources),d=b.next();!d.done;d=b.next())for(var d=$jscomp.makeIterator(d.value),c=d.next();!c.done;c=d.next())if(c=c.value.getValueAt(a),
null!=c)return c;return null}},{key:"getShader",value:function(){var a=this,b=this.getShaderKey()+"/"+this.chunkFormat.shaderKey;return this.gl.memoize.get(b,function(){return a.buildShader()})}},{key:"defineShader",value:function(a){this.vertexComputationManager.defineShader(a);a.addFragmentCode("\nvoid emit(vec4 color) {\n  gl_FragData[0] = color;\n}\n");this.chunkFormat.defineShader(a);a.addFragmentCode("\n"+b.i(k.d)(this.dataType)+" getDataValue() { return getDataValue(0); }\n")}},{key:"beginSlice",
value:function(a){a=this.gl;var b=this.shader;b.bind();this.vertexComputationManager.beginSlice(a,b);return b}},{key:"endSlice",value:function(a){this.vertexComputationManager.endSlice(this.gl,a)}},{key:"draw",value:function(a){var b=a.visibleLayers.get(this);if(0!==b.length&&(this.initializeShader(),void 0!==this.shader)){var d=this.gl,f=p.a.create(),g=this.beginSlice(a),e=this.vertexComputationManager,h=this.chunkFormat;h.beginDrawing(d,g);for(var k={},b=$jscomp.makeIterator(b),l=b.next();!l.done;k=
{chunkDataSize:k.chunkDataSize},l=b.next()){var q=l.value,v=q.spec.chunkLayout,l=q.chunks,m=v.size;k.chunkDataSize=void 0;var x=a.visibleChunks.get(v);if(x){e.beginSource(d,g,a,a.dataToDevice,q.spec);q=q.chunkFormat;q.beginSource(d,g);for(var v=function(a){return function(b){a.chunkDataSize=b;e.setupChunkDataSize(d,g,a.chunkDataSize)}}(k),x=$jscomp.makeIterator(x),w=x.next();!w.done;w=x.next())if((w=l.get(w.value))&&w.state===c.b.GPU_MEMORY){var r=w.chunkDataSize;r!==k.chunkDataSize&&v(r);p.a.multiply(f,
m,w.chunkGridPosition);q.bindChunk(d,g,w);e.drawChunk(d,g,f)}}}h.endDrawing(d,g);this.endSlice(g)}}},{key:"dataType",get:function(){return this.sources[0][0].spec.dataType}},{key:"chunkFormat",get:function(){return this.sources[0][0].chunkFormat}}]);return d}(n.a)},function(n,e,b){e.a=function(b){return new m.b(void 0===b?1:b,u.j)};var m=b(7),u=b(2)},function(n,e,b){e.a=function(a){a=void 0===a?m.a.create():a;return new c(a,a)};var m=b(1),u=b(2),r=b(3),a=function(){function a(a,b){for(var c=0;c<b.length;c++){var e=
b[c];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}(),c=function(){function c(a,b){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.value_=a;this.defaultValue=b;this.changed=new r.a}a(c,[{key:"toJSON",value:function(){if(this.value_!==this.defaultValue)return this.value_.toString()}},{key:"restoreState",value:function(a){try{this.value=
b.i(u.l)(a.split(","))}catch(w){this.value=this.defaultValue}}},{key:"reset",value:function(){this.value=this.defaultValue}},{key:"value",get:function(){return this.value_},set:function(a){a!==this.value_&&(this.value_=a,this.changed.dispatch())}}]);return c}()},function(n,e,b){e.a=function(b,e,r,a){for(;e<r;){var c=b[e];a(c)?++e:(--r,b[e]=b[r],b[r]=c)}return r};e.b=function(b,e){if(b.length===e)return b;e=new b.constructor(e);e.set(b);return e}},function(n,e,b){e.a=function(b){if(!window.getSelection().isCollapsed)return!0;
b=b.target.tagName;return"TEXTAREA"===b||"INPUT"===b?!0:!1};e.b=function(e,r){r=void 0===r?"text/plain":r;var a=!1,c=b.i(m.a)(document,"copy",function(b){b.clipboardData.setData(r,e);a=!0;b.stopPropagation();b.preventDefault()},!0);try{document.execCommand("copy")}finally{c()}return a};var m=b(0)},function(n,e,b){e.a=function(b,e,r){var a=void 0===r?{}:r,c=void 0===a.horizontal?!1:a.horizontal,l=void 0===a.vertical?!0:a.vertical,p=void 0===a.topMargin?6:a.topMargin,m=void 0===a.bottomMargin?6:a.bottomMargin,
v=void 0===a.leftMargin?6:a.leftMargin,k=void 0===a.rightMargin?6:a.rightMargin;r=void 0===a.maxHeight?!0:a.maxHeight;a=void 0===a.maxWidth?!0:a.maxWidth;e=e.getBoundingClientRect();if(c){var c=e.right,h=b.ownerDocument.documentElement.clientHeight-e.left;c>h?(b.style.left="",b.style.right="0",a&&(b.style.maxWidth=c-v+"px")):(b.style.right="",b.style.left="0",a&&(b.style.maxWidth=h-k+"px"))}l&&(l=e.top-p,m=b.ownerDocument.documentElement.clientHeight-e.bottom-m,l>3*m?(b.style.top="",b.style.bottom=
"100%",r&&(b.style.maxHeight=l+"px")):(b.style.top="100%",b.style.bottom="",r&&(b.style.maxHeight=m+"px")))}},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,
writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return c});n=b(0);var r=b(15),a=function(){function a(a,b){for(var c=0;c<b.length;c++){var e=b[c];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}(),c=function(c){function e(a,b){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");
var c=m(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));c.target=a;c.eventMap=b;c.registerEventListener(a,"wheel",function(a){c.dispatch("wheel",a)});c.registerEventListener(a,"click",function(a){c.dispatch("click"+a.button,a)});c.registerEventListener(a,"dblclick",function(a){c.dispatch("dblclick"+a.button,a)});c.registerEventListener(a,"mousedown",function(a){c.dispatch("mousedown"+a.button,a)});c.registerEventListener(a,"mouseup",function(a){c.dispatch("mouseup"+a.button,a)});return c}
u(e,c);a(e,[{key:"dispatch",value:function(a,c){b.i(r.c)(a,c,this.eventMap)}}]);return e}(n.b)},function(n,e,b){e.a=function(b,e){var m=b.view.document,a=b.screenX,c=b.screenY,l=function(b){var k=a-b.screenX,h=c-b.screenY;a=b.screenX;c=b.screenY;e(b,k,h)},p=b.button,w=function(a){a.button===p&&(m.removeEventListener("mousemove",l,!0),m.removeEventListener("mouseup",w,!1))};m.addEventListener("mousemove",l,!0);m.addEventListener("mouseup",w,!1)}},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");
}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}e.c=function(a,b,c){c=void 0===c?!1:c;b=b.attribute("aIndexRaw");0<=b&&(c&&a.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(b,0),a.disableVertexAttribArray(b))};e.a=function(a){return a.memoize.get("IndexBuffer",
function(){return new p(a)})};e.b=function(a){a.addAttribute("highp vec3","aIndexRaw");a.addVertexCode(c.j);a.addVertexCode("\nuint32_t getPrimitiveIndex() {\n  uint32_t result;\n  result.value = vec4(aIndexRaw, 0.0);\n  return result;\n}\n")};b.d(e,"d",function(){return w});e.e=function(b,c){return r.a.fromData(b,new Uint8Array(c.buffer,c.byteOffset,c.byteLength),a.c,a.d)};n=b(0);var r=b(16),a=b(25),c=b(5),l=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||
!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,g){c&&a(b.prototype,c);g&&a(b,g);return b}}(),p=function(b){function c(a){m(this,c);var b;b=(c.__proto__||Object.getPrototypeOf(c)).call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!==typeof b&&"function"!==typeof b?this:b;b.gl=a;b.buffer=b.registerDisposer(new r.a(a));return b}u(c,b);l(c,[{key:"resize",value:function(a){var b,
c;if(256>a){c=b=new Uint8Array(a);for(var f=0;f<a;++f)c[f]=f;c=1}else if(65536>a){c=b=new Uint8Array(2*a);for(var f=0,e=2*a,h=0;h<e;h+=2)c[h]=f,c[h+1]=f>>8,++f;c=2}else if(16777216>a){c=b=new Uint8Array(3*a);f=3*a;for(h=e=0;h<f;h+=3)c[h]=e,c[h+1]=e>>8,c[h+2]=e>>16,++e;c=3}else throw Error("Length of index buffer must not exceed 2^24.");this.buffer.setData(b);this.numComponents=c;this.length=a}},{key:"ensure",value:function(a){(void 0===this.length||this.length<a)&&this.resize(a);return this}},{key:"bindToVertexAttrib",
value:function(b){this.buffer.bindToVertexAttrib(b,this.numComponents,a.j,!0)}},{key:"bind",value:function(a,b){b=void 0===b?0:b;a=a.attribute("aIndexRaw");0<=a&&(this.bindToVertexAttrib(a),0!==b&&this.gl.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(a,b))}}]);return c}(n.b),w=function(){function b(a){m(this,b);this.name=a;this.attributeName="a"+this.name;this.getterName="get"+this.name}l(b,[{key:"defineShader",value:function(a){a.addAttribute("highp vec4",this.attributeName);a.addVertexCode("\nfloat "+
this.getterName+" () {\n  vec4 temp = "+this.attributeName+";\n  return temp.x + temp.y * 256.0 + temp.z * 65536.0;\n}\n")}},{key:"bind",value:function(b,c){b.bindToVertexAttrib(c.attribute(this.attributeName),4,a.j,!1)}},{key:"disable",value:function(a){a.gl.disableVertexAttribArray(a.attribute(this.attributeName))}}]);return b}()},function(n,e,b){function m(a){a.setFragmentMain("gl_FragColor = getValue0();")}e.a=m;e.b=function(a,c,e){c=void 0===c?m:c;e=void 0===e?1:e;return a.memoize.get("elementWiseTextureShader:"+
e+":"+b.i(u.a)(c),function(){var b=new r.a(a);b.addVarying("vec2","vTexCoord");b.addUniform("sampler2D","uSampler",e);b.addInitializer(function(b){for(var c=[],h=0;h<e;++h)c[h]=h;a.uniform1iv(b.uniform("uSampler"),c)});for(var l=0;l<e;++l)b.addFragmentCode("\nvec4 getValue"+l+"() {\n  return texture2D(uSampler["+l+"], vTexCoord);\n}\n");b.addUniform("mat4","uProjectionMatrix");b.require(c);b.addAttribute("vec4","aVertexPosition");b.addAttribute("vec2","aTexCoord");b.setVertexMain("vTexCoord = aTexCoord; gl_Position = uProjectionMatrix * aVertexPosition;");
return b.build()})};e.c=function(a){return a.memoize.get("trivialColorShader",function(){var b=new r.a(a);b.addVarying("vec4","vColor");b.setFragmentMain("gl_FragColor = vColor;");b.addAttribute("vec4","aVertexPosition");b.addAttribute("vec4","aColor");b.addUniform("mat4","uProjectionMatrix");b.setVertexMain("vColor = aColor; gl_Position = uProjectionMatrix * aVertexPosition;");return b.build()})};var u=b(20),r=b(26)},function(n,e,b){e.a=function(b,e){""===e.id&&(e.id="unique-id-for-association-"+
m++);b.setAttribute("for",e.id)};var m=0},function(n,e,b){function m(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function u(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function r(a){for(var b=p.length,
c=p[b-1],d=0;d<b;++d){var f=p[d];if(a>=f.lengthInNanometers){c=f;break}}return c}e.a=r;b.d(e,"b",function(){return v});n=b(0);var a=b(8),c=function(){function a(a,b){for(var c=0;c<b.length;c++){var f=b[c];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(a,f.key,f)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}();b(204);var l=[1.5,2,3,5,7.5,10],p=[{unit:"km",lengthInNanometers:1E12},{unit:"m",lengthInNanometers:1E9},{unit:"mm",lengthInNanometers:1E6},
{unit:"\u00b5m",lengthInNanometers:1E3},{unit:"nm",lengthInNanometers:1},{unit:"pm",lengthInNanometers:.001}],w=function(){function a(){u(this,a);this.allowedSignificands=l;this.prevTargetLengthInPixels=this.prevNanometersPerPixel=0}c(a,[{key:"update",value:function(){var a=this.nanometersPerPixel,b=this.targetLengthInPixels;if(this.prevNanometersPerPixel===a&&this.prevTargetLengthInPixels===b)return!1;this.prevNanometersPerPixel=a;this.prevTargetLengthInPixels=b;for(var c=b*a,b=Math.pow(10,Math.floor(Math.log(c)/
Math.LN10)),c=c/b,f=1,e=$jscomp.makeIterator(this.allowedSignificands),l=e.next();!l.done;l=e.next())if(l=l.value,Math.abs(l-c)<Math.abs(f-c))f=l;else break;b*=f;c=r(b);this.lengthInPixels=Math.round(b/a);this.physicalUnit=c.unit;this.physicalLength=b/c.lengthInNanometers;return!0}}]);return a}(),v=function(e){function h(a){a=void 0===a?new w:a;u(this,h);var b;b=(h.__proto__||Object.getPrototypeOf(h)).call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
b=!b||"object"!==typeof b&&"function"!==typeof b?this:b;b.dimensions=a;b.element=document.createElement("div");b.textNode=document.createTextNode("");b.barElement=document.createElement("div");a=b.element;var c=b.textNode,g=b.barElement;a.className="scale-bar-container";a.appendChild(c);a.appendChild(g);g.className="scale-bar";return b}m(h,e);c(h,[{key:"update",value:function(){var a=this.dimensions;a.update()&&(this.textNode.textContent=a.physicalLength+" "+a.physicalUnit,this.barElement.style.width=
a.lengthInPixels+"px")}},{key:"disposed",value:function(){b.i(a.a)(this.element)}}]);return h}(n.b)},function(n,e,b){(function(b,e){n.exports=e()})(this,function(){function b(a){return new RegExp("(^|\\s)"+a+"(?:$|\\s)\\s*")}function e(a){for(var b=a.childNodes.length;0<b;--b)a.removeChild(a.firstChild);return a}function r(a,b){return e(a).appendChild(b)}function a(a,b,c,d){a=document.createElement(a);c&&(a.className=c);d&&(a.style.cssText=d);if("string"==typeof b)a.appendChild(document.createTextNode(b));
else if(b)for(c=0;c<b.length;++c)a.appendChild(b[c]);return a}function c(b,c,d,f){b=a(b,c,d,f);b.setAttribute("role","presentation");return b}function l(a,b){3==b.nodeType&&(b=b.parentNode);if(a.contains)return a.contains(b);do if(11==b.nodeType&&(b=b.host),b==a)return!0;while(b=b.parentNode)}function p(){var a;try{a=document.activeElement}catch(A){a=document.body||null}for(;a&&a.shadowRoot&&a.shadowRoot.activeElement;)a=a.shadowRoot.activeElement;return a}function w(a,c){var d=a.className;b(c).test(d)||
(a.className+=(d?" ":"")+c)}function v(a,c){a=a.split(" ");for(var d=0;d<a.length;d++)a[d]&&!b(a[d]).test(c)&&(c+=" "+a[d]);return c}function k(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,b)}}function h(a,b,c){b||(b={});for(var d in a)!a.hasOwnProperty(d)||!1===c&&b.hasOwnProperty(d)||(b[d]=a[d]);return b}function g(a,b,c,d,f){null==b&&(b=a.search(/[^\s\u00a0]/),-1==b&&(b=a.length));d=d||0;for(f=f||0;;){var t=a.indexOf("\t",d);if(0>t||t>=b)return f+(b-d);
f+=t-d;f+=c-f%c;d=t+1}}function d(a,b){for(var c=0;c<a.length;++c)if(a[c]==b)return c;return-1}function f(a,b,c){for(var d=0,t=0;;){var A=a.indexOf("\t",d);-1==A&&(A=a.length);var f=A-d;if(A==a.length||t+f>=b)return d+Math.min(f,b-t);t+=A-d;t+=c-t%c;d=A+1;if(t>=b)return d}}function q(a){for(;Ac.length<=a;)Ac.push(x(Ac)+" ");return Ac[a]}function x(a){return a[a.length-1]}function n(a,b){for(var c=[],d=0;d<a.length;d++)c[d]=b(a[d],d);return c}function C(a,b,c){for(var d=0,t=c(b);d<a.length&&c(a[d])<=
t;)d++;a.splice(d,0,b)}function B(){}function z(a,b){Object.create?a=Object.create(a):(B.prototype=a,a=new B);b&&h(b,a);return a}function E(a){return/\w/.test(a)||"\u0080"<a&&(a.toUpperCase()!=a.toLowerCase()||Wf.test(a))}function y(a,b){return b?-1<b.source.indexOf("\\w")&&E(a)?!0:b.test(a):E(a)}function H(a){for(var b in a)if(a.hasOwnProperty(b)&&a[b])return!1;return!0}function G(a){return 768<=a.charCodeAt(0)&&Xf.test(a)}function J(a,b,c){for(;(0>c?0<b:b<a.length)&&G(a.charAt(b));)b+=c;return b}
function D(a,b,c){for(;;){if(1>=Math.abs(b-c))return a(b)?b:c;var d=Math.floor((b+c)/2);a(d)?c=d:b=d}}function S(b,d,f){this.input=f;this.scrollbarFiller=a("div",null,"CodeMirror-scrollbar-filler");this.scrollbarFiller.setAttribute("cm-not-content","true");this.gutterFiller=a("div",null,"CodeMirror-gutter-filler");this.gutterFiller.setAttribute("cm-not-content","true");this.lineDiv=c("div",null,"CodeMirror-code");this.selectionDiv=a("div",null,null,"position: relative; z-index: 1");this.cursorDiv=
a("div",null,"CodeMirror-cursors");this.measure=a("div",null,"CodeMirror-measure");this.lineMeasure=a("div",null,"CodeMirror-measure");this.lineSpace=c("div",[this.measure,this.lineMeasure,this.selectionDiv,this.cursorDiv,this.lineDiv],null,"position: relative; outline: none");var t=c("div",[this.lineSpace],"CodeMirror-lines");this.mover=a("div",[t],null,"position: relative");this.sizer=a("div",[this.mover],"CodeMirror-sizer");this.sizerWidth=null;this.heightForcer=a("div",null,null,"position: absolute; height: 30px; width: 1px;");
this.gutters=a("div",null,"CodeMirror-gutters");this.lineGutter=null;this.scroller=a("div",[this.sizer,this.heightForcer,this.gutters],"CodeMirror-scroll");this.scroller.setAttribute("tabIndex","-1");this.wrapper=a("div",[this.scrollbarFiller,this.gutterFiller,this.scroller],"CodeMirror");Z&&8>da&&(this.gutters.style.zIndex=-1,this.scroller.style.paddingRight=0);oa||Ta&&Qb||(this.scroller.draggable=!0);b&&(b.appendChild?b.appendChild(this.wrapper):b(this.wrapper));this.reportedViewFrom=this.reportedViewTo=
this.viewFrom=this.viewTo=d.first;this.view=[];this.externalMeasured=this.renderedView=null;this.lastWrapHeight=this.lastWrapWidth=this.viewOffset=0;this.updateLineNumbers=null;this.nativeBarWidth=this.barHeight=this.barWidth=0;this.scrollbarsClipped=!1;this.lineNumWidth=this.lineNumInnerWidth=this.lineNumChars=null;this.alignWidgets=!1;this.maxLine=this.cachedCharWidth=this.cachedTextHeight=this.cachedPaddingH=null;this.maxLineLength=0;this.maxLineChanged=!1;this.wheelDX=this.wheelDY=this.wheelStartX=
this.wheelStartY=null;this.shift=!1;this.activeTouch=this.selForContextMenu=null;f.init(this)}function I(a,b){b-=a.first;if(0>b||b>=a.size)throw Error("There is no line "+(b+a.first)+" in the document.");for(;!a.lines;)for(var c=0;;++c){var d=a.children[c],t=d.chunkSize();if(b<t){a=d;break}b-=t}return a.lines[b]}function P(a,b,c){var d=[],t=b.line;a.iter(b.line,c.line+1,function(a){a=a.text;t==c.line&&(a=a.slice(0,c.ch));t==b.line&&(a=a.slice(b.ch));d.push(a);++t});return d}function U(a,b,c){var d=
[];a.iter(b,c,function(a){d.push(a.text)});return d}function V(a,b){if(b-=a.height)for(;a;a=a.parent)a.height+=b}function L(a){if(null==a.parent)return null;var b=a.parent;a=d(b.lines,a);for(var c=b.parent;c;b=c,c=c.parent)for(var t=0;c.children[t]!=b;++t)a+=c.children[t].chunkSize();return a+b.first}function Q(a,b){var c=a.first;a:do{for(var d=0;d<a.children.length;++d){var t=a.children[d],A=t.height;if(b<A){a=t;continue a}b-=A;c+=t.chunkSize()}return c}while(!a.lines);for(d=0;d<a.lines.length;++d){t=
a.lines[d].height;if(b<t)break;b-=t}return c+d}function W(a,b){return b>=a.first&&b<a.first+a.size}function X(a,b){return String(a.lineNumberFormatter(b+a.firstLineNumber))}function K(a,b,c){void 0===c&&(c=null);if(!(this instanceof K))return new K(a,b,c);this.line=a;this.ch=b;this.sticky=c}function O(a,b){return a.line-b.line||a.ch-b.ch}function na(a,b){return a.sticky==b.sticky&&0==O(a,b)}function sa(a){return K(a.line,a.ch)}function ta(a,b){return 0>O(a,b)?b:a}function Na(a,b){return 0>O(a,b)?
a:b}function T(a,b){if(b.line<a.first)return K(a.first,0);var c=a.first+a.size-1;if(b.line>c)return K(c,I(a,c).text.length);a=I(a,b.line).text.length;c=b.ch;b=null==c||c>a?K(b.line,a):0>c?K(b.line,0):b;return b}function Fa(a,b){for(var c=[],d=0;d<b.length;d++)c[d]=T(a,b[d]);return c}function pa(a,b,c){this.marker=a;this.from=b;this.to=c}function Y(a,b){if(a)for(var c=0;c<a.length;++c){var d=a[c];if(d.marker==b)return d}}function ab(a,b){if(b.full)return null;var c=W(a,b.from.line)&&I(a,b.from.line).markedSpans,
d=W(a,b.to.line)&&I(a,b.to.line).markedSpans;if(!c&&!d)return null;a=b.from.ch;var t=b.to.ch,A=0==O(b.from,b.to),f;if(c)for(var g=0;g<c.length;++g){var e=c[g],h=e.marker;if(null==e.from||(h.inclusiveLeft?e.from<=a:e.from<a)||!(e.from!=a||"bookmark"!=h.type||A&&e.marker.insertLeft)){var l=null==e.to||(h.inclusiveRight?e.to>=a:e.to>a);(f||(f=[])).push(new pa(h,e.from,l?null:e.to))}}var c=f,k;if(d)for(f=0;f<d.length;++f)if(g=d[f],e=g.marker,null==g.to||(e.inclusiveRight?g.to>=t:g.to>t)||g.from==t&&"bookmark"==
e.type&&(!A||g.marker.insertLeft))h=null==g.from||(e.inclusiveLeft?g.from<=t:g.from<t),(k||(k=[])).push(new pa(e,h?null:g.from-t,null==g.to?null:g.to-t));d=1==b.text.length;t=x(b.text).length+(d?a:0);if(c)for(A=0;A<c.length;++A)if(f=c[A],null==f.to)(g=Y(k,f.marker),g)?d&&(f.to=null==g.to?null:g.to+t):f.to=a;if(k)for(a=0;a<k.length;++a)A=k[a],null!=A.to&&(A.to+=t),null==A.from?Y(c,A.marker)||(A.from=t,d&&(c||(c=[])).push(A)):(A.from+=t,d&&(c||(c=[])).push(A));c&&(c=Lb(c));k&&k!=c&&(k=Lb(k));a=[c];
if(!d){b=b.text.length-2;var q;if(0<b&&c)for(d=0;d<c.length;++d)null==c[d].to&&(q||(q=[])).push(new pa(c[d].marker,null,null));for(c=0;c<b;++c)a.push(q);a.push(k)}return a}function Lb(a){for(var b=0;b<a.length;++b){var c=a[b];null!=c.from&&c.from==c.to&&!1!==c.marker.clearWhenEmpty&&a.splice(b--,1)}return a.length?a:null}function Mb(a,b,c){var t=null;a.iter(b.line,c.line+1,function(a){if(a.markedSpans)for(var b=0;b<a.markedSpans.length;++b){var c=a.markedSpans[b].marker;!c.readOnly||t&&-1!=d(t,c)||
(t||(t=[])).push(c)}});if(!t)return null;a=[{from:b,to:c}];for(b=0;b<t.length;++b){c=t[b];for(var f=c.find(0),A=0;A<a.length;++A){var g=a[A];if(!(0>O(g.to,f.from)||0<O(g.from,f.to))){var e=[A,1],h=O(g.from,f.from),N=O(g.to,f.to);(0>h||!c.inclusiveLeft&&!h)&&e.push({from:g.from,to:f.from});(0<N||!c.inclusiveRight&&!N)&&e.push({from:f.to,to:g.to});a.splice.apply(a,e);A+=e.length-3}}}return a}function Sa(a){var b=a.markedSpans;if(b){for(var c=0;c<b.length;++c)b[c].marker.detachLine(a);a.markedSpans=
null}}function Nb(a,b){if(b){for(var c=0;c<b.length;++c)b[c].marker.attachLine(a);a.markedSpans=b}}function rb(a,b){var c=a.lines.length-b.lines.length;if(0!=c)return c;var c=a.find(),d=b.find(),t=O(c.from,d.from)||(a.inclusiveLeft?-1:0)-(b.inclusiveLeft?-1:0);return t?-t:(c=O(c.to,d.to)||(a.inclusiveRight?1:0)-(b.inclusiveRight?1:0))?c:b.id-a.id}function qa(a,b){a=Ua&&a.markedSpans;var c;if(a)for(var d,t=0;t<a.length;++t)d=a[t],d.marker.collapsed&&null==(b?d.from:d.to)&&(!c||0>rb(c,d.marker))&&(c=
d.marker);return c}function sb(a,b,c,d,f){a=I(a,b);if(a=Ua&&a.markedSpans)for(b=0;b<a.length;++b){var t=a[b];if(t.marker.collapsed){var A=t.marker.find(0),g=O(A.from,c)||(t.marker.inclusiveLeft?-1:0)-(f.inclusiveLeft?-1:0),e=O(A.to,d)||(t.marker.inclusiveRight?1:0)-(f.inclusiveRight?1:0);if(!(0<=g&&0>=e||0>=g&&0<=e)&&(0>=g&&(t.marker.inclusiveRight&&f.inclusiveLeft?0<=O(A.to,c):0<O(A.to,c))||0<=g&&(t.marker.inclusiveRight&&f.inclusiveLeft?0>=O(A.from,d):0>O(A.from,d))))return!0}}}function ra(a){for(var b;b=
qa(a,!0);)a=b.find(-1,!0).line;return a}function Ob(a,b){a=I(a,b);var c=ra(a);return a==c?b:L(c)}function Pb(a,b){if(b>a.lastLine())return b;var c=I(a,b);if(!bb(a,c))return b;for(;a=qa(c,!1);)c=a.find(1,!0).line;return L(c)+1}function bb(a,b){var c=Ua&&b.markedSpans;if(c)for(var d,t=0;t<c.length;++t)if(d=c[t],d.marker.collapsed&&(null==d.from||!d.marker.widgetNode&&0==d.from&&d.marker.inclusiveLeft&&$c(a,b,d)))return!0}function $c(a,b,c){if(null==c.to)return b=c.marker.find(1,!0),$c(a,b.line,Y(b.line.markedSpans,
c.marker));if(c.marker.inclusiveRight&&c.to==b.text.length)return!0;for(var d,t=0;t<b.markedSpans.length;++t)if(d=b.markedSpans[t],d.marker.collapsed&&!d.marker.widgetNode&&d.from==c.to&&(null==d.to||d.to!=c.from)&&(d.marker.inclusiveLeft||c.marker.inclusiveRight)&&$c(a,b,d))return!0}function Ga(a){a=ra(a);for(var b=0,c=a.parent,d=0;d<c.lines.length;++d){var t=c.lines[d];if(t==a)break;else b+=t.height}for(a=c.parent;a;c=a,a=c.parent)for(d=0;d<a.children.length&&(t=a.children[d],t!=c);++d)b+=t.height;
return b}function Bc(a){if(0==a.height)return 0;for(var b=a.text.length,c,d=a;c=qa(d,!0);)c=c.find(0,!0),d=c.from.line,b+=c.from.ch-c.to.ch;for(d=a;c=qa(d,!1);)a=c.find(0,!0),b-=d.text.length-a.from.ch,d=a.to.line,b+=d.text.length-a.to.ch;return b}function ad(a){var b=a.display;a=a.doc;b.maxLine=I(a,a.first);b.maxLineLength=Bc(b.maxLine);b.maxLineChanged=!0;a.iter(function(a){var c=Bc(a);c>b.maxLineLength&&(b.maxLineLength=c,b.maxLine=a)})}function Yf(a,b,c,d){if(!a)return d(b,c,"ltr");for(var t=
!1,f=0;f<a.length;++f){var A=a[f];if(A.from<c&&A.to>b||b==c&&A.to==b)d(Math.max(A.from,b),Math.min(A.to,c),1==A.level?"rtl":"ltr"),t=!0}t||d(b,c,"ltr")}function bd(a,b,c){var d;Rb=null;for(var t=0;t<a.length;++t){var f=a[t];if(f.from<b&&f.to>b)return t;f.to==b&&(f.from!=f.to&&"before"==c?d=t:Rb=t);f.from==b&&(f.from!=f.to&&"before"!=c?d=t:Rb=t)}return null!=d?d:Rb}function Va(a,b){var c=a.order;null==c&&(c=a.order=Zf(a.text,b));return c}function cd(a,b,c){b=J(a.text,b+c,c);return 0>b||b>a.text.length?
null:b}function dd(a,b,c){a=cd(a,b.ch,c);return null==a?null:new K(b.line,a,0>c?"after":"before")}function ed(a,b,c,d,f){if(a&&(a=Va(c,b.doc.direction))){a=0>f?x(a):a[0];var t=0>f==(1==a.level)?"after":"before",A;if(0<a.level){var g=tb(b,c);A=0>f?c.text.length-1:0;var e=Oa(b,g,A).top;A=D(function(a){return Oa(b,g,a).top==e},0>f==(1==a.level)?a.from:a.to-1,A);"before"==t&&(A=cd(c,A,1))}else A=0>f?a.to:a.from;return new K(d,A,t)}return new K(d,0>f?c.text.length:0,0>f?"before":"after")}function Wd(a,
b,c,d){var t=Va(b,a.doc.direction);if(!t)return dd(b,c,d);c.ch>=b.text.length?(c.ch=b.text.length,c.sticky="before"):0>=c.ch&&(c.ch=0,c.sticky="after");var f=bd(t,c.ch,c.sticky),A=t[f];if("ltr"==a.doc.direction&&0==A.level%2&&(0<d?A.to>c.ch:A.from<c.ch))return dd(b,c,d);var g=function(a,c){return cd(b,a instanceof K?a.ch:a,c)},e,h=function(c){if(!a.options.lineWrapping)return{begin:0,end:b.text.length};var d=e=e||tb(a,b);c=cb(a,b,Oa(a,d,c),"line").top;return Xd(a,b,d,c)},M=h("before"==c.sticky?g(c,
-1):c.ch);if("rtl"==a.doc.direction||1==A.level){var N=1==A.level==0>d,l=g(c,N?1:-1);if(null!=l&&(N?l<=A.to&&l<=M.end:l>=A.from&&l>=M.begin))return new K(c.line,l,N?"before":"after")}A=function(a,b,d){for(var f=function(a,b){return b?new K(c.line,g(a,1),"before"):new K(c.line,a,"after")};0<=a&&a<t.length;a+=b){var A=t[a],e=0<b==(1!=A.level),h=e?d.begin:g(d.end,-1);if(A.from<=h&&h<A.to)return f(h,e);h=e?A.from:g(A.to,-1);if(d.begin<=h&&h<d.end)return f(h,e)}};if(f=A(f+d,d,M))return f;M=0<d?M.end:g(M.begin,
-1);return null==M||0<d&&M==b.text.length||!(f=A(0<d?0:t.length-1,d,h(M)))?null:f}function Ba(a,b,c){if(a.removeEventListener)a.removeEventListener(b,c,!1);else if(a.detachEvent)a.detachEvent("on"+b,c);else{var t=(a=a._handlers)&&a[b];t&&(c=d(t,c),-1<c&&(a[b]=t.slice(0,c).concat(t.slice(c+1))))}}function fa(a,b){var c=a._handlers&&a._handlers[b]||Cc;if(c.length)for(var d=Array.prototype.slice.call(arguments,2),t=0;t<c.length;++t)c[t].apply(null,d)}function ia(a,b,c){"string"==typeof b&&(b={type:b,
preventDefault:function(){this.defaultPrevented=!0}});fa(a,c||b.type,a,b);return fd(b)||b.codemirrorIgnore}function Yd(a){var b=a._handlers&&a._handlers.cursorActivity;if(b){a=a.curOp.cursorActivityHandlers||(a.curOp.cursorActivityHandlers=[]);for(var c=0;c<b.length;++c)-1==d(a,b[c])&&a.push(b[c])}}function Ea(a,b){return 0<(a._handlers&&a._handlers[b]||Cc).length}function ub(a){a.prototype.on=function(a,b){R(this,a,b)};a.prototype.off=function(a,b){Ba(this,a,b)}}function ua(a){a.preventDefault?a.preventDefault():
a.returnValue=!1}function Zd(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function fd(a){return null!=a.defaultPrevented?a.defaultPrevented:0==a.returnValue}function Sb(a){ua(a);Zd(a)}function $d(a){var b=a.which;null==b&&(a.button&1?b=1:a.button&2?b=3:a.button&4&&(b=2));Ha&&a.ctrlKey&&1==b&&(b=3);return b}function $f(b){if(null==gd){var c=a("span","\u200b");r(b,a("span",[c,document.createTextNode("x")]));0!=b.firstChild.offsetHeight&&(gd=1>=c.offsetWidth&&2<c.offsetHeight&&!(Z&&8>da))}b=
gd?a("span","\u200b"):a("span","\u00a0",null,"display: inline-block; width: 1px; margin-right: -1px");b.setAttribute("cm-text","");return b}function ag(a,b){2<arguments.length&&(b.dependencies=Array.prototype.slice.call(arguments,2));hd[a]=b}function Dc(a){if("string"==typeof a&&vb.hasOwnProperty(a))a=vb[a];else if(a&&"string"==typeof a.name&&vb.hasOwnProperty(a.name)){var b=vb[a.name];"string"==typeof b&&(b={name:b});a=z(b,a);a.name=b.name}else{if("string"==typeof a&&/^[\w\-]+\/[\w\-]+\+xml$/.test(a))return Dc("application/xml");
if("string"==typeof a&&/^[\w\-]+\/[\w\-]+\+json$/.test(a))return Dc("application/json")}return"string"==typeof a?{name:a}:a||{name:"null"}}function id(a,b){b=Dc(b);var c=hd[b.name];if(!c)return id(a,"text/plain");a=c(a,b);if(wb.hasOwnProperty(b.name)){var c=wb[b.name],d;for(d in c)c.hasOwnProperty(d)&&(a.hasOwnProperty(d)&&(a["_"+d]=a[d]),a[d]=c[d])}a.name=b.name;b.helperType&&(a.helperType=b.helperType);if(b.modeProps)for(var t in b.modeProps)a[t]=b.modeProps[t];return a}function bg(a,b){a=wb.hasOwnProperty(a)?
wb[a]:wb[a]={};h(b,a)}function db(a,b){if(!0===b)return b;if(a.copyState)return a.copyState(b);a={};for(var c in b){var d=b[c];d instanceof Array&&(d=d.concat([]));a[c]=d}return a}function jd(a,b){for(var c;a.innerMode;){c=a.innerMode(b);if(!c||c.mode==a)break;b=c.state;a=c.mode}return c||{mode:a,state:b}}function ae(a,b,c){return a.startState?a.startState(b,c):!0}function be(a,b,c,d){var t=[a.state.modeGen],f={};ce(a,b.text,a.doc.mode,c,function(a,b){return t.push(a,b)},f,d);d=c.state;for(var g=
function(d){var g=a.state.overlays[d],A=1,e=0;c.state=!0;ce(a,b.text,g.mode,c,function(a,b){for(var c=A;e<a;){var d=t[A];d>a&&t.splice(A,1,a,t[A+1],d);A+=2;e=Math.min(a,d)}if(b)if(g.opaque)t.splice(c,A-c,a,"overlay "+b),A=c+2;else for(;c<A;c+=2)a=t[c+1],t[c+1]=(a?a+" ":"")+"overlay "+b},f)},A=0;A<a.state.overlays.length;++A)g(A);c.state=d;return{styles:t,classes:f.bgClass||f.textClass?f:null}}function de(a,b,c){if(!b.styles||b.styles[0]!=a.state.modeGen){var d=Tb(a,L(b)),t=b.text.length>a.options.maxHighlightLength&&
db(a.doc.mode,d.state),f=be(a,b,d);t&&(d.state=t);b.stateAfter=d.save(!t);b.styles=f.styles;f.classes?b.styleClasses=f.classes:b.styleClasses&&(b.styleClasses=null);c===a.doc.highlightFrontier&&(a.doc.modeFrontier=Math.max(a.doc.modeFrontier,++a.doc.highlightFrontier))}return b.styles}function Tb(a,b,c){var d=a.doc,t=a.display;if(!d.mode.startState)return new Pa(d,!0,b);var f=cg(a,b,c),g=f>d.first&&I(d,f-1).stateAfter,A=g?Pa.fromSaved(d,g,f):new Pa(d,ae(d.mode),f);d.iter(f,b,function(c){kd(a,c.text,
A);var d=A.line;c.stateAfter=d==b-1||0==d%5||d>=t.viewFrom&&d<t.viewTo?A.save():null;A.nextLine()});c&&(d.modeFrontier=A.line);return A}function kd(a,b,c,d){var t=a.doc.mode;a=new ga(b,a.options.tabSize,c);a.start=a.pos=d||0;for(""==b&&ee(t,c.state);!a.eol();)ld(t,a,c.state),a.start=a.pos}function ee(a,b){if(a.blankLine)return a.blankLine(b);if(a.innerMode&&(a=jd(a,b),a.mode.blankLine))return a.mode.blankLine(a.state)}function ld(a,b,c,d){for(var t=0;10>t;t++){d&&(d[0]=jd(a,c).mode);var f=a.token(b,
c);if(b.pos>b.start)return f}throw Error("Mode "+a.name+" failed to advance stream.");}function fe(a,b,c,d){var t=a.doc,f=t.mode,g;b=T(t,b);var A=I(t,b.line);c=Tb(a,b.line,c);a=new ga(A.text,a.options.tabSize,c);var e;for(d&&(e=[]);(d||a.pos<b.ch)&&!a.eol();)a.start=a.pos,g=ld(f,a,c.state),d&&e.push(new ge(a,g,db(t.mode,c.state)));return d?e:new ge(a,g,c.state)}function he(a,b){if(a)for(;;){var c=a.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!c)break;a=a.slice(0,c.index)+a.slice(c.index+c[0].length);
var d=c[1]?"bgClass":"textClass";null==b[d]?b[d]=c[2]:(new RegExp("(?:^|s)"+c[2]+"(?:$|s)")).test(b[d])||(b[d]+=" "+c[2])}return a}function ce(a,b,c,d,f,g,e){var t=c.flattenSpans;null==t&&(t=a.options.flattenSpans);var A=0,h=null,M=new ga(b,a.options.tabSize,d),l,k=a.options.addModeClass&&[null];for(""==b&&he(ee(c,d.state),g);!M.eol();){M.pos>a.options.maxHighlightLength?(t=!1,e&&kd(a,b,d,M.pos),M.pos=b.length,l=null):l=he(ld(c,M,d.state,k),g);if(k){var q=k[0].name;q&&(l="m-"+(l?q+" "+l:q))}if(!t||
h!=l){for(;A<M.start;)A=Math.min(M.start,A+5E3),f(A,h);h=l}M.start=M.pos}for(;A<M.pos;)a=Math.min(M.pos,A+5E3),f(a,h),A=a}function cg(a,b,c){for(var d,t,f=a.doc,A=c?-1:b-(a.doc.mode.innerMode?1E3:100);b>A;--b){if(b<=f.first)return f.first;var e=I(f,b-1),h=e.stateAfter;if(h&&(!c||b+(h instanceof Ec?h.lookAhead:0)<=f.modeFrontier))return b;e=g(e.text,null,a.options.tabSize);if(null==t||d>e)t=b-1,d=e}return t}function dg(a,b){a.modeFrontier=Math.min(a.modeFrontier,b);if(!(a.highlightFrontier<b-10)){for(var c=
a.first,d=b-1;d>c;d--){var t=I(a,d).stateAfter;if(t&&(!(t instanceof Ec)||d+t.lookAhead<b)){c=d+1;break}}a.highlightFrontier=Math.min(a.highlightFrontier,c)}}function ie(a,b){if(!a||/^\s*$/.test(a))return null;b=b.addModeClass?eg:fg;return b[a]||(b[a]=a.replace(/\S+/g,"cm-$&"))}function je(a,b){var d=c("span",null,null,oa?"padding-right: .1px":null),d={pre:c("pre",[d],"CodeMirror-line"),content:d,col:0,pos:0,cm:a,trailingSpace:!1,splitSpaces:(Z||oa)&&a.getOption("lineWrapping")};b.measure={};for(var t=
0;t<=(b.rest?b.rest.length:0);t++){var f=t?b.rest[t-1]:b.line,g=void 0;d.pos=0;d.addToken=gg;var A;A=a.display.measure;if(null!=md)A=md;else{var h=r(A,document.createTextNode("A\u062eA")),l=xb(h,0,1).getBoundingClientRect(),h=xb(h,1,2).getBoundingClientRect();e(A);A=l&&l.left!=l.right?md=3>h.right-l.right:!1}A&&(g=Va(f,a.doc.direction))&&(d.addToken=hg(d.addToken,g));d.map=[];A=b!=a.display.externalMeasured&&L(f);a:{g=d;A=de(a,f,A);var k=f.markedSpans,l=f.text,h=0;if(k)for(var q=l.length,p=0,m=1,
x="",y=void 0,w=void 0,n=0,u=void 0,C=void 0,z=void 0,F=void 0,E=void 0;;){if(n==p){for(var u=C=z=F=w="",E=null,n=Infinity,B=[],H=void 0,G=0;G<k.length;++G){var J=k[G],D=J.marker;"bookmark"==D.type&&J.from==p&&D.widgetNode?B.push(D):J.from<=p&&(null==J.to||J.to>p||D.collapsed&&J.to==p&&J.from==p)?(null!=J.to&&J.to!=p&&n>J.to&&(n=J.to,C=""),D.className&&(u+=" "+D.className),D.css&&(w=(w?w+";":"")+D.css),D.startStyle&&J.from==p&&(z+=" "+D.startStyle),D.endStyle&&J.to==n&&(H||(H=[])).push(D.endStyle,
J.to),D.title&&!F&&(F=D.title),D.collapsed&&(!E||0>rb(E.marker,D))&&(E=J)):J.from>p&&n>J.from&&(n=J.from)}if(H)for(G=0;G<H.length;G+=2)H[G+1]==n&&(C+=" "+H[G]);if(!E||E.from==p)for(H=0;H<B.length;++H)ke(g,0,B[H]);if(E&&(E.from||0)==p){ke(g,(null==E.to?q+1:E.to)-p,E.marker,null==E.from);if(null==E.to)break a;E.to==p&&(E=!1)}}if(p>=q)break;for(B=Math.min(q,n);;){if(x){H=p+x.length;E||(G=H>B?x.slice(0,B-p):x,g.addToken(g,G,y?y+u:u,z,p+G.length==n?C:"",F,w));if(H>=B){x=x.slice(B-p);p=B;break}p=H;z=""}x=
l.slice(h,h=A[m++]);y=ie(A[m++],g.cm.options)}}else for(k=1;k<A.length;k+=2)g.addToken(g,l.slice(h,h=A[k]),ie(A[k+1],g.cm.options))}f.styleClasses&&(f.styleClasses.bgClass&&(d.bgClass=v(f.styleClasses.bgClass,d.bgClass||"")),f.styleClasses.textClass&&(d.textClass=v(f.styleClasses.textClass,d.textClass||"")));0==d.map.length&&d.map.push(0,0,d.content.appendChild($f(a.display.measure)));0==t?(b.measure.map=d.map,b.measure.cache={}):((b.measure.maps||(b.measure.maps=[])).push(d.map),(b.measure.caches||
(b.measure.caches=[])).push({}))}oa&&(t=d.content.lastChild,/\bcm-tab\b/.test(t.className)||t.querySelector&&t.querySelector(".cm-tab"))&&(d.content.className="cm-tab-wrap-hack");fa(a,"renderLine",a,b.line,d.pre);d.pre.className&&(d.textClass=v(d.pre.className,d.textClass||""));return d}function ig(b){var c=a("span","\u2022","cm-invalidchar");c.title="\\u"+b.charCodeAt(0).toString(16);c.setAttribute("aria-label",c.title);return c}function gg(b,c,d,f,g,e,h){if(c){var t;if(b.splitSpaces)if(t=b.trailingSpace,
1<c.length&&!/  /.test(c))t=c;else{for(var A="",M=0;M<c.length;M++){var l=c.charAt(M);" "!=l||!t||M!=c.length-1&&32!=c.charCodeAt(M+1)||(l="\u00a0");A+=l;t=" "==l}t=A}else t=c;A=t;M=b.cm.state.specialChars;l=!1;if(M.test(c)){t=document.createDocumentFragment();for(var k=0;;){M.lastIndex=k;var N=M.exec(c),aa=N?N.index-k:c.length-k;if(aa){var p=document.createTextNode(A.slice(k,k+aa));Z&&9>da?t.appendChild(a("span",[p])):t.appendChild(p);b.map.push(b.pos,b.pos+aa,p);b.col+=aa;b.pos+=aa}if(!N)break;
k+=aa+1;"\t"==N[0]?(N=b.cm.options.tabSize,N-=b.col%N,aa=t.appendChild(a("span",q(N),"cm-tab")),aa.setAttribute("role","presentation"),aa.setAttribute("cm-text","\t"),b.col+=N):("\r"==N[0]||"\n"==N[0]?(aa=t.appendChild(a("span","\r"==N[0]?"\u240d":"\u2424","cm-invalidchar")),aa.setAttribute("cm-text",N[0])):(aa=b.cm.options.specialCharPlaceholder(N[0]),aa.setAttribute("cm-text",N[0]),Z&&9>da?t.appendChild(a("span",[aa])):t.appendChild(aa)),b.col+=1);b.map.push(b.pos,b.pos+1,aa);b.pos++}}else b.col+=
c.length,t=document.createTextNode(A),b.map.push(b.pos,b.pos+c.length,t),Z&&9>da&&(l=!0),b.pos+=c.length;b.trailingSpace=32==A.charCodeAt(c.length-1);if(d||f||g||l||h)return c=d||"",f&&(c+=f),g&&(c+=g),f=a("span",[t],c,h),e&&(f.title=e),b.content.appendChild(f);b.content.appendChild(t)}}function hg(a,b){return function(c,d,t,f,g,A,e){t=t?t+" cm-force-border":"cm-force-border";for(var h=c.pos,M=h+d.length;;){for(var l=void 0,k=0;k<b.length&&!(l=b[k],l.to>h&&l.from<=h);k++);if(l.to>=M)return a(c,d,
t,f,g,A,e);a(c,d.slice(0,l.to-h),t,f,null,A,e);f=null;d=d.slice(l.to-h);h=l.to}}}function ke(a,b,c,d){var t=!d&&c.widgetNode;t&&a.map.push(a.pos,a.pos+b,t);!d&&a.cm.display.input.needsContentAttribute&&(t||(t=a.content.appendChild(document.createElement("span"))),t.setAttribute("cm-marker",c.id));t&&(a.cm.display.input.setUneditable(t),a.content.appendChild(t));a.pos+=b;a.trailingSpace=!1}function le(a,b,c){for(var d=this.line=b,t;d=qa(d,!1);)d=d.find(1,!0).line,(t||(t=[])).push(d);this.size=(this.rest=
t)?L(x(this.rest))-c+1:1;this.node=this.text=null;this.hidden=bb(a,b)}function Fc(a,b,c){var d=[],t;for(t=b;t<c;)b=new le(a.doc,I(a.doc,t),t),t+=b.size,d.push(b);return d}function jg(a,b){if(a=a.ownsGroup)try{var c=a.delayedCallbacks,d=0;do{for(;d<c.length;d++)c[d].call(null);for(var t=0;t<a.ops.length;t++){var f=a.ops[t];if(f.cursorActivityHandlers)for(;f.cursorActivityCalled<f.cursorActivityHandlers.length;)f.cursorActivityHandlers[f.cursorActivityCalled++].call(null,f.cm)}}while(d<c.length)}finally{yb=
null,b(a)}}function la(a,b){var c=a._handlers&&a._handlers[b]||Cc;if(c.length){var d=Array.prototype.slice.call(arguments,2),t;yb?t=yb.delayedCallbacks:Ub?t=Ub:(t=Ub=[],setTimeout(kg,0));for(var f=function(a){t.push(function(){return c[a].apply(null,d)})},g=0;g<c.length;++g)f(g)}}function kg(){var a=Ub;Ub=null;for(var b=0;b<a.length;++b)a[b]()}function me(a,b,c,d){for(var t=0;t<b.changes.length;t++){var f=b.changes[t];if("text"==f){var f=a,g=b,A=g.text.className,e=ne(f,g);g.text==g.node&&(g.node=
e.pre);g.text.parentNode.replaceChild(e.pre,g.text);g.text=e.pre;e.bgClass!=g.bgClass||e.textClass!=g.textClass?(g.bgClass=e.bgClass,g.textClass=e.textClass,nd(f,g)):A&&(g.text.className=A)}else if("gutter"==f)oe(a,b,c,d);else if("class"==f)nd(a,b);else if("widget"==f){f=a;g=b;A=d;g.alignable&&(g.alignable=null);for(var e=g.node.firstChild,h;e;e=h)h=e.nextSibling,"CodeMirror-linewidget"==e.className&&g.node.removeChild(e);pe(f,g,A)}}b.changes=null}function Vb(b){b.node==b.text&&(b.node=a("div",null,
null,"position: relative"),b.text.parentNode&&b.text.parentNode.replaceChild(b.node,b.text),b.node.appendChild(b.text),Z&&8>da&&(b.node.style.zIndex=2));return b.node}function ne(a,b){var c=a.display.externalMeasured;return c&&c.line==b.line?(a.display.externalMeasured=null,b.measure=c.measure,c.built):je(a,b)}function nd(b,c){var d=c.bgClass?c.bgClass+" "+(c.line.bgClass||""):c.line.bgClass;d&&(d+=" CodeMirror-linebackground");if(c.background)d?c.background.className=d:(c.background.parentNode.removeChild(c.background),
c.background=null);else if(d){var t=Vb(c);c.background=t.insertBefore(a("div",null,d),t.firstChild);b.display.input.setUneditable(c.background)}c.line.wrapClass?Vb(c).className=c.line.wrapClass:c.node!=c.text&&(c.node.className="");c.text.className=(c.textClass?c.textClass+" "+(c.line.textClass||""):c.line.textClass)||""}function oe(b,c,d,f){c.gutter&&(c.node.removeChild(c.gutter),c.gutter=null);c.gutterBackground&&(c.node.removeChild(c.gutterBackground),c.gutterBackground=null);if(c.line.gutterClass){var t=
Vb(c);c.gutterBackground=a("div",null,"CodeMirror-gutter-background "+c.line.gutterClass,"left: "+(b.options.fixedGutter?f.fixedPos:-f.gutterTotalWidth)+"px; width: "+f.gutterTotalWidth+"px");b.display.input.setUneditable(c.gutterBackground);t.insertBefore(c.gutterBackground,c.text)}t=c.line.gutterMarkers;if(b.options.lineNumbers||t){var g=Vb(c),e=c.gutter=a("div",null,"CodeMirror-gutter-wrapper","left: "+(b.options.fixedGutter?f.fixedPos:-f.gutterTotalWidth)+"px");b.display.input.setUneditable(e);
g.insertBefore(e,c.text);c.line.gutterClass&&(e.className+=" "+c.line.gutterClass);!b.options.lineNumbers||t&&t["CodeMirror-linenumbers"]||(c.lineNumber=e.appendChild(a("div",X(b.options,d),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+f.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+b.display.lineNumInnerWidth+"px")));if(t)for(c=0;c<b.options.gutters.length;++c)d=b.options.gutters[c],(g=t.hasOwnProperty(d)&&t[d])&&e.appendChild(a("div",[g],"CodeMirror-gutter-elt","left: "+f.gutterLeft[d]+
"px; width: "+f.gutterWidth[d]+"px"))}}function lg(a,b,c,d){var t=ne(a,b);b.text=b.node=t.pre;t.bgClass&&(b.bgClass=t.bgClass);t.textClass&&(b.textClass=t.textClass);nd(a,b);oe(a,b,c,d);pe(a,b,d);return b.node}function pe(a,b,c){qe(a,b.line,b,c,!0);if(b.rest)for(var d=0;d<b.rest.length;d++)qe(a,b.rest[d],b,c,!1)}function qe(b,c,d,f,g){if(c.widgets){var t=Vb(d),e=0;for(c=c.widgets;e<c.length;++e){var A=c[e],h=a("div",[A.node],"CodeMirror-linewidget");A.handleMouseEvents||h.setAttribute("cm-ignore-events",
"true");var M=A,l=h,k=f;if(M.noHScroll){(d.alignable||(d.alignable=[])).push(l);var q=k.wrapperWidth;l.style.left=k.fixedPos+"px";M.coverGutter||(q-=k.gutterTotalWidth,l.style.paddingLeft=k.gutterTotalWidth+"px");l.style.width=q+"px"}M.coverGutter&&(l.style.zIndex=5,l.style.position="relative",M.noHScroll||(l.style.marginLeft=-k.gutterTotalWidth+"px"));b.display.input.setUneditable(h);g&&A.above?t.insertBefore(h,d.gutter||d.text):t.appendChild(h);la(A,"redraw")}}}function Wb(b){if(null!=b.height)return b.height;
var c=b.doc.cm;if(!c)return 0;if(!l(document.body,b.node)){var d="position: relative;";b.coverGutter&&(d+="margin-left: -"+c.display.gutters.offsetWidth+"px;");b.noHScroll&&(d+="width: "+c.display.wrapper.clientWidth+"px;");r(c.display.measure,a("div",[b.node],null,d))}return b.height=b.node.parentNode.offsetHeight}function Qa(a,b){for(b=b.target||b.srcElement;b!=a.wrapper;b=b.parentNode)if(!b||1==b.nodeType&&"true"==b.getAttribute("cm-ignore-events")||b.parentNode==a.sizer&&b!=a.mover)return!0}function od(a){return a.mover.offsetHeight-
a.lineSpace.offsetHeight}function re(b){if(b.cachedPaddingH)return b.cachedPaddingH;var c=r(b.measure,a("pre","x")),c=window.getComputedStyle?window.getComputedStyle(c):c.currentStyle,c={left:parseInt(c.paddingLeft),right:parseInt(c.paddingRight)};isNaN(c.left)||isNaN(c.right)||(b.cachedPaddingH=c);return c}function La(a){return 30-a.display.nativeBarWidth}function eb(a){return a.display.scroller.clientWidth-La(a)-a.display.barWidth}function pd(a){return a.display.scroller.clientHeight-La(a)-a.display.barHeight}
function se(a,b,c){if(a.line==b)return{map:a.measure.map,cache:a.measure.cache};for(var d=0;d<a.rest.length;d++)if(a.rest[d]==b)return{map:a.measure.maps[d],cache:a.measure.caches[d]};for(b=0;b<a.rest.length;b++)if(L(a.rest[b])>c)return{map:a.measure.maps[b],cache:a.measure.caches[b],before:!0}}function qd(a,b){if(b>=a.display.viewFrom&&b<a.display.viewTo)return a.display.view[fb(a,b)];if((a=a.display.externalMeasured)&&b>=a.lineN&&b<a.lineN+a.size)return a}function tb(a,b){var c=L(b),d=qd(a,c);d&&
!d.text?d=null:d&&d.changes&&(me(a,d,c,rd(a)),a.curOp.forceUpdate=!0);if(!d){var t;t=ra(b);d=L(t);t=a.display.externalMeasured=new le(a.doc,t,d);t.lineN=d;d=t.built=je(a,t);t.text=d.pre;r(a.display.lineMeasure,d.pre);d=t}a=se(d,b,c);return{line:b,view:d,rect:null,map:a.map,cache:a.cache,before:a.before,hasHeights:!1}}function Oa(b,c,d,f,g){c.before&&(d=-1);var t=d+(f||"");if(c.cache.hasOwnProperty(t))b=c.cache[t];else{c.rect||(c.rect=c.view.text.getBoundingClientRect());if(!c.hasHeights){var e=c.view,
A=c.rect,h=b.options.lineWrapping,l=h&&eb(b);if(!e.measure.heights||h&&e.measure.width!=l){var k=e.measure.heights=[];if(h)for(e.measure.width=l,e=e.text.firstChild.getClientRects(),h=0;h<e.length-1;h++){var l=e[h],M=e[h+1];2<Math.abs(l.bottom-M.bottom)&&k.push((l.bottom+M.top)/2-A.top)}k.push(A.bottom-A.top)}c.hasHeights=!0}k=f;e=te(c.map,d,k);f=e.node;A=e.start;h=e.end;d=e.collapse;var q;if(3==f.nodeType){for(var N=0;4>N;N++){for(;A&&G(c.line.text.charAt(e.coverStart+A));)--A;for(;e.coverStart+
h<e.coverEnd&&G(c.line.text.charAt(e.coverStart+h));)++h;if(Z&&9>da&&0==A&&h==e.coverEnd-e.coverStart)q=f.parentNode.getBoundingClientRect();else{q=xb(f,A,h).getClientRects();h=ue;if("left"==k)for(l=0;l<q.length&&(h=q[l]).left==h.right;l++);else for(l=q.length-1;0<=l&&(h=q[l]).left==h.right;l--);q=h}if(q.left||q.right||0==A)break;h=A;--A;d="right"}Z&&11>da&&((N=!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI)||(null!=sd?N=sd:(k=r(b.display.measure,a("span","x")),N=
k.getBoundingClientRect(),k=xb(k,0,1).getBoundingClientRect(),N=sd=1<Math.abs(N.left-k.left)),N=!N),N||(N=screen.logicalXDPI/screen.deviceXDPI,k=screen.logicalYDPI/screen.deviceYDPI,q={left:q.left*N,right:q.right*N,top:q.top*k,bottom:q.bottom*k}))}else 0<A&&(d=k="right"),q=b.options.lineWrapping&&1<(N=f.getClientRects()).length?N["right"==k?N.length-1:0]:f.getBoundingClientRect();!(Z&&9>da)||A||q&&(q.left||q.right)||(q=(q=f.parentNode.getClientRects()[0])?{left:q.left,right:q.left+Xb(b.display),top:q.top,
bottom:q.bottom}:ue);f=q.top-c.rect.top;A=q.bottom-c.rect.top;N=(f+A)/2;k=c.view.measure.heights;for(e=0;e<k.length-1&&!(N<k[e]);e++);d={left:("right"==d?q.right:q.left)-c.rect.left,right:("left"==d?q.left:q.right)-c.rect.left,top:e?k[e-1]:0,bottom:k[e]};q.left||q.right||(d.bogus=!0);b.options.singleCursorHeightPerLine||(d.rtop=f,d.rbottom=A);b=d;b.bogus||(c.cache[t]=b)}return{left:b.left,right:b.right,top:g?b.rtop:b.top,bottom:g?b.rbottom:b.bottom}}function te(a,b,c){for(var d,t,f,g,e,A,h=0;h<a.length;h+=
3){e=a[h];A=a[h+1];if(b<e)t=0,f=1,g="left";else if(b<A)t=b-e,f=t+1;else if(h==a.length-3||b==A&&a[h+3]>b)f=A-e,t=f-1,b>=A&&(g="right");if(null!=t){d=a[h+2];e==A&&c==(d.insertLeft?"left":"right")&&(g=c);if("left"==c&&0==t)for(;h&&a[h-2]==a[h-3]&&a[h-1].insertLeft;)d=a[(h-=3)+2],g="left";if("right"==c&&t==A-e)for(;h<a.length-3&&a[h+3]==a[h+4]&&!a[h+5].insertLeft;)d=a[(h+=3)+2],g="right";break}}return{node:d,start:t,end:f,collapse:g,coverStart:e,coverEnd:A}}function ve(a){if(a.measure&&(a.measure.cache=
{},a.measure.heights=null,a.rest))for(var b=0;b<a.rest.length;b++)a.measure.caches[b]={}}function we(a){a.display.externalMeasure=null;e(a.display.lineMeasure);for(var b=0;b<a.display.view.length;b++)ve(a.display.view[b])}function Yb(a){we(a);a.display.cachedCharWidth=a.display.cachedTextHeight=a.display.cachedPaddingH=null;a.options.lineWrapping||(a.display.maxLineChanged=!0);a.display.lineNumChars=null}function xe(){return Gc&&Hc?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):
window.pageXOffset||(document.documentElement||document.body).scrollLeft}function ye(){return Gc&&Hc?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function cb(a,b,c,d,f){if(!f&&b.widgets)for(f=0;f<b.widgets.length;++f)if(b.widgets[f].above){var t=Wb(b.widgets[f]);c.top+=t;c.bottom+=t}if("line"==d)return c;d||(d="local");b=Ga(b);b="local"==d?b+a.display.lineSpace.offsetTop:b-a.display.viewOffset;
if("page"==d||"window"==d)a=a.display.lineSpace.getBoundingClientRect(),b+=a.top+("window"==d?0:ye()),d=a.left+("window"==d?0:xe()),c.left+=d,c.right+=d;c.top+=b;c.bottom+=b;return c}function ze(a,b,c){if("div"==c)return b;var d=b.left;b=b.top;"page"==c?(d-=xe(),b-=ye()):"local"!=c&&c||(c=a.display.sizer.getBoundingClientRect(),d+=c.left,b+=c.top);a=a.display.lineSpace.getBoundingClientRect();return{left:d-a.left,top:b-a.top}}function Ic(a,b,c,d,f){d||(d=I(a.doc,b.line));var t=d;b=b.ch;d=Oa(a,tb(a,
d),b,f);return cb(a,t,d,c)}function Ia(a,b,c,d,f,g){function t(b,t){b=Oa(a,f,b,t?"right":"left",g);t?b.left=b.right:b.right=b.left;return cb(a,d,b,c)}function e(a,b,c){return t(c?a-1:a,0!=A[b].level%2!=c)}d=d||I(a.doc,b.line);f||(f=tb(a,d));var A=Va(d,a.doc.direction),h=b.ch;b=b.sticky;h>=d.text.length?(h=d.text.length,b="before"):0>=h&&(h=0,b="after");if(!A)return t("before"==b?h-1:h,"before"==b);var l=bd(A,h,b),k=Rb,l=e(h,l,"before"==b);null!=k&&(l.other=e(h,k,"before"!=b));return l}function Ae(a,
b){var c=0;b=T(a.doc,b);a.options.lineWrapping||(c=Xb(a.display)*b.ch);b=I(a.doc,b.line);a=Ga(b)+a.display.lineSpace.offsetTop;return{left:c,right:c,top:a,bottom:a+b.height}}function td(a,b,c){var d=a.doc;c+=a.display.viewOffset;if(0>c)return a=K(d.first,0,null),a.xRel=-1,a.outside=!0,a;var t=Q(d,c),f=d.first+d.size-1;if(t>f)return a=I(d,f).text.length,a=K(d.first+d.size-1,a,null),a.xRel=1,a.outside=!0,a;0>b&&(b=0);for(f=I(d,t);;)if(d=mg(a,f,t,b,c),f=(t=qa(f,!1))&&t.find(0,!0),t&&(d.ch>f.from.ch||
d.ch==f.from.ch&&0<d.xRel))t=L(f=f.to.line);else return d}function Xd(a,b,c,d){var t=b.text.length,f=D(function(t){return cb(a,b,Oa(a,c,t-1),"line").bottom<=d},t,0),t=D(function(t){return cb(a,b,Oa(a,c,t),"line").top>d},f,t);return{begin:f,end:t}}function mg(a,b,c,d,f){f-=Ga(b);var t=0,g=b.text.length,e=tb(a,b);if(Va(b,a.doc.direction)){if(a.options.lineWrapping){var A;A=Xd(a,b,e,f);t=A.begin;g=A.end;A}c=new K(c,Math.floor(t+(g-t)/2));var h=Ia(a,c,"line",b,e).left;A=h<d?1:-1;var l=h-d,k,q=Math.ceil((g-
t)/4);a:do{h=l;k=c;for(var M=0;M<q;++M){var N=c;c=Wd(a,b,c,A);if(null==c||c.ch<t||g<=("before"==c.sticky?c.ch-1:c.ch)){c=N;break a}}l=Ia(a,c,"line",b,e).left-d;1<q&&(q=Math.min(q,Math.ceil(Math.abs(l)/(Math.abs(l-h)/q))),A=0>l?1:-1)}while(0!=l&&(1<q||0>A!=0>l&&Math.abs(l)<=Math.abs(h)));if(Math.abs(l)>Math.abs(h)){if(0>l==0>h)throw Error("Broke out of infinite loop in coordsCharInner");c=k}}else t=D(function(c){var t=cb(a,b,Oa(a,e,c),"line");return t.top>f?(g=Math.min(c,g),!0):t.bottom<=f?!1:t.left>
d?!0:t.right<d?!1:d-t.left<t.right-d},t,g),t=J(b.text,t,1),c=new K(c,t,t==g?"before":"after");t=Ia(a,c,"line",b,e);if(f<t.top||t.bottom<f)c.outside=!0;c.xRel=d<t.left?-1:d>t.right?1:0;return c}function gb(b){if(null!=b.cachedTextHeight)return b.cachedTextHeight;if(null==hb){hb=a("pre");for(var c=0;49>c;++c)hb.appendChild(document.createTextNode("x")),hb.appendChild(a("br"));hb.appendChild(document.createTextNode("x"))}r(b.measure,hb);c=hb.offsetHeight/50;3<c&&(b.cachedTextHeight=c);e(b.measure);return c||
1}function Xb(b){if(null!=b.cachedCharWidth)return b.cachedCharWidth;var c=a("span","xxxxxxxxxx"),d=a("pre",[c]);r(b.measure,d);c=c.getBoundingClientRect();c=(c.right-c.left)/10;2<c&&(b.cachedCharWidth=c);return c||10}function rd(a){for(var b=a.display,c={},d={},t=b.gutters.clientLeft,f=b.gutters.firstChild,g=0;f;f=f.nextSibling,++g)c[a.options.gutters[g]]=f.offsetLeft+f.clientLeft+t,d[a.options.gutters[g]]=f.clientWidth;return{fixedPos:ud(b),gutterTotalWidth:b.gutters.offsetWidth,gutterLeft:c,gutterWidth:d,
wrapperWidth:b.wrapper.clientWidth}}function ud(a){return a.scroller.getBoundingClientRect().left-a.sizer.getBoundingClientRect().left}function Be(a){var b=gb(a.display),c=a.options.lineWrapping,d=c&&Math.max(5,a.display.scroller.clientWidth/Xb(a.display)-3);return function(t){if(bb(a.doc,t))return 0;var f=0;if(t.widgets)for(var g=0;g<t.widgets.length;g++)t.widgets[g].height&&(f+=t.widgets[g].height);return c?f+(Math.ceil(t.text.length/d)||1)*b:f+b}}function vd(a){var b=a.doc,c=Be(a);b.iter(function(a){var b=
c(a);b!=a.height&&V(a,b)})}function ib(a,b,c,d){var t=a.display;if(!c&&"true"==(b.target||b.srcElement).getAttribute("cm-not-content"))return null;var f,e;c=t.lineSpace.getBoundingClientRect();try{f=b.clientX-c.left,e=b.clientY-c.top}catch(Vd){return null}b=td(a,f,e);var A;d&&1==b.xRel&&(A=I(a.doc,b.line).text).length==b.ch&&(d=g(A,A.length,a.options.tabSize)-A.length,b=K(b.line,Math.max(0,Math.round((f-re(a.display).left)/Xb(a.display))-d)));return b}function fb(a,b){if(b>=a.display.viewTo)return null;
b-=a.display.viewFrom;if(0>b)return null;a=a.display.view;for(var c=0;c<a.length;c++)if(b-=a[c].size,0>b)return c}function Zb(a){a.display.input.showSelection(a.display.input.prepareSelection())}function Ce(a,b){for(var c=a.doc,d={},t=d.cursors=document.createDocumentFragment(),f=d.selection=document.createDocumentFragment(),g=0;g<c.sel.ranges.length;g++)if(!1!==b||g!=c.sel.primIndex){var e=c.sel.ranges[g];if(!(e.from().line>=a.display.viewTo||e.to().line<a.display.viewFrom)){var A=e.empty();(A||
a.options.showCursorWhenSelecting)&&De(a,e.head,t);A||ng(a,e,f)}}return d}function De(b,c,d){c=Ia(b,c,"div",null,null,!b.options.singleCursorHeightPerLine);var t=d.appendChild(a("div","\u00a0","CodeMirror-cursor"));t.style.left=c.left+"px";t.style.top=c.top+"px";t.style.height=Math.max(0,c.bottom-c.top)*b.options.cursorHeight+"px";c.other&&(b=d.appendChild(a("div","\u00a0","CodeMirror-cursor CodeMirror-secondarycursor")),b.style.display="",b.style.left=c.other.left+"px",b.style.top=c.other.top+"px",
b.style.height=.85*(c.other.bottom-c.other.top)+"px")}function ng(b,c,d){function t(b,c,d,t){0>c&&(c=0);c=Math.round(c);t=Math.round(t);A.appendChild(a("div",null,"CodeMirror-selected","position: absolute; left: "+b+"px;\n                             top: "+c+"px; width: "+(null==d?k-b:d)+"px;\n                             height: "+(t-c)+"px"))}function f(a,c,d){var f=I(e,a),g=f.text.length,A,h;Yf(Va(f,e.direction),c||0,null==d?g:d,function(e,q,M){var N=Ic(b,K(a,e),"div",f,"left"),aa,p;e==q?(aa=
N,M=p=N.left):(aa=Ic(b,K(a,q-1),"div",f,"right"),"rtl"==M&&(M=N,N=aa,aa=M),M=N.left,p=aa.right);null==c&&0==e&&(M=l);3<aa.top-N.top&&(t(M,N.top,null,N.bottom),M=l,N.bottom<aa.top&&t(M,N.bottom,null,aa.top));null==d&&q==g&&(p=k);if(!A||N.top<A.top||N.top==A.top&&N.left<A.left)A=N;if(!h||aa.bottom>h.bottom||aa.bottom==h.bottom&&aa.right>h.right)h=aa;M<l+1&&(M=l);t(M,aa.top,p-M,aa.bottom)});return{start:A,end:h}}var g=b.display,e=b.doc,A=document.createDocumentFragment(),h=re(b.display),l=h.left,k=Math.max(g.sizerWidth,
eb(b)-g.sizer.offsetLeft)-h.right,g=c.from();c=c.to();if(g.line==c.line)f(g.line,g.ch,c.ch);else{var q=I(e,g.line),h=I(e,c.line),h=ra(q)==ra(h),g=f(g.line,g.ch,h?q.text.length+1:null).end;c=f(c.line,h?0:null,c.ch).start;h&&(g.top<c.top-2?(t(g.right,g.top,null,g.bottom),t(l,c.top,c.left,c.bottom)):t(g.right,g.top,c.left-g.right,g.bottom));g.bottom<c.top&&t(l,g.bottom,null,c.top)}d.appendChild(A)}function wd(a){if(a.state.focused){var b=a.display;clearInterval(b.blinker);var c=!0;b.cursorDiv.style.visibility=
"";0<a.options.cursorBlinkRate?b.blinker=setInterval(function(){return b.cursorDiv.style.visibility=(c=!c)?"":"hidden"},a.options.cursorBlinkRate):0>a.options.cursorBlinkRate&&(b.cursorDiv.style.visibility="hidden")}}function Ee(a){a.state.focused||(a.display.input.focus(),xd(a))}function Fe(a){a.state.delayingBlurEvent=!0;setTimeout(function(){a.state.delayingBlurEvent&&(a.state.delayingBlurEvent=!1,$b(a))},100)}function xd(a,b){a.state.delayingBlurEvent&&(a.state.delayingBlurEvent=!1);"nocursor"!=
a.options.readOnly&&(a.state.focused||(fa(a,"focus",a,b),a.state.focused=!0,w(a.display.wrapper,"CodeMirror-focused"),a.curOp||a.display.selForContextMenu==a.doc.sel||(a.display.input.reset(),oa&&setTimeout(function(){return a.display.input.reset(!0)},20)),a.display.input.receivedFocus()),wd(a))}function $b(a,b){a.state.delayingBlurEvent||(a.state.focused&&(fa(a,"blur",a,b),a.state.focused=!1,jb(a.display.wrapper,"CodeMirror-focused")),clearInterval(a.display.blinker),setTimeout(function(){a.state.focused||
(a.display.shift=!1)},150))}function Jc(a){a=a.display;for(var b=a.lineDiv.offsetTop,c=0;c<a.view.length;c++){var d=a.view[c],t;if(!d.hidden){if(Z&&8>da){var f=d.node.offsetTop+d.node.offsetHeight;t=f-b;b=f}else t=d.node.getBoundingClientRect(),t=t.bottom-t.top;f=d.line.height-t;2>t&&(t=gb(a));if(.005<f||-.005>f)if(V(d.line,t),Ge(d.line),d.rest)for(t=0;t<d.rest.length;t++)Ge(d.rest[t])}}}function Ge(a){if(a.widgets)for(var b=0;b<a.widgets.length;++b)a.widgets[b].height=a.widgets[b].node.parentNode.offsetHeight}
function yd(a,b,c){var d=c&&null!=c.top?Math.max(0,c.top):a.scroller.scrollTop,d=Math.floor(d-a.lineSpace.offsetTop),t=c&&null!=c.bottom?c.bottom:d+a.wrapper.clientHeight,d=Q(b,d),t=Q(b,t);if(c&&c.ensure){var f=c.ensure.from.line;c=c.ensure.to.line;f<d?(d=f,t=Q(b,Ga(I(b,f))+a.wrapper.clientHeight)):Math.min(c,b.lastLine())>=t&&(d=Q(b,Ga(I(b,c))-a.wrapper.clientHeight),t=c)}return{from:d,to:Math.max(t,d+1)}}function He(a){var b=a.display,c=b.view;if(b.alignWidgets||b.gutters.firstChild&&a.options.fixedGutter){for(var d=
ud(b)-b.scroller.scrollLeft+a.doc.scrollLeft,t=b.gutters.offsetWidth,f=d+"px",g=0;g<c.length;g++)if(!c[g].hidden){a.options.fixedGutter&&(c[g].gutter&&(c[g].gutter.style.left=f),c[g].gutterBackground&&(c[g].gutterBackground.style.left=f));var e=c[g].alignable;if(e)for(var h=0;h<e.length;h++)e[h].style.left=f}a.options.fixedGutter&&(b.gutters.style.left=d+t+"px")}}function Ie(b){if(!b.options.lineNumbers)return!1;var c=b.doc,c=X(b.options,c.first+c.size-1),d=b.display;if(c.length!=d.lineNumChars){var t=
d.measure.appendChild(a("div",[a("div",c)],"CodeMirror-linenumber CodeMirror-gutter-elt")),f=t.firstChild.offsetWidth,t=t.offsetWidth-f;d.lineGutter.style.width="";d.lineNumInnerWidth=Math.max(f,d.lineGutter.offsetWidth-t)+1;d.lineNumWidth=d.lineNumInnerWidth+t;d.lineNumChars=d.lineNumInnerWidth?c.length:-1;d.lineGutter.style.width=d.lineNumWidth+"px";zd(b);return!0}return!1}function Ad(a,b){var c=a.display,d=gb(a.display);0>b.top&&(b.top=0);var t=a.curOp&&null!=a.curOp.scrollTop?a.curOp.scrollTop:
c.scroller.scrollTop,f=pd(a),g={};b.bottom-b.top>f&&(b.bottom=b.top+f);var e=a.doc.height+od(c),h=b.top<d,d=b.bottom>e-d;b.top<t?g.scrollTop=h?0:b.top:b.bottom>t+f&&(f=Math.min(b.top,(d?e:b.bottom)-f),f!=t&&(g.scrollTop=f));t=a.curOp&&null!=a.curOp.scrollLeft?a.curOp.scrollLeft:c.scroller.scrollLeft;a=eb(a)-(a.options.fixedGutter?c.gutters.offsetWidth:0);if(c=b.right-b.left>a)b.right=b.left+a;10>b.left?g.scrollLeft=0:b.left<t?g.scrollLeft=Math.max(0,b.left-(c?0:10)):b.right>a+t-3&&(g.scrollLeft=b.right+
(c?0:10)-a);return g}function Kc(a,b){null!=b&&(Lc(a),a.curOp.scrollTop=(null==a.curOp.scrollTop?a.doc.scrollTop:a.curOp.scrollTop)+b)}function zb(a){Lc(a);var b=a.getCursor();a.curOp.scrollToPos={from:b,to:b,margin:a.options.cursorScrollMargin}}function ac(a,b,c){null==b&&null==c||Lc(a);null!=b&&(a.curOp.scrollLeft=b);null!=c&&(a.curOp.scrollTop=c)}function Lc(a){var b=a.curOp.scrollToPos;if(b){a.curOp.scrollToPos=null;var c=Ae(a,b.from),d=Ae(a,b.to);Je(a,c,d,b.margin)}}function Je(a,b,c,d){b=Ad(a,
{left:Math.min(b.left,c.left),top:Math.min(b.top,c.top)-d,right:Math.max(b.right,c.right),bottom:Math.max(b.bottom,c.bottom)+d});ac(a,b.scrollLeft,b.scrollTop)}function bc(a,b){2>Math.abs(a.doc.scrollTop-b)||(Ta||Bd(a,{top:b}),Ke(a,b,!0),Ta&&Bd(a),cc(a,100))}function Ke(a,b,c){b=Math.min(a.display.scroller.scrollHeight-a.display.scroller.clientHeight,b);if(a.display.scroller.scrollTop!=b||c)a.doc.scrollTop=b,a.display.scrollbars.setScrollTop(b),a.display.scroller.scrollTop!=b&&(a.display.scroller.scrollTop=
b)}function kb(a,b,c,d){b=Math.min(b,a.display.scroller.scrollWidth-a.display.scroller.clientWidth);(c?b==a.doc.scrollLeft:2>Math.abs(a.doc.scrollLeft-b))&&!d||(a.doc.scrollLeft=b,He(a),a.display.scroller.scrollLeft!=b&&(a.display.scroller.scrollLeft=b),a.display.scrollbars.setScrollLeft(b))}function dc(a){var b=a.display,c=b.gutters.offsetWidth,d=Math.round(a.doc.height+od(a.display));return{clientHeight:b.scroller.clientHeight,viewHeight:b.wrapper.clientHeight,scrollWidth:b.scroller.scrollWidth,
clientWidth:b.scroller.clientWidth,viewWidth:b.wrapper.clientWidth,barLeft:a.options.fixedGutter?c:0,docHeight:d,scrollHeight:d+La(a)+b.barHeight,nativeBarWidth:b.nativeBarWidth,gutterWidth:c}}function Ab(a,b){b||(b=dc(a));var c=a.display.barWidth,d=a.display.barHeight;Le(a,b);for(b=0;4>b&&c!=a.display.barWidth||d!=a.display.barHeight;b++)c!=a.display.barWidth&&a.options.lineWrapping&&Jc(a),Le(a,dc(a)),c=a.display.barWidth,d=a.display.barHeight}function Le(a,b){var c=a.display,d=c.scrollbars.update(b);
c.sizer.style.paddingRight=(c.barWidth=d.right)+"px";c.sizer.style.paddingBottom=(c.barHeight=d.bottom)+"px";c.heightForcer.style.borderBottom=d.bottom+"px solid transparent";d.right&&d.bottom?(c.scrollbarFiller.style.display="block",c.scrollbarFiller.style.height=d.bottom+"px",c.scrollbarFiller.style.width=d.right+"px"):c.scrollbarFiller.style.display="";d.bottom&&a.options.coverGutterNextToScrollbar&&a.options.fixedGutter?(c.gutterFiller.style.display="block",c.gutterFiller.style.height=d.bottom+
"px",c.gutterFiller.style.width=b.gutterWidth+"px"):c.gutterFiller.style.display=""}function Me(a){a.display.scrollbars&&(a.display.scrollbars.clear(),a.display.scrollbars.addClass&&jb(a.display.wrapper,a.display.scrollbars.addClass));a.display.scrollbars=new Ne[a.options.scrollbarStyle](function(b){a.display.wrapper.insertBefore(b,a.display.scrollbarFiller);R(b,"mousedown",function(){a.state.focused&&setTimeout(function(){return a.display.input.focus()},0)});b.setAttribute("cm-not-content","true")},
function(b,c){"horizontal"==c?kb(a,b):bc(a,b)},a);a.display.scrollbars.addClass&&w(a.display.wrapper,a.display.scrollbars.addClass)}function lb(a){a.curOp={cm:a,viewChanged:!1,startHeight:a.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++og};a=a.curOp;yb?yb.ops.push(a):a.ownsGroup=yb={ops:[a],delayedCallbacks:[]}}function mb(b){jg(b.curOp,
function(b){for(var c=0;c<b.ops.length;c++)b.ops[c].cm.curOp=null;b=b.ops;for(c=0;c<b.length;c++){var d=b[c],f=d.cm,t=f.display,g=f.display;!g.scrollbarsClipped&&g.scroller.offsetWidth&&(g.nativeBarWidth=g.scroller.offsetWidth-g.scroller.clientWidth,g.heightForcer.style.height=La(f)+"px",g.sizer.style.marginBottom=-g.nativeBarWidth+"px",g.sizer.style.borderRightWidth=La(f)+"px",g.scrollbarsClipped=!0);d.updateMaxLine&&ad(f);d.mustUpdate=d.viewChanged||d.forceUpdate||null!=d.scrollTop||d.scrollToPos&&
(d.scrollToPos.from.line<t.viewFrom||d.scrollToPos.to.line>=t.viewTo)||t.maxLineChanged&&f.options.lineWrapping;d.update=d.mustUpdate&&new Mc(f,d.mustUpdate&&{top:d.scrollTop,ensure:d.scrollToPos},d.forceUpdate)}for(c=0;c<b.length;c++)d=b[c],d.updatedDisplay=d.mustUpdate&&Cd(d.cm,d.update);for(c=0;c<b.length;c++)if(d=b[c],f=d.cm,t=f.display,d.updatedDisplay&&Jc(f),d.barMeasure=dc(f),t.maxLineChanged&&!f.options.lineWrapping&&(g=t.maxLine.text.length,g=Oa(f,tb(f,t.maxLine),g,void 0),d.adjustWidthTo=
g.left+3,f.display.sizerWidth=d.adjustWidthTo,d.barMeasure.scrollWidth=Math.max(t.scroller.clientWidth,t.sizer.offsetLeft+d.adjustWidthTo+La(f)+f.display.barWidth),d.maxScrollLeft=Math.max(0,t.sizer.offsetLeft+d.adjustWidthTo-eb(f))),d.updatedDisplay||d.selectionChanged)d.preparedSelection=t.input.prepareSelection(d.focus);for(c=0;c<b.length;c++)d=b[c],f=d.cm,null!=d.adjustWidthTo&&(f.display.sizer.style.minWidth=d.adjustWidthTo+"px",d.maxScrollLeft<f.doc.scrollLeft&&kb(f,Math.min(f.display.scroller.scrollLeft,
d.maxScrollLeft),!0),f.display.maxLineChanged=!1),t=d.focus&&d.focus==p()&&(!document.hasFocus||document.hasFocus()),d.preparedSelection&&f.display.input.showSelection(d.preparedSelection,t),(d.updatedDisplay||d.startHeight!=f.doc.height)&&Ab(f,d.barMeasure),d.updatedDisplay&&Dd(f,d.barMeasure),d.selectionChanged&&wd(f),f.state.focused&&d.updateInput&&f.display.input.reset(d.typing),t&&Ee(d.cm);for(c=0;c<b.length;c++){d=b[c];f=d.cm;t=f.display;g=f.doc;d.updatedDisplay&&Oe(f,d.update);null==t.wheelStartX||
null==d.scrollTop&&null==d.scrollLeft&&!d.scrollToPos||(t.wheelStartX=t.wheelStartY=null);null!=d.scrollTop&&Ke(f,d.scrollTop,d.forceScroll);null!=d.scrollLeft&&kb(f,d.scrollLeft,!0,!0);if(d.scrollToPos){var e=T(g,d.scrollToPos.from),h=T(g,d.scrollToPos.to),A=d.scrollToPos.margin;null==A&&(A=0);var l=void 0;f.options.lineWrapping||e!=h||(e=e.ch?K(e.line,"before"==e.sticky?e.ch-1:e.ch,"after"):e,h="before"==e.sticky?K(e.line,e.ch+1,"before"):e);for(var k=0;5>k;k++){var q=!1,l=Ia(f,e),v=h&&h!=e?Ia(f,
h):l,l={left:Math.min(l.left,v.left),top:Math.min(l.top,v.top)-A,right:Math.max(l.left,v.left),bottom:Math.max(l.bottom,v.bottom)+A},v=Ad(f,l),x=f.doc.scrollTop,m=f.doc.scrollLeft;null!=v.scrollTop&&(bc(f,v.scrollTop),1<Math.abs(f.doc.scrollTop-x)&&(q=!0));null!=v.scrollLeft&&(kb(f,v.scrollLeft),1<Math.abs(f.doc.scrollLeft-m)&&(q=!0));if(!q)break}h=l;ia(f,"scrollCursorIntoView")||(A=f.display,k=A.sizer.getBoundingClientRect(),e=null,0>h.top+k.top?e=!0:h.bottom+k.top>(window.innerHeight||document.documentElement.clientHeight)&&
(e=!1),null==e||pg||(h=a("div","\u200b",null,"position: absolute;\n                         top: "+(h.top-A.viewOffset-f.display.lineSpace.offsetTop)+"px;\n                         height: "+(h.bottom-h.top+La(f)+A.barHeight)+"px;\n                         left: "+h.left+"px; width: "+Math.max(2,h.right-h.left)+"px;"),f.display.lineSpace.appendChild(h),h.scrollIntoView(e),f.display.lineSpace.removeChild(h)))}h=d.maybeHiddenMarkers;e=d.maybeUnhiddenMarkers;if(h)for(A=0;A<h.length;++A)h[A].lines.length||
fa(h[A],"hide");if(e)for(h=0;h<e.length;++h)e[h].lines.length&&fa(e[h],"unhide");t.wrapper.offsetHeight&&(g.scrollTop=f.display.scroller.scrollTop);d.changeObjs&&fa(f,"changes",f,d.changeObjs);d.update&&d.update.finish()}})}function za(a,b){if(a.curOp)return b();lb(a);try{return b()}finally{mb(a)}}function ja(a,b){return function(){if(a.curOp)return b.apply(a,arguments);lb(a);try{return b.apply(a,arguments)}finally{mb(a)}}}function va(a){return function(){if(this.curOp)return a.apply(this,arguments);
lb(this);try{return a.apply(this,arguments)}finally{mb(this)}}}function ka(a){return function(){var b=this.cm;if(!b||b.curOp)return a.apply(this,arguments);lb(b);try{return a.apply(this,arguments)}finally{mb(b)}}}function xa(a,b,c,d){null==b&&(b=a.doc.first);null==c&&(c=a.doc.first+a.doc.size);d||(d=0);var f=a.display;d&&c<f.viewTo&&(null==f.updateLineNumbers||f.updateLineNumbers>b)&&(f.updateLineNumbers=b);a.curOp.viewChanged=!0;if(b>=f.viewTo)Ua&&Ob(a.doc,b)<f.viewTo&&Wa(a);else if(c<=f.viewFrom)Ua&&
Pb(a.doc,c+d)>f.viewFrom?Wa(a):(f.viewFrom+=d,f.viewTo+=d);else if(b<=f.viewFrom&&c>=f.viewTo)Wa(a);else if(b<=f.viewFrom){var t=Nc(a,c,c+d,1);t?(f.view=f.view.slice(t.index),f.viewFrom=t.lineN,f.viewTo+=d):Wa(a)}else if(c>=f.viewTo)(t=Nc(a,b,b,-1))?(f.view=f.view.slice(0,t.index),f.viewTo=t.lineN):Wa(a);else{var t=Nc(a,b,b,-1),g=Nc(a,c,c+d,1);t&&g?(f.view=f.view.slice(0,t.index).concat(Fc(a,t.lineN,g.lineN)).concat(f.view.slice(g.index)),f.viewTo+=d):Wa(a)}if(a=f.externalMeasured)c<a.lineN?a.lineN+=
d:b<a.lineN+a.size&&(f.externalMeasured=null)}function Xa(a,b,c){a.curOp.viewChanged=!0;var f=a.display,t=a.display.externalMeasured;t&&b>=t.lineN&&b<t.lineN+t.size&&(f.externalMeasured=null);b<f.viewFrom||b>=f.viewTo||(a=f.view[fb(a,b)],null!=a.node&&(a=a.changes||(a.changes=[]),-1==d(a,c)&&a.push(c)))}function Wa(a){a.display.viewFrom=a.display.viewTo=a.doc.first;a.display.view=[];a.display.viewOffset=0}function Nc(a,b,c,d){var f=fb(a,b),t=a.display.view;if(!Ua||c==a.doc.first+a.doc.size)return{index:f,
lineN:c};for(var g=a.display.viewFrom,e=0;e<f;e++)g+=t[e].size;if(g!=b){if(0<d){if(f==t.length-1)return null;b=g+t[f].size-b;f++}else b=g-b;c+=b}for(;Ob(a.doc,c)!=c;){if(f==(0>d?0:t.length-1))return null;c+=d*t[f-(0>d?1:0)].size;f+=d}return{index:f,lineN:c}}function Pe(a){a=a.display.view;for(var b=0,c=0;c<a.length;c++){var d=a[c];d.hidden||d.node&&!d.changes||++b}return b}function cc(a,b){a.doc.highlightFrontier<a.display.viewTo&&a.state.highlight.set(b,k(qg,a))}function qg(a){var b=a.doc;if(!(b.highlightFrontier>=
a.display.viewTo)){var c=+new Date+a.options.workTime,d=Tb(a,b.highlightFrontier),f=[];b.iter(d.line,Math.min(b.first+b.size,a.display.viewTo+500),function(t){if(d.line>=a.display.viewFrom){var g=t.styles,e=t.text.length>a.options.maxHighlightLength?db(b.mode,d.state):null,h=be(a,t,d,!0);e&&(d.state=e);t.styles=h.styles;e=t.styleClasses;(h=h.classes)?t.styleClasses=h:e&&(t.styleClasses=null);h=!g||g.length!=t.styles.length||e!=h&&(!e||!h||e.bgClass!=h.bgClass||e.textClass!=h.textClass);for(e=0;!h&&
e<g.length;++e)h=g[e]!=t.styles[e];h&&f.push(d.line);t.stateAfter=d.save()}else t.text.length<=a.options.maxHighlightLength&&kd(a,t.text,d),t.stateAfter=0==d.line%5?d.save():null;d.nextLine();if(+new Date>c)return cc(a,a.options.workDelay),!0});b.highlightFrontier=d.line;b.modeFrontier=Math.max(b.modeFrontier,d.line);f.length&&za(a,function(){for(var b=0;b<f.length;b++)Xa(a,f[b],"text")})}}function Cd(a,b){var c=a.display,d=a.doc;if(b.editorIsHidden)return Wa(a),!1;if(!b.force&&b.visible.from>=c.viewFrom&&
b.visible.to<=c.viewTo&&(null==c.updateLineNumbers||c.updateLineNumbers>=c.viewTo)&&c.renderedView==c.view&&0==Pe(a))return!1;Ie(a)&&(Wa(a),b.dims=rd(a));var f=d.first+d.size,t=Math.max(b.visible.from-a.options.viewportMargin,d.first),g=Math.min(f,b.visible.to+a.options.viewportMargin);c.viewFrom<t&&20>t-c.viewFrom&&(t=Math.max(d.first,c.viewFrom));c.viewTo>g&&20>c.viewTo-g&&(g=Math.min(f,c.viewTo));Ua&&(t=Ob(a.doc,t),g=Pb(a.doc,g));d=t!=c.viewFrom||g!=c.viewTo||c.lastWrapHeight!=b.wrapperHeight||
c.lastWrapWidth!=b.wrapperWidth;f=a.display;0==f.view.length||t>=f.viewTo||g<=f.viewFrom?(f.view=Fc(a,t,g),f.viewFrom=t):(f.viewFrom>t?f.view=Fc(a,t,f.viewFrom).concat(f.view):f.viewFrom<t&&(f.view=f.view.slice(fb(a,t))),f.viewFrom=t,f.viewTo<g?f.view=f.view.concat(Fc(a,f.viewTo,g)):f.viewTo>g&&(f.view=f.view.slice(0,fb(a,g))));f.viewTo=g;c.viewOffset=Ga(I(a.doc,c.viewFrom));a.display.mover.style.top=c.viewOffset+"px";g=Pe(a);if(!d&&0==g&&!b.force&&c.renderedView==c.view&&(null==c.updateLineNumbers||
c.updateLineNumbers>=c.viewTo))return!1;a.hasFocus()?t=null:(t=p())&&l(a.display.lineDiv,t)?(t={activeElt:t},window.getSelection&&(f=window.getSelection(),f.anchorNode&&f.extend&&l(a.display.lineDiv,f.anchorNode)&&(t.anchorNode=f.anchorNode,t.anchorOffset=f.anchorOffset,t.focusNode=f.focusNode,t.focusOffset=f.focusOffset))):t=null;4<g&&(c.lineDiv.style.display="none");rg(a,c.updateLineNumbers,b.dims);4<g&&(c.lineDiv.style.display="");c.renderedView=c.view;(g=t)&&g.activeElt&&g.activeElt!=p()&&(g.activeElt.focus(),
g.anchorNode&&l(document.body,g.anchorNode)&&l(document.body,g.focusNode)&&(t=window.getSelection(),f=document.createRange(),f.setEnd(g.anchorNode,g.anchorOffset),f.collapse(!1),t.removeAllRanges(),t.addRange(f),t.extend(g.focusNode,g.focusOffset)));e(c.cursorDiv);e(c.selectionDiv);c.gutters.style.height=c.sizer.style.minHeight=0;d&&(c.lastWrapHeight=b.wrapperHeight,c.lastWrapWidth=b.wrapperWidth,cc(a,400));c.updateLineNumbers=null;return!0}function Oe(a,b){for(var c=b.viewport,d=!0;;d=!1){if(!d||
!a.options.lineWrapping||b.oldDisplayWidth==eb(a))if(c&&null!=c.top&&(c={top:Math.min(a.doc.height+od(a.display)-pd(a),c.top)}),b.visible=yd(a.display,a.doc,c),b.visible.from>=a.display.viewFrom&&b.visible.to<=a.display.viewTo)break;if(!Cd(a,b))break;Jc(a);d=dc(a);Zb(a);Ab(a,d);Dd(a,d);b.force=!1}b.signal(a,"update",a);if(a.display.viewFrom!=a.display.reportedViewFrom||a.display.viewTo!=a.display.reportedViewTo)b.signal(a,"viewportChange",a,a.display.viewFrom,a.display.viewTo),a.display.reportedViewFrom=
a.display.viewFrom,a.display.reportedViewTo=a.display.viewTo}function Bd(a,b){b=new Mc(a,b);if(Cd(a,b)){Jc(a);Oe(a,b);var c=dc(a);Zb(a);Ab(a,c);Dd(a,c);b.finish()}}function rg(a,b,c){function f(b){var c=b.nextSibling;oa&&Ha&&a.display.currentWheelTarget==b?b.style.display="none":b.parentNode.removeChild(b);return c}for(var t=a.display,g=a.options.lineNumbers,h=t.lineDiv,A=h.firstChild,l=t.view,t=t.viewFrom,k=0;k<l.length;k++){var q=l[k];if(!q.hidden)if(q.node&&q.node.parentNode==h){for(;A!=q.node;)A=
f(A);A=g&&null!=b&&b<=t&&q.lineNumber;q.changes&&(-1<d(q.changes,"gutter")&&(A=!1),me(a,q,t,c));A&&(e(q.lineNumber),q.lineNumber.appendChild(document.createTextNode(X(a.options,t))));A=q.node.nextSibling}else{var p=lg(a,q,t,c);h.insertBefore(p,A)}t+=q.size}for(;A;)A=f(A)}function zd(a){a.display.sizer.style.marginLeft=a.display.gutters.offsetWidth+"px"}function Dd(a,b){a.display.sizer.style.minHeight=b.docHeight+"px";a.display.heightForcer.style.top=b.docHeight+"px";a.display.gutters.style.height=
b.docHeight+a.display.barHeight+La(a)+"px"}function Qe(b){var c=b.display.gutters,d=b.options.gutters;e(c);for(var f=0;f<d.length;++f){var t=d[f],g=c.appendChild(a("div",null,"CodeMirror-gutter "+t));"CodeMirror-linenumbers"==t&&(b.display.lineGutter=g,g.style.width=(b.display.lineNumWidth||1)+"px")}c.style.display=f?"":"none";zd(b)}function Ed(a){var b=d(a.gutters,"CodeMirror-linenumbers");-1==b&&a.lineNumbers?a.gutters=a.gutters.concat(["CodeMirror-linenumbers"]):-1<b&&!a.lineNumbers&&(a.gutters=
a.gutters.slice(0),a.gutters.splice(b,1))}function Re(a){var b=a.wheelDeltaX,c=a.wheelDeltaY;null==b&&a.detail&&a.axis==a.HORIZONTAL_AXIS&&(b=a.detail);null==c&&a.detail&&a.axis==a.VERTICAL_AXIS?c=a.detail:null==c&&(c=a.wheelDelta);return{x:b,y:c}}function sg(a){a=Re(a);a.x*=Ca;a.y*=Ca;return a}function Se(a,b){var c=Re(b),d=c.x,c=c.y,f=a.display,t=f.scroller,g=t.scrollWidth>t.clientWidth,e=t.scrollHeight>t.clientHeight;if(d&&g||c&&e){if(c&&Ha&&oa){var g=b.target,h=f.view;a:for(;g!=t;g=g.parentNode)for(var A=
0;A<h.length;A++)if(h[A].node==g){a.display.currentWheelTarget=g;break a}}!d||Ta||Ja||null==Ca?(c&&null!=Ca&&(b=c*Ca,e=a.doc.scrollTop,g=e+f.wrapper.clientHeight,0>b?e=Math.max(0,e+b-50):g=Math.min(a.doc.height,g+b+50),Bd(a,{top:e,bottom:g})),20>Oc&&(null==f.wheelStartX?(f.wheelStartX=t.scrollLeft,f.wheelStartY=t.scrollTop,f.wheelDX=d,f.wheelDY=c,setTimeout(function(){if(null!=f.wheelStartX){var a=t.scrollLeft-f.wheelStartX,b=t.scrollTop-f.wheelStartY,a=b&&f.wheelDY&&b/f.wheelDY||a&&f.wheelDX&&a/
f.wheelDX;f.wheelStartX=f.wheelStartY=null;a&&(Ca=(Ca*Oc+a)/(Oc+1),++Oc)}},200)):(f.wheelDX+=d,f.wheelDY+=c))):(c&&e&&bc(a,Math.max(0,t.scrollTop+c*Ca)),kb(a,Math.max(0,t.scrollLeft+d*Ca)),(!c||c&&e)&&ua(b),f.wheelStartX=null)}}function Ka(a,b){b=a[b];a.sort(function(a,b){return O(a.from(),b.from())});b=d(a,b);for(var c=1;c<a.length;c++){var f=a[c],t=a[c-1];if(0<=O(t.to(),f.from())){var g=Na(t.from(),f.from()),e=ta(t.to(),f.to()),f=t.empty()?f.from()==f.head:t.from()==t.head;c<=b&&--b;a.splice(--c,
2,new ba(f?e:g,f?g:e))}}return new Da(a,b)}function Ra(a,b){return new Da([new ba(a,b||a)],0)}function Ya(a){return a.text?K(a.from.line+a.text.length-1,x(a.text).length+(1==a.text.length?a.from.ch:0)):a.to}function Te(a,b){if(0>O(a,b.from))return a;if(0>=O(a,b.to))return Ya(b);var c=a.line+b.text.length-(b.to.line-b.from.line)-1,d=a.ch;a.line==b.to.line&&(d+=Ya(b).ch-b.to.ch);return K(c,d)}function Fd(a,b){for(var c=[],d=0;d<a.sel.ranges.length;d++){var f=a.sel.ranges[d];c.push(new ba(Te(f.anchor,
b),Te(f.head,b)))}return Ka(c,a.sel.primIndex)}function Ue(a,b,c){return a.line==b.line?K(c.line,a.ch-b.ch+c.ch):K(c.line+(a.line-b.line),a.ch)}function Gd(a){a.doc.mode=id(a.options,a.doc.modeOption);ec(a)}function ec(a){a.doc.iter(function(a){a.stateAfter&&(a.stateAfter=null);a.styles&&(a.styles=null)});a.doc.modeFrontier=a.doc.highlightFrontier=a.doc.first;cc(a,100);a.state.modeGen++;a.curOp&&xa(a)}function Ve(a,b){return 0==b.from.ch&&0==b.to.ch&&""==x(b.text)&&(!a.cm||a.cm.options.wholeLineUpdateBefore)}
function Hd(a,b,c,d){function f(a,c,f){a.text=c;a.stateAfter&&(a.stateAfter=null);a.styles&&(a.styles=null);null!=a.order&&(a.order=null);Sa(a);Nb(a,f);c=d?d(a):1;c!=a.height&&V(a,c);la(a,"change",a,b)}function g(a,b){for(var f=[];a<b;++a)f.push(new Bb(h[a],c?c[a]:null,d));return f}var t=b.from,e=b.to,h=b.text,A=I(a,t.line),l=I(a,e.line),k=x(h),q=c?c[h.length-1]:null,M=e.line-t.line;b.full?(a.insert(0,g(0,h.length)),a.remove(h.length,a.size-h.length)):Ve(a,b)?(e=g(0,h.length-1),f(l,l.text,q),M&&a.remove(t.line,
M),e.length&&a.insert(t.line,e)):A==l?1==h.length?f(A,A.text.slice(0,t.ch)+k+A.text.slice(e.ch),q):(M=g(1,h.length-1),M.push(new Bb(k+A.text.slice(e.ch),q,d)),f(A,A.text.slice(0,t.ch)+h[0],c?c[0]:null),a.insert(t.line+1,M)):1==h.length?(f(A,A.text.slice(0,t.ch)+h[0]+l.text.slice(e.ch),c?c[0]:null),a.remove(t.line+1,M)):(f(A,A.text.slice(0,t.ch)+h[0],c?c[0]:null),f(l,k+l.text.slice(e.ch),q),q=g(1,h.length-1),1<M&&a.remove(t.line+1,M-1),a.insert(t.line+1,q));la(a,"change",a,b)}function nb(a,b,c){function d(a,
f,g){if(a.linked)for(var t=0;t<a.linked.length;++t){var e=a.linked[t];if(e.doc!=f){var h=g&&e.sharedHist;if(!c||h)b(e.doc,h),d(e.doc,a,h)}}}d(a,null,!0)}function We(a,b){if(b.cm)throw Error("This document is already in use.");a.doc=b;b.cm=a;vd(a);Gd(a);Xe(a);a.options.lineWrapping||ad(a);a.options.mode=b.modeOption;xa(a)}function Xe(a){("rtl"==a.doc.direction?w:jb)(a.display.lineDiv,"CodeMirror-rtl")}function tg(a){za(a,function(){Xe(a);xa(a)})}function Pc(a){this.done=[];this.undone=[];this.undoDepth=
Infinity;this.lastModTime=this.lastSelTime=0;this.lastOrigin=this.lastSelOrigin=this.lastOp=this.lastSelOp=null;this.generation=this.maxGeneration=a||1}function Id(a,b){var c={from:sa(b.from),to:Ya(b),text:P(a,b.from,b.to)};Ye(a,c,b.from.line,b.to.line+1);nb(a,function(a){return Ye(a,c,b.from.line,b.to.line+1)},!0);return c}function Ze(a){for(;a.length;)if(x(a).ranges)a.pop();else break}function $e(a,b,c,d){var f=a.history;f.undone.length=0;var g=+new Date,t,e,h;if(h=f.lastOp==d||f.lastOrigin==b.origin&&
b.origin&&("+"==b.origin.charAt(0)&&a.cm&&f.lastModTime>g-a.cm.options.historyEventDelay||"*"==b.origin.charAt(0)))f.lastOp==d?(Ze(f.done),t=x(f.done)):f.done.length&&!x(f.done).ranges?t=x(f.done):1<f.done.length&&!f.done[f.done.length-2].ranges?(f.done.pop(),t=x(f.done)):t=void 0,h=t;if(h)e=x(t.changes),0==O(b.from,b.to)&&0==O(b.from,e.to)?e.to=Ya(b):t.changes.push(Id(a,b));else for((t=x(f.done))&&t.ranges||Qc(a.sel,f.done),t={changes:[Id(a,b)],generation:f.generation},f.done.push(t);f.done.length>
f.undoDepth;)f.done.shift(),f.done[0].ranges||f.done.shift();f.done.push(c);f.generation=++f.maxGeneration;f.lastModTime=f.lastSelTime=g;f.lastOp=f.lastSelOp=d;f.lastOrigin=f.lastSelOrigin=b.origin;e||fa(a,"historyAdded")}function Qc(a,b){var c=x(b);c&&c.ranges&&c.equals(a)||b.push(a)}function Ye(a,b,c,d){var f=b["spans_"+a.id],g=0;a.iter(Math.max(a.first,c),Math.min(a.first+a.size,d),function(c){c.markedSpans&&((f||(f=b["spans_"+a.id]={}))[g]=c.markedSpans);++g})}function ug(a){if(!a)return null;
for(var b,c=0;c<a.length;++c)a[c].marker.explicitlyCleared?b||(b=a.slice(0,c)):b&&b.push(a[c]);return b?b.length?b:null:a}function af(a,b){var c;if(c=b["spans_"+a.id]){for(var d=[],f=0;f<b.text.length;++f)d.push(ug(c[f]));c=d}else c=null;a=ab(a,b);if(!c)return a;if(!a)return c;for(b=0;b<c.length;++b)if(d=c[b],f=a[b],d&&f){var g=0;a:for(;g<f.length;++g){for(var t=f[g],e=0;e<d.length;++e)if(d[e].marker==t.marker)continue a;d.push(t)}}else f&&(c[b]=f);return c}function Cb(a,b,c){for(var f=[],g=0;g<a.length;++g){var t=
a[g];if(t.ranges)f.push(c?Da.prototype.deepCopy.call(t):t);else{var t=t.changes,e=[];f.push({changes:e});for(var h=0;h<t.length;++h){var l=t[h],A;e.push({from:l.from,to:l.to,text:l.text});if(b)for(var k in l)(A=k.match(/^spans_(\d+)$/))&&-1<d(b,Number(A[1]))&&(x(e)[k]=l[k],delete l[k])}}}return f}function Jd(a,b,c,d){return d?(a=a.anchor,c&&(d=0>O(b,a),d!=0>O(c,a)?(a=b,b=c):d!=0>O(b,c)&&(b=c)),new ba(a,b)):new ba(c||b,b)}function Rc(a,b,c,d,f){null==f&&(f=a.cm&&(a.cm.display.shift||a.extend));ma(a,
new Da([Jd(a.sel.primary(),b,c,f)],0),d)}function bf(a,b,c){for(var d=[],f=a.cm&&(a.cm.display.shift||a.extend),g=0;g<a.sel.ranges.length;g++)d[g]=Jd(a.sel.ranges[g],b[g],null,f);b=Ka(d,a.sel.primIndex);ma(a,b,c)}function Kd(a,b,c,d){var f=a.sel.ranges.slice(0);f[b]=c;ma(a,Ka(f,a.sel.primIndex),d)}function vg(a,b,c){c={ranges:b.ranges,update:function(b){this.ranges=[];for(var c=0;c<b.length;c++)this.ranges[c]=new ba(T(a,b[c].anchor),T(a,b[c].head))},origin:c&&c.origin};fa(a,"beforeSelectionChange",
a,c);a.cm&&fa(a.cm,"beforeSelectionChange",a.cm,c);return c.ranges!=b.ranges?Ka(c.ranges,c.ranges.length-1):b}function cf(a,b,c){var d=a.history.done,f=x(d);f&&f.ranges?(d[d.length-1]=b,Sc(a,b,c)):ma(a,b,c)}function ma(a,b,c){Sc(a,b,c);b=a.sel;var d=a.cm?a.cm.curOp.id:NaN,f=a.history,g=c&&c.origin,t;if(!(t=d==f.lastSelOp)&&(t=g&&f.lastSelOrigin==g)&&!(t=f.lastModTime==f.lastSelTime&&f.lastOrigin==g)){t=x(f.done);var e=g.charAt(0);t="*"==e||"+"==e&&t.ranges.length==b.ranges.length&&t.somethingSelected()==
b.somethingSelected()&&new Date-a.history.lastSelTime<=(a.cm?a.cm.options.historyEventDelay:500)}t?f.done[f.done.length-1]=b:Qc(b,f.done);f.lastSelTime=+new Date;f.lastSelOrigin=g;f.lastSelOp=d;c&&!1!==c.clearRedo&&Ze(f.undone)}function Sc(a,b,c){if(Ea(a,"beforeSelectionChange")||a.cm&&Ea(a.cm,"beforeSelectionChange"))b=vg(a,b,c);var d=c&&c.bias||(0>O(b.primary().head,a.sel.primary().head)?-1:1);df(a,ef(a,b,d,!0));c&&!1===c.scroll||!a.cm||zb(a.cm)}function df(a,b){b.equals(a.sel)||(a.sel=b,a.cm&&
(a.cm.curOp.updateInput=a.cm.curOp.selectionChanged=!0,Yd(a.cm)),la(a,"cursorActivity",a))}function ff(a){df(a,ef(a,a.sel,null,!1))}function ef(a,b,c,d){for(var f,g=0;g<b.ranges.length;g++){var t=b.ranges[g],e=b.ranges.length==a.sel.ranges.length&&a.sel.ranges[g],h=Ld(a,t.anchor,e&&e.anchor,c,d),e=Ld(a,t.head,e&&e.head,c,d);if(f||h!=t.anchor||e!=t.head)f||(f=b.ranges.slice(0,g)),f[g]=new ba(h,e)}return f?Ka(f,b.primIndex):b}function Db(a,b,c,d,f){var g=I(a,b.line);if(g.markedSpans)for(var t=0;t<g.markedSpans.length;++t){var e=
g.markedSpans[t],h=e.marker;if((null==e.from||(h.inclusiveLeft?e.from<=b.ch:e.from<b.ch))&&(null==e.to||(h.inclusiveRight?e.to>=b.ch:e.to>b.ch))){if(f&&(fa(h,"beforeCursorEnter"),h.explicitlyCleared))if(g.markedSpans){--t;continue}else break;if(h.atomic){if(c){t=h.find(0>d?1:-1);e=void 0;if(0>d?h.inclusiveRight:h.inclusiveLeft)t=gf(a,t,-d,t&&t.line==b.line?g:null);if(t&&t.line==b.line&&(e=O(t,c))&&(0>d?0>e:0<e))return Db(a,t,b,d,f)}c=h.find(0>d?-1:1);if(0>d?h.inclusiveLeft:h.inclusiveRight)c=gf(a,
c,d,c.line==b.line?g:null);return c?Db(a,c,b,d,f):null}}}return b}function Ld(a,b,c,d,f){d=d||1;b=Db(a,b,c,d,f)||!f&&Db(a,b,c,d,!0)||Db(a,b,c,-d,f)||!f&&Db(a,b,c,-d,!0);return b?b:(a.cantEdit=!0,K(a.first,0))}function gf(a,b,c,d){return 0>c&&0==b.ch?b.line>a.first?T(a,K(b.line-1)):null:0<c&&b.ch==(d||I(a,b.line)).text.length?b.line<a.first+a.size-1?K(b.line+1,0):null:new K(b.line,b.ch+c)}function hf(a){a.setSelection(K(a.firstLine(),0),K(a.lastLine()),Ma)}function jf(a,b,c){var d={canceled:!1,from:b.from,
to:b.to,text:b.text,origin:b.origin,cancel:function(){return d.canceled=!0}};c&&(d.update=function(b,c,f,g){b&&(d.from=T(a,b));c&&(d.to=T(a,c));f&&(d.text=f);void 0!==g&&(d.origin=g)});fa(a,"beforeChange",a,d);a.cm&&fa(a.cm,"beforeChange",a.cm,d);return d.canceled?null:{from:d.from,to:d.to,text:d.text,origin:d.origin}}function Eb(a,b,c){if(a.cm){if(!a.cm.curOp)return ja(a.cm,Eb)(a,b,c);if(a.cm.state.suppressEdits)return}if(Ea(a,"beforeChange")||a.cm&&Ea(a.cm,"beforeChange"))if(b=jf(a,b,!0),!b)return;
if(c=kf&&!c&&Mb(a,b.from,b.to))for(var d=c.length-1;0<=d;--d)lf(a,{from:c[d].from,to:c[d].to,text:d?[""]:b.text,origin:b.origin});else lf(a,b)}function lf(a,b){if(1!=b.text.length||""!=b.text[0]||0!=O(b.from,b.to)){var c=Fd(a,b);$e(a,b,c,a.cm?a.cm.curOp.id:NaN);fc(a,b,c,ab(a,b));var f=[];nb(a,function(a,c){c||-1!=d(f,a.history)||(mf(a.history,b),f.push(a.history));fc(a,b,null,ab(a,b))})}}function Tc(a,b,c){if(!a.cm||!a.cm.state.suppressEdits||c){for(var f=a.history,g,e=a.sel,t="undo"==b?f.done:f.undone,
h="undo"==b?f.undone:f.done,l=0;l<t.length&&(g=t[l],c?!g.ranges||g.equals(a.sel):g.ranges);l++);if(l!=t.length){for(f.lastOrigin=f.lastSelOrigin=null;;)if(g=t.pop(),g.ranges){Qc(g,h);if(c&&!g.equals(a.sel)){ma(a,g,{clearRedo:!1});return}e=g}else break;var k=[];Qc(e,h);h.push({changes:k,generation:f.generation});f.generation=g.generation||++f.maxGeneration;var q=Ea(a,"beforeChange")||a.cm&&Ea(a.cm,"beforeChange");c=function(c){var f=g.changes[c];f.origin=b;if(q&&!jf(a,f,!1))return t.length=0,{};k.push(Id(a,
f));var e=c?Fd(a,f):x(t);fc(a,f,e,af(a,f));!c&&a.cm&&a.cm.scrollIntoView({from:f.from,to:Ya(f)});var h=[];nb(a,function(a,b){b||-1!=d(h,a.history)||(mf(a.history,f),h.push(a.history));fc(a,f,null,af(a,f))})};for(f=g.changes.length-1;0<=f;--f)if(e=c(f))return e.v}}}function nf(a,b){if(0!=b&&(a.first+=b,a.sel=new Da(n(a.sel.ranges,function(a){return new ba(K(a.anchor.line+b,a.anchor.ch),K(a.head.line+b,a.head.ch))}),a.sel.primIndex),a.cm)){xa(a.cm,a.first,a.first-b,b);for(var c=a.cm.display,d=c.viewFrom;d<
c.viewTo;d++)Xa(a.cm,d,"gutter")}}function fc(a,b,c,d){if(a.cm&&!a.cm.curOp)return ja(a.cm,fc)(a,b,c,d);if(b.to.line<a.first)nf(a,b.text.length-1-(b.to.line-b.from.line));else if(!(b.from.line>a.lastLine())){if(b.from.line<a.first){var f=b.text.length-1-(a.first-b.from.line);nf(a,f);b={from:K(a.first,0),to:K(b.to.line+f,b.to.ch),text:[x(b.text)],origin:b.origin}}f=a.lastLine();b.to.line>f&&(b={from:b.from,to:K(f,I(a,f).text.length),text:[b.text[0]],origin:b.origin});b.removed=P(a,b.from,b.to);c||
(c=Fd(a,b));a.cm?wg(a.cm,b,d):Hd(a,b,d);Sc(a,c,Ma)}}function wg(a,b,c){var d=a.doc,f=a.display,g=b.from,e=b.to,t=!1,h=g.line;a.options.lineWrapping||(h=L(ra(I(d,g.line))),d.iter(h,e.line+1,function(a){if(a==f.maxLine)return t=!0}));-1<d.sel.contains(b.from,b.to)&&Yd(a);Hd(d,b,c,Be(a));a.options.lineWrapping||(d.iter(h,g.line+b.text.length,function(a){var b=Bc(a);b>f.maxLineLength&&(f.maxLine=a,f.maxLineLength=b,f.maxLineChanged=!0,t=!1)}),t&&(a.curOp.updateMaxLine=!0));dg(d,g.line);cc(a,400);c=b.text.length-
(e.line-g.line)-1;b.full?xa(a):g.line!=e.line||1!=b.text.length||Ve(a.doc,b)?xa(a,g.line,e.line+1,c):Xa(a,g.line,"text");c=Ea(a,"changes");if((d=Ea(a,"change"))||c)b={from:g,to:e,text:b.text,removed:b.removed,origin:b.origin},d&&la(a,"change",a,b),c&&(a.curOp.changeObjs||(a.curOp.changeObjs=[])).push(b);a.display.selForContextMenu=null}function Fb(a,b,c,d,f){d||(d=c);if(0>O(d,c)){var g=d;d=c;c=g}"string"==typeof b&&(b=a.splitLines(b));Eb(a,{from:c,to:d,text:b,origin:f})}function of(a,b,c,d){c<a.line?
a.line+=d:b<a.line&&(a.line=b,a.ch=0)}function pf(a,b,c,d){for(var f=0;f<a.length;++f){var g=a[f],e=!0;if(g.ranges)for(g.copied||(g=a[f]=g.deepCopy(),g.copied=!0),e=0;e<g.ranges.length;e++)of(g.ranges[e].anchor,b,c,d),of(g.ranges[e].head,b,c,d);else{for(var t=0;t<g.changes.length;++t){var h=g.changes[t];if(c<h.from.line)h.from=K(h.from.line+d,h.from.ch),h.to=K(h.to.line+d,h.to.ch);else if(b<=h.to.line){e=!1;break}}e||(a.splice(0,f+1),f=0)}}}function mf(a,b){var c=b.from.line,d=b.to.line;b=b.text.length-
(d-c)-1;pf(a.done,c,d,b);pf(a.undone,c,d,b)}function gc(a,b,c,d){var f=b,g=b;"number"==typeof b?g=I(a,Math.max(a.first,Math.min(b,a.first+a.size-1))):f=L(b);if(null==f)return null;d(g,f)&&a.cm&&Xa(a.cm,f,c);return g}function hc(a){this.lines=a;this.parent=null;for(var b=0,c=0;c<a.length;++c)a[c].parent=this,b+=a[c].height;this.height=b}function ic(a){this.children=a;for(var b=0,c=0,d=0;d<a.length;++d){var f=a[d],b=b+f.chunkSize(),c=c+f.height;f.parent=this}this.size=b;this.height=c;this.parent=null}
function xg(a,b,c,d){var f=new jc(a,c,d),g=a.cm;g&&f.noHScroll&&(g.display.alignWidgets=!0);gc(a,b,"widget",function(b){var c=b.widgets||(b.widgets=[]);null==f.insertAt?c.push(f):c.splice(Math.min(c.length-1,Math.max(0,f.insertAt)),0,f);f.line=b;g&&!bb(a,b)&&(c=Ga(b)<a.scrollTop,V(b,b.height+Wb(f)),c&&Kc(g,f.height),g.curOp.forceUpdate=!0);return!0});la(g,"lineWidgetAdded",g,f,"number"==typeof b?b:L(b));return f}function Gb(a,b,d,f,g){if(f&&f.shared)return yg(a,b,d,f,g);if(a.cm&&!a.cm.curOp)return ja(a.cm,
Gb)(a,b,d,f,g);var e=new Za(a,g);g=O(b,d);f&&h(f,e,!1);if(0<g||0==g&&!1!==e.clearWhenEmpty)return e;e.replacedWith&&(e.collapsed=!0,e.widgetNode=c("span",[e.replacedWith],"CodeMirror-widget"),f.handleMouseEvents||e.widgetNode.setAttribute("cm-ignore-events","true"),f.insertLeft&&(e.widgetNode.insertLeft=!0));if(e.collapsed){if(sb(a,b.line,b,d,e)||b.line!=d.line&&sb(a,d.line,b,d,e))throw Error("Inserting collapsed marker partially overlapping an existing one");Ua=!0}e.addToHistory&&$e(a,{from:b,to:d,
origin:"markText"},a.sel,NaN);var t=b.line,l=a.cm,k;a.iter(t,d.line+1,function(a){l&&e.collapsed&&!l.options.lineWrapping&&ra(a)==l.display.maxLine&&(k=!0);e.collapsed&&t!=b.line&&V(a,0);var c=new pa(e,t==b.line?b.ch:null,t==d.line?d.ch:null);a.markedSpans=a.markedSpans?a.markedSpans.concat([c]):[c];c.marker.attachLine(a);++t});e.collapsed&&a.iter(b.line,d.line+1,function(b){bb(a,b)&&V(b,0)});e.clearOnEnter&&R(e,"beforeCursorEnter",function(){return e.clear()});e.readOnly&&(kf=!0,(a.history.done.length||
a.history.undone.length)&&a.clearHistory());e.collapsed&&(e.id=++qf,e.atomic=!0);if(l){k&&(l.curOp.updateMaxLine=!0);if(e.collapsed)xa(l,b.line,d.line+1);else if(e.className||e.title||e.startStyle||e.endStyle||e.css)for(f=b.line;f<=d.line;f++)Xa(l,f,"text");e.atomic&&ff(l.doc);la(l,"markerAdded",l,e)}return e}function yg(a,b,c,d,f){d=h(d);d.shared=!1;var g=[Gb(a,b,c,d,f)],e=g[0],t=d.widgetNode;nb(a,function(a){t&&(d.widgetNode=t.cloneNode(!0));g.push(Gb(a,T(a,b),T(a,c),d,f));for(var h=0;h<a.linked.length;++h)if(a.linked[h].isParent)return;
e=x(g)});return new kc(g,e)}function rf(a){return a.findMarks(K(a.first,0),a.clipPos(K(a.lastLine())),function(a){return a.parent})}function zg(a){for(var b=function(b){b=a[b];var c=[b.primary.doc];nb(b.primary.doc,function(a){return c.push(a)});for(var f=0;f<b.markers.length;f++){var g=b.markers[f];-1==d(c,g.doc)&&(g.parent=null,b.markers.splice(f--,1))}},c=0;c<a.length;c++)b(c)}function Ag(a){var b=this;sf(b);if(!ia(b,a)&&!Qa(b.display,a)){ua(a);Z&&(tf=+new Date);var c=ib(b,a,!0),f=a.dataTransfer.files;
if(c&&!b.isReadOnly())if(f&&f.length&&window.FileReader&&window.File)for(var g=f.length,e=Array(g),t=0,h=function(a,f){if(!b.options.allowDropFileTypes||-1!=d(b.options.allowDropFileTypes,a.type)){var h=new FileReader;h.onload=ja(b,function(){var a=h.result;/[\x00-\x08\x0e-\x1f]{2}/.test(a)&&(a="");e[f]=a;++t==g&&(c=T(b.doc,c),a={from:c,to:c,text:b.doc.splitLines(e.join(b.doc.lineSeparator())),origin:"paste"},Eb(b.doc,a),cf(b.doc,Ra(c,Ya(a))))});h.readAsText(a)}},l=0;l<g;++l)h(f[l],l);else if(b.state.draggingText&&
-1<b.doc.sel.contains(c))b.state.draggingText(a),setTimeout(function(){return b.display.input.focus()},20);else try{if(h=a.dataTransfer.getData("Text")){b.state.draggingText&&!b.state.draggingText.copy&&(l=b.listSelections());Sc(b.doc,Ra(c,c));if(l)for(f=0;f<l.length;++f)Fb(b.doc,"",l[f].anchor,l[f].head,"drag");b.replaceSelection(h,"around","paste");b.display.input.focus()}}catch(dh){}}}function sf(a){a.display.dragCursor&&(a.display.lineSpace.removeChild(a.display.dragCursor),a.display.dragCursor=
null)}function uf(a){if(document.getElementsByClassName)for(var b=document.getElementsByClassName("CodeMirror"),c=0;c<b.length;c++){var d=b[c].CodeMirror;d&&a(d)}}function Bg(){var a;R(window,"resize",function(){null==a&&(a=setTimeout(function(){a=null;uf(Cg)},100))});R(window,"blur",function(){return uf($b)})}function Cg(a){var b=a.display;if(b.lastWrapHeight!=b.wrapper.clientHeight||b.lastWrapWidth!=b.wrapper.clientWidth)b.cachedCharWidth=b.cachedTextHeight=b.cachedPaddingH=null,b.scrollbarsClipped=
!1,a.setSize()}function Dg(a){var b=a.split(/-(?!$)/);a=b[b.length-1];for(var c,d,f,g,e=0;e<b.length-1;e++){var t=b[e];if(/^(cmd|meta|m)$/i.test(t))g=!0;else if(/^a(lt)?$/i.test(t))c=!0;else if(/^(c|ctrl|control)$/i.test(t))d=!0;else if(/^s(hift)?$/i.test(t))f=!0;else throw Error("Unrecognized modifier name: "+t);}c&&(a="Alt-"+a);d&&(a="Ctrl-"+a);g&&(a="Cmd-"+a);f&&(a="Shift-"+a);return a}function Eg(a){var b={},c;for(c in a)if(a.hasOwnProperty(c)){var d=a[c];if(!/^(name|fallthrough|(de|at)tach)$/.test(c)){if("..."!=
d)for(var f=n(c.split(" "),Dg),g=0;g<f.length;g++){var e,t;g==f.length-1?(t=f.join(" "),e=d):(t=f.slice(0,g+1).join(" "),e="...");var h=b[t];if(!h)b[t]=e;else if(h!=e)throw Error("Inconsistent bindings for "+t);}delete a[c]}}for(var l in b)a[l]=b[l];return a}function Hb(a,b,c,d){b=Uc(b);var f=b.call?b.call(a,d):b[a];if(!1===f)return"nothing";if("..."===f)return"multi";if(null!=f&&c(f))return"handled";if(b.fallthrough){if("[object Array]"!=Object.prototype.toString.call(b.fallthrough))return Hb(a,
b.fallthrough,c,d);for(f=0;f<b.fallthrough.length;f++){var g=Hb(a,b.fallthrough[f],c,d);if(g)return g}}}function vf(a){a="string"==typeof a?a:$a[a.keyCode];return"Ctrl"==a||"Alt"==a||"Shift"==a||"Mod"==a}function wf(a,b,c){var d=a;b.altKey&&"Alt"!=d&&(a="Alt-"+a);(xf?b.metaKey:b.ctrlKey)&&"Ctrl"!=d&&(a="Ctrl-"+a);(xf?b.ctrlKey:b.metaKey)&&"Cmd"!=d&&(a="Cmd-"+a);!c&&b.shiftKey&&"Shift"!=d&&(a="Shift-"+a);return a}function yf(a,b){if(Ja&&34==a.keyCode&&a["char"])return!1;var c=$a[a.keyCode];return null==
c||a.altGraphKey?!1:wf(c,a,b)}function Uc(a){return"string"==typeof a?lc[a]:a}function Ib(a,b){for(var c=a.doc.sel.ranges,d=[],f=0;f<c.length;f++){for(var g=b(c[f]);d.length&&0>=O(g.from,x(d).to);){var e=d.pop();if(0>O(e.from,g.from)){g.from=e.from;break}}d.push(g)}za(a,function(){for(var b=d.length-1;0<=b;b--)Fb(a.doc,"",d[b].from,d[b].to,"+delete");zb(a)})}function zf(a,b){var c=I(a.doc,b),d=ra(c);d!=c&&(b=L(d));return ed(!0,a,d,b,1)}function Af(a,b){var c=zf(a,b.line),d=I(a.doc,c.line);a=Va(d,
a.doc.direction);return a&&0!=a[0].level?c:(d=Math.max(0,d.text.search(/\S/)),K(c.line,b.line==c.line&&b.ch<=d&&b.ch?0:d,c.sticky))}function Vc(a,b,c){if("string"==typeof b&&(b=mc[b],!b))return!1;a.display.input.ensurePolled();var d=a.display.shift,f=!1;try{a.isReadOnly()&&(a.state.suppressEdits=!0),c&&(a.display.shift=!1),f=b(a)!=Wc}finally{a.display.shift=d,a.state.suppressEdits=!1}return f}function Fg(a,b,c){for(var d=0;d<a.state.keyMaps.length;d++){var f=Hb(b,a.state.keyMaps[d],c,a);if(f)return f}return a.options.extraKeys&&
Hb(b,a.options.extraKeys,c,a)||Hb(b,a.options.keyMap,c,a)}function nc(a,b,c,d){var f=a.state.keySeq;if(f){if(vf(b))return"handled";Gg.set(50,function(){a.state.keySeq==f&&(a.state.keySeq=null,a.display.input.reset())});b=f+" "+b}d=Fg(a,b,d);"multi"==d&&(a.state.keySeq=b);"handled"==d&&la(a,"keyHandled",a,b,c);if("handled"==d||"multi"==d)ua(c),wd(a);return f&&!d&&/\'$/.test(b)?(ua(c),!0):!!d}function Bf(a,b){var c=yf(b,!0);return c?b.shiftKey&&!a.state.keySeq?nc(a,"Shift-"+c,b,function(b){return Vc(a,
b,!0)})||nc(a,c,b,function(b){if("string"==typeof b?/^go[A-Z]/.test(b):b.motion)return Vc(a,b)}):nc(a,c,b,function(b){return Vc(a,b)}):!1}function Hg(a,b,c){return nc(a,"'"+c+"'",b,function(b){return Vc(a,b,!0)})}function Cf(a){this.curOp.focus=p();if(!ia(this,a)){Z&&11>da&&27==a.keyCode&&(a.returnValue=!1);var b=a.keyCode;this.display.shift=16==b||a.shiftKey;var c=Bf(this,a);Ja&&(Md=c?b:null,!c&&88==b&&!Ig&&(Ha?a.metaKey:a.ctrlKey)&&this.replaceSelection("",null,"cut"));18!=b||/\bCodeMirror-crosshair\b/.test(this.display.lineDiv.className)||
Jg(this)}}function Jg(a){function b(a){18!=a.keyCode&&a.altKey||(jb(c,"CodeMirror-crosshair"),Ba(document,"keyup",b),Ba(document,"mouseover",b))}var c=a.display.lineDiv;w(c,"CodeMirror-crosshair");R(document,"keyup",b);R(document,"mouseover",b)}function Df(a){16==a.keyCode&&(this.doc.sel.shift=!1);ia(this,a)}function Ef(a){if(!(Qa(this.display,a)||ia(this,a)||a.ctrlKey&&!a.altKey||Ha&&a.metaKey)){var b=a.keyCode,c=a.charCode;if(Ja&&b==Md)Md=null,ua(a);else if(!Ja||a.which&&!(10>a.which)||!Bf(this,
a))if(b=String.fromCharCode(null==c?b:c),"\b"!=b&&!Hg(this,a,b))this.display.input.onKeyPress(a)}}function Kg(a,b){var c=+new Date;if(oc&&oc.compare(c,a,b))return pc=oc=null,"triple";if(pc&&pc.compare(c,a,b))return oc=new Nd(c,a,b),pc=null,"double";pc=new Nd(c,a,b);oc=null;return"single"}function Ff(a){var b=this.display;if(!(ia(this,a)||b.activeTouch&&b.input.supportsTouch()))if(b.input.ensurePolled(),b.shift=a.shiftKey,Qa(b,a))oa||(b.scroller.draggable=!1,setTimeout(function(){return b.scroller.draggable=
!0},100));else if(!Od(this,a,"gutterClick",!0)){var c=ib(this,a),d=$d(a),f=c?Kg(c,d):"single";window.focus();1==d&&this.state.selectingText&&this.state.selectingText(a);c&&Lg(this,d,c,f,a)||(1==d?c?Mg(this,c,f,a):(a.target||a.srcElement)==b.scroller&&ua(a):2==d?(c&&Rc(this.doc,c),setTimeout(function(){return b.input.focus()},20)):3==d&&(Pd?Gf(this,a):Fe(this)))}}function Lg(a,b,c,d,f){var g="Click";"double"==d?g="Double"+g:"triple"==d&&(g="Triple"+g);return nc(a,wf((1==b?"Left":2==b?"Middle":"Right")+
g,f),f,function(b){"string"==typeof b&&(b=mc[b]);if(!b)return!1;var d=!1;try{a.isReadOnly()&&(a.state.suppressEdits=!0),d=b(a,c)!=Wc}finally{a.state.suppressEdits=!1}return d})}function Mg(a,b,c,d){Z?setTimeout(k(Ee,a),0):a.curOp.focus=p();var f=a.getOption("configureMouse"),f=f?f(a,c,d):{};null==f.unit&&(f.unit=(Ng?d.shiftKey&&d.metaKey:d.altKey)?"rectangle":"single"==c?"char":"double"==c?"word":"line");if(null==f.extend||a.doc.extend)f.extend=a.doc.extend||d.shiftKey;null==f.addNew&&(f.addNew=Ha?
d.metaKey:d.ctrlKey);null==f.moveOnDrag&&(f.moveOnDrag=!(Ha?d.altKey:d.ctrlKey));var g=a.doc.sel,e;a.options.dragDrop&&Og&&!a.isReadOnly()&&"single"==c&&-1<(e=g.contains(b))&&(0>O((e=g.ranges[e]).from(),b)||0<b.xRel)&&(0<O(e.to(),b)||0>b.xRel)?Pg(a,d,b,f):Qg(a,d,b,f)}function Pg(a,b,c,d){var f=a.display,g=!1,e=ja(a,function(b){oa&&(f.scroller.draggable=!1);a.state.draggingText=!1;Ba(document,"mouseup",e);Ba(document,"mousemove",t);Ba(f.scroller,"dragstart",h);Ba(f.scroller,"drop",e);g||(ua(b),d.addNew||
Rc(a.doc,c,null,null,d.extend),oa||Z&&9==da?setTimeout(function(){document.body.focus();f.input.focus()},20):f.input.focus())}),t=function(a){g=g||10<=Math.abs(b.clientX-a.clientX)+Math.abs(b.clientY-a.clientY)},h=function(){return g=!0};oa&&(f.scroller.draggable=!0);a.state.draggingText=e;e.copy=!d.moveOnDrag;f.scroller.dragDrop&&f.scroller.dragDrop();R(document,"mouseup",e);R(document,"mousemove",t);R(f.scroller,"dragstart",h);R(f.scroller,"drop",e);Fe(a);setTimeout(function(){return f.input.focus()},
20)}function Hf(a,b,c){if("char"==c)return new ba(b,b);if("word"==c)return a.findWordAt(b);if("line"==c)return new ba(K(b.line,0),T(a.doc,K(b.line+1,0)));a=c(a,b);return new ba(a.from,a.to)}function Qg(a,b,c,d){function e(b){if(0!=O(m,b))if(m=b,"rectangle"==d.unit){for(var e=[],h=a.options.tabSize,t=g(I(k,c.line).text,c.ch,h),l=g(I(k,b.line).text,b.ch,h),p=Math.min(t,l),t=Math.max(t,l),l=Math.min(c.line,b.line),x=Math.min(a.lastLine(),Math.max(c.line,b.line));l<=x;l++){var y=I(k,l).text,w=f(y,p,h);
p==t?e.push(new ba(K(l,w),K(l,w))):y.length>w&&e.push(new ba(K(l,w),K(l,f(y,t,h))))}e.length||e.push(new ba(c,c));ma(k,Ka(v.ranges.slice(0,A).concat(e),A),{origin:"*mouse",scroll:!1});a.scrollIntoView(b)}else e=q,p=Hf(a,b,d.unit),b=e.anchor,0<O(p.anchor,b)?(h=p.head,b=Na(e.from(),p.anchor)):(h=p.anchor,b=ta(e.to(),p.head)),e=v.ranges.slice(0),e[A]=new ba(T(k,b),h),ma(k,Ka(e,A),Qd)}function h(b){var c=++w,f=ib(a,b,!0,"rectangle"==d.unit);if(f)if(0!=O(f,m)){a.curOp.focus=p();e(f);var g=yd(l,k);(f.line>=
g.to||f.line<g.from)&&setTimeout(ja(a,function(){w==c&&h(b)}),150)}else{var t=b.clientY<y.top?-20:b.clientY>y.bottom?20:0;t&&setTimeout(ja(a,function(){w==c&&(l.scroller.scrollTop+=t,h(b))}),50)}}function t(b){a.state.selectingText=!1;w=Infinity;ua(b);l.input.focus();Ba(document,"mousemove",r);Ba(document,"mouseup",n);k.history.lastSelOrigin=null}var l=a.display,k=a.doc;ua(b);var q,A,v=k.sel,x=v.ranges;d.addNew&&!d.extend?(A=k.sel.contains(c),q=-1<A?x[A]:new ba(c,c)):(q=k.sel.primary(),A=k.sel.primIndex);
"rectangle"==d.unit?(d.addNew||(q=new ba(c,c)),c=ib(a,b,!0,!0),A=-1):(b=Hf(a,c,d.unit),q=d.extend?Jd(q,b.anchor,b.head,d.extend):b);d.addNew?-1==A?(A=x.length,ma(k,Ka(x.concat([q]),A),{scroll:!1,origin:"*mouse"})):1<x.length&&x[A].empty()&&"char"==d.unit&&!d.extend?(ma(k,Ka(x.slice(0,A).concat(x.slice(A+1)),0),{scroll:!1,origin:"*mouse"}),v=k.sel):Kd(k,A,q,Qd):(A=0,ma(k,new Da([q],0),Qd),v=k.sel);var m=c,y=l.wrapper.getBoundingClientRect(),w=0,r=ja(a,function(a){$d(a)?h(a):t(a)}),n=ja(a,t);a.state.selectingText=
n;R(document,"mousemove",r);R(document,"mouseup",n)}function Od(a,b,c,d){var f,g;try{f=b.clientX,g=b.clientY}catch(Vd){return!1}if(f>=Math.floor(a.display.gutters.getBoundingClientRect().right))return!1;d&&ua(b);d=a.display;var e=d.lineDiv.getBoundingClientRect();if(g>e.bottom||!Ea(a,c))return fd(b);g-=e.top-d.viewOffset;for(e=0;e<a.options.gutters.length;++e){var h=d.gutters.childNodes[e];if(h&&h.getBoundingClientRect().right>=f)return f=Q(a.doc,g),fa(a,c,a,f,a.options.gutters[e],b),fd(b)}}function Gf(a,
b){var c;(c=Qa(a.display,b))||(c=Ea(a,"gutterContextMenu")?Od(a,b,"gutterContextMenu",!1):!1);if(!c&&!ia(a,b,"contextmenu"))a.display.input.onContextMenu(b)}function If(a){a.display.wrapper.className=a.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+a.options.theme.replace(/(^|\s)\s*/g," cm-s-");Yb(a)}function qc(a){Qe(a);xa(a);He(a)}function Rg(a,b,c){!b!=!(c&&c!=Jb)&&(c=a.display.dragFunctions,b=b?R:Ba,b(a.display.scroller,"dragstart",c.start),b(a.display.scroller,"dragenter",c.enter),b(a.display.scroller,
"dragover",c.over),b(a.display.scroller,"dragleave",c.leave),b(a.display.scroller,"drop",c.drop))}function Sg(a){a.options.lineWrapping?(w(a.display.wrapper,"CodeMirror-wrap"),a.display.sizer.style.minWidth="",a.display.sizerWidth=null):(jb(a.display.wrapper,"CodeMirror-wrap"),ad(a));vd(a);xa(a);Yb(a);setTimeout(function(){return Ab(a)},100)}function ea(a,b){var c=this;if(!(this instanceof ea))return new ea(a,b);this.options=b=b?h(b):{};h(Jf,b,!1);Ed(b);var d=b.value;"string"==typeof d&&(d=new ya(d,
b.mode,null,b.lineSeparator,b.direction));this.doc=d;var f=new ea.inputStyles[b.inputStyle](this);a=this.display=new S(a,d,f);a.wrapper.CodeMirror=this;Qe(this);If(this);b.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap");Me(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new ob,keySeq:null,specialChars:null};b.autofocus&&!Qb&&a.input.focus();
Z&&11>da&&setTimeout(function(){return c.display.input.reset(!0)},20);Tg(this);Kf||(Bg(),Kf=!0);lb(this);this.curOp.forceUpdate=!0;We(this,d);b.autofocus&&!Qb||this.hasFocus()?setTimeout(k(xd,this),20):$b(this);for(var g in Xc)if(Xc.hasOwnProperty(g))Xc[g](c,b[g],Jb);Ie(this);b.finishInit&&b.finishInit(this);for(d=0;d<Rd.length;++d)Rd[d](c);mb(this);oa&&b.lineWrapping&&"optimizelegibility"==getComputedStyle(a.lineDiv).textRendering&&(a.lineDiv.style.textRendering="auto")}function Tg(b){function c(){f.activeTouch&&
(g=setTimeout(function(){return f.activeTouch=null},1E3),e=f.activeTouch,e.end=+new Date)}function d(a,b){if(null==b.left)return!0;var c=b.left-a.left;a=b.top-a.top;return 400<c*c+a*a}var f=b.display;R(f.scroller,"mousedown",ja(b,Ff));Z&&11>da?R(f.scroller,"dblclick",ja(b,function(a){if(!ia(b,a)){var c=ib(b,a);!c||Od(b,a,"gutterClick",!0)||Qa(b.display,a)||(ua(a),a=b.findWordAt(c),Rc(b.doc,a.anchor,a.head))}})):R(f.scroller,"dblclick",function(a){return ia(b,a)||ua(a)});Pd||R(f.scroller,"contextmenu",
function(a){return Gf(b,a)});var g,e={end:0};R(f.scroller,"touchstart",function(a){var c;if(c=!ia(b,a))1!=a.touches.length?c=!1:(c=a.touches[0],c=1>=c.radiusX&&1>=c.radiusY),c=!c;c&&(f.input.ensurePolled(),clearTimeout(g),c=+new Date,f.activeTouch={start:c,moved:!1,prev:300>=c-e.end?e:null},1==a.touches.length&&(f.activeTouch.left=a.touches[0].pageX,f.activeTouch.top=a.touches[0].pageY))});R(f.scroller,"touchmove",function(){f.activeTouch&&(f.activeTouch.moved=!0)});R(f.scroller,"touchend",function(a){var g=
f.activeTouch;if(g&&!Qa(f,a)&&null!=g.left&&!g.moved&&300>new Date-g.start){var e=b.coordsChar(f.activeTouch,"page"),g=!g.prev||d(g,g.prev)?new ba(e,e):!g.prev.prev||d(g,g.prev.prev)?b.findWordAt(e):new ba(K(e.line,0),T(b.doc,K(e.line+1,0)));b.setSelection(g.anchor,g.head);b.focus();ua(a)}c()});R(f.scroller,"touchcancel",c);R(f.scroller,"scroll",function(){f.scroller.clientHeight&&(bc(b,f.scroller.scrollTop),kb(b,f.scroller.scrollLeft,!0),fa(b,"scroll",b))});R(f.scroller,"mousewheel",function(a){return Se(b,
a)});R(f.scroller,"DOMMouseScroll",function(a){return Se(b,a)});R(f.wrapper,"scroll",function(){return f.wrapper.scrollTop=f.wrapper.scrollLeft=0});f.dragFunctions={enter:function(a){ia(b,a)||Sb(a)},over:function(c){if(!ia(b,c)){var d=ib(b,c);if(d){var f=document.createDocumentFragment();De(b,d,f);b.display.dragCursor||(b.display.dragCursor=a("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),b.display.lineSpace.insertBefore(b.display.dragCursor,b.display.cursorDiv));r(b.display.dragCursor,f)}Sb(c)}},
start:function(c){if(Z&&(!b.state.draggingText||100>+new Date-tf))Sb(c);else if(!ia(b,c)&&!Qa(b.display,c)&&(c.dataTransfer.setData("Text",b.getSelection()),c.dataTransfer.effectAllowed="copyMove",c.dataTransfer.setDragImage&&!Lf)){var d=a("img",null,null,"position: fixed; left: 0; top: 0;");d.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";Ja&&(d.width=d.height=1,b.display.wrapper.appendChild(d),d._top=d.offsetTop);c.dataTransfer.setDragImage(d,0,0);Ja&&d.parentNode.removeChild(d)}},
drop:ja(b,Ag),leave:function(a){ia(b,a)||sf(b)}};var h=f.input.getField();R(h,"keyup",function(a){return Df.call(b,a)});R(h,"keydown",ja(b,Cf));R(h,"keypress",ja(b,Ef));R(h,"focus",function(a){return xd(b,a)});R(h,"blur",function(a){return $b(b,a)})}function rc(a,b,c,d){var f=a.doc,e;null==c&&(c="add");"smart"==c&&(f.mode.indent?e=Tb(a,b).state:c="prev");var h=a.options.tabSize,t=I(f,b),l=g(t.text,null,h);t.stateAfter&&(t.stateAfter=null);var k=t.text.match(/^\s*/)[0],p;if(!d&&!/\S/.test(t.text))p=
0,c="not";else if("smart"==c&&(p=f.mode.indent(e,t.text.slice(k.length),t.text),p==Wc||150<p)){if(!d)return;c="prev"}"prev"==c?p=b>f.first?g(I(f,b-1).text,null,h):0:"add"==c?p=l+a.options.indentUnit:"subtract"==c?p=l-a.options.indentUnit:"number"==typeof c&&(p=l+c);p=Math.max(0,p);c="";d=0;if(a.options.indentWithTabs)for(a=Math.floor(p/h);a;--a)d+=h,c+="\t";d<p&&(c+=q(p-d));if(c!=k)return Fb(f,c,K(b,0),K(b,k.length),"+input"),t.stateAfter=null,!0;for(h=0;h<f.sel.ranges.length;h++)if(t=f.sel.ranges[h],
t.head.line==b&&t.head.ch<k.length){b=K(b,k.length);Kd(f,h,new ba(b,b));break}}function Sd(a,b,c,d,f){var g=a.doc;a.display.shift=!1;d||(d=g.sel);var e=a.state.pasteIncoming||"paste"==f,h=Td(b),t=null;if(e&&1<d.ranges.length)if(Aa&&Aa.text.join("\n")==b){if(0==d.ranges.length%Aa.text.length)for(var t=[],l=0;l<Aa.text.length;l++)t.push(g.splitLines(Aa.text[l]))}else h.length==d.ranges.length&&a.options.pasteLinesPerSelection&&(t=n(h,function(a){return[a]}));for(var k,l=d.ranges.length-1;0<=l;l--){k=
d.ranges[l];var q=k.from(),p=k.to();k.empty()&&(c&&0<c?q=K(q.line,q.ch-c):a.state.overwrite&&!e?p=K(p.line,Math.min(I(g,p.line).text.length,p.ch+x(h).length)):Aa&&Aa.lineWise&&Aa.text.join("\n")==b&&(q=p=K(q.line,0)));k=a.curOp.updateInput;q={from:q,to:p,text:t?t[l%t.length]:h,origin:f||(e?"paste":a.state.cutIncoming?"cut":"+input")};Eb(a.doc,q);la(a,"inputRead",a,q)}b&&!e&&Mf(a,b);zb(a);a.curOp.updateInput=k;a.curOp.typing=!0;a.state.pasteIncoming=a.state.cutIncoming=!1}function Nf(a,b){var c=a.clipboardData&&
a.clipboardData.getData("Text");if(c)return a.preventDefault(),b.isReadOnly()||b.options.disableInput||za(b,function(){return Sd(b,c,0,null,"paste")}),!0}function Mf(a,b){if(a.options.electricChars&&a.options.smartIndent)for(var c=a.doc.sel,d=c.ranges.length-1;0<=d;d--){var f=c.ranges[d];if(!(100<f.head.ch||d&&c.ranges[d-1].head.line==f.head.line)){var g=a.getModeAt(f.head),e=!1;if(g.electricChars)for(var h=0;h<g.electricChars.length;h++){if(-1<b.indexOf(g.electricChars.charAt(h))){e=rc(a,f.head.line,
"smart");break}}else g.electricInput&&g.electricInput.test(I(a.doc,f.head.line).text.slice(0,f.head.ch))&&(e=rc(a,f.head.line,"smart"));e&&la(a,"electricInput",a,f.head.line)}}}function Of(a){for(var b=[],c=[],d=0;d<a.doc.sel.ranges.length;d++){var f=a.doc.sel.ranges[d].head.line,f={anchor:K(f,0),head:K(f+1,0)};c.push(f);b.push(a.getRange(f.anchor,f.head))}return{text:b,ranges:c}}function Pf(a,b){a.setAttribute("autocorrect","off");a.setAttribute("autocapitalize","off");a.setAttribute("spellcheck",
!!b)}function Qf(){var b=a("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),c=a("div",[b],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");oa?b.style.width="1000px":b.setAttribute("wrap","off");sc&&(b.style.border="1px solid black");Pf(b);return c}function Ud(a,b,c,d,f){function g(d){var g;g=f?Wd(a.cm,t,b,c):dd(t,b,c);if(null==g){if(d=!d)d=b.line+c,d<a.first||d>=a.first+a.size?d=!1:(b=new K(d,b.ch,b.sticky),d=t=I(a,
d));if(d)b=ed(f,a.cm,t,b.line,c);else return!1}else b=g;return!0}var e=b,h=c,t=I(a,b.line);if("char"==d)g();else if("column"==d)g(!0);else if("word"==d||"group"==d){var l=null;d="group"==d;for(var k=a.cm&&a.cm.getHelper(b,"wordChars"),q=!0;!(0>c)||g(!q);q=!1){var p=t.text.charAt(b.ch)||"\n",p=y(p,k)?"w":d&&"\n"==p?"n":!d||/\s/.test(p)?null:"p";!d||q||p||(p="s");if(l&&l!=p){0>c&&(c=1,g(),b.sticky="after");break}p&&(l=p);if(0<c&&!g(!q))break}}h=Ld(a,b,e,h,!0);na(e,h)&&(h.hitSide=!0);return h}function Rf(a,
b,c,d){var f=a.doc,g=b.left,e;"page"==d?(e=Math.max(Math.min(a.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight)-.5*gb(a.display),3),e=(0<c?b.bottom:b.top)+c*e):"line"==d&&(e=0<c?b.bottom+3:b.top-3);for(;;){b=td(a,g,e);if(!b.outside)break;if(0>c?0>=e:e>=f.height){b.hitSide=!0;break}e+=5*c}return b}function Sf(a,b){var c=qd(a,b.line);if(!c||c.hidden)return null;var d=I(a.doc,b.line),c=se(c,d,b.line);a=Va(d,a.doc.direction);d="left";a&&(d=bd(a,b.ch)%2?"right":"left");
b=te(c.map,b.ch,d);b.offset="right"==b.collapse?b.end:b.start;return b}function Ug(a){for(;a;a=a.parentNode)if(/CodeMirror-gutter-wrapper/.test(a.className))return!0;return!1}function Kb(a,b){b&&(a.bad=!0);return a}function Vg(a,b,c,d,f){function g(a){return function(b){return b.id==a}}function e(a){a&&(l&&(t+=k,l=!1),t+=a)}function h(b){if(1==b.nodeType){var c=b.getAttribute("cm-text");if(null!=c)e(c||b.textContent.replace(/\u200b/g,""));else{var c=b.getAttribute("cm-marker"),q;if(c)b=a.findMarks(K(d,
0),K(f+1,0),g(+c)),b.length&&(q=b[0].find(0))&&e(P(a.doc,q.from,q.to).join(k));else if("false"!=b.getAttribute("contenteditable")){(q=/^(pre|div|p)$/i.test(b.nodeName))&&l&&(t+=k,l=!1);for(c=0;c<b.childNodes.length;c++)h(b.childNodes[c]);q&&(l=!0)}}}else 3==b.nodeType&&e(b.nodeValue)}for(var t="",l=!1,k=a.doc.lineSeparator();;){h(b);if(b==c)break;b=b.nextSibling}return t}function Yc(a,b,c){var d;if(b==a.display.lineDiv){d=a.display.lineDiv.childNodes[c];if(!d)return Kb(a.clipPos(K(a.display.viewTo-
1)),!0);b=null;c=0}else for(d=b;;d=d.parentNode){if(!d||d==a.display.lineDiv)return null;if(d.parentNode&&d.parentNode==a.display.lineDiv)break}for(var f=0;f<a.display.view.length;f++){var g=a.display.view[f];if(g.node==d)return Wg(g,b,c)}}function Wg(a,b,c){function d(b,c,d){for(var f=-1;f<(k?k.length:0);f++)for(var g=0>f?t.map:k[f],e=0;e<g.length;e+=3){var h=g[e+2];if(h==b||h==c){c=L(0>f?a.line:a.rest[f]);f=g[e]+d;if(0>d||h!=b)f=g[e+(d?1:0)];return K(c,f)}}}var f=a.text.firstChild,g=!1;if(!b||!l(f,
b))return Kb(K(L(a.line),0),!0);if(b==f&&(g=!0,b=f.childNodes[c],c=0,!b))return c=a.rest?x(a.rest):a.line,Kb(K(L(c),c.text.length),g);var e=3==b.nodeType?b:null,h=b;e||1!=b.childNodes.length||3!=b.firstChild.nodeType||(e=b.firstChild,c&&(c=e.nodeValue.length));for(;h.parentNode!=f;)h=h.parentNode;var t=a.measure,k=t.maps;if(b=d(e,h,c))return Kb(b,g);f=h.nextSibling;for(e=e?e.nodeValue.length-c:0;f;f=f.nextSibling){if(b=d(f,f.firstChild,0))return Kb(K(b.line,b.ch-e),g);e+=f.textContent.length}for(h=
h.previousSibling;h;h=h.previousSibling){if(b=d(h,h.firstChild,-1))return Kb(K(b.line,b.ch+c),g);c+=h.textContent.length}}var wa=navigator.userAgent,Tf=navigator.platform,Ta=/gecko\/\d/i.test(wa),Uf=/MSIE \d/.test(wa),Vf=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(wa),tc=/Edge\/(\d+)/.exec(wa),Z=Uf||Vf||tc,da=Z&&(Uf?document.documentMode||6:+(tc||Vf)[1]),oa=!tc&&/WebKit\//.test(wa),Xg=oa&&/Qt\/\d+\.\d+/.test(wa),Gc=!tc&&/Chrome\//.test(wa),Ja=/Opera\//.test(wa),Lf=/Apple Computer/.test(navigator.vendor),
Yg=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(wa),pg=/PhantomJS/.test(wa),sc=!tc&&/AppleWebKit/.test(wa)&&/Mobile\/\w+/.test(wa),Hc=/Android/.test(wa),Qb=sc||Hc||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(wa),Ha=sc||/Mac/.test(Tf),Ng=/\bCrOS\b/.test(wa),Zg=/win/i.test(Tf),pb=Ja&&wa.match(/Version\/(\d*\.\d*)/);pb&&(pb=Number(pb[1]));pb&&15<=pb&&(Ja=!1,oa=!0);var xf=Ha&&(Xg||Ja&&(null==pb||12.11>pb)),Pd=Ta||Z&&9<=da,jb=function(a,c){var d=a.className;if(c=b(c).exec(d)){var f=d.slice(c.index+
c[0].length);a.className=d.slice(0,c.index)+(f?c[1]+f:"")}},xb;xb=document.createRange?function(a,b,c,d){var f=document.createRange();f.setEnd(d||a,c);f.setStart(a,b);return f}:function(a,b,c){var d=document.body.createTextRange();try{d.moveToElementText(a.parentNode)}catch(aa){return d}d.collapse(!0);d.moveEnd("character",c);d.moveStart("character",b);return d};var uc=function(a){a.select()};sc?uc=function(a){a.selectionStart=0;a.selectionEnd=a.value.length}:Z&&(uc=function(a){try{a.select()}catch(A){}});
var ob=function(){this.id=null};ob.prototype.set=function(a,b){clearTimeout(this.id);this.id=setTimeout(b,a)};var Wc={toString:function(){return"CodeMirror.Pass"}},Ma={scroll:!1},Qd={origin:"*mouse"},vc={origin:"+move"},Ac=[""],Wf=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,Xf=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/,
kf=!1,Ua=!1,Rb=null,Zf=function(){function a(a){return 247>=a?"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN".charAt(a):1424<=a&&1524>=a?"R":1536<=a&&1785>=a?"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111".charAt(a-
1536):1774<=a&&2220>=a?"r":8192<=a&&8203>=a?"w":8204==a?"b":"L"}function b(a,b,c){this.level=a;this.from=b;this.to=c}var c=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,d=/[stwN]/,f=/[LRr]/,g=/[Lb1n]/,e=/[1n]/;return function(h,t){var l="ltr"==t?"L":"R";if(0==h.length||"ltr"==t&&!c.test(h))return!1;for(var k=h.length,q=[],p=0;p<k;++p)q.push(a(h.charCodeAt(p)));for(var p=0,v=l;p<k;++p){var m=q[p];"m"==m?q[p]=v:v=m}p=0;for(v=l;p<k;++p)m=q[p],"1"==m&&"r"==v?q[p]="n":f.test(m)&&(v=m,"r"==m&&(q[p]="R"));
p=1;for(v=q[0];p<k-1;++p)m=q[p],"+"==m&&"1"==v&&"1"==q[p+1]?q[p]="1":","!=m||v!=q[p+1]||"1"!=v&&"n"!=v||(q[p]=v),v=m;for(p=0;p<k;++p)if(v=q[p],","==v)q[p]="N";else if("%"==v){for(v=p+1;v<k&&"%"==q[v];++v);for(m=p&&"!"==q[p-1]||v<k&&"1"==q[v]?"1":"N";p<v;++p)q[p]=m;p=v-1}p=0;for(v=l;p<k;++p)m=q[p],"L"==v&&"1"==m?q[p]="L":f.test(m)&&(v=m);for(v=0;v<k;++v)if(d.test(q[v])){for(p=v+1;p<k&&d.test(q[p]);++p);m="L"==(v?q[v-1]:l);for(m=m==("L"==(p<k?q[p]:l))?m?"L":"R":l;v<p;++v)q[v]=m;v=p-1}for(var l=[],A,
p=0;p<k;)if(g.test(q[p])){v=p;for(++p;p<k&&g.test(q[p]);++p);l.push(new b(0,v,p))}else{var y=p,v=l.length;for(++p;p<k&&"L"!=q[p];++p);for(m=y;m<p;)if(e.test(q[m])){y<m&&l.splice(v,0,new b(1,y,m));y=m;for(++m;m<p&&e.test(q[m]);++m);l.splice(v,0,new b(2,y,m));y=m}else++m;y<p&&l.splice(v,0,new b(1,y,p))}1==l[0].level&&(A=h.match(/^\s+/))&&(l[0].from=A[0].length,l.unshift(new b(0,0,A[0].length)));1==x(l).level&&(A=h.match(/\s+$/))&&(x(l).to-=A[0].length,l.push(new b(0,k-A[0].length,k)));return"rtl"==
t?l.reverse():l}}(),Cc=[],R=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):(a=a._handlers||(a._handlers={}),a[b]=(a[b]||Cc).concat(c))},Og=function(){if(Z&&9>da)return!1;var b=a("div");return"draggable"in b||"dragDrop"in b}(),gd,md,Td=3!="\n\nb".split(/\n/).length?function(a){for(var b=0,c=[],d=a.length;b<=d;){var f=a.indexOf("\n",b);-1==f&&(f=a.length);var g=a.slice(b,"\r"==a.charAt(f-1)?f-1:f),e=g.indexOf("\r");-1!=e?(c.push(g.slice(0,e)),b+=
e+1):(c.push(g),b=f+1)}return c}:function(a){return a.split(/\r\n?|\n/)},$g=window.getSelection?function(a){try{return a.selectionStart!=a.selectionEnd}catch(A){return!1}}:function(a){var b;try{b=a.ownerDocument.selection.createRange()}catch(N){}return b&&b.parentElement()==a?0!=b.compareEndPoints("StartToEnd",b):!1},Ig=function(){var b=a("div");if("oncopy"in b)return!0;b.setAttribute("oncopy","return;");return"function"==typeof b.oncopy}(),sd=null,hd={},vb={},wb={},ga=function(a,b,c){this.pos=this.start=
0;this.string=a;this.tabSize=b||8;this.lineStart=this.lastColumnPos=this.lastColumnValue=0;this.lineOracle=c};ga.prototype.eol=function(){return this.pos>=this.string.length};ga.prototype.sol=function(){return this.pos==this.lineStart};ga.prototype.peek=function(){return this.string.charAt(this.pos)||void 0};ga.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)};ga.prototype.eat=function(a){var b=this.string.charAt(this.pos);if("string"==typeof a?b==a:b&&
(a.test?a.test(b):a(b)))return++this.pos,b};ga.prototype.eatWhile=function(a){for(var b=this.pos;this.eat(a););return this.pos>b};ga.prototype.eatSpace=function(){for(var a=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>a};ga.prototype.skipToEnd=function(){this.pos=this.string.length};ga.prototype.skipTo=function(a){a=this.string.indexOf(a,this.pos);if(-1<a)return this.pos=a,!0};ga.prototype.backUp=function(a){this.pos-=a};ga.prototype.column=function(){this.lastColumnPos<
this.start&&(this.lastColumnValue=g(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start);return this.lastColumnValue-(this.lineStart?g(this.string,this.lineStart,this.tabSize):0)};ga.prototype.indentation=function(){return g(this.string,null,this.tabSize)-(this.lineStart?g(this.string,this.lineStart,this.tabSize):0)};ga.prototype.match=function(a,b,c){if("string"==typeof a){var d=function(a){return c?a.toLowerCase():a},f=this.string.substr(this.pos,
a.length);if(d(f)==d(a))return!1!==b&&(this.pos+=a.length),!0}else{if((a=this.string.slice(this.pos).match(a))&&0<a.index)return null;a&&!1!==b&&(this.pos+=a[0].length);return a}};ga.prototype.current=function(){return this.string.slice(this.start,this.pos)};ga.prototype.hideFirstChars=function(a,b){this.lineStart+=a;try{return b()}finally{this.lineStart-=a}};ga.prototype.lookAhead=function(a){var b=this.lineOracle;return b&&b.lookAhead(a)};var Ec=function(a,b){this.state=a;this.lookAhead=b},Pa=function(a,
b,c,d){this.state=b;this.doc=a;this.line=c;this.maxLookAhead=d||0};Pa.prototype.lookAhead=function(a){var b=this.doc.getLine(this.line+a);null!=b&&a>this.maxLookAhead&&(this.maxLookAhead=a);return b};Pa.prototype.nextLine=function(){this.line++;0<this.maxLookAhead&&this.maxLookAhead--};Pa.fromSaved=function(a,b,c){return b instanceof Ec?new Pa(a,db(a.mode,b.state),c,b.lookAhead):new Pa(a,db(a.mode,b),c)};Pa.prototype.save=function(a){a=!1!==a?db(this.doc.mode,this.state):this.state;return 0<this.maxLookAhead?
new Ec(a,this.maxLookAhead):a};var ge=function(a,b,c){this.start=a.start;this.end=a.pos;this.string=a.current();this.type=b||null;this.state=c},Bb=function(a,b,c){this.text=a;Nb(this,b);this.height=c?c(this):1};Bb.prototype.lineNo=function(){return L(this)};ub(Bb);var fg={},eg={},yb=null,Ub=null,ue={left:0,right:0,top:0,bottom:0},hb,qb=function(b,c,d){this.cm=d;var f=this.vert=a("div",[a("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),g=this.horiz=a("div",[a("div",null,null,"height: 100%; min-height: 1px")],
"CodeMirror-hscrollbar");b(f);b(g);R(f,"scroll",function(){f.clientHeight&&c(f.scrollTop,"vertical")});R(g,"scroll",function(){g.clientWidth&&c(g.scrollLeft,"horizontal")});this.checkedZeroWidth=!1;Z&&8>da&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};qb.prototype.update=function(a){var b=a.scrollWidth>a.clientWidth+1,c=a.scrollHeight>a.clientHeight+1,d=a.nativeBarWidth;c?(this.vert.style.display="block",this.vert.style.bottom=b?d+"px":"0",this.vert.firstChild.style.height=Math.max(0,
a.scrollHeight-a.clientHeight+(a.viewHeight-(b?d:0)))+"px"):(this.vert.style.display="",this.vert.firstChild.style.height="0");b?(this.horiz.style.display="block",this.horiz.style.right=c?d+"px":"0",this.horiz.style.left=a.barLeft+"px",this.horiz.firstChild.style.width=Math.max(0,a.scrollWidth-a.clientWidth+(a.viewWidth-a.barLeft-(c?d:0)))+"px"):(this.horiz.style.display="",this.horiz.firstChild.style.width="0");!this.checkedZeroWidth&&0<a.clientHeight&&(0==d&&this.zeroWidthHack(),this.checkedZeroWidth=
!0);return{right:c?d:0,bottom:b?d:0}};qb.prototype.setScrollLeft=function(a){this.horiz.scrollLeft!=a&&(this.horiz.scrollLeft=a);this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")};qb.prototype.setScrollTop=function(a){this.vert.scrollTop!=a&&(this.vert.scrollTop=a);this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")};qb.prototype.zeroWidthHack=function(){this.horiz.style.height=this.vert.style.width=Ha&&!Yg?"12px":"18px";this.horiz.style.pointerEvents=
this.vert.style.pointerEvents="none";this.disableHoriz=new ob;this.disableVert=new ob};qb.prototype.enableZeroWidthBar=function(a,b,c){function d(){var f=a.getBoundingClientRect();("vert"==c?document.elementFromPoint(f.right-1,(f.top+f.bottom)/2):document.elementFromPoint((f.right+f.left)/2,f.bottom-1))!=a?a.style.pointerEvents="none":b.set(1E3,d)}a.style.pointerEvents="auto";b.set(1E3,d)};qb.prototype.clear=function(){var a=this.horiz.parentNode;a.removeChild(this.horiz);a.removeChild(this.vert)};
var wc=function(){};wc.prototype.update=function(){return{bottom:0,right:0}};wc.prototype.setScrollLeft=function(){};wc.prototype.setScrollTop=function(){};wc.prototype.clear=function(){};var Ne={"native":qb,"null":wc},og=0,Mc=function(a,b,c){var d=a.display;this.viewport=b;this.visible=yd(d,a.doc,b);this.editorIsHidden=!d.wrapper.offsetWidth;this.wrapperHeight=d.wrapper.clientHeight;this.wrapperWidth=d.wrapper.clientWidth;this.oldDisplayWidth=eb(a);this.force=c;this.dims=rd(a);this.events=[]};Mc.prototype.signal=
function(a,b){Ea(a,b)&&this.events.push(arguments)};Mc.prototype.finish=function(){for(var a=0;a<this.events.length;a++)fa.apply(null,this.events[a])};var Oc=0,Ca=null;Z?Ca=-.53:Ta?Ca=15:Gc?Ca=-.7:Lf&&(Ca=-1/3);var Da=function(a,b){this.ranges=a;this.primIndex=b};Da.prototype.primary=function(){return this.ranges[this.primIndex]};Da.prototype.equals=function(a){if(a==this)return!0;if(a.primIndex!=this.primIndex||a.ranges.length!=this.ranges.length)return!1;for(var b=0;b<this.ranges.length;b++){var c=
this.ranges[b],d=a.ranges[b];if(!na(c.anchor,d.anchor)||!na(c.head,d.head))return!1}return!0};Da.prototype.deepCopy=function(){for(var a=[],b=0;b<this.ranges.length;b++)a[b]=new ba(sa(this.ranges[b].anchor),sa(this.ranges[b].head));return new Da(a,this.primIndex)};Da.prototype.somethingSelected=function(){for(var a=0;a<this.ranges.length;a++)if(!this.ranges[a].empty())return!0;return!1};Da.prototype.contains=function(a,b){b||(b=a);for(var c=0;c<this.ranges.length;c++){var d=this.ranges[c];if(0<=O(b,
d.from())&&0>=O(a,d.to()))return c}return-1};var ba=function(a,b){this.anchor=a;this.head=b};ba.prototype.from=function(){return Na(this.anchor,this.head)};ba.prototype.to=function(){return ta(this.anchor,this.head)};ba.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch};hc.prototype={chunkSize:function(){return this.lines.length},removeInner:function(a,b){for(var c=a,d=a+b;c<d;++c){var f=this.lines[c];this.height-=f.height;var g=f;g.parent=null;Sa(g);
la(f,"delete")}this.lines.splice(a,b)},collapse:function(a){a.push.apply(a,this.lines)},insertInner:function(a,b,c){this.height+=c;this.lines=this.lines.slice(0,a).concat(b).concat(this.lines.slice(a));for(a=0;a<b.length;++a)b[a].parent=this},iterN:function(a,b,c){for(b=a+b;a<b;++a)if(c(this.lines[a]))return!0}};ic.prototype={chunkSize:function(){return this.size},removeInner:function(a,b){this.size-=b;for(var c=0;c<this.children.length;++c){var d=this.children[c],f=d.chunkSize();if(a<f){var g=Math.min(b,
f-a),e=d.height;d.removeInner(a,g);this.height-=e-d.height;f==g&&(this.children.splice(c--,1),d.parent=null);if(0==(b-=g))break;a=0}else a-=f}25>this.size-b&&(1<this.children.length||!(this.children[0]instanceof hc))&&(a=[],this.collapse(a),this.children=[new hc(a)],this.children[0].parent=this)},collapse:function(a){for(var b=0;b<this.children.length;++b)this.children[b].collapse(a)},insertInner:function(a,b,c){this.size+=b.length;this.height+=c;for(var d=0;d<this.children.length;++d){var f=this.children[d],
g=f.chunkSize();if(a<=g){f.insertInner(a,b,c);if(f.lines&&50<f.lines.length){for(b=a=f.lines.length%25+25;b<f.lines.length;)c=new hc(f.lines.slice(b,b+=25)),f.height-=c.height,this.children.splice(++d,0,c),c.parent=this;f.lines=f.lines.slice(0,a);this.maybeSpill()}break}a-=g}},maybeSpill:function(){if(!(10>=this.children.length)){var a=this;do{var b=a.children.splice(a.children.length-5,5),b=new ic(b);if(a.parent){a.size-=b.size;a.height-=b.height;var c=d(a.parent.children,a);a.parent.children.splice(c+
1,0,b)}else c=new ic(a.children),c.parent=a,a.children=[c,b],a=c;b.parent=a.parent}while(10<a.children.length);a.parent.maybeSpill()}},iterN:function(a,b,c){for(var d=0;d<this.children.length;++d){var f=this.children[d],g=f.chunkSize();if(a<g){g=Math.min(b,g-a);if(f.iterN(a,g,c))return!0;if(0==(b-=g))break;a=0}else a-=g}}};var jc=function(a,b,c){if(c)for(var d in c)c.hasOwnProperty(d)&&(this[d]=c[d]);this.doc=a;this.node=b};jc.prototype.clear=function(){var a=this.doc.cm,b=this.line.widgets,c=this.line,
d=L(c);if(null!=d&&b){for(var f=0;f<b.length;++f)b[f]==this&&b.splice(f--,1);b.length||(c.widgets=null);var g=Wb(this);V(c,Math.max(0,c.height-g));a&&(za(a,function(){var b=-g;Ga(c)<(a.curOp&&a.curOp.scrollTop||a.doc.scrollTop)&&Kc(a,b);Xa(a,d,"widget")}),la(a,"lineWidgetCleared",a,this,d))}};jc.prototype.changed=function(){var a=this,b=this.height,c=this.doc.cm,d=this.line;this.height=null;var f=Wb(this)-b;f&&(V(d,d.height+f),c&&za(c,function(){c.curOp.forceUpdate=!0;Ga(d)<(c.curOp&&c.curOp.scrollTop||
c.doc.scrollTop)&&Kc(c,f);la(c,"lineWidgetChanged",c,a,L(d))}))};ub(jc);var qf=0,Za=function(a,b){this.lines=[];this.type=b;this.doc=a;this.id=++qf};Za.prototype.clear=function(){if(!this.explicitlyCleared){var a=this.doc.cm,b=a&&!a.curOp;b&&lb(a);if(Ea(this,"clear")){var c=this.find();c&&la(this,"clear",c.from,c.to)}for(var d=c=null,f=0;f<this.lines.length;++f){var g=this.lines[f],e=Y(g.markedSpans,this);a&&!this.collapsed?Xa(a,L(g),"text"):a&&(null!=e.to&&(d=L(g)),null!=e.from&&(c=L(g)));for(var h=
g,l=g.markedSpans,k=e,q=void 0,p=0;p<l.length;++p)l[p]!=k&&(q||(q=[])).push(l[p]);h.markedSpans=q;null==e.from&&this.collapsed&&!bb(this.doc,g)&&a&&V(g,gb(a.display))}if(a&&this.collapsed&&!a.options.lineWrapping)for(f=0;f<this.lines.length;++f)g=ra(this.lines[f]),e=Bc(g),e>a.display.maxLineLength&&(a.display.maxLine=g,a.display.maxLineLength=e,a.display.maxLineChanged=!0);null!=c&&a&&this.collapsed&&xa(a,c,d+1);this.lines.length=0;this.explicitlyCleared=!0;this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=
!1,a&&ff(a.doc));a&&la(a,"markerCleared",a,this,c,d);b&&mb(a);this.parent&&this.parent.clear()}};Za.prototype.find=function(a,b){null==a&&"bookmark"==this.type&&(a=1);for(var c,d,f=0;f<this.lines.length;++f){var g=this.lines[f],e=Y(g.markedSpans,this);if(null!=e.from&&(c=K(b?g:L(g),e.from),-1==a))return c;if(null!=e.to&&(d=K(b?g:L(g),e.to),1==a))return d}return c&&{from:c,to:d}};Za.prototype.changed=function(){var a=this,b=this.find(-1,!0),c=this,d=this.doc.cm;b&&d&&za(d,function(){var f=b.line,g=
L(b.line);if(g=qd(d,g))ve(g),d.curOp.selectionChanged=d.curOp.forceUpdate=!0;d.curOp.updateMaxLine=!0;bb(c.doc,f)||null==c.height||(g=c.height,c.height=null,(g=Wb(c)-g)&&V(f,f.height+g));la(d,"markerChanged",d,a)})};Za.prototype.attachLine=function(a){if(!this.lines.length&&this.doc.cm){var b=this.doc.cm.curOp;b.maybeHiddenMarkers&&-1!=d(b.maybeHiddenMarkers,this)||(b.maybeUnhiddenMarkers||(b.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(a)};Za.prototype.detachLine=function(a){this.lines.splice(d(this.lines,
a),1);!this.lines.length&&this.doc.cm&&(a=this.doc.cm.curOp,(a.maybeHiddenMarkers||(a.maybeHiddenMarkers=[])).push(this))};ub(Za);var kc=function(a,b){this.markers=a;this.primary=b;for(b=0;b<a.length;++b)a[b].parent=this};kc.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var a=0;a<this.markers.length;++a)this.markers[a].clear();la(this,"clear")}};kc.prototype.find=function(a,b){return this.primary.find(a,b)};ub(kc);var ah=0,ya=function(a,b,c,d,f){if(!(this instanceof
ya))return new ya(a,b,c,d,f);null==c&&(c=0);ic.call(this,[new hc([new Bb("",null)])]);this.first=c;this.scrollTop=this.scrollLeft=0;this.cantEdit=!1;this.cleanGeneration=1;this.modeFrontier=this.highlightFrontier=c;c=K(c,0);this.sel=Ra(c);this.history=new Pc(null);this.id=++ah;this.modeOption=b;this.lineSep=d;this.direction="rtl"==f?"rtl":"ltr";this.extend=!1;"string"==typeof a&&(a=this.splitLines(a));Hd(this,{from:c,to:c,text:a});ma(this,Ra(c),Ma)};ya.prototype=z(ic.prototype,{constructor:ya,iter:function(a,
b,c){c?this.iterN(a-this.first,b-a,c):this.iterN(this.first,this.first+this.size,a)},insert:function(a,b){for(var c=0,d=0;d<b.length;++d)c+=b[d].height;this.insertInner(a-this.first,b,c)},remove:function(a,b){this.removeInner(a-this.first,b)},getValue:function(a){var b=U(this,this.first,this.first+this.size);return!1===a?b:b.join(a||this.lineSeparator())},setValue:ka(function(a){var b=K(this.first,0),c=this.first+this.size-1;Eb(this,{from:b,to:K(c,I(this,c).text.length),text:this.splitLines(a),origin:"setValue",
full:!0},!0);this.cm&&ac(this.cm,0,0);ma(this,Ra(b),Ma)}),replaceRange:function(a,b,c,d){b=T(this,b);c=c?T(this,c):b;Fb(this,a,b,c,d)},getRange:function(a,b,c){a=P(this,T(this,a),T(this,b));return!1===c?a:a.join(c||this.lineSeparator())},getLine:function(a){return(a=this.getLineHandle(a))&&a.text},getLineHandle:function(a){if(W(this,a))return I(this,a)},getLineNumber:function(a){return L(a)},getLineHandleVisualStart:function(a){"number"==typeof a&&(a=I(this,a));return ra(a)},lineCount:function(){return this.size},
firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(a){return T(this,a)},getCursor:function(a){var b=this.sel.primary();return null==a||"head"==a?b.head:"anchor"==a?b.anchor:"end"==a||"to"==a||!1===a?b.to():b.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:ka(function(a,b,c){a=T(this,"number"==typeof a?K(a,b||0):a);ma(this,Ra(a,null),c)}),setSelection:ka(function(a,
b,c){var d=T(this,a);a=T(this,b||a);ma(this,Ra(d,a),c)}),extendSelection:ka(function(a,b,c){Rc(this,T(this,a),b&&T(this,b),c)}),extendSelections:ka(function(a,b){bf(this,Fa(this,a),b)}),extendSelectionsBy:ka(function(a,b){a=n(this.sel.ranges,a);bf(this,Fa(this,a),b)}),setSelections:ka(function(a,b,c){if(a.length){for(var d=[],f=0;f<a.length;f++)d[f]=new ba(T(this,a[f].anchor),T(this,a[f].head));null==b&&(b=Math.min(a.length-1,this.sel.primIndex));ma(this,Ka(d,b),c)}}),addSelection:ka(function(a,b,
c){var d=this.sel.ranges.slice(0);d.push(new ba(T(this,a),T(this,b||a)));ma(this,Ka(d,d.length-1),c)}),getSelection:function(a){for(var b=this.sel.ranges,c,d=0;d<b.length;d++){var f=P(this,b[d].from(),b[d].to());c=c?c.concat(f):f}return!1===a?c:c.join(a||this.lineSeparator())},getSelections:function(a){for(var b=[],c=this.sel.ranges,d=0;d<c.length;d++){var f=P(this,c[d].from(),c[d].to());!1!==a&&(f=f.join(a||this.lineSeparator()));b[d]=f}return b},replaceSelection:function(a,b,c){for(var d=[],f=0;f<
this.sel.ranges.length;f++)d[f]=a;this.replaceSelections(d,b,c||"+input")},replaceSelections:ka(function(a,b,c){for(var d=[],f=this.sel,g=0;g<f.ranges.length;g++){var e=f.ranges[g];d[g]={from:e.from(),to:e.to(),text:this.splitLines(a[g]),origin:c}}if(a=b&&"end"!=b){a=[];f=c=K(this.first,0);for(g=0;g<d.length;g++){var h=d[g],e=Ue(h.from,c,f),l=Ue(Ya(h),c,f);c=h.to;f=l;"around"==b?(h=this.sel.ranges[g],h=0>O(h.head,h.anchor),a[g]=new ba(h?l:e,h?e:l)):a[g]=new ba(e,e)}a=new Da(a,this.sel.primIndex)}b=
a;for(a=d.length-1;0<=a;a--)Eb(this,d[a]);b?cf(this,b):this.cm&&zb(this.cm)}),undo:ka(function(){Tc(this,"undo")}),redo:ka(function(){Tc(this,"redo")}),undoSelection:ka(function(){Tc(this,"undo",!0)}),redoSelection:ka(function(){Tc(this,"redo",!0)}),setExtending:function(a){this.extend=a},getExtending:function(){return this.extend},historySize:function(){for(var a=this.history,b=0,c=0,d=0;d<a.done.length;d++)a.done[d].ranges||++b;for(d=0;d<a.undone.length;d++)a.undone[d].ranges||++c;return{undo:b,
redo:c}},clearHistory:function(){this.history=new Pc(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(a){a&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null);return this.history.generation},isClean:function(a){return this.history.generation==(a||this.cleanGeneration)},getHistory:function(){return{done:Cb(this.history.done),undone:Cb(this.history.undone)}},setHistory:function(a){var b=this.history=new Pc(this.history.maxGeneration);
b.done=Cb(a.done.slice(0),null,!0);b.undone=Cb(a.undone.slice(0),null,!0)},setGutterMarker:ka(function(a,b,c){return gc(this,a,"gutter",function(a){var d=a.gutterMarkers||(a.gutterMarkers={});d[b]=c;!c&&H(d)&&(a.gutterMarkers=null);return!0})}),clearGutter:ka(function(a){var b=this;this.iter(function(c){c.gutterMarkers&&c.gutterMarkers[a]&&gc(b,c,"gutter",function(){c.gutterMarkers[a]=null;H(c.gutterMarkers)&&(c.gutterMarkers=null);return!0})})}),lineInfo:function(a){var b;if("number"==typeof a){if(!W(this,
a))return null;b=a;a=I(this,a);if(!a)return null}else if(b=L(a),null==b)return null;return{line:b,handle:a,text:a.text,gutterMarkers:a.gutterMarkers,textClass:a.textClass,bgClass:a.bgClass,wrapClass:a.wrapClass,widgets:a.widgets}},addLineClass:ka(function(a,c,d){return gc(this,a,"gutter"==c?"gutter":"class",function(a){var f="text"==c?"textClass":"background"==c?"bgClass":"gutter"==c?"gutterClass":"wrapClass";if(a[f]){if(b(d).test(a[f]))return!1;a[f]+=" "+d}else a[f]=d;return!0})}),removeLineClass:ka(function(a,
c,d){return gc(this,a,"gutter"==c?"gutter":"class",function(a){var f="text"==c?"textClass":"background"==c?"bgClass":"gutter"==c?"gutterClass":"wrapClass",g=a[f];if(g)if(null==d)a[f]=null;else{var e=g.match(b(d));if(!e)return!1;var h=e.index+e[0].length;a[f]=g.slice(0,e.index)+(e.index&&h!=g.length?" ":"")+g.slice(h)||null}else return!1;return!0})}),addLineWidget:ka(function(a,b,c){return xg(this,a,b,c)}),removeLineWidget:function(a){a.clear()},markText:function(a,b,c){return Gb(this,T(this,a),T(this,
b),c,c&&c.type||"range")},setBookmark:function(a,b){b={replacedWith:b&&(null==b.nodeType?b.widget:b),insertLeft:b&&b.insertLeft,clearWhenEmpty:!1,shared:b&&b.shared,handleMouseEvents:b&&b.handleMouseEvents};a=T(this,a);return Gb(this,a,a,b,"bookmark")},findMarksAt:function(a){a=T(this,a);var b=[],c=I(this,a.line).markedSpans;if(c)for(var d=0;d<c.length;++d){var f=c[d];(null==f.from||f.from<=a.ch)&&(null==f.to||f.to>=a.ch)&&b.push(f.marker.parent||f.marker)}return b},findMarks:function(a,b,c){a=T(this,
a);b=T(this,b);var d=[],f=a.line;this.iter(a.line,b.line+1,function(g){if(g=g.markedSpans)for(var e=0;e<g.length;e++){var h=g[e];null!=h.to&&f==a.line&&a.ch>=h.to||null==h.from&&f!=a.line||null!=h.from&&f==b.line&&h.from>=b.ch||c&&!c(h.marker)||d.push(h.marker.parent||h.marker)}++f});return d},getAllMarks:function(){var a=[];this.iter(function(b){if(b=b.markedSpans)for(var c=0;c<b.length;++c)null!=b[c].from&&a.push(b[c].marker)});return a},posFromIndex:function(a){var b,c=this.first,d=this.lineSeparator().length;
this.iter(function(f){f=f.text.length+d;if(f>a)return b=a,!0;a-=f;++c});return T(this,K(c,b))},indexFromPos:function(a){a=T(this,a);var b=a.ch;if(a.line<this.first||0>a.ch)return 0;var c=this.lineSeparator().length;this.iter(this.first,a.line,function(a){b+=a.text.length+c});return b},copy:function(a){var b=new ya(U(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);b.scrollTop=this.scrollTop;b.scrollLeft=this.scrollLeft;b.sel=this.sel;b.extend=!1;a&&(b.history.undoDepth=
this.history.undoDepth,b.setHistory(this.getHistory()));return b},linkedDoc:function(a){a||(a={});var b=this.first,c=this.first+this.size;null!=a.from&&a.from>b&&(b=a.from);null!=a.to&&a.to<c&&(c=a.to);b=new ya(U(this,b,c),a.mode||this.modeOption,b,this.lineSep,this.direction);a.sharedHist&&(b.history=this.history);(this.linked||(this.linked=[])).push({doc:b,sharedHist:a.sharedHist});b.linked=[{doc:this,isParent:!0,sharedHist:a.sharedHist}];a=rf(this);for(c=0;c<a.length;c++){var d=a[c],f=d.find(),
g=b.clipPos(f.from),f=b.clipPos(f.to);O(g,f)&&(g=Gb(b,g,f,d.primary,d.primary.type),d.markers.push(g),g.parent=d)}return b},unlinkDoc:function(a){a instanceof ea&&(a=a.doc);if(this.linked)for(var b=0;b<this.linked.length;++b)if(this.linked[b].doc==a){this.linked.splice(b,1);a.unlinkDoc(this);zg(rf(this));break}if(a.history==this.history){var c=[a.id];nb(a,function(a){return c.push(a.id)},!0);a.history=new Pc(null);a.history.done=Cb(this.history.done,c);a.history.undone=Cb(this.history.undone,c)}},
iterLinkedDocs:function(a){nb(this,a)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(a){return this.lineSep?a.split(this.lineSep):Td(a)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:ka(function(a){"rtl"!=a&&(a="ltr");a!=this.direction&&(this.direction=a,this.iter(function(a){return a.order=null}),this.cm&&tg(this.cm))})});ya.prototype.eachLine=ya.prototype.iter;for(var tf=0,Kf=!1,$a={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",
17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",
63302:"Insert"},xc=0;10>xc;xc++)$a[xc+48]=$a[xc+96]=String(xc);for(var Zc=65;90>=Zc;Zc++)$a[Zc]=String.fromCharCode(Zc);for(var yc=1;12>=yc;yc++)$a[yc+111]=$a[yc+63235]="F"+yc;var lc={basic:{Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",
Esc:"singleSelection"},pcDefault:{"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll",
"Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},emacsy:{"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars",
"Ctrl-O":"openLine"},macDefault:{"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace",
"Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]}};lc["default"]=Ha?lc.macDefault:lc.pcDefault;var mc={selectAll:hf,singleSelection:function(a){return a.setSelection(a.getCursor("anchor"),a.getCursor("head"),Ma)},killLine:function(a){return Ib(a,function(b){if(b.empty()){var c=
I(a.doc,b.head.line).text.length;return b.head.ch==c&&b.head.line<a.lastLine()?{from:b.head,to:K(b.head.line+1,0)}:{from:b.head,to:K(b.head.line,c)}}return{from:b.from(),to:b.to()}})},deleteLine:function(a){return Ib(a,function(b){return{from:K(b.from().line,0),to:T(a.doc,K(b.to().line+1,0))}})},delLineLeft:function(a){return Ib(a,function(a){return{from:K(a.from().line,0),to:a.from()}})},delWrappedLineLeft:function(a){return Ib(a,function(b){var c=a.charCoords(b.head,"div").top+5;return{from:a.coordsChar({left:0,
top:c},"div"),to:b.from()}})},delWrappedLineRight:function(a){return Ib(a,function(b){var c=a.charCoords(b.head,"div").top+5,c=a.coordsChar({left:a.display.lineDiv.offsetWidth+100,top:c},"div");return{from:b.from(),to:c}})},undo:function(a){return a.undo()},redo:function(a){return a.redo()},undoSelection:function(a){return a.undoSelection()},redoSelection:function(a){return a.redoSelection()},goDocStart:function(a){return a.extendSelection(K(a.firstLine(),0))},goDocEnd:function(a){return a.extendSelection(K(a.lastLine()))},
goLineStart:function(a){return a.extendSelectionsBy(function(b){return zf(a,b.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(a){return a.extendSelectionsBy(function(b){return Af(a,b.head)},{origin:"+move",bias:1})},goLineEnd:function(a){return a.extendSelectionsBy(function(b){b=b.head.line;var c=I(a.doc,b),d;d=c;for(var f;f=qa(d,!1);)d=f.find(1,!0).line;d!=c&&(b=L(d));return ed(!0,a,c,b,-1)},{origin:"+move",bias:-1})},goLineRight:function(a){return a.extendSelectionsBy(function(b){b=
a.cursorCoords(b.head,"div").top+5;return a.coordsChar({left:a.display.lineDiv.offsetWidth+100,top:b},"div")},vc)},goLineLeft:function(a){return a.extendSelectionsBy(function(b){b=a.cursorCoords(b.head,"div").top+5;return a.coordsChar({left:0,top:b},"div")},vc)},goLineLeftSmart:function(a){return a.extendSelectionsBy(function(b){var c=a.cursorCoords(b.head,"div").top+5,c=a.coordsChar({left:0,top:c},"div");return c.ch<a.getLine(c.line).search(/\S/)?Af(a,b.head):c},vc)},goLineUp:function(a){return a.moveV(-1,
"line")},goLineDown:function(a){return a.moveV(1,"line")},goPageUp:function(a){return a.moveV(-1,"page")},goPageDown:function(a){return a.moveV(1,"page")},goCharLeft:function(a){return a.moveH(-1,"char")},goCharRight:function(a){return a.moveH(1,"char")},goColumnLeft:function(a){return a.moveH(-1,"column")},goColumnRight:function(a){return a.moveH(1,"column")},goWordLeft:function(a){return a.moveH(-1,"word")},goGroupRight:function(a){return a.moveH(1,"group")},goGroupLeft:function(a){return a.moveH(-1,
"group")},goWordRight:function(a){return a.moveH(1,"word")},delCharBefore:function(a){return a.deleteH(-1,"char")},delCharAfter:function(a){return a.deleteH(1,"char")},delWordBefore:function(a){return a.deleteH(-1,"word")},delWordAfter:function(a){return a.deleteH(1,"word")},delGroupBefore:function(a){return a.deleteH(-1,"group")},delGroupAfter:function(a){return a.deleteH(1,"group")},indentAuto:function(a){return a.indentSelection("smart")},indentMore:function(a){return a.indentSelection("add")},
indentLess:function(a){return a.indentSelection("subtract")},insertTab:function(a){return a.replaceSelection("\t")},insertSoftTab:function(a){for(var b=[],c=a.listSelections(),d=a.options.tabSize,f=0;f<c.length;f++){var e=c[f].from(),e=g(a.getLine(e.line),e.ch,d);b.push(q(d-e%d))}a.replaceSelections(b)},defaultTab:function(a){a.somethingSelected()?a.indentSelection("add"):a.execCommand("insertTab")},transposeChars:function(a){return za(a,function(){for(var b=a.listSelections(),c=[],d=0;d<b.length;d++)if(b[d].empty()){var f=
b[d].head,g=I(a.doc,f.line).text;if(g)if(f.ch==g.length&&(f=new K(f.line,f.ch-1)),0<f.ch)f=new K(f.line,f.ch+1),a.replaceRange(g.charAt(f.ch-1)+g.charAt(f.ch-2),K(f.line,f.ch-2),f,"+transpose");else if(f.line>a.doc.first){var e=I(a.doc,f.line-1).text;e&&(f=new K(f.line,1),a.replaceRange(g.charAt(0)+a.doc.lineSeparator()+e.charAt(e.length-1),K(f.line-1,e.length-1),f,"+transpose"))}c.push(new ba(f,f))}a.setSelections(c)})},newlineAndIndent:function(a){return za(a,function(){for(var b=a.listSelections(),
c=b.length-1;0<=c;c--)a.replaceRange(a.doc.lineSeparator(),b[c].anchor,b[c].head,"+input");b=a.listSelections();for(c=0;c<b.length;c++)a.indentLine(b[c].from().line,null,!0);zb(a)})},openLine:function(a){return a.replaceSelection("\n","start")},toggleOverwrite:function(a){return a.toggleOverwrite()}},Gg=new ob,Md=null,Nd=function(a,b,c){this.time=a;this.pos=b;this.button=c};Nd.prototype.compare=function(a,b,c){return this.time+400>a&&0==O(b,this.pos)&&c==this.button};var pc,oc,Jb={toString:function(){return"CodeMirror.Init"}},
Jf={},Xc={};ea.defaults=Jf;ea.optionHandlers=Xc;var Rd=[];ea.defineInitHook=function(a){return Rd.push(a)};var Aa=null,ca=function(a){this.cm=a;this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null;this.polling=new ob;this.composing=null;this.gracePeriod=!1;this.readDOMTimeout=null};ca.prototype.init=function(a){function b(a){if(!ia(f,a)){if(f.somethingSelected())Aa={lineWise:!1,text:f.getSelections()},"cut"==a.type&&f.replaceSelection("",null,"cut");else if(f.options.lineWiseCopyCut){var b=
Of(f);Aa={lineWise:!0,text:b.text};"cut"==a.type&&f.operation(function(){f.setSelections(b.ranges,0,Ma);f.replaceSelection("",null,"cut")})}else return;if(a.clipboardData){a.clipboardData.clearData();var c=Aa.text.join("\n");a.clipboardData.setData("Text",c);if(a.clipboardData.getData("Text")==c){a.preventDefault();return}}var e=Qf();a=e.firstChild;f.display.lineSpace.insertBefore(e,f.display.lineSpace.firstChild);a.value=Aa.text.join("\n");var h=document.activeElement;uc(a);setTimeout(function(){f.display.lineSpace.removeChild(e);
h.focus();h==g&&d.showPrimarySelection()},50)}}var c=this,d=this,f=d.cm,g=d.div=a.lineDiv;Pf(g,f.options.spellcheck);R(g,"paste",function(a){ia(f,a)||Nf(a,f)||11>=da&&setTimeout(ja(f,function(){return c.updateFromDOM()}),20)});R(g,"compositionstart",function(a){c.composing={data:a.data,done:!1}});R(g,"compositionupdate",function(a){c.composing||(c.composing={data:a.data,done:!1})});R(g,"compositionend",function(a){c.composing&&(a.data!=c.composing.data&&c.readFromDOMSoon(),c.composing.done=!0)});
R(g,"touchstart",function(){return d.forceCompositionEnd()});R(g,"input",function(){c.composing||c.readFromDOMSoon()});R(g,"copy",b);R(g,"cut",b)};ca.prototype.prepareSelection=function(){var a=Ce(this.cm,!1);a.focus=this.cm.state.focused;return a};ca.prototype.showSelection=function(a,b){a&&this.cm.display.view.length&&((a.focus||b)&&this.showPrimarySelection(),this.showMultipleSelections(a))};ca.prototype.showPrimarySelection=function(){var a=window.getSelection(),b=this.cm,c=b.doc.sel.primary(),
d=c.from(),c=c.to();if(b.display.viewTo==b.display.viewFrom||d.line>=b.display.viewTo||c.line<b.display.viewFrom)a.removeAllRanges();else{var f=Yc(b,a.anchorNode,a.anchorOffset),g=Yc(b,a.focusNode,a.focusOffset);if(!f||f.bad||!g||g.bad||0!=O(Na(f,g),d)||0!=O(ta(f,g),c))if(f=b.display.view,d=d.line>=b.display.viewFrom&&Sf(b,d)||{node:f[0].measure.map[2],offset:0},c=c.line<b.display.viewTo&&Sf(b,c),c||(c=f[f.length-1].measure,c=c.maps?c.maps[c.maps.length-1]:c.map,c={node:c[c.length-1],offset:c[c.length-
2]-c[c.length-3]}),d&&c){var f=a.rangeCount&&a.getRangeAt(0),e;try{e=xb(d.node,d.offset,c.offset,c.node)}catch(ch){}e&&(!Ta&&b.state.focused?(a.collapse(d.node,d.offset),e.collapsed||(a.removeAllRanges(),a.addRange(e))):(a.removeAllRanges(),a.addRange(e)),f&&null==a.anchorNode?a.addRange(f):Ta&&this.startGracePeriod());this.rememberSelection()}else a.removeAllRanges()}};ca.prototype.startGracePeriod=function(){var a=this;clearTimeout(this.gracePeriod);this.gracePeriod=setTimeout(function(){a.gracePeriod=
!1;a.selectionChanged()&&a.cm.operation(function(){return a.cm.curOp.selectionChanged=!0})},20)};ca.prototype.showMultipleSelections=function(a){r(this.cm.display.cursorDiv,a.cursors);r(this.cm.display.selectionDiv,a.selection)};ca.prototype.rememberSelection=function(){var a=window.getSelection();this.lastAnchorNode=a.anchorNode;this.lastAnchorOffset=a.anchorOffset;this.lastFocusNode=a.focusNode;this.lastFocusOffset=a.focusOffset};ca.prototype.selectionInEditor=function(){var a=window.getSelection();
if(!a.rangeCount)return!1;a=a.getRangeAt(0).commonAncestorContainer;return l(this.div,a)};ca.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()||this.showSelection(this.prepareSelection(),!0),this.div.focus())};ca.prototype.blur=function(){this.div.blur()};ca.prototype.getField=function(){return this.div};ca.prototype.supportsTouch=function(){return!0};ca.prototype.receivedFocus=function(){function a(){b.cm.state.focused&&(b.pollSelection(),b.polling.set(b.cm.options.pollInterval,
a))}var b=this;this.selectionInEditor()?this.pollSelection():za(this.cm,function(){return b.cm.curOp.selectionChanged=!0});this.polling.set(this.cm.options.pollInterval,a)};ca.prototype.selectionChanged=function(){var a=window.getSelection();return a.anchorNode!=this.lastAnchorNode||a.anchorOffset!=this.lastAnchorOffset||a.focusNode!=this.lastFocusNode||a.focusOffset!=this.lastFocusOffset};ca.prototype.pollSelection=function(){if(null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){var a=
window.getSelection(),b=this.cm;if(Hc&&Gc&&this.cm.options.gutters.length&&Ug(a.anchorNode))this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),this.focus();else if(!this.composing){this.rememberSelection();var c=Yc(b,a.anchorNode,a.anchorOffset),d=Yc(b,a.focusNode,a.focusOffset);c&&d&&za(b,function(){ma(b.doc,Ra(c,d),Ma);if(c.bad||d.bad)b.curOp.selectionChanged=!0})}}};ca.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),
this.readDOMTimeout=null);var a=this.cm,b=a.display,c=a.doc.sel.primary(),d=c.from(),f=c.to();0==d.ch&&d.line>a.firstLine()&&(d=K(d.line-1,I(a.doc,d.line-1).length));f.ch==I(a.doc,f.line).text.length&&f.line<a.lastLine()&&(f=K(f.line+1,0));if(d.line<b.viewFrom||f.line>b.viewTo-1)return!1;var g;d.line==b.viewFrom||0==(g=fb(a,d.line))?(c=L(b.view[0].line),g=b.view[0].node):(c=L(b.view[g].line),g=b.view[g-1].node.nextSibling);var e=fb(a,f.line);e==b.view.length-1?(f=b.viewTo-1,b=b.lineDiv.lastChild):
(f=L(b.view[e+1].line)-1,b=b.view[e+1].node.previousSibling);if(!g)return!1;b=a.doc.splitLines(Vg(a,g,b,c,f));for(g=P(a.doc,K(c,0),K(f,I(a.doc,f).text.length));1<b.length&&1<g.length;)if(x(b)==x(g))b.pop(),g.pop(),f--;else if(b[0]==g[0])b.shift(),g.shift(),c++;else break;for(var h=0,e=0,l=b[0],k=g[0],q=Math.min(l.length,k.length);h<q&&l.charCodeAt(h)==k.charCodeAt(h);)++h;l=x(b);k=x(g);for(q=Math.min(l.length-(1==b.length?h:0),k.length-(1==g.length?h:0));e<q&&l.charCodeAt(l.length-e-1)==k.charCodeAt(k.length-
e-1);)++e;if(1==b.length&&1==g.length&&c==d.line)for(;h&&h>d.ch&&l.charCodeAt(l.length-e-1)==k.charCodeAt(k.length-e-1);)h--,e++;b[b.length-1]=l.slice(0,l.length-e).replace(/^\u200b+/,"");b[0]=b[0].slice(h).replace(/\u200b+$/,"");d=K(c,h);c=K(f,g.length?x(g).length-e:0);if(1<b.length||b[0]||O(d,c))return Fb(a.doc,b,d,c,"+input"),!0};ca.prototype.ensurePolled=function(){this.forceCompositionEnd()};ca.prototype.reset=function(){this.forceCompositionEnd()};ca.prototype.forceCompositionEnd=function(){this.composing&&
(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())};ca.prototype.readFromDOMSoon=function(){var a=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(function(){a.readDOMTimeout=null;if(a.composing)if(a.composing.done)a.composing=null;else return;a.updateFromDOM()},80))};ca.prototype.updateFromDOM=function(){var a=this;!this.cm.isReadOnly()&&this.pollContent()||za(this.cm,function(){return xa(a.cm)})};ca.prototype.setUneditable=
function(a){a.contentEditable="false"};ca.prototype.onKeyPress=function(a){0!=a.charCode&&(a.preventDefault(),this.cm.isReadOnly()||ja(this.cm,Sd)(this.cm,String.fromCharCode(null==a.charCode?a.keyCode:a.charCode),0))};ca.prototype.readOnlyChanged=function(a){this.div.contentEditable=String("nocursor"!=a)};ca.prototype.onContextMenu=function(){};ca.prototype.resetPosition=function(){};ca.prototype.needsContentAttribute=!0;var ha=function(a){this.cm=a;this.prevInput="";this.pollingFast=!1;this.polling=
new ob;this.hasSelection=!1;this.composing=null};ha.prototype.init=function(a){function b(a){if(!ia(f,a)){if(f.somethingSelected())Aa={lineWise:!1,text:f.getSelections()};else if(f.options.lineWiseCopyCut){var b=Of(f);Aa={lineWise:!0,text:b.text};"cut"==a.type?f.setSelections(b.ranges,null,Ma):(d.prevInput="",e.value=b.text.join("\n"),uc(e))}else return;"cut"==a.type&&(f.state.cutIncoming=!0)}}var c=this,d=this,f=this.cm,g=this.wrapper=Qf(),e=this.textarea=g.firstChild;a.wrapper.insertBefore(g,a.wrapper.firstChild);
sc&&(e.style.width="0px");R(e,"input",function(){Z&&9<=da&&c.hasSelection&&(c.hasSelection=null);d.poll()});R(e,"paste",function(a){ia(f,a)||Nf(a,f)||(f.state.pasteIncoming=!0,d.fastPoll())});R(e,"cut",b);R(e,"copy",b);R(a.scroller,"paste",function(b){Qa(a,b)||ia(f,b)||(f.state.pasteIncoming=!0,d.focus())});R(a.lineSpace,"selectstart",function(b){Qa(a,b)||ua(b)});R(e,"compositionstart",function(){var a=f.getCursor("from");d.composing&&d.composing.range.clear();d.composing={start:a,range:f.markText(a,
f.getCursor("to"),{className:"CodeMirror-composing"})}});R(e,"compositionend",function(){d.composing&&(d.poll(),d.composing.range.clear(),d.composing=null)})};ha.prototype.prepareSelection=function(){var a=this.cm,b=a.display,c=a.doc,d=Ce(a);if(a.options.moveInputWithCursor){var a=Ia(a,c.sel.primary().head,"div"),c=b.wrapper.getBoundingClientRect(),f=b.lineDiv.getBoundingClientRect();d.teTop=Math.max(0,Math.min(b.wrapper.clientHeight-10,a.top+f.top-c.top));d.teLeft=Math.max(0,Math.min(b.wrapper.clientWidth-
10,a.left+f.left-c.left))}return d};ha.prototype.showSelection=function(a){var b=this.cm.display;r(b.cursorDiv,a.cursors);r(b.selectionDiv,a.selection);null!=a.teTop&&(this.wrapper.style.top=a.teTop+"px",this.wrapper.style.left=a.teLeft+"px")};ha.prototype.reset=function(a){if(!this.contextMenuPending&&!this.composing){var b=this.cm;b.somethingSelected()?(this.prevInput="",a=b.getSelection(),this.textarea.value=a,b.state.focused&&uc(this.textarea),Z&&9<=da&&(this.hasSelection=a)):a||(this.prevInput=
this.textarea.value="",Z&&9<=da&&(this.hasSelection=null))}};ha.prototype.getField=function(){return this.textarea};ha.prototype.supportsTouch=function(){return!1};ha.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!Qb||p()!=this.textarea))try{this.textarea.focus()}catch(t){}};ha.prototype.blur=function(){this.textarea.blur()};ha.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0};ha.prototype.receivedFocus=function(){this.slowPoll()};ha.prototype.slowPoll=
function(){var a=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){a.poll();a.cm.state.focused&&a.slowPoll()})};ha.prototype.fastPoll=function(){function a(){c.poll()||b?(c.pollingFast=!1,c.slowPoll()):(b=!0,c.polling.set(60,a))}var b=!1,c=this;c.pollingFast=!0;c.polling.set(20,a)};ha.prototype.poll=function(){var a=this,b=this.cm,c=this.textarea,d=this.prevInput;if(this.contextMenuPending||!b.state.focused||$g(c)&&!d&&!this.composing||b.isReadOnly()||b.options.disableInput||
b.state.keySeq)return!1;var f=c.value;if(f==d&&!b.somethingSelected())return!1;if(Z&&9<=da&&this.hasSelection===f||Ha&&/[\uf700-\uf7ff]/.test(f))return b.display.input.reset(),!1;if(b.doc.sel==b.display.selForContextMenu){var g=f.charCodeAt(0);8203!=g||d||(d="\u200b");if(8666==g)return this.reset(),this.cm.execCommand("undo")}for(var e=0,g=Math.min(d.length,f.length);e<g&&d.charCodeAt(e)==f.charCodeAt(e);)++e;za(b,function(){Sd(b,f.slice(e),d.length-e,null,a.composing?"*compose":null);1E3<f.length||
-1<f.indexOf("\n")?c.value=a.prevInput="":a.prevInput=f;a.composing&&(a.composing.range.clear(),a.composing.range=b.markText(a.composing.start,b.getCursor("to"),{className:"CodeMirror-composing"}))});return!0};ha.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)};ha.prototype.onKeyPress=function(){Z&&9<=da&&(this.hasSelection=null);this.fastPoll()};ha.prototype.onContextMenu=function(a){function b(){if(null!=e.selectionStart){var a=f.somethingSelected(),b="\u200b"+
(a?e.value:"");e.value="\u21da";e.value=b;d.prevInput=a?"":"\u200b";e.selectionStart=1;e.selectionEnd=b.length;g.selForContextMenu=f.doc.sel}}function c(){d.contextMenuPending=!1;d.wrapper.style.cssText=q;e.style.cssText=k;Z&&9>da&&g.scrollbars.setScrollTop(g.scroller.scrollTop=l);if(null!=e.selectionStart){(!Z||Z&&9>da)&&b();var a=0,c=function(){g.selForContextMenu==f.doc.sel&&0==e.selectionStart&&0<e.selectionEnd&&"\u200b"==d.prevInput?ja(f,hf)(f):10>a++?g.detectingSelectAll=setTimeout(c,500):(g.selForContextMenu=
null,g.input.reset())};g.detectingSelectAll=setTimeout(c,200)}}var d=this,f=d.cm,g=f.display,e=d.textarea,h=ib(f,a),l=g.scroller.scrollTop;if(h&&!Ja){f.options.resetSelectionOnContextMenu&&-1==f.doc.sel.contains(h)&&ja(f,ma)(f.doc,Ra(h),Ma);var k=e.style.cssText,q=d.wrapper.style.cssText;d.wrapper.style.cssText="position: absolute";h=d.wrapper.getBoundingClientRect();e.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(a.clientY-h.top-5)+"px; left: "+(a.clientX-h.left-5)+
"px;\n      z-index: 1000; background: "+(Z?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";var p;oa&&(p=window.scrollY);g.input.focus();oa&&window.scrollTo(null,p);g.input.reset();f.somethingSelected()||(e.value=d.prevInput=" ");d.contextMenuPending=!0;g.selForContextMenu=f.doc.sel;clearTimeout(g.detectingSelectAll);Z&&9<=da&&b();if(Pd){Sb(a);var v=function(){Ba(window,"mouseup",v);setTimeout(c,
20)};R(window,"mouseup",v)}else setTimeout(c,50)}};ha.prototype.readOnlyChanged=function(a){a||this.reset();this.textarea.disabled="nocursor"==a};ha.prototype.setUneditable=function(){};ha.prototype.needsContentAttribute=!1;(function(a){function b(b,d,f,g){a.defaults[b]=d;f&&(c[b]=g?function(a,b,c){c!=Jb&&f(a,b,c)}:f)}var c=a.optionHandlers;a.defineOption=b;a.Init=Jb;b("value","",function(a,b){return a.setValue(b)},!0);b("mode",null,function(a,b){a.doc.modeOption=b;Gd(a)},!0);b("indentUnit",2,Gd,
!0);b("indentWithTabs",!1);b("smartIndent",!0);b("tabSize",4,function(a){ec(a);Yb(a);xa(a)},!0);b("lineSeparator",null,function(a,b){if(a.doc.lineSep=b){var c=[],d=a.doc.first;a.doc.iter(function(a){for(var f=0;;){var g=a.text.indexOf(b,f);if(-1==g)break;f=g+b.length;c.push(K(d,g))}d++});for(var f=c.length-1;0<=f;f--)Fb(a.doc,b,c[f],K(c[f].line,c[f].ch+b.length))}});b("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff]/g,function(a,b,c){a.state.specialChars=new RegExp(b.source+
(b.test("\t")?"":"|\t"),"g");c!=Jb&&a.refresh()});b("specialCharPlaceholder",ig,function(a){return a.refresh()},!0);b("electricChars",!0);b("inputStyle",Qb?"contenteditable":"textarea",function(){throw Error("inputStyle can not (yet) be changed in a running editor");},!0);b("spellcheck",!1,function(a,b){return a.getInputField().spellcheck=b},!0);b("rtlMoveVisually",!Zg);b("wholeLineUpdateBefore",!0);b("theme","default",function(a){If(a);qc(a)},!0);b("keyMap","default",function(a,b,c){b=Uc(b);(c=c!=
Jb&&Uc(c))&&c.detach&&c.detach(a,b);b.attach&&b.attach(a,c||null)});b("extraKeys",null);b("configureMouse",null);b("lineWrapping",!1,Sg,!0);b("gutters",[],function(a){Ed(a.options);qc(a)},!0);b("fixedGutter",!0,function(a,b){a.display.gutters.style.left=b?ud(a.display)+"px":"0";a.refresh()},!0);b("coverGutterNextToScrollbar",!1,function(a){return Ab(a)},!0);b("scrollbarStyle","native",function(a){Me(a);Ab(a);a.display.scrollbars.setScrollTop(a.doc.scrollTop);a.display.scrollbars.setScrollLeft(a.doc.scrollLeft)},
!0);b("lineNumbers",!1,function(a){Ed(a.options);qc(a)},!0);b("firstLineNumber",1,qc,!0);b("lineNumberFormatter",function(a){return a},qc,!0);b("showCursorWhenSelecting",!1,Zb,!0);b("resetSelectionOnContextMenu",!0);b("lineWiseCopyCut",!0);b("pasteLinesPerSelection",!0);b("readOnly",!1,function(a,b){"nocursor"==b&&($b(a),a.display.input.blur());a.display.input.readOnlyChanged(b)});b("disableInput",!1,function(a,b){b||a.display.input.reset()},!0);b("dragDrop",!0,Rg);b("allowDropFileTypes",null);b("cursorBlinkRate",
530);b("cursorScrollMargin",0);b("cursorHeight",1,Zb,!0);b("singleCursorHeightPerLine",!0,Zb,!0);b("workTime",100);b("workDelay",100);b("flattenSpans",!0,ec,!0);b("addModeClass",!1,ec,!0);b("pollInterval",100);b("undoDepth",200,function(a,b){return a.doc.history.undoDepth=b});b("historyEventDelay",1250);b("viewportMargin",10,function(a){return a.refresh()},!0);b("maxHighlightLength",1E4,ec,!0);b("moveInputWithCursor",!0,function(a,b){b||a.display.input.resetPosition()});b("tabindex",null,function(a,
b){return a.display.input.getField().tabIndex=b||""});b("autofocus",null);b("direction","ltr",function(a,b){return a.doc.setDirection(b)},!0)})(ea);(function(a){var b=a.optionHandlers,c=a.helpers={};a.prototype={constructor:a,focus:function(){window.focus();this.display.input.focus()},setOption:function(a,c){var d=this.options,f=d[a];if(d[a]!=c||"mode"==a)d[a]=c,b.hasOwnProperty(a)&&ja(this,b[a])(this,c,f),fa(this,"optionChange",this,a)},getOption:function(a){return this.options[a]},getDoc:function(){return this.doc},
addKeyMap:function(a,b){this.state.keyMaps[b?"push":"unshift"](Uc(a))},removeKeyMap:function(a){for(var b=this.state.keyMaps,c=0;c<b.length;++c)if(b[c]==a||b[c].name==a)return b.splice(c,1),!0},addOverlay:va(function(b,c){var d=b.token?b:a.getMode(this.options,b);if(d.startState)throw Error("Overlays may not be stateful.");C(this.state.overlays,{mode:d,modeSpec:b,opaque:c&&c.opaque,priority:c&&c.priority||0},function(a){return a.priority});this.state.modeGen++;xa(this)}),removeOverlay:va(function(a){for(var b=
this.state.overlays,c=0;c<b.length;++c){var d=b[c].modeSpec;if(d==a||"string"==typeof a&&d.name==a){b.splice(c,1);this.state.modeGen++;xa(this);break}}}),indentLine:va(function(a,b,c){"string"!=typeof b&&"number"!=typeof b&&(b=null==b?this.options.smartIndent?"smart":"prev":b?"add":"subtract");W(this.doc,a)&&rc(this,a,b,c)}),indentSelection:va(function(a){for(var b=this.doc.sel.ranges,c=-1,d=0;d<b.length;d++){var f=b[d];if(f.empty())f.head.line>c&&(rc(this,f.head.line,a,!0),c=f.head.line,d==this.doc.sel.primIndex&&
zb(this));else{for(var g=f.from(),f=f.to(),e=Math.max(c,g.line),c=Math.min(this.lastLine(),f.line-(f.ch?0:1))+1,f=e;f<c;++f)rc(this,f,a);f=this.doc.sel.ranges;0==g.ch&&b.length==f.length&&0<f[d].from().ch&&Kd(this.doc,d,new ba(g,f[d].to()),Ma)}}}),getTokenAt:function(a,b){return fe(this,a,b)},getLineTokens:function(a,b){return fe(this,K(a),b,!0)},getTokenTypeAt:function(a){a=T(this.doc,a);var b=de(this,I(this.doc,a.line)),c=0,d=(b.length-1)/2;a=a.ch;if(0==a)b=b[2];else for(;;){var f=c+d>>1;if((f?
b[2*f-1]:0)>=a)d=f;else if(b[2*f+1]<a)c=f+1;else{b=b[2*f+2];break}}c=b?b.indexOf("overlay "):-1;return 0>c?b:0==c?null:b.slice(0,c-1)},getModeAt:function(b){var c=this.doc.mode;return c.innerMode?a.innerMode(c,this.getTokenAt(b).state).mode:c},getHelper:function(a,b){return this.getHelpers(a,b)[0]},getHelpers:function(a,b){var f=[];if(!c.hasOwnProperty(b))return f;var g=c[b];a=this.getModeAt(a);if("string"==typeof a[b])g[a[b]]&&f.push(g[a[b]]);else if(a[b])for(var e=0;e<a[b].length;e++){var h=g[a[b][e]];
h&&f.push(h)}else a.helperType&&g[a.helperType]?f.push(g[a.helperType]):g[a.name]&&f.push(g[a.name]);for(b=0;b<g._global.length;b++)e=g._global[b],e.pred(a,this)&&-1==d(f,e.val)&&f.push(e.val);return f},getStateAfter:function(a,b){var c=this.doc;a=Math.max(c.first,Math.min(null==a?c.first+c.size-1:a,c.first+c.size-1));return Tb(this,a+1,b).state},cursorCoords:function(a,b){var c=this.doc.sel.primary();a=null==a?c.head:"object"==typeof a?T(this.doc,a):a?c.from():c.to();return Ia(this,a,b||"page")},
charCoords:function(a,b){return Ic(this,T(this.doc,a),b||"page")},coordsChar:function(a,b){a=ze(this,a,b||"page");return td(this,a.left,a.top)},lineAtHeight:function(a,b){a=ze(this,{top:a,left:0},b||"page").top;return Q(this.doc,a+this.display.viewOffset)},heightAtLine:function(a,b,c){var d=!1;if("number"==typeof a){var f=this.doc.first+this.doc.size-1;a<this.doc.first?a=this.doc.first:a>f&&(a=f,d=!0);a=I(this.doc,a)}return cb(this,a,{top:0,left:0},b||"page",c||d).top+(d?this.doc.height-Ga(a):0)},
defaultTextHeight:function(){return gb(this.display)},defaultCharWidth:function(){return Xb(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(a,b,c,d,f){var g=this.display;a=Ia(this,T(this.doc,a));var e=a.bottom,h=a.left;b.style.position="absolute";b.setAttribute("cm-ignore-events","true");this.display.input.setUneditable(b);g.sizer.appendChild(b);if("over"==d)e=a.top;else if("above"==d||"near"==d){var l=Math.max(g.wrapper.clientHeight,
this.doc.height),k=Math.max(g.sizer.clientWidth,g.lineSpace.clientWidth);("above"==d||a.bottom+b.offsetHeight>l)&&a.top>b.offsetHeight?e=a.top-b.offsetHeight:a.bottom+b.offsetHeight<=l&&(e=a.bottom);h+b.offsetWidth>k&&(h=k-b.offsetWidth)}b.style.top=e+"px";b.style.left=b.style.right="";"right"==f?(h=g.sizer.clientWidth-b.offsetWidth,b.style.right="0px"):("left"==f?h=0:"middle"==f&&(h=(g.sizer.clientWidth-b.offsetWidth)/2),b.style.left=h+"px");c&&(a=Ad(this,{left:h,top:e,right:h+b.offsetWidth,bottom:e+
b.offsetHeight}),null!=a.scrollTop&&bc(this,a.scrollTop),null!=a.scrollLeft&&kb(this,a.scrollLeft))},triggerOnKeyDown:va(Cf),triggerOnKeyPress:va(Ef),triggerOnKeyUp:Df,triggerOnMouseDown:va(Ff),execCommand:function(a){if(mc.hasOwnProperty(a))return mc[a].call(null,this)},triggerElectric:va(function(a){Mf(this,a)}),findPosH:function(a,b,c,d){var f=1;0>b&&(f=-1,b=-b);a=T(this.doc,a);for(var g=0;g<b&&(a=Ud(this.doc,a,f,c,d),!a.hitSide);++g);return a},moveH:va(function(a,b){var c=this;this.extendSelectionsBy(function(d){return c.display.shift||
c.doc.extend||d.empty()?Ud(c.doc,d.head,a,b,c.options.rtlMoveVisually):0>a?d.from():d.to()},vc)}),deleteH:va(function(a,b){var c=this.doc;this.doc.sel.somethingSelected()?c.replaceSelection("",null,"+delete"):Ib(this,function(d){var f=Ud(c,d.head,a,b,!1);return 0>a?{from:f,to:d.head}:{from:d.head,to:f}})}),findPosV:function(a,b,c,d){var f=1;0>b&&(f=-1,b=-b);var g=T(this.doc,a);for(a=0;a<b&&(g=Ia(this,g,"div"),null==d?d=g.left:g.left=d,g=Rf(this,g,f,c),!g.hitSide);++a);return g},moveV:va(function(a,
b){var c=this,d=this.doc,f=[],g=!this.display.shift&&!d.extend&&d.sel.somethingSelected();d.extendSelectionsBy(function(e){if(g)return 0>a?e.from():e.to();var h=Ia(c,e.head,"div");null!=e.goalColumn&&(h.left=e.goalColumn);f.push(h.left);var l=Rf(c,h,a,b);"page"==b&&e==d.sel.primary()&&Kc(c,Ic(c,l,"div").top-h.top);return l},vc);if(f.length)for(var e=0;e<d.sel.ranges.length;e++)d.sel.ranges[e].goalColumn=f[e]}),findWordAt:function(a){var b=I(this.doc,a.line).text,c=a.ch,d=a.ch;if(b){var f=this.getHelper(a,
"wordChars");"before"!=a.sticky&&d!=b.length||!c?++d:--c;for(var g=b.charAt(c),g=y(g,f)?function(a){return y(a,f)}:/\s/.test(g)?function(a){return/\s/.test(a)}:function(a){return!/\s/.test(a)&&!y(a)};0<c&&g(b.charAt(c-1));)--c;for(;d<b.length&&g(b.charAt(d));)++d}return new ba(K(a.line,c),K(a.line,d))},toggleOverwrite:function(a){if(null==a||a!=this.state.overwrite)(this.state.overwrite=!this.state.overwrite)?w(this.display.cursorDiv,"CodeMirror-overwrite"):jb(this.display.cursorDiv,"CodeMirror-overwrite"),
fa(this,"overwriteToggle",this,this.state.overwrite)},hasFocus:function(){return this.display.input.getField()==p()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:va(function(a,b){ac(this,a,b)}),getScrollInfo:function(){var a=this.display.scroller;return{left:a.scrollLeft,top:a.scrollTop,height:a.scrollHeight-La(this)-this.display.barHeight,width:a.scrollWidth-La(this)-this.display.barWidth,clientHeight:pd(this),clientWidth:eb(this)}},scrollIntoView:va(function(a,
b){null==a?(a={from:this.doc.sel.primary().head,to:null},null==b&&(b=this.options.cursorScrollMargin)):"number"==typeof a?a={from:K(a,0),to:null}:null==a.from&&(a={from:a,to:null});a.to||(a.to=a.from);a.margin=b||0;null!=a.from.line?(Lc(this),this.curOp.scrollToPos=a):Je(this,a.from,a.to,a.margin)}),setSize:va(function(a,b){var c=this,d=function(a){return"number"==typeof a||/^\d+$/.test(String(a))?a+"px":a};null!=a&&(this.display.wrapper.style.width=d(a));null!=b&&(this.display.wrapper.style.height=
d(b));this.options.lineWrapping&&we(this);var f=this.display.viewFrom;this.doc.iter(f,this.display.viewTo,function(a){if(a.widgets)for(var b=0;b<a.widgets.length;b++)if(a.widgets[b].noHScroll){Xa(c,f,"widget");break}++f});this.curOp.forceUpdate=!0;fa(this,"refresh",this)}),operation:function(a){return za(this,a)},startOperation:function(){return lb(this)},endOperation:function(){return mb(this)},refresh:va(function(){var a=this.display.cachedTextHeight;xa(this);this.curOp.forceUpdate=!0;Yb(this);
ac(this,this.doc.scrollLeft,this.doc.scrollTop);zd(this);(null==a||.5<Math.abs(a-gb(this.display)))&&vd(this);fa(this,"refresh",this)}),swapDoc:va(function(a){var b=this.doc;b.cm=null;We(this,a);Yb(this);this.display.input.reset();ac(this,a.scrollLeft,a.scrollTop);this.curOp.forceScroll=!0;la(this,"swapDoc",this,b);return b}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},
getGutterElement:function(){return this.display.gutters}};ub(a);a.registerHelper=function(b,d,f){c.hasOwnProperty(b)||(c[b]=a[b]={_global:[]});c[b][d]=f};a.registerGlobalHelper=function(b,d,f,g){a.registerHelper(b,d,g);c[b]._global.push({pred:f,val:g})}})(ea);var bh="iter insert remove copy getEditor constructor".split(" "),zc;for(zc in ya.prototype)ya.prototype.hasOwnProperty(zc)&&0>d(bh,zc)&&(ea.prototype[zc]=function(a){return function(){return a.apply(this.doc,arguments)}}(ya.prototype[zc]));
ub(ya);ea.inputStyles={textarea:ha,contenteditable:ca};ea.defineMode=function(a){ea.defaults.mode||"null"==a||(ea.defaults.mode=a);ag.apply(this,arguments)};ea.defineMIME=function(a,b){vb[a]=b};ea.defineMode("null",function(){return{token:function(a){return a.skipToEnd()}}});ea.defineMIME("text/plain","null");ea.defineExtension=function(a,b){ea.prototype[a]=b};ea.defineDocExtension=function(a,b){ya.prototype[a]=b};ea.fromTextArea=function(a,b){function c(){a.value=l.getValue()}b=b?h(b):{};b.value=
a.value;!b.tabindex&&a.tabIndex&&(b.tabindex=a.tabIndex);!b.placeholder&&a.placeholder&&(b.placeholder=a.placeholder);if(null==b.autofocus){var d=p();b.autofocus=d==a||null!=a.getAttribute("autofocus")&&d==document.body}var f;if(a.form&&(R(a.form,"submit",c),!b.leaveSubmitMethodAlone)){var g=a.form;f=g.submit;try{var e=g.submit=function(){c();g.submit=f;g.submit();g.submit=e}}catch(Vd){}}b.finishInit=function(b){b.save=c;b.getTextArea=function(){return a};b.toTextArea=function(){b.toTextArea=isNaN;
c();a.parentNode.removeChild(b.getWrapperElement());a.style.display="";a.form&&(Ba(a.form,"submit",c),"function"==typeof a.form.submit&&(a.form.submit=f))}};a.style.display="none";var l=ea(function(b){return a.parentNode.insertBefore(b,a.nextSibling)},b);return l};(function(a){a.off=Ba;a.on=R;a.wheelEventPixels=sg;a.Doc=ya;a.splitLines=Td;a.countColumn=g;a.findColumn=f;a.isWordChar=E;a.Pass=Wc;a.signal=fa;a.Line=Bb;a.changeEnd=Ya;a.scrollbarModel=Ne;a.Pos=K;a.cmpPos=O;a.modes=hd;a.mimeModes=vb;a.resolveMode=
Dc;a.getMode=id;a.modeExtensions=wb;a.extendMode=bg;a.copyState=db;a.startState=ae;a.innerMode=jd;a.commands=mc;a.keyMap=lc;a.keyName=yf;a.isModifierKey=vf;a.lookupKey=Hb;a.normalizeKeyMap=Eg;a.StringStream=ga;a.SharedTextMarker=kc;a.TextMarker=Za;a.LineWidget=jc;a.e_preventDefault=ua;a.e_stopPropagation=Zd;a.e_stop=Sb;a.addClass=w;a.contains=l;a.rmClass=jb;a.keyNames=$a})(ea);ea.version="5.29.0";return ea})},function(n,e){},function(n,e){},function(n,e,b){b(17);b(209);b(210);var m=b(100),u=b(211),
r=b(212);b(213);var a=b(101),c=b(102);b.d(e,"d",function(){return m});b.d(e,"b",function(){return u});b.d(e,"c",function(){return r});b.d(e,"a",function(){return a});b.d(e,"e",function(){return c})},function(n,e,b){function m(a,b,e){var c=b[0],l=b[1],v=b[2],k=b[3],h=b[4],g=b[5],d=b[6],f=b[7];b=b[8];var q=e[0],m=e[1],r=e[2],n=e[3],u=e[4],z=e[5],E=e[6],y=e[7];e=e[8];a[0]=q*c+m*k+r*d;a[1]=q*l+m*h+r*f;a[2]=q*v+m*g+r*b;a[3]=n*c+u*k+z*d;a[4]=n*l+u*h+z*f;a[5]=n*v+u*g+z*b;a[6]=E*c+y*k+e*d;a[7]=E*l+y*h+e*
f;a[8]=E*v+y*g+e*b;return a}function u(a,b,e){a[0]=b[0]-e[0];a[1]=b[1]-e[1];a[2]=b[2]-e[2];a[3]=b[3]-e[3];a[4]=b[4]-e[4];a[5]=b[5]-e[5];a[6]=b[6]-e[6];a[7]=b[7]-e[7];a[8]=b[8]-e[8];return a}Object.defineProperty(e,"__esModule",{value:!0});e.create=function(){var a=new r.a(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};e.fromMat4=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[4];a[4]=b[5];a[5]=b[6];a[6]=b[8];a[7]=b[9];a[8]=b[10];return a};e.clone=function(a){var b=
new r.a(9);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};e.copy=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a};e.fromValues=function(a,b,e,p,m,v,k,h,g){var c=new r.a(9);c[0]=a;c[1]=b;c[2]=e;c[3]=p;c[4]=m;c[5]=v;c[6]=k;c[7]=h;c[8]=g;return c};e.set=function(a,b,e,p,m,v,k,h,g,d){a[0]=b;a[1]=e;a[2]=p;a[3]=m;a[4]=v;a[5]=k;a[6]=h;a[7]=g;a[8]=d;return a};e.identity=function(a){a[0]=1;
a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};e.transpose=function(a,b){if(a===b){var c=b[1],e=b[2],m=b[5];a[1]=b[3];a[2]=b[6];a[3]=c;a[5]=b[7];a[6]=e;a[7]=m}else a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a};e.invert=function(a,b){var c=b[0],e=b[1],m=b[2],v=b[3],k=b[4],h=b[5],g=b[6],d=b[7];b=b[8];var f=b*k-h*d,q=-b*v+h*g,x=d*v-k*g,r=c*f+e*q+m*x;if(!r)return null;r=1/r;a[0]=f*r;a[1]=(-b*e+m*d)*r;a[2]=(h*e-m*k)*r;a[3]=q*r;a[4]=
(b*c-m*g)*r;a[5]=(-h*c+m*v)*r;a[6]=x*r;a[7]=(-d*c+e*g)*r;a[8]=(k*c-e*v)*r;return a};e.adjoint=function(a,b){var c=b[0],e=b[1],m=b[2],v=b[3],k=b[4],h=b[5],g=b[6],d=b[7];b=b[8];a[0]=k*b-h*d;a[1]=m*d-e*b;a[2]=e*h-m*k;a[3]=h*g-v*b;a[4]=c*b-m*g;a[5]=m*v-c*h;a[6]=v*d-k*g;a[7]=e*g-c*d;a[8]=c*k-e*v;return a};e.determinant=function(a){var b=a[3],e=a[4],p=a[5],m=a[6],v=a[7],k=a[8];return a[0]*(k*e-p*v)+a[1]*(-k*b+p*m)+a[2]*(v*b-e*m)};e.multiply=m;e.translate=function(a,b,e){var c=b[0],l=b[1],v=b[2],k=b[3],
h=b[4],g=b[5],d=b[6],f=b[7];b=b[8];var q=e[0];e=e[1];a[0]=c;a[1]=l;a[2]=v;a[3]=k;a[4]=h;a[5]=g;a[6]=q*c+e*k+d;a[7]=q*l+e*h+f;a[8]=q*v+e*g+b;return a};e.rotate=function(a,b,e){var c=b[0],l=b[1],v=b[2],k=b[3],h=b[4],g=b[5],d=b[6],f=b[7];b=b[8];var q=Math.sin(e);e=Math.cos(e);a[0]=e*c+q*k;a[1]=e*l+q*h;a[2]=e*v+q*g;a[3]=e*k-q*c;a[4]=e*h-q*l;a[5]=e*g-q*v;a[6]=d;a[7]=f;a[8]=b;return a};e.scale=function(a,b,e){var c=e[0];e=e[1];a[0]=c*b[0];a[1]=c*b[1];a[2]=c*b[2];a[3]=e*b[3];a[4]=e*b[4];a[5]=e*b[5];a[6]=
b[6];a[7]=b[7];a[8]=b[8];return a};e.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=b[0];a[7]=b[1];a[8]=1;return a};e.fromRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=c;a[2]=0;a[3]=-c;a[4]=b;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};e.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=b[1];a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};e.fromMat2d=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=0;a[3]=b[2];a[4]=b[3];a[5]=0;a[6]=b[4];a[7]=b[5];a[8]=1;return a};
e.fromQuat=function(a,b){var c=b[0],e=b[1],m=b[2];b=b[3];var v=c+c,k=e+e,h=m+m,c=c*v,g=e*v,e=e*k,d=m*v,f=m*k,m=m*h,v=b*v,k=b*k;b*=h;a[0]=1-e-m;a[3]=g-b;a[6]=d+k;a[1]=g+b;a[4]=1-c-m;a[7]=f-v;a[2]=d-k;a[5]=f+v;a[8]=1-c-e;return a};e.normalFromMat4=function(a,b){var c=b[0],e=b[1],m=b[2],v=b[3],k=b[4],h=b[5],g=b[6],d=b[7],f=b[8],q=b[9],x=b[10],r=b[11],n=b[12],u=b[13],z=b[14];b=b[15];var E=c*h-e*k,y=c*g-m*k,H=c*d-v*k,G=e*g-m*h,J=e*d-v*h,D=m*d-v*g,S=f*u-q*n,I=f*z-x*n,f=f*b-r*n,P=q*z-x*u,q=q*b-r*u,x=x*b-
r*z,r=E*x-y*q+H*P+G*f-J*I+D*S;if(!r)return null;r=1/r;a[0]=(h*x-g*q+d*P)*r;a[1]=(g*f-k*x-d*I)*r;a[2]=(k*q-h*f+d*S)*r;a[3]=(m*q-e*x-v*P)*r;a[4]=(c*x-m*f+v*I)*r;a[5]=(e*f-c*q-v*S)*r;a[6]=(u*D-z*J+b*G)*r;a[7]=(z*H-n*D-b*y)*r;a[8]=(n*J-u*H+b*E)*r;return a};e.projection=function(a,b,e){a[0]=2/b;a[1]=0;a[2]=0;a[3]=0;a[4]=-2/e;a[5]=0;a[6]=-1;a[7]=1;a[8]=1;return a};e.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};e.frob=function(a){return Math.sqrt(Math.pow(a[0],
2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};e.add=function(a,b,e){a[0]=b[0]+e[0];a[1]=b[1]+e[1];a[2]=b[2]+e[2];a[3]=b[3]+e[3];a[4]=b[4]+e[4];a[5]=b[5]+e[5];a[6]=b[6]+e[6];a[7]=b[7]+e[7];a[8]=b[8]+e[8];return a};e.subtract=u;e.multiplyScalar=function(a,b,e){a[0]=b[0]*e;a[1]=b[1]*e;a[2]=b[2]*e;a[3]=b[3]*e;a[4]=b[4]*e;a[5]=b[5]*e;a[6]=b[6]*e;a[7]=b[7]*e;a[8]=b[8]*e;return a};e.multiplyScalarAndAdd=function(a,
b,e,p){a[0]=b[0]+e[0]*p;a[1]=b[1]+e[1]*p;a[2]=b[2]+e[2]*p;a[3]=b[3]+e[3]*p;a[4]=b[4]+e[4]*p;a[5]=b[5]+e[5]*p;a[6]=b[6]+e[6]*p;a[7]=b[7]+e[7]*p;a[8]=b[8]+e[8]*p;return a};e.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]};e.equals=function(a,b){var c=a[0],e=a[1],m=a[2],v=a[3],k=a[4],h=a[5],g=a[6],d=a[7];a=a[8];var f=b[0],q=b[1],x=b[2],n=b[3],u=b[4],B=b[5],z=b[6],E=b[7];b=b[8];return Math.abs(c-f)<=
r.c*Math.max(1,Math.abs(c),Math.abs(f))&&Math.abs(e-q)<=r.c*Math.max(1,Math.abs(e),Math.abs(q))&&Math.abs(m-x)<=r.c*Math.max(1,Math.abs(m),Math.abs(x))&&Math.abs(v-n)<=r.c*Math.max(1,Math.abs(v),Math.abs(n))&&Math.abs(k-u)<=r.c*Math.max(1,Math.abs(k),Math.abs(u))&&Math.abs(h-B)<=r.c*Math.max(1,Math.abs(h),Math.abs(B))&&Math.abs(g-z)<=r.c*Math.max(1,Math.abs(g),Math.abs(z))&&Math.abs(d-E)<=r.c*Math.max(1,Math.abs(d),Math.abs(E))&&Math.abs(a-b)<=r.c*Math.max(1,Math.abs(a),Math.abs(b))};var r=b(17);
e.mul=m;e.sub=u},function(n,e,b){function m(){var a=new g.a(3);a[0]=0;a[1]=0;a[2]=0;return a}function u(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)}function r(a,b,c){var d=new g.a(3);d[0]=a;d[1]=b;d[2]=c;return d}function a(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];return a}function c(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];a[2]=b[2]*c[2];return a}function l(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];a[2]=b[2]/c[2];return a}function p(a,b){var c=b[0]-a[0],d=b[1]-a[1];a=b[2]-a[2];return Math.sqrt(c*
c+d*d+a*a)}function w(a,b){var c=b[0]-a[0],d=b[1]-a[1];a=b[2]-a[2];return c*c+d*d+a*a}function v(a){var b=a[0],c=a[1];a=a[2];return b*b+c*c+a*a}function k(a,b){var c=b[0],d=b[1],f=b[2],c=c*c+d*d+f*f;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c);return a}function h(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}Object.defineProperty(e,"__esModule",{value:!0});e.create=m;e.clone=function(a){var b=new g.a(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};e.length=u;e.fromValues=r;e.copy=function(a,
b){a[0]=b[0];a[1]=b[1];a[2]=b[2];return a};e.set=function(a,b,c,g){a[0]=b;a[1]=c;a[2]=g;return a};e.add=function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];return a};e.subtract=a;e.multiply=c;e.divide=l;e.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);a[2]=Math.ceil(b[2]);return a};e.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);a[2]=Math.floor(b[2]);return a};e.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);a[2]=Math.min(b[2],c[2]);
return a};e.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);a[2]=Math.max(b[2],c[2]);return a};e.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);a[2]=Math.round(b[2]);return a};e.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;return a};e.scaleAndAdd=function(a,b,c,g){a[0]=b[0]+c[0]*g;a[1]=b[1]+c[1]*g;a[2]=b[2]+c[2]*g;return a};e.distance=p;e.squaredDistance=w;e.squaredLength=v;e.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];return a};e.inverse=
function(a,b){a[0]=1/b[0];a[1]=1/b[1];a[2]=1/b[2];return a};e.normalize=k;e.dot=h;e.cross=function(a,b,c){var d=b[0],f=b[1];b=b[2];var g=c[0],e=c[1];c=c[2];a[0]=f*c-b*e;a[1]=b*g-d*c;a[2]=d*e-f*g;return a};e.lerp=function(a,b,c,g){var d=b[0],f=b[1];b=b[2];a[0]=d+g*(c[0]-d);a[1]=f+g*(c[1]-f);a[2]=b+g*(c[2]-b);return a};e.hermite=function(a,b,c,g,e,h){var d=h*h,f=d*(2*h-3)+1,k=d*(h-2)+h,l=d*(h-1);h=d*(3-2*h);a[0]=b[0]*f+c[0]*k+g[0]*l+e[0]*h;a[1]=b[1]*f+c[1]*k+g[1]*l+e[1]*h;a[2]=b[2]*f+c[2]*k+g[2]*l+
e[2]*h;return a};e.bezier=function(a,b,c,g,e,h){var d=1-h,f=d*d,k=h*h,l=f*d,f=3*h*f,d=3*k*d;h*=k;a[0]=b[0]*l+c[0]*f+g[0]*d+e[0]*h;a[1]=b[1]*l+c[1]*f+g[1]*d+e[1]*h;a[2]=b[2]*l+c[2]*f+g[2]*d+e[2]*h;return a};e.random=function(a,b){b=b||1;var c=2*g.b()*Math.PI,d=2*g.b()-1,f=Math.sqrt(1-d*d)*b;a[0]=Math.cos(c)*f;a[1]=Math.sin(c)*f;a[2]=d*b;return a};e.transformMat4=function(a,b,c){var d=b[0],f=b[1];b=b[2];var g=c[3]*d+c[7]*f+c[11]*b+c[15],g=g||1;a[0]=(c[0]*d+c[4]*f+c[8]*b+c[12])/g;a[1]=(c[1]*d+c[5]*f+
c[9]*b+c[13])/g;a[2]=(c[2]*d+c[6]*f+c[10]*b+c[14])/g;return a};e.transformMat3=function(a,b,c){var d=b[0],f=b[1];b=b[2];a[0]=d*c[0]+f*c[3]+b*c[6];a[1]=d*c[1]+f*c[4]+b*c[7];a[2]=d*c[2]+f*c[5]+b*c[8];return a};e.transformQuat=function(a,b,c){var d=b[0],f=b[1],g=b[2];b=c[0];var e=c[1],h=c[2];c=c[3];var k=c*d+e*g-h*f,l=c*f+h*d-b*g,q=c*g+b*f-e*d,d=-b*d-e*f-h*g;a[0]=k*c+d*-b+l*-h-q*-e;a[1]=l*c+d*-e+q*-b-k*-h;a[2]=q*c+d*-h+k*-e-l*-b;return a};e.rotateX=function(a,b,c,g){var d=[],f=[];d[0]=b[0]-c[0];d[1]=
b[1]-c[1];d[2]=b[2]-c[2];f[0]=d[0];f[1]=d[1]*Math.cos(g)-d[2]*Math.sin(g);f[2]=d[1]*Math.sin(g)+d[2]*Math.cos(g);a[0]=f[0]+c[0];a[1]=f[1]+c[1];a[2]=f[2]+c[2];return a};e.rotateY=function(a,b,c,g){var d=[],f=[];d[0]=b[0]-c[0];d[1]=b[1]-c[1];d[2]=b[2]-c[2];f[0]=d[2]*Math.sin(g)+d[0]*Math.cos(g);f[1]=d[1];f[2]=d[2]*Math.cos(g)-d[0]*Math.sin(g);a[0]=f[0]+c[0];a[1]=f[1]+c[1];a[2]=f[2]+c[2];return a};e.rotateZ=function(a,b,c,g){var d=[],f=[];d[0]=b[0]-c[0];d[1]=b[1]-c[1];d[2]=b[2]-c[2];f[0]=d[0]*Math.cos(g)-
d[1]*Math.sin(g);f[1]=d[0]*Math.sin(g)+d[1]*Math.cos(g);f[2]=d[2];a[0]=f[0]+c[0];a[1]=f[1]+c[1];a[2]=f[2]+c[2];return a};e.angle=function(a,b){a=r(a[0],a[1],a[2]);b=r(b[0],b[1],b[2]);k(a,a);k(b,b);b=h(a,b);return 1<b?0:-1>b?Math.PI:Math.acos(b)};e.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"};e.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]};e.equals=function(a,b){var c=a[0],d=a[1];a=a[2];var f=b[0],e=b[1];b=b[2];return Math.abs(c-f)<=g.c*Math.max(1,Math.abs(c),
Math.abs(f))&&Math.abs(d-e)<=g.c*Math.max(1,Math.abs(d),Math.abs(e))&&Math.abs(a-b)<=g.c*Math.max(1,Math.abs(a),Math.abs(b))};var g=b(17);e.sub=a;e.mul=c;e.div=l;e.dist=p;e.sqrDist=w;e.len=u;e.sqrLen=v;n=function(){var a=m();return function(b,c,d,g,e,h){c||(c=3);d||(d=0);for(g=g?Math.min(g*c+d,b.length):b.length;d<g;d+=c)a[0]=b[d],a[1]=b[d+1],a[2]=b[d+2],e(a,a,h),b[d]=a[0],b[d+1]=a[1],b[d+2]=a[2];return b}}();e.forEach=n},function(n,e,b){function m(){var a=new h.a(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a}
function u(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];return a}function r(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];a[2]=b[2]*c[2];a[3]=b[3]*c[3];return a}function a(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];a[2]=b[2]/c[2];a[3]=b[3]/c[3];return a}function c(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;return a}function l(a,b){var c=b[0]-a[0],d=b[1]-a[1],g=b[2]-a[2];a=b[3]-a[3];return Math.sqrt(c*c+d*d+g*g+a*a)}function p(a,b){var c=b[0]-a[0],d=b[1]-a[1],g=b[2]-a[2];a=b[3]-
a[3];return c*c+d*d+g*g+a*a}function w(a){var b=a[0],c=a[1],g=a[2];a=a[3];return Math.sqrt(b*b+c*c+g*g+a*a)}function v(a){var b=a[0],c=a[1],g=a[2];a=a[3];return b*b+c*c+g*g+a*a}function k(a,b){var c=b[0],d=b[1],g=b[2];b=b[3];var e=c*c+d*d+g*g+b*b;0<e&&(e=1/Math.sqrt(e),a[0]=c*e,a[1]=d*e,a[2]=g*e,a[3]=b*e);return a}Object.defineProperty(e,"__esModule",{value:!0});e.create=m;e.clone=function(a){var b=new h.a(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};e.fromValues=function(a,b,c,e){var d=new h.a(4);
d[0]=a;d[1]=b;d[2]=c;d[3]=e;return d};e.copy=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a};e.set=function(a,b,c,e,h){a[0]=b;a[1]=c;a[2]=e;a[3]=h;return a};e.add=function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];return a};e.subtract=u;e.multiply=r;e.divide=a;e.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);a[2]=Math.ceil(b[2]);a[3]=Math.ceil(b[3]);return a};e.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);a[2]=Math.floor(b[2]);
a[3]=Math.floor(b[3]);return a};e.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);a[2]=Math.min(b[2],c[2]);a[3]=Math.min(b[3],c[3]);return a};e.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);a[2]=Math.max(b[2],c[2]);a[3]=Math.max(b[3],c[3]);return a};e.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);a[2]=Math.round(b[2]);a[3]=Math.round(b[3]);return a};e.scale=c;e.scaleAndAdd=function(a,b,c,e){a[0]=b[0]+c[0]*e;a[1]=b[1]+c[1]*e;a[2]=b[2]+
c[2]*e;a[3]=b[3]+c[3]*e;return a};e.distance=l;e.squaredDistance=p;e.length=w;e.squaredLength=v;e.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=-b[3];return a};e.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];a[2]=1/b[2];a[3]=1/b[3];return a};e.normalize=k;e.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};e.lerp=function(a,b,c,e){var d=b[0],f=b[1],g=b[2];b=b[3];a[0]=d+e*(c[0]-d);a[1]=f+e*(c[1]-f);a[2]=g+e*(c[2]-g);a[3]=b+e*(c[3]-b);return a};e.random=function(a,b){b=
b||1;a[0]=h.b();a[1]=h.b();a[2]=h.b();a[3]=h.b();k(a,a);c(a,a,b);return a};e.transformMat4=function(a,b,c){var d=b[0],f=b[1],e=b[2];b=b[3];a[0]=c[0]*d+c[4]*f+c[8]*e+c[12]*b;a[1]=c[1]*d+c[5]*f+c[9]*e+c[13]*b;a[2]=c[2]*d+c[6]*f+c[10]*e+c[14]*b;a[3]=c[3]*d+c[7]*f+c[11]*e+c[15]*b;return a};e.transformQuat=function(a,b,c){var d=b[0],f=b[1],e=b[2],g=c[0],h=c[1],k=c[2];c=c[3];var l=c*d+h*e-k*f,p=c*f+k*d-g*e,v=c*e+g*f-h*d,d=-g*d-h*f-k*e;a[0]=l*c+d*-g+p*-k-v*-h;a[1]=p*c+d*-h+v*-g-l*-k;a[2]=v*c+d*-k+l*-h-p*
-g;a[3]=b[3];return a};e.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};e.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]};e.equals=function(a,b){var c=a[0],d=a[1],e=a[2];a=a[3];var g=b[0],k=b[1],l=b[2];b=b[3];return Math.abs(c-g)<=h.c*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(d-k)<=h.c*Math.max(1,Math.abs(d),Math.abs(k))&&Math.abs(e-l)<=h.c*Math.max(1,Math.abs(e),Math.abs(l))&&Math.abs(a-b)<=h.c*Math.max(1,Math.abs(a),Math.abs(b))};var h=
b(17);e.sub=u;e.mul=r;e.div=a;e.dist=l;e.sqrDist=p;e.len=w;e.sqrLen=v;n=function(){var a=m();return function(b,c,e,g,h,k){c||(c=4);e||(e=0);for(g=g?Math.min(g*c+e,b.length):b.length;e<g;e+=c)a[0]=b[e],a[1]=b[e+1],a[2]=b[e+2],a[3]=b[e+3],h(a,a,k),b[e]=a[0],b[e+1]=a[1],b[e+2]=a[2],b[e+3]=a[3];return b}}();e.forEach=n},function(n,e,b){e=b(104).Symbol;n.exports=e},function(n,e,b){e=b(216);b="object"==typeof self&&self&&self.Object===Object&&self;e=e||b||Function("return this")();n.exports=e},function(n,
e,b){Object.defineProperty(e,"__esModule",{value:!0});var m=b(156);window.addEventListener("DOMContentLoaded",function(){b.i(m.a)()})},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(e,"__esModule",{value:!0});b.d(e,"AnnotationPointListUserLayer",function(){return h});var a=b(121),c=b(122);n=b(10);e=b(12);var l=b(7),p=b(1),w=b(180),v=function f(a,b,c){null===a&&(a=Function.prototype);var e=Object.getOwnPropertyDescriptor(a,b);if(void 0===e){if(a=Object.getPrototypeOf(a),null!==
a)return f(a,b,c)}else{if("value"in e)return e.value;b=e.get;return void 0===b?void 0:b.call(c)}},k=function(){function a(a,b){for(var c=0;c<b.length;c++){var f=b[c];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(a,f.key,f)}}return function(b,c,f){c&&a(b.prototype,c);f&&a(b,f);return b}}();b(188);var h=function(b){function f(b,e){m(this,f);var g=u(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,[]));g.manager=b;g.selectedIndex=new l.a(null);
g.layer=new a.a(g.manager.chunkManager,new c.a,g.manager.voxelSize,g.selectedIndex);g.layer.pointList.restoreState(e.points);g.registerDisposer(g.layer.pointList.changed.add(function(){g.specificationChanged.dispatch()}));g.addRenderLayer(new a.b(g.layer));g.addRenderLayer(new a.c(g.layer));var h=b.layerSelectedValues;g.registerDisposer(h.changed.add(function(){var a=h.get(g);g.selectedIndex.value="number"===typeof a?a:null}));return g}r(f,b);k(f,[{key:"toJSON",value:function(){var a={type:"pointAnnotation"};
a.points=this.layer.pointList.toJSON();return a}},{key:"handleAction",value:function(a){switch(a){case "annotate":a=this.manager.layerSelectedValues.get(this),void 0!==a?this.layer.pointList.delete(a):this.manager.layerSelectedValues.mouseState.active&&this.layer.pointList.append(this.manager.voxelSize.voxelFromSpatial(p.a.create(),this.manager.layerSelectedValues.mouseState.position))}}},{key:"makeDropdown",value:function(a){return new g(a,this)}}]);return f}(n.h),g=function(a){function b(a,c){m(this,
b);var f=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));f.element=a;f.layer=c;f.pointListWidget=f.registerDisposer(new w.a(f.layer.layer.pointList,f.layer.selectedIndex));a.classList.add("neuroglancer-annotation-point-list-dropdown");a.appendChild(f.pointListWidget.element);f.registerDisposer(f.pointListWidget.pointSelected.add(function(a){f.layer.manager.setVoxelCoordinates(f.layer.layer.pointList.get(a))}));return f}r(b,a);k(b,[{key:"onShow",value:function(){v(b.prototype.__proto__||
Object.getPrototypeOf(b.prototype),"onShow",this).call(this);this.pointListWidget.visible=!0}},{key:"onHide",value:function(){v(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"onHide",this).call(this);this.pointListWidget.visible=!1}}]);return b}(n.i);b.i(e.c)("pointAnnotation",h)},function(n,e,b){Object.defineProperty(e,"__esModule",{value:!0});n=b(68);e=b(42);var m=b(127);n.a.register(e.a,function(){return new m.a})},function(n,e,b){Object.defineProperty(e,"__esModule",{value:!0});var m=
b(61),u=b(42);n=b(19);b.i(n.b)("brainmaps",function(b){return new m.BrainmapsDataSource(m.productionInstance,b.credentialsManager.getCredentialsProvider(u.a))})},function(n,e){},function(n,e,b){Object.defineProperty(e,"__esModule",{value:!0});var m=b(62);n=b(19);b.i(n.b)("dvid",function(){return new m.DVIDDataSource})},function(n,e,b){Object.defineProperty(e,"__esModule",{value:!0});var m=b(38);n=b(19);b.i(n.b)("ndstore",function(){return new m.NDStoreDataSource})},function(n,e,b){Object.defineProperty(e,
"__esModule",{value:!0});var m=b(63);n=b(19);b.i(n.b)("nifti",function(){return new m.NiftiDataSource})},function(n,e,b){Object.defineProperty(e,"__esModule",{value:!0});var m=b(64);n=b(19);b.i(n.b)("openconnectome",function(){return new m.OpenConnectomeDataSource})},function(n,e,b){Object.defineProperty(e,"__esModule",{value:!0});var m=b(65);n=b(19);b.i(n.b)("precomputed",function(){return new m.PrecomputedDataSource})},function(n,e,b){Object.defineProperty(e,"__esModule",{value:!0});n=b(19);var m=
b(66);b.i(n.b)("render",function(){return new m.RenderDataSource})},function(n,e){},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=
Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function a(a){return new d.a({shaderError:a.shaderError,fragmentMain:a.fragmentMain,fragmentMainStartLine:w.c})}Object.defineProperty(e,"__esModule",{value:!0});b.d(e,"ImageUserLayer",function(){return q});var c=b(41);n=b(10);var l=b(12);e=b(27);var p=b(4),w=b(151),v=b(32),k=b(1),h=b(29),g=b(56),d=b(57),f=function(){function a(a,b){for(var c=
0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}();b(97);b(58);b(98);var q=function(a){function d(a,f){m(this,d);var e=u(this,(d.__proto__||Object.getPrototypeOf(d)).call(this));e.opacity=b.i(v.a)(.5);e.fragmentMain=b.i(w.a)();e.shaderError=b.i(h.a)();e.transform=new c.a;var g=f.source;if("string"!==typeof g)throw Error("Invalid image layer specification");
e.opacity.restoreState(f.opacity);e.fragmentMain.restoreState(f.shader);e.transform.restoreState(f.transform);e.registerDisposer(e.fragmentMain.changed.add(function(){e.specificationChanged.dispatch()}));e.volumePath=g;b.i(l.d)(a.dataSourceProvider,a.chunkManager,g).then(function(a){e.wasDisposed||(a=e.renderLayer=new w.b(a,{opacity:e.opacity,fragmentMain:e.fragmentMain,shaderError:e.shaderError,sourceOptions:{transform:k.c.clone(e.transform.transform)}}),e.addRenderLayer(a),e.shaderError.changed.dispatch())});
return e}r(d,a);f(d,[{key:"toJSON",value:function(){var a={type:"image"};a.source=this.volumePath;a.opacity=this.opacity.toJSON();a.shader=this.fragmentMain.toJSON();a.transform=this.transform.toJSON();return a}},{key:"makeDropdown",value:function(a){return new x(a,this)}}]);return d}(n.h),x=function(b){function c(b,d){m(this,c);var f=u(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));f.element=b;f.layer=d;f.opacityWidget=f.registerDisposer(new g.a(f.layer.opacity));f.codeWidget=f.registerDisposer(a(f.layer));
b.classList.add("image-dropdown");var e=f.opacityWidget;d=document.createElement("div");d.className="image-dropdown-top-row";e.promptElement.textContent="Opacity";e=document.createElement("div");e.style.flex="1";var h=document.createElement("a"),k=document.createElement("button");k.type="button";k.textContent="?";k.className="help-link";h.appendChild(k);h.title="Documentation on image layer rendering";h.target="_blank";h.href="https://github.com/google/neuroglancer/blob/master/src/neuroglancer/sliceview/image_layer_rendering.md";
k=document.createElement("button");k.innerHTML="&square;";k.className="maximize-button";k.title="Show larger editor view";f.registerEventListener(k,"click",function(){new F(f.layer)});d.appendChild(f.opacityWidget.element);d.appendChild(e);d.appendChild(k);d.appendChild(h);b.appendChild(d);b.appendChild(f.codeWidget.element);f.codeWidget.textEditor.refresh();return f}r(c,b);f(c,[{key:"onShow",value:function(){this.codeWidget.textEditor.refresh()}}]);return c}(n.i),F=function(b){function c(b){m(this,
c);var d=u(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));d.layer=b;d.codeWidget=d.registerDisposer(a(d.layer));d.content.classList.add("image-layer-shader-overlay");d.content.appendChild(d.codeWidget.element);d.codeWidget.textEditor.refresh();return d}r(c,b);return c}(e.b);b.i(l.c)("image",q);b.i(l.g)(p.a.IMAGE,q)},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function a(a){return new H.a({fragmentMain:a.displayState.fragmentMain,shaderError:a.displayState.shaderError,fragmentMainStartLine:g.e})}
Object.defineProperty(e,"__esModule",{value:!0});b.d(e,"SegmentationUserLayer",function(){return P});var c=b(41);n=b(10);var l=b(12),p=b(45);e=b(27);var w=b(133),v=b(78),k=b(39),h=b(140),g=b(80),d=b(4),f=b(152),q=b(32),x=b(33),F=b(159),C=b(2),B=b(11),z=b(29),E=b(56),y=b(182),H=b(57),G=b(183),J=b(79),D=b(226);b.n(D);var S=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,
c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}(),I=function Q(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),null!==a)return Q(a,b,c)}else{if("value"in d)return d.value;b=d.get;return void 0===b?void 0:b.call(c)}};b(21);b(195);var P=function(a){function e(a,p){m(this,e);var r=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,[]));r.manager=a;r.displayState={segmentColorHash:v.a.getDefault(),segmentSelectionState:new k.a,
selectedAlpha:b.i(q.a)(.5),notSelectedAlpha:b.i(q.a)(0),objectAlpha:b.i(q.a)(1),clipBounds:J.a.make(r.manager.worker,void 0),hideSegmentZero:new x.a(!0,!0),visibleSegments:F.a.makeWithCounterpart(r.manager.worker),segmentEquivalences:h.a.makeWithCounterpart(r.manager.worker),volumeSourceOptions:{},objectToDataTransform:new c.a,fragmentMain:b.i(g.a)(),shaderError:b.i(z.a)()};r.editorSocket=new D.EditorSocket(r);r.editorSource=b.i(w.a)();r.displayState.visibleSegments.changed.add(function(){r.specificationChanged.dispatch()});
r.displayState.segmentEquivalences.changed.add(function(){r.specificationChanged.dispatch()});r.displayState.segmentSelectionState.bindTo(a.layerSelectedValues,r);r.displayState.selectedAlpha.changed.add(function(){r.specificationChanged.dispatch()});r.displayState.notSelectedAlpha.changed.add(function(){r.specificationChanged.dispatch()});r.displayState.objectAlpha.changed.add(function(){r.specificationChanged.dispatch()});r.displayState.hideSegmentZero.changed.add(function(){r.specificationChanged.dispatch()});
r.displayState.fragmentMain.changed.add(function(){r.specificationChanged.dispatch()});r.displayState.selectedAlpha.restoreState(p.selectedAlpha);r.displayState.notSelectedAlpha.restoreState(p.notSelectedAlpha);r.displayState.objectAlpha.restoreState(p.objectAlpha);r.displayState.hideSegmentZero.restoreState(p.hideSegmentZero);r.displayState.objectToDataTransform.restoreState(p.transform);r.displayState.volumeSourceOptions.transform=r.displayState.objectToDataTransform.transform;r.displayState.fragmentMain.restoreState(p.skeletonShader);
var n=r.volumePath=b.i(C.e)(p.source),y=r.meshPath=null===p.mesh?null:b.i(C.e)(p.mesh),E=r.skeletonsPath=b.i(C.e)(p.skeletons);void 0!==n&&b.i(l.d)(a.dataSourceProvider,a.chunkManager,n,{volumeType:d.a.SEGMENTATION}).then(function(a){if(!r.wasDisposed&&(r.addRenderLayer(new f.a(a,r.displayState)),void 0===y)){var c=a.getMeshSource();null!=c&&r.addMesh(c)}r.editorSource=b.i(w.a)(a);new Promise(function(a,b){r.editorSocket.open(a,b)})});null!=y&&r.manager.dataSourceProvider.getMeshSource(a.chunkManager,
y).then(function(a){r.wasDisposed||r.addMesh(a)});void 0!==E&&r.manager.dataSourceProvider.getSkeletonSource(a.chunkManager,E).then(function(b){r.wasDisposed||(b=new g.b(a.chunkManager,b,a.voxelSize,r.displayState),r.addRenderLayer(new g.c(b.addRef())),r.addRenderLayer(new g.d(b)))});b.i(C.d)(p,"equivalences",function(a){r.displayState.segmentEquivalences.restoreState(a)});b.i(C.d)(p,"segments",function(a){if(void 0!==a){var c=r.displayState,d=c.visibleSegments,f=c.segmentEquivalences;b.i(C.k)(a,
function(a){a=B.a.parseString(String(a),10);d.add(f.get(a))})}});b.i(C.d)(p,"clipBounds",function(a){if(void 0!==a){var c,d;b.i(C.d)(a,"center",function(a){return c=b.i(C.l)(a)});b.i(C.d)(a,"size",function(a){return d=b.i(C.l)(a)});c&&d&&(r.displayState.clipBounds.value={center:c,size:d})}});return r}r(e,a);S(e,[{key:"addMesh",value:function(a){this.meshLayer=new p.a(this.manager.chunkManager,a,this.displayState);this.addRenderLayer(this.meshLayer)}},{key:"disposed",value:function(){this.editorSocket.close();
I(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disposed",this).call(this)}},{key:"toJSON",value:function(){var a={type:"segmentation"};a.source=this.volumePath;a.mesh=this.meshPath;a.skeletons=this.skeletonsPath;a.selectedAlpha=this.displayState.selectedAlpha.toJSON();a.notSelectedAlpha=this.displayState.notSelectedAlpha.toJSON();a.objectAlpha=this.displayState.objectAlpha.toJSON();a.hideSegmentZero=this.displayState.hideSegmentZero.toJSON();var b=this.displayState.visibleSegments;0<
b.size&&(a.segments=b.toJSON());b=this.displayState.segmentEquivalences;0<b.size&&(a.equivalences=b.toJSON());b=this.displayState.clipBounds;b.value&&(a.clipBounds={center:b.value.center,size:b.value.size});a.transform=this.displayState.objectToDataTransform.toJSON();a.skeletonShader=this.displayState.fragmentMain.toJSON();return a}},{key:"transformPickedValue",value:function(a){if(null==a)return a;var b=this.displayState.segmentEquivalences;if(0===b.size)return a;"number"===typeof a&&(a=new B.a(a,
0));b=b.get(a);return B.a.equal(b,a)?a:new k.b(a,b)}},{key:"makeDropdown",value:function(a){return new U(a,this)}},{key:"mergeOne",value:function(a,b){this.displayState.segmentEquivalences.link(a,b)}},{key:"currentMerges",value:function(){return this.displayState.segmentEquivalences.toJSON()}},{key:"restoreSaved",value:function(a){void 0!==a&&this.displayState.segmentEquivalences.restoreSaved(a)}},{key:"handleMessage",value:function(a){a=JSON.parse(a);switch(a.action){case "restore":this.restoreSaved(a.merge);
break;case "save":b.i(l.e)(this,"Successfully saved"),this.restoreSaved(a.merge)}}},{key:"handleMergeAction",value:function(a,b){var c=this.displayState.segmentSelectionState,d=c.hasSelectedSegment;switch(a){case "select":if(d){a=c.selectedSegment;if(void 0===b.segment){b.segment=a.clone();break}b.segment=void 0;break}case "edit":d&&b.segment&&this.mergeOne(b.segment,c.selectedSegment);break;default:this.handleAction(a)}}},{key:"handleEditorAction",value:function(a,b){switch(b.editor.value){case 1:this.handleMergeAction(a,
b);break;default:this.handleAction(a)}}},{key:"handleAction",value:function(a){switch(a){case "recolor":this.displayState.segmentColorHash.randomize();break;case "clear-segments":this.displayState.visibleSegments.clear();break;case "save":a=this.currentMerges(),a=JSON.stringify({action:"save",merge:a}),b.i(l.f)(this,a);case "select":if(a=this.displayState.segmentSelectionState,a.hasSelectedSegment){a=a.selectedSegment;var c=this.displayState.visibleSegments;c.has(a)?c.delete(a):c.add(a)}}}}]);return e}(n.h),
U=function(b){function c(b,d){m(this,c);var f=u(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));f.element=b;f.layer=d;f.visibleSegmentWidget=f.registerDisposer(new y.a(f.layer.displayState));f.addSegmentWidget=f.registerDisposer(new G.a);f.selectedAlphaWidget=f.registerDisposer(new E.a(f.layer.displayState.selectedAlpha));f.notSelectedAlphaWidget=f.registerDisposer(new E.a(f.layer.displayState.notSelectedAlpha));f.objectAlphaWidget=f.registerDisposer(new E.a(f.layer.displayState.objectAlpha));
b.classList.add("segmentation-dropdown");var e=f.notSelectedAlphaWidget,g=f.objectAlphaWidget;f.selectedAlphaWidget.promptElement.textContent="Opacity (on)";e.promptElement.textContent="Opacity (off)";g.promptElement.textContent="Opacity (3d)";b.appendChild(f.selectedAlphaWidget.element);b.appendChild(f.notSelectedAlphaWidget.element);b.appendChild(f.objectAlphaWidget.element);d=f.registerDisposer(new x.b(d.displayState.hideSegmentZero));d.element.className="neuroglancer-segmentation-dropdown-hide-segment-zero neuroglancer-noselect";
e=document.createElement("label");e.className="neuroglancer-segmentation-dropdown-hide-segment-zero neuroglancer-noselect";e.appendChild(document.createTextNode("Hide segment ID 0"));e.appendChild(d.element);b.appendChild(e);f.addSegmentWidget.element.classList.add("add-segment");f.addSegmentWidget.element.title="Add segment ID";b.appendChild(f.registerDisposer(f.addSegmentWidget).element);f.registerDisposer(f.addSegmentWidget.valueEntered.add(function(a){f.layer.displayState.visibleSegments.add(a)}));
b.appendChild(f.registerDisposer(f.visibleSegmentWidget).element);if(void 0!==f.layer.skeletonsPath){d=document.createElement("div");d.className="neuroglancer-segmentation-dropdown-skeleton-shader-header";e=document.createElement("div");e.style.flex="1";e.textContent="Skeleton shader:";var g=document.createElement("a"),h=document.createElement("button");h.type="button";h.textContent="?";h.className="help-link";g.appendChild(h);g.title="Documentation on skeleton rendering";g.target="_blank";g.href=
"https://github.com/google/neuroglancer/blob/master/src/neuroglancer/sliceview/image_layer_rendering.md";h=document.createElement("button");h.innerHTML="&square;";h.className="maximize-button";h.title="Show larger editor view";f.registerEventListener(h,"click",function(){new V(f.layer)});d.appendChild(e);d.appendChild(h);d.appendChild(g);b.appendChild(d);d=f.codeWidget=f.registerDisposer(a(f.layer));b.appendChild(d.element);d.textEditor.refresh()}return f}r(c,b);S(c,[{key:"onShow",value:function(){void 0!==
this.codeWidget&&this.codeWidget.textEditor.refresh()}}]);return c}(n.i),V=function(b){function c(b){m(this,c);var d=u(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));d.layer=b;d.codeWidget=d.registerDisposer(a(d.layer));d.content.classList.add("neuroglancer-segmentation-layer-skeleton-shader-overlay");d.content.appendChild(d.codeWidget.element);d.codeWidget.textEditor.refresh();return d}r(c,b);return c}(e.b);b.i(l.c)("segmentation",P);b.i(l.g)(d.a.SEGMENTATION,P)},function(n,e,b){function m(a,
b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?
Object.setPrototypeOf(a,b):a.__proto__=b)}function a(a){return a.split(/[^a-zA-Z0-9]+/).filter(function(a){return a}).join("_")}function c(b){var c=new Set,d=[];b=$jscomp.makeIterator(b);for(var f=b.next();!f.done;f=b.next()){for(var f=a(f.value),e="",g=0;c.has(f+e);)e=""+ ++g;d.push(f+e)}return d}function l(a){return new f.a({fragmentMain:a.displayState.fragmentMain,shaderError:a.displayState.shaderError,fragmentMainStartLine:k.d})}function p(a){return new F(a.displayState.attributeNames,function(){return a.meshSource&&
a.meshSource.info.vertexAttributes})}Object.defineProperty(e,"__esModule",{value:!0});b.d(e,"SingleMeshUserLayer",function(){return x});n=b(22);var w=b.n(n);n=b(10);e=b(12);var v=b(27),k=b(142),h=b(0),g=b(8),d=b(2),f=b(57),q=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}();b(196);var x=function(a){function f(a,
e){m(this,f);var g=u(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,[]));g.manager=a;g.displayState=new k.a;g.parameters={meshSourceUrl:b.i(d.d)(e,"source",d.h),attributeSourceUrls:b.i(d.d)(e,"vertexAttributeSources",function(a){return void 0!==a?b.i(d.k)(a,d.h):[]})};g.displayState.objectToDataTransform.restoreState(e.transform);g.displayState.fragmentMain.restoreState(e.shader);g.userSpecifiedAttributeNames=b.i(d.d)(e,"vertexAttributeNames",function(a){if(void 0!==a)return b.i(d.k)(a,function(a){if(a=
b.i(d.e)(a))return a})});b.i(k.b)(a.chunkManager,g.parameters).then(function(a){if(!g.wasDisposed){g.meshSource=a;var b=g.defaultAttributeNames=c(a.info.vertexAttributes.map(function(a){return a.name})),d=g.userSpecifiedAttributeNames;void 0!==d&&d.length===b.length?(b=d,g.userSpecifiedAttributeNames=void 0):b=Array.from(b);g.displayState.attributeNames.value=b;g.addRenderLayer(new k.c(a,g.displayState))}});g.registerDisposer(g.displayState.fragmentMain.changed.add(function(){g.specificationChanged.dispatch()}));
g.registerDisposer(g.displayState.attributeNames.changed.add(function(){g.specificationChanged.dispatch()}));return g}r(f,a);q(f,[{key:"toJSON",value:function(){var a={type:"mesh"},b=this.parameters.attributeSourceUrls;a.source=this.parameters.meshSourceUrl;b&&(a.vertexAttributeSources=b);a.shader=this.displayState.fragmentMain.toJSON();a.transform=this.displayState.objectToDataTransform.toJSON();if(void 0===this.meshSource)b=this.userSpecifiedAttributeNames;else{for(var b=this.defaultAttributeNames,
c=this.displayState.attributeNames.value,d=!0,f=c.length,e=0;e<f;++e)if(c[e]!==b[e]){d=!1;break}b=d?void 0:Array.from(c)}a.vertexAttributeNames=b;return a}},{key:"makeDropdown",value:function(a){return new C(a,this)}}]);return f}(n.h),F=function(a){function c(a,b){m(this,c);var d=u(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));d.attributeNames=a;d.getAttributeInfo=b;d.element=document.createElement("div");d.debouncedValueUpdater=w()(function(){d.updateAttributeNames()},500);d.element.className=
"neuroglancer-single-mesh-attribute-widget";d.updateInputElements();d.registerDisposer(a.changed.add(function(){d.updateInputElements()}));return d}r(c,a);q(c,[{key:"updateInputElements",value:function(){var a=this.attributeNames,c=this.attributeNameElements;if(void 0===c){var d=this.getAttributeInfo();if(void 0===d)return;for(var c=this.attributeNameElements=[],f=void 0,e=a.value.length,g=this.element,h=0;h<e;++h){var l=d[h],q=l.source;if(q!==f&&void 0!==q){var f=q,p=document.createElement("div");
p.className="neuroglancer-single-mesh-source-header";p.textContent=q;g.appendChild(p)}q=document.createElement("div");q.className="neuroglancer-single-mesh-attribute";p=document.createElement("input");p.title=l.name;this.registerEventListener(p,"input",this.debouncedValueUpdater);p.type="text";q.textContent=b.i(k.e)(l);q.appendChild(p);if(void 0!==l.min&&void 0!==l.max){var v=document.createElement("span");v.className="neuroglancer-single-mesh-attribute-range";v.textContent="["+l.min.toPrecision(6)+
", "+l.max.toPrecision(6)+"]";q.appendChild(v)}c[h]=p;g.appendChild(q)}}a.value.forEach(function(a,b){c[b].value=a||""})}},{key:"disposed",value:function(){b.i(g.a)(this.element)}},{key:"updateAttributeNames",value:function(){var a=this.attributeNames.value,b=this.attributeNameElements,c=!1;a.forEach(function(d,f){var e=b[f].value;e||(e=void 0);e!==d&&(c=!0,a[f]=e)});c&&this.attributeNames.changed.dispatch()}}]);return c}(h.b),C=function(a){function b(a,c){m(this,b);var d=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));
d.element=a;d.layer=c;d.attributeWidget=d.registerDisposer(p(d.layer));d.codeWidget=d.registerDisposer(l(d.layer));a.classList.add("neuroglancer-single-mesh-dropdown");c=document.createElement("div");c.className="neuroglancer-single-mesh-dropdown-top-row";var f=document.createElement("div");f.style.flex="1";var e=document.createElement("a"),g=document.createElement("button");g.type="button";g.textContent="?";g.className="help-link";e.appendChild(g);e.title="Documentation on single mesh layer rendering";
e.target="_blank";e.href="https://github.com/google/neuroglancer/blob/master/src/neuroglancer/sliceview/image_layer_rendering.md";g=document.createElement("button");g.innerHTML="&square;";g.className="maximize-button";g.title="Show larger editor view";d.registerEventListener(g,"click",function(){new B(d.layer)});c.appendChild(f);c.appendChild(g);c.appendChild(e);a.appendChild(c);a.appendChild(d.attributeWidget.element);a.appendChild(d.codeWidget.element);d.codeWidget.textEditor.refresh();return d}
r(b,a);q(b,[{key:"onShow",value:function(){this.codeWidget.textEditor.refresh()}}]);return b}(n.i),B=function(a){function b(a){m(this,b);var c=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));c.layer=a;c.attributeWidget=c.registerDisposer(p(c.layer));c.codeWidget=c.registerDisposer(l(c.layer));c.content.classList.add("neuroglancer-single-mesh-layer-shader-overlay");c.content.appendChild(c.attributeWidget.element);c.content.appendChild(c.codeWidget.element);c.codeWidget.textEditor.refresh();
return c}r(b,a);return b}(v.b);b.i(e.c)("mesh",x)},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,
{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function a(a,b,c,d){d=void 0===d?{}:d;return p.a.forPromise(new Promise(function(f){f(a.getVectorGraphicsSource(b,c,d))}),{initialMessage:"Retrieving metadata for vector graphics source "+c+".",delay:!0,errorPrefix:"Error retrieving metadata for vector graphics source "+c+": "})}Object.defineProperty(e,"__esModule",{value:!0});b.d(e,"VectorGraphicsUserLayer",function(){return x});
n=b(10);e=b(12);var c=b(48),l=b(150),p=b(24),w=b(32),v=b(85),k=b(86),h=b(1),g=b(2),d=b(56),f=b(184),q=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}();b(97);b(58);b(98);var x=function(d){function f(d,e){m(this,f);var q=u(this,(f.__proto__||Object.getPrototypeOf(f)).call(this));q.opacity=b.i(w.a)(.5);q.lineWidth=
b.i(v.a)(10);q.color=b.i(k.a)(h.a.fromValues(1,1,1));q.opacity.restoreState(e.opacity);q.lineWidth.restoreState(e.linewidth);q.color.restoreState(e.color);q.lineWidth.changed.add(function(){q.specificationChanged.dispatch()});q.color.changed.add(function(){q.specificationChanged.dispatch()});q.vectorGraphicsLayerType=b.i(g.n)(e.type,c.a);e=q.vectorGraphicsPath=b.i(g.e)(e.source);void 0!==e&&q.vectorGraphicsLayerType===c.a.LINE&&a(d.dataSourceProvider,d.chunkManager,e).then(function(a){q.wasDisposed||
(a=q.renderLayer=new l.a(a,{opacity:q.opacity,lineWidth:q.lineWidth,color:q.color,sourceOptions:{}}),q.addRenderLayer(a))});return q}r(f,d);q(f,[{key:"toJSON",value:function(){var a={type:this.getLayerType()};a.source=this.vectorGraphicsPath;a.opacity=this.opacity.toJSON();a.linewidth=this.lineWidth.toJSON();a.color=this.color.toJSON();return a}},{key:"getLayerType",value:function(){return c.a[this.vectorGraphicsLayerType].toLowerCase()}},{key:"makeDropdown",value:function(a){return new F(a,this)}}]);
return f}(n.h),F=function(a){function b(a,c){m(this,b);var f=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));f.element=a;f.layer=c;f.opacityWidget=f.registerDisposer(new d.a(f.layer.opacity));f.lineWidthWidget=f.registerDisposer(new d.a(f.layer.lineWidth,{min:0,max:50,step:1}));f.colorWidget=f.registerDisposer(new C(f.layer.color));a.classList.add("image-dropdown");var e=f.opacityWidget,g=f.lineWidthWidget,h=f.colorWidget;c=document.createElement("div");c.className="image-dropdown-top-row";
e.promptElement.textContent="Opacity";g.promptElement.textContent="Line Width";h.promptElement.textContent="Color";e=document.createElement("div");e.style.flex="1";g=document.createElement("a");h=document.createElement("button");h.type="button";h.textContent="?";h.className="help-link";g.appendChild(h);g.title="Documentation on vector graphics layer rendering";g.target="_blank";g.href="https://github.com/google/neuroglancer/blob/master/src/neuroglancer/sliceview/vectorgraphics_layer_rendering.md";
c.appendChild(e);c.appendChild(g);a.appendChild(c);a.appendChild(f.opacityWidget.element);a.appendChild(f.lineWidthWidget.element);a.appendChild(f.colorWidget.element);return f}r(b,a);return b}(n.i),C=function(a){function c(a){m(this,c);return u(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,a))}r(c,a);q(c,[{key:"verifyValue",value:function(a){a=b.i(g.j)(a);a/=255;return 0>a?0:1<a?1:a}},{key:"updateInput",value:function(){this.inputx.valueAsNumber=Math.round(255*this.model.value[0]);this.inputy.valueAsNumber=
Math.round(255*this.model.value[1]);this.inputz.valueAsNumber=Math.round(255*this.model.value[2])}}]);return c}(f.a);b.i(e.c)("line",x)},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return x});b.d(e,"b",function(){return C});b.d(e,"c",function(){return z});n=b(30);e=b(46);var a=b(0),c=b(1),l=b(3),p=b(16),w=b(92),v=b(26),k=b(5),h=b(54),g=function y(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),
null!==a)return y(a,b,c)}else{if("value"in d)return d.value;b=d.get;return void 0===b?void 0:b.call(c)}},d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}(),f=c.c.create(),q=new Float32Array(4),x=function(a){function b(a,c,d,f){m(this,b);var e=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));e.chunkManager=
a;e.pointList=c;e.voxelSizeObject=d;e.selectedIndex=f;e.generation=-1;e.redrawNeeded=new l.a;e.color=Float32Array.of(1,1,0,1);e.selectedColor=Float32Array.of(0,1,0,1);e.buffer=new p.a(a.gl);e.registerDisposer(c.changed.add(function(){e.selectedIndex.value=null;e.redrawNeeded.dispatch()}));e.registerDisposer(f.changed.add(function(){e.redrawNeeded.dispatch()}));return e}r(b,a);d(b,[{key:"updateBuffer",value:function(){var a=this.pointList,b=a.generation;this.generation!==b&&(this.generation=b,this.buffer.setData(a.points.view))}},
{key:"updateMouseState",value:function(a,b){c.a.multiply(a.position,this.pointList.get(b),this.voxelSizeObject.size)}},{key:"gl",get:function(){return this.chunkManager.gl}}]);return b}(a.b),a=function(a){function e(a){m(this,e);var c=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));c.gl=a;c.shaders=new Map;c.squareCornersBuffer=b.i(h.a)(c.gl);c.countingBuffer=c.registerDisposer(b.i(w.a)(c.gl));return c}r(e,a);d(e,[{key:"defineShader",value:function(a){a.addAttribute("highp vec3","aVertexPosition");
a.addAttribute("highp vec2","aCornerOffset");a.addUniform("highp vec2","uPointRadii");a.addUniform("highp vec4","uColor");a.addUniform("highp vec4","uColorSelected");a.addUniform("highp vec4","uSelectedIndex");a.addVarying("highp vec4","vColor");a.addUniform("highp mat4","uProjection");a.addUniform("highp vec4","uPickID");a.addVarying("highp vec4","vPickID");a.addVarying("highp vec2","vPointCoord");a.require(w.b);a.addVertexCode(k.l);a.setVertexMain("\ngl_Position = uProjection * vec4(aVertexPosition, 1.0);\ngl_Position.xy += aCornerOffset * uPointRadii * gl_Position.w;\nvPointCoord = aCornerOffset;\n\nuint32_t primitiveIndex = getPrimitiveIndex();\n\nuint32_t pickID; pickID.value = uPickID;\nvPickID = add(pickID, primitiveIndex).value;\n\nif (uSelectedIndex == primitiveIndex.value) {\n  vColor = uColorSelected;\n} else {\n  vColor = uColor;\n}\n");
a.setFragmentMain("\nif (dot(vPointCoord, vPointCoord) > 1.0) {\n  discard;\n}\nemit(getColor(), vPickID);\n")}},{key:"getShader",value:function(a){var b=this.shaders,c=b.get(a);void 0===c&&(c=new v.a(this.gl),c.require(a),this.defineShader(c),c=this.registerDisposer(c.build()),b.set(a,c));return c}},{key:"draw",value:function(a,d,e){var g=this.getShader(e.emitter),h=this.gl;g.bind();d.updateBuffer();var l=d.pointList.length,p=g.attribute("aVertexPosition"),v=g.attribute("aCornerOffset");d.buffer.bindToVertexAttrib(p,
3);h.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(p,1);this.squareCornersBuffer.bindToVertexAttrib(v,2);this.countingBuffer.ensure(l).bind(g,1);c.c.identity(f);c.c.scale(f,f,d.voxelSizeObject.size);c.c.multiply(f,e.dataToDevice,f);h.uniformMatrix4fv(g.uniform("uProjection"),!1,f);h.uniform2f(g.uniform("uPointRadii"),8/e.viewportWidth,8/e.viewportHeight);e.emitPickID&&(a=e.pickIDs.register(a,l),h.uniform4fv(g.uniform("uPickID"),b.i(k.m)(q,a)));e.emitColor&&(h.uniform4fv(g.uniform("uColor"),d.color),
h.uniform4fv(g.uniform("uColorSelected"),d.selectedColor),d=d.selectedIndex.value,null===d&&(d=4294967295),h.uniform4fv(g.uniform("uSelectedIndex"),b.i(k.m)(q,d)));h.ANGLE_instanced_arrays.drawArraysInstancedANGLE(h.TRIANGLE_FAN,0,4,l);h.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(p,0);b.i(w.c)(h,g,!0);h.disableVertexAttribArray(p)}}]);return e}(a.b),F=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}r(b,a);d(b,[{key:"defineShader",
value:function(a){g(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"defineShader",this).call(this,a);a.addFragmentCode("\nvec4 getColor () { return vColor; }\n")}}]);return b}(a),C=function(a){function b(a){m(this,b);var c=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));c.base=a;c.renderHelper=c.registerDisposer(new F(c.gl));c.registerDisposer(a);c.registerDisposer(a.redrawNeeded.add(function(){c.redrawNeeded.dispatch()}));c.setReady(!0);return c}r(b,a);d(b,[{key:"draw",value:function(a){this.renderHelper.draw(this,
this.base,a)}},{key:"updateMouseState",value:function(a,b,c){this.base.updateMouseState(a,c)}},{key:"transformPickedValue",value:function(a,b){return b}},{key:"gl",get:function(){return this.base.chunkManager.gl}}]);return b}(n.a),B=function(a){function b(){m(this,b);return u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}r(b,a);d(b,[{key:"defineShader",value:function(a){g(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"defineShader",this).call(this,a);a.addFragmentCode("\nvec4 getColor() {\n  float scalar = 1.0 - 2.0 * abs(0.5 - gl_FragCoord.z);\n  return vec4(vColor.xyz, scalar * vColor.a);\n}\n")}}]);
return b}(a),z=function(a){function b(a){m(this,b);var c=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));c.base=a;c.renderHelper=c.registerDisposer(new B(c.gl));c.registerDisposer(a);c.registerDisposer(a.redrawNeeded.add(function(){c.redrawNeeded.dispatch()}));c.setReady(!0);return c}r(b,a);d(b,[{key:"draw",value:function(a){this.renderHelper.draw(this,this.base,a)}},{key:"updateMouseState",value:function(a,b,c){this.base.updateMouseState(a,c)}},{key:"transformPickedValue",value:function(a,
b){return b}},{key:"gl",get:function(){return this.base.chunkManager.gl}}]);return b}(e.b)},function(n,e,b){b.d(e,"a",function(){return c});var m=b(165),u=b(2),r=b(3),a=function(){function a(a,b){for(var c=0;c<b.length;c++){var e=b[c];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}(),c=function(){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");
this.points=new m.a;this.changed=new r.a;this.generation=0}a(c,[{key:"delete",value:function(a){this.points.eraseRange(3*a,3*a+3);++this.generation;this.changed.dispatch()}},{key:"get",value:function(a){return this.points.data.subarray(3*a,3*a+3)}},{key:"append",value:function(a){this.points.appendArray(a.subarray(0,3));++this.generation;this.changed.dispatch()}},{key:"reset",value:function(){this.points.clear();++this.generation;this.changed.dispatch()}},{key:"restoreState",value:function(a){try{if(Array.isArray(a)){var c=
a.length,e=this.points;e.resize(3*c);for(var k=e.data,e=0;e<c;++e){var h=3*e;b.i(u.i)(k.subarray(h,h+3),a[e],u.j)}++this.generation;this.changed.dispatch()}}catch(g){this.reset()}}},{key:"toJSON",value:function(){for(var a=this.length,b=this.points.data,c=Array(a),e=0;e<a;++e){var h=3*e;c[e]=[b[h],b[h+1],b[h+2]]}return c}},{key:"length",get:function(){return this.points.length/3}}]);return c}()},function(n,e,b){function m(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function u(c,e){var l=c.memoize.get({type:"getSharedCredentialsProvider",credentialsProvider:b.i(a.a)(e)},function(){return new r.a(e.addRef(),c.rpc)}),k=l.addCounterpartRef();l.dispose();return k}e.a=function(){return function(e){return function(e){function p(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];
if(!(this instanceof p))throw new TypeError("Cannot call a class as a function");var d,c=(d=p.__proto__||Object.getPrototypeOf(p)).call.apply(d,[].concat([this],$jscomp.arrayFromIterable(b)));if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");d=!c||"object"!==typeof c&&"function"!==typeof c?this:c;d.credentialsProvider=b[1].credentialsProvider.addRef();return d}m(p,e);c(p,[{key:"initializeCounterpart",value:function(a,b){b.credentialsProvider=u(this.chunkManager,
this.credentialsProvider);l(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"initializeCounterpart",this).call(this,a,b)}}],[{key:"encodeOptions",value:function(c){var e=l(p.__proto__||Object.getPrototypeOf(p),"encodeOptions",this).call(this,c);e.credentialsProvider=b.i(a.a)(c.credentialsProvider);return e}}]);return p}(e)}};var r=b(124),a=b(20),c=function(){function a(a,b){for(var c=0;c<b.length;c++){var e=b[c];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);
Object.defineProperty(a,e.key,e)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}(),l=function w(a,b,c){null===a&&(a=Function.prototype);var e=Object.getOwnPropertyDescriptor(a,b);if(void 0===e){if(a=Object.getPrototypeOf(a),null!==a)return w(a,b,c)}else{if("value"in e)return e.value;b=e.get;return void 0===b?void 0:b.call(c)}}},function(n,e,b){function m(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);
a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return a});n=b(125);e=b(6);var u=function(){function a(a,b){for(var c=0;c<b.length;c++){var e=b[c];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}(),r=this&&this.__decorate||function(a,
b,e,m){var c=arguments.length,k=3>c?b:null===m?m=Object.getOwnPropertyDescriptor(b,e):m,h;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)k=Reflect.decorate(a,b,e,m);else for(var g=a.length-1;0<=g;g--)if(h=a[g])k=(3>c?h(k):3<c?h(b,e,k):h(b,e))||k;return 3<c&&k&&Object.defineProperty(b,e,k),k},a=function(a){function b(a,c){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var e;e=(b.__proto__||Object.getPrototypeOf(b)).call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
e=!e||"object"!==typeof e&&"function"!==typeof e?this:e;e.provider=a;e.registerDisposer(a);e.initializeCounterpart(c);return e}m(b,a);u(b,[{key:"get",value:function(a,b){return this.provider.get(a,b)}}]);return b}(e.b),a=r([b.i(e.f)(n.a)],a);b.i(e.g)(n.b,function(a,b){return this.get(a.providerId).get(a.invalidCredentials,b).then(function(a){return{value:a}})})},function(n,e,b){e.a="CredentialsProvider";e.b="CredentialsProvider.get"},function(n,e,b){function m(a,b){if("function"!==typeof b&&null!==
b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function u(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}b.d(e,"d",function(){return r});b.d(e,"a",function(){return a});b.d(e,"b",function(){return c});b.d(e,"c",function(){return l});var r;(function(a){a[a.RAW=
0]="RAW";a[a.JPEG=1]="JPEG";a[a.COMPRESSED_SEGMENTATION=2]="COMPRESSED_SEGMENTATION"})(r||(r={}));var a=function w(){u(this,w)};a.RPC_ID="brainmaps/VolumeChunkSource";var c=function v(){u(this,v)};c.RPC_ID="brainmaps/MeshSource";var l=function(a){function b(){u(this,b);var a=(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!==typeof a&&"function"!==typeof a?this:a}m(b,a);return b}(c);
l.RPC_ID="brainmaps/SkeletonSource"},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,
b):a.__proto__=b)}b.d(e,"a",function(){return p});var r=b(69),a=b(24),c=b(13),l=b(166),p=function(e){function p(){if(!(this instanceof p))throw new TypeError("Cannot call a class as a function");var e=m(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments));e.get=b.i(r.b)(function(e){var g=new a.a(!0),d;return new Promise(function(a,h){function f(a,b){b=void 0===b?"Request authorization.":b;g.setText((void 0===a?"Brain Maps authorization required.":a)+"  ");a=document.createElement("button");
a.textContent=b;g.element.appendChild(a);a.addEventListener("click",function(){k(!1)});g.setVisible(!0)}function k(e){void 0!==d&&d.cancel();d=new c.a;f("Waiting for Brain Maps authorization...","Retry");b.i(l.a)({clientId:"639403125587-4k5hgdfumtrvur8v48e3pr7oo91d765k.apps.googleusercontent.com",scopes:["https://www.googleapis.com/auth/brainmaps"],immediate:e,authUser:0},d).then(function(b){void 0!==d&&(d=void 0,g.dispose(),a(b))},function(a){void 0!==d&&(d=void 0,e?f():f("Brain Maps authorization failed: "+
a+".","Retry"))})}e.add(function(){void 0!==d&&(d.cancel(),d=void 0,g.dispose(),h(c.b))});k(!0)})});return e}u(p,e);return p}(r.c)},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,
enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function r(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}b.d(e,"b",function(){return a});b.d(e,"a",function(){return c});b.d(e,"d",function(){return l});b.d(e,"c",function(){return p});var a;(function(a){a[a.JPEG=0]="JPEG";a[a.COMPRESSED_SEGMENTATION=1]="COMPRESSED_SEGMENTATION"})(a||(a={}));n=function v(){r(this,v)};var c=function(a){function b(){r(this,
b);return m(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}u(b,a);return b}(n);c.RPC_ID="dvid/VolumeChunkSource";var l;(function(a){a[a.JPEG=0]="JPEG"})(l||(l={}));var p=function(a){function b(){r(this,b);return m(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}u(b,a);return b}(n);p.RPC_ID="dvid/TileChunkSource"},function(n,e,b){b.d(e,"a",function(){return u});e.b="nifti/getNiftiVolumeInfo";var m;(function(b){b[b.NONE=0]="NONE";b[b.BINARY=1]="BINARY";b[b.UINT8=
2]="UINT8";b[b.INT16=4]="INT16";b[b.INT32=8]="INT32";b[b.FLOAT32=16]="FLOAT32";b[b.COMPLEX64=32]="COMPLEX64";b[b.FLOAT64=64]="FLOAT64";b[b.RGB24=128]="RGB24";b[b.INT8=256]="INT8";b[b.UINT16=512]="UINT16";b[b.UINT32=768]="UINT32";b[b.INT64=1024]="INT64";b[b.UINT64=1280]="UINT64";b[b.FLOAT128=1536]="FLOAT128";b[b.COMPLEX128=1792]="COMPLEX128";b[b.COMPLEX256=2048]="COMPLEX256"})(m||(m={}));var u=function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");};u.RPC_ID=
"nifti/VolumeChunkSource"},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}b.d(e,"c",function(){return u});b.d(e,"a",function(){return r});b.d(e,"b",function(){return a});var u;(function(a){a[a.RAW=0]="RAW";a[a.JPEG=1]="JPEG";a[a.COMPRESSED_SEGMENTATION=2]="COMPRESSED_SEGMENTATION"})(u||(u={}));var r=function l(){m(this,l)};r.RPC_ID="precomputed/VolumeChunkSource";var a=function p(){m(this,p)};a.RPC_ID="precomputed/MeshSource"},function(n,
e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function r(a,b){if(!(a instanceof
b))throw new TypeError("Cannot call a class as a function");}b.d(e,"a",function(){return a});b.d(e,"b",function(){return c});n=function(a){function b(){r(this,b);return m(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}u(b,a);return b}(function p(){r(this,p)});var a=function(a){function b(){r(this,b);return m(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}u(b,a);return b}(n);a.RPC_ID="render/TileChunkSource";var c=function(a){function b(){r(this,b);return m(this,
(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}u(b,a);return b}(n);c.RPC_ID="render/PointMatchSource"},function(n,e,b){function m(b){return void 0!==b.handleEditorAction}e.b=m;e.a=function(b){if(m(b))return b}},function(n,e,b){e.a=function(b){if(b instanceof m.MultiscaleVolumeChunkSource){var e=b.channel,a=b.key;b=b.baseUrls[0].split("://").pop();return{channel:e,host:b,key:a}}return{channel:void 0,host:void 0,key:void 0}};var m=b(38)},function(n,e,b){function m(a){return a%2}e.a=
function(a){return new u.b(void 0===a?0:a,m)};var u=b(7),r;(function(a){a[a.NONE=0]="NONE";a[a.MERGE=1]="MERGE";a[a.SPLIT=2]="SPLIT";a[a.TOTAL=2]="TOTAL"})(r||(r={}));n=new Map([[1,"merge (2x click)"],[0,"select (2x click)"]]);e.b=n},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function r(a){return a.startsWith("key")?a.substring(3):a.startsWith("digit")||a.startsWith("arrow")?a.substring(5):a}b.d(e,"a",function(){return a});n=b(27);b(189);var a=function(a){function b(a){function c(a,b){for(var d=$jscomp.makeIterator(a.parents),f=d.next();!f.done;f=d.next())f=f.value,void 0!==f.label?e(f.label,
f):c(f,b);a=$jscomp.makeIterator(a.bindings.entries());for(d=a.next();!d.done;d=a.next()){var f=$jscomp.makeIterator(d.value),d=f.next().value,f=f.next().value,g=d.indexOf(":"),d=d.substring(g+1);b.set(d,f.action)}}function e(a,b){d.has(b)||(a={label:a,entries:new Map},c(b,a.entries),d.set(b,a))}if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var k=m(this,(b.__proto__||Object.getPrototypeOf(b)).call(this)),h=k.content;h.classList.add("describe-key-bindings");var g=
document.createElement("div");g.classList.add("describe-key-bindings-container");var d=new Map;a=$jscomp.makeIterator(a);for(var f=a.next();!f.done;f=a.next()){var l=$jscomp.makeIterator(f.value),f=l.next().value,l=l.next().value;e(f,l)}a=$jscomp.makeIterator(d.values());for(f=a.next();!f.done;f=a.next()){l=f.value;f=document.createElement("h2");f.textContent=l.label;g.appendChild(f);f=document.createElement("div");f.className="dl";for(var l=$jscomp.makeIterator(l.entries),p=l.next();!p.done;p=l.next()){var n=
$jscomp.makeIterator(p.value),p=n.next().value,n=n.next().value,u=document.createElement("div"),B=document.createElement("div");B.className="definition-outer-container";u.className="definition-container";var z=document.createElement("div");z.className="dt";z.textContent=p.split("+").map(r).join("+");p=document.createElement("div");p.className="dd";p.textContent=n;u.appendChild(z);u.appendChild(p);f.appendChild(B);B.appendChild(u)}g.appendChild(f)}h.appendChild(g);return k}u(b,a);return b}(n.b)},function(n,
e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});
b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return g});var a=b(73),c=b(12);n=b(0);var l=b(8),p=b(89);e=b(224);var w=b.n(e),v=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}(),k=function f(a,b,c){null===a&&(a=Function.prototype);var e=Object.getOwnPropertyDescriptor(a,
b);if(void 0===e){if(a=Object.getPrototypeOf(a),null!==a)return f(a,b,c)}else{if("value"in e)return e.value;b=e.get;return void 0===b?void 0:b.call(c)}};b(21);b(191);var h=function(f){function e(b,f){m(this,e);var g=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));g.layer=b;g.panel=f;var h=g.element=document.createElement("span");h.className="layer-item-parent neuroglancer-noselect";f=g.widgetElement=document.createElement("span");f.className="layer-item neuroglancer-noselect";h.appendChild(f);
var k=g.labelElement=document.createElement("span");k.className="layer-item-label";var l=g.layerNumberElement=document.createElement("span");l.className="layer-item-number";var q=g.valueElement=document.createElement("span");q.className="layer-item-value";var p=document.createElement("span");p.title="Delete layer";p.className="layer-item-close";g.registerEventListener(p,"click",function(a){g.panel.layerManager.removeManagedLayer(g.layer)});f.appendChild(l);f.appendChild(k);f.appendChild(q);f.appendChild(p);
g.registerEventListener(f,"click",function(a){b.setVisible(!b.visible)});var v=g.dropdownElement=document.createElement("div"),k=function(a){g.registerEventListener(h,a,function(a){0===a.button&&g.panel.setDragging(!0)});g.registerEventListener(v,a,function(a){a.stopPropagation()})};k("mousedown");k("pointerdown");g.registerEventListener(h,"mouseup",function(a){0===a.button&&g.panel.setDragging(!1)});g.registerEventListener(f,"dblclick",function(f){b instanceof c.b&&new a.a(g.panel.manager,b)});g.setupDropdownElement();
g.handleLayerChanged();g.registerDisposer(b.layerChanged.add(function(){g.handleLayerChanged()}));h.appendChild(v);g.registerEventListener(h,"mouseenter",function(){g.hovering=!0;g.updateDropdownState()});g.registerEventListener(h,"mouseleave",function(a){g.hovering=!1;g.updateDropdownState()});return g}r(e,f);v(e,[{key:"updateDropdownState",value:function(){var a=this.dropdownElement.style;if(this.hovering&&!this.panel.dragging&&0<this.dropdownElement.childElementCount){if("flex"!==a.display&&(a.display=
"flex",this.dropdown))this.dropdown.onShow();b.i(p.a)(this.dropdownElement,this.widgetElement)}else if("none"!==a.display&&(this.dropdownElement.style.display="none",this.dropdown))this.dropdown.onHide()}},{key:"setupDropdownElement",value:function(){this.dropdownElement.className="layer-dropdown"}},{key:"update",value:function(){var a=this.layer;this.labelElement.textContent=a.name;this.widgetElement.setAttribute("layer-visible",a.visible.toString())}},{key:"handleLayerChanged",value:function(){var a=
this.layer.layer;a!==this.userLayer&&(this.dropdown&&(this.dropdown.dispose(),b.i(l.b)(this.dropdownElement),this.setupDropdownElement()),this.dropdown=(this.userLayer=a)?a.makeDropdown(this.dropdownElement):void 0)}},{key:"disposed",value:function(){this.dropdown&&this.dropdown.dispose();this.element.parentElement.removeChild(this.element);k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disposed",this).call(this)}}]);return e}(n.b),g=function(b){function c(a,b){m(this,c);var f=u(this,
(c.__proto__||Object.getPrototypeOf(c)).call(this));f.element=a;f.manager=b;f.layerWidgets=new Map;f.layerUpdateNeeded=!0;f.valueUpdateNeeded=!1;f.dragging=!1;a.className="layer-panel";f.registerDisposer(b.layerSelectedValues.changed.add(function(){f.handleLayerValuesChanged()}));f.registerDisposer(b.layerManager.layersChanged.add(function(){f.handleLayersChanged()}));b=f.addButton=document.createElement("button");b.className="layer-add-button";b.title="Add layer";f.registerEventListener(b,"click",
function(){f.addLayerMenu()});a.appendChild(b);f.update();var e=new w.a(f.element,{draggable:".layer-item-parent",onStart:function(a){f.setDragging(!0);f.element.classList.add("sorting-in-progress")},onEnd:function(a){f.setDragging(!1);f.element.classList.remove("sorting-in-progress");f.layerManager.reorderManagedLayer(a.oldIndex,a.newIndex)},onMove:function(a){return a.related!==f.addButton}});f.registerDisposer(function(){e.destroy()});return f}r(c,b);v(c,[{key:"setDragging",value:function(a){if(this.dragging!==
a){this.dragging=a;a=$jscomp.makeIterator(this.layerWidgets.values());for(var b=a.next();!b.done;b=a.next())b.value.updateDropdownState()}}},{key:"disposed",value:function(){this.layerWidgets.forEach(function(a){return a.dispose()});this.layerWidgets=void 0;k(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"disposed",this).call(this)}},{key:"handleLayersChanged",value:function(){this.layerUpdateNeeded=!0;this.handleLayerValuesChanged()}},{key:"handleLayerValuesChanged",value:function(){this.valueUpdateNeeded||
(this.valueUpdateNeeded=!0,requestAnimationFrame(this.update.bind(this)))}},{key:"update",value:function(){this.valueUpdateNeeded=!1;this.updateLayers();for(var a=this.manager.layerSelectedValues,b=$jscomp.makeIterator(this.layerWidgets),c=b.next();!c.done;c=b.next()){var c=$jscomp.makeIterator(c.value),f=c.next().value,c=c.next().value,e=f.layer,f="";null!==e&&(e=a.get(e),void 0!==e&&(f=""+e));c.valueElement.textContent=f}}},{key:"updateLayers",value:function(){var a=this;if(this.layerUpdateNeeded){this.layerUpdateNeeded=
!1;var b=this.element,c=new Set,f=b.firstElementChild;this.manager.layerManager.managedLayers.forEach(function(e,g){c.add(e);var k=a.layerWidgets.get(e);void 0===k&&(k=new h(e,a),a.layerWidgets.set(e,k));k.layerNumberElement.textContent=""+(1+g);k.update();k.element!==f&&b.insertBefore(k.element,a.addButton)});for(var e=$jscomp.makeIterator(this.layerWidgets),g=e.next();!g.done;g=e.next()){var k=$jscomp.makeIterator(g.value),g=k.next().value,k=k.next().value;c.has(g)||(this.layerWidgets.delete(g),
k.dispose())}}}},{key:"addLayerMenu",value:function(){new a.a(this.manager)}},{key:"layerManager",get:function(){return this.manager.layerManager}}]);return c}(n.b)},function(n,e,b){e.a="mesh/MeshLayer";e.b="mesh/FragmentSource"},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function r(a){a.addFragmentExtension("GL_EXT_draw_buffers");a.addFragmentCode(z)}function a(a){a.addFragmentExtension("GL_EXT_draw_buffers");a.addFragmentCode(E)}function c(a){a.setFragmentMain("\nvec4 v0 = getValue0();\nvec4 v1 = getValue1();\nvec4 accum = vec4(v0.rgb, v1.r);\nfloat revealage = v0.a;\n\ngl_FragColor = vec4(accum.rgb / accum.a, revealage);\n")}
b.d(e,"a",function(){return G});var l=b(67),p=b(10),w=b(76),v=b(30);n=b(77);var k=b(31),h=b(33),g=b(15),d=b(1),f=b(91),q=b(52),x=b(5),F=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}(),C=function D(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),
null!==a)return D(a,b,c)}else{if("value"in d)return d.value;b=d.get;return void 0===b?void 0:b.call(c)}};b(21);b(193);var B;(function(a){a[a.COLOR=0]="COLOR";a[a.Z=1]="Z";a[a.PICK=2]="PICK";a[a.NUM_TEXTURES=3]="NUM_TEXTURES"})(B||(B={}));var z=[x.a,"\nvoid emit(vec4 color, vec4 pickId) {\n  gl_FragData["+B.COLOR+"] = color;\n  gl_FragData["+B.Z+"] = packFloat01ToFixedPoint(1.0 - gl_FragCoord.z);\n  gl_FragData["+B.PICK+"] = pickId;\n}\n"],E=["\nfloat computeOITWeight(float alpha) {\n  float a = min(1.0, alpha) * 8.0 + 0.01;\n  float b = -gl_FragCoord.z * 0.95 + 1.0;\n  return a * a * a * b * b * b;\n}\n",
"\nvoid emit(vec4 color, vec4 pickId) {\n  float weight = computeOITWeight(color.a);\n  vec4 accum = color * weight;\n  gl_FragData[0] = vec4(accum.rgb, color.a);\n  gl_FragData[1] = vec4(accum.a, 0.0, 0.0, 0.0);\n}\n"],y=d.a.create(),H=d.c.create(),G=function(e){function n(a,e,u){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");var x=m(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,a,e,u));x.visibleLayerTracker=b.i(p.e)(x.viewer.layerManager,v.a,x);x.sliceViews=
new Set;x.projectionMat=d.c.create();x.inverseProjectionMat=d.c.create();x.modelViewMat=d.c.create();x.width=0;x.height=0;x.pickIDs=new w.a;x.axesLineHelper=x.registerDisposer(l.a.get(x.gl));x.sliceViewRenderHelper=x.registerDisposer(k.b.get(x.gl,r));x.offscreenFramebuffer=x.registerDisposer(new q.a(x.gl,{colorBuffers:b.i(q.b)(x.gl,B.NUM_TEXTURES),depthBuffer:new q.c(x.gl)}));x.offscreenCopyHelper=x.registerDisposer(q.d.get(x.gl));x.transparencyCopyHelper=x.registerDisposer(q.d.get(x.gl,c,2));x.registerDisposer(x.navigationState.changed.add(function(){x.viewportChanged()}));
b.i(g.b)(e,"translate-via-mouse-drag",function(a){b.i(f.a)(a.detail,function(a,b,c){a=x.width;var f=x.height,e=x.viewer.navigationState.position,g=e.spatialCoordinates;d.a.transformMat4(y,g,x.projectionMat);y[0]=2*b/a;y[1]=-2*c/f;d.a.transformMat4(g,y,x.inverseProjectionMat);e.changed.dispatch()})});b.i(g.b)(e,"rotate-via-mouse-drag",function(a){b.i(f.a)(a.detail,function(a,b,c){x.navigationState.pose.rotateRelative(d.g[1],-b/4*Math.PI/180);x.navigationState.pose.rotateRelative(d.g[0],c/4*Math.PI/
180);x.viewer.navigationState.changed.dispatch()})});u.showSliceViewsCheckbox&&(a=x.registerDisposer(new h.b(u.showSliceViews)),a.element.className="perspective-panel-show-slice-views neuroglancer-noselect",e=document.createElement("label"),e.className="perspective-panel-show-slice-views neuroglancer-noselect",e.appendChild(document.createTextNode("Slices")),e.appendChild(a.element),x.element.appendChild(e));x.registerDisposer(u.showSliceViews.changed.add(function(){x.scheduleRedraw()}));x.registerDisposer(u.showAxisLines.changed.add(function(){x.scheduleRedraw()}));
return x}u(n,e);F(n,[{key:"updateProjectionMatrix",value:function(){var a=this.projectionMat;d.c.perspective(a,Math.PI/4,this.width/this.height,10,5E3);var b=this.modelViewMat;this.navigationState.toMat4(b);d.a.set(y,1,-1,-1);d.c.scale(b,b,y);var c=d.a.set(y,0,0,100);d.c.translate(b,b,c);d.c.invert(H,b);d.c.multiply(a,a,H);d.c.invert(this.inverseProjectionMat,a)}},{key:"viewportChanged",value:function(){this.context.scheduleRedraw()}},{key:"onResize",value:function(){var a=this.element,b=a.clientHeight;
if(a.clientWidth!==this.width||b!==this.height)this.width=this.element.clientWidth,this.height=this.element.clientHeight,this.viewportChanged()}},{key:"disposed",value:function(){for(var a=$jscomp.makeIterator(this.sliceViews),b=a.next();!b.done;b=a.next())b.value.dispose();this.sliceViews.clear();C(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"disposed",this).call(this)}},{key:"updateMouseState",value:function(a){a.pickedRenderLayer=null;if(!this.navigationState.valid)return!1;var c=
a.position,f=this.offscreenFramebuffer,e=this.width,g=this.height;if(!f.hasSize(e,g))return!1;var h=this.mouseX,k=g-this.mouseY,l=f.readPixel(B.Z,h,k),l=1-b.i(x.b)(l);if(1===l)return!1;c[0]=2*h/e-1;c[1]=2*k/g-1;c[2]=2*l-1;d.a.transformMat4(c,c,this.inverseProjectionMat);this.pickIDs.setMouseState(a,f.readPixelAsUint32(B.PICK,h,k));return!0}},{key:"draw",value:function(){var c=this.width,f=this.height;if(this.navigationState.valid&&0!==c&&0!==f){this.onResize();if(this.viewer.showSliceViews.value)for(var e=
$jscomp.makeIterator(this.sliceViews),g=e.next();!g.done;g=e.next())g.value.updateRendering();e=this.gl;this.offscreenFramebuffer.bind(c,f);e.disable(e.SCISSOR_TEST);this.gl.clearColor(0,0,0,0);e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);e.enable(e.DEPTH_TEST);g=this.projectionMat;this.updateProjectionMatrix();var h=d.a.create();b.i(d.f)(h,d.g[2],this.modelViewMat);d.a.normalize(h,h);var k=this.pickIDs;k.clear();for(var g={dataToDevice:g,lightDirection:h,ambientLighting:.2,directionalLighting:.8,
pickIDs:k,emitter:r,emitColor:!0,emitPickID:!0,alreadyEmittedPickID:!1,viewportWidth:c,viewportHeight:f},h=this.visibleLayerTracker.getVisibleLayers(),l=!1,q=$jscomp.makeIterator(h),k=q.next();!k.done;k=q.next())k=k.value,k.isTransparent?l=!0:k.draw(g);this.viewer.showSliceViews.value&&this.drawSliceViews(g);this.viewer.showAxisLines.value&&this.drawAxisLines();if(l){e.depthMask(!1);e.enable(e.BLEND);l=this.transparentConfiguration;l.bind(c,f);this.gl.clearColor(0,0,0,1);e.clear(e.COLOR_BUFFER_BIT);
g.emitter=a;e.blendFuncSeparate(e.ONE,e.ONE,e.ZERO,e.ONE_MINUS_SRC_ALPHA);g.emitPickID=!1;q=$jscomp.makeIterator(h);for(k=q.next();!k.done;k=q.next())k=k.value,k.isTransparent&&k.draw(g);e.disable(e.DEPTH_TEST);this.offscreenFramebuffer.bindSingle(B.COLOR);e.blendFunc(e.ONE_MINUS_SRC_ALPHA,e.SRC_ALPHA);this.transparencyCopyHelper.draw(l.colorBuffers[0].texture,l.colorBuffers[1].texture);e.depthMask(!0);e.disable(e.BLEND);e.enable(e.DEPTH_TEST);this.offscreenFramebuffer.bind(c,f)}e.WEBGL_draw_buffers.drawBuffersWEBGL([e.NONE,
e.WEBGL_draw_buffers.COLOR_ATTACHMENT1_WEBGL,e.WEBGL_draw_buffers.COLOR_ATTACHMENT2_WEBGL]);g.emitter=r;g.emitPickID=!0;g.emitColor=!1;c=$jscomp.makeIterator(h);for(k=c.next();!k.done;k=c.next())f=k.value,g.alreadyEmittedPickID=!f.isTransparent,f.draw(g);e.disable(e.DEPTH_TEST);this.offscreenFramebuffer.unbind();this.setGLViewport();this.offscreenCopyHelper.draw(this.offscreenFramebuffer.colorBuffers[B.COLOR].texture)}}},{key:"drawSliceViews",value:function(a){var b=this.sliceViewRenderHelper,c=a.lightDirection,
f=a.ambientLighting,e=a.directionalLighting;a=a.dataToDevice;for(var g=$jscomp.makeIterator(this.sliceViews),h=g.next();!h.done;h=g.next()){var h=h.value,k=Math.abs(d.a.dot(c,h.viewportAxes[2])),k=f+k*e,l=H;d.c.identity(l);l[0]=h.width/2;l[5]=-h.height/2;d.c.multiply(l,h.viewportToData,l);d.c.multiply(l,a,l);b.draw(h.offscreenFramebuffer.colorBuffers[0].texture,l,d.m.fromValues(k,k,k,1),d.m.fromValues(.5,.5,.5,1),0,0,1,1)}}},{key:"drawAxisLines",value:function(){var a=this.gl;d.c.identity(H);H[0]=
1600;H[5]=1600;H[10]=1600;var b=this.navigationState.position.spatialCoordinates;H[12]=b[0];H[13]=b[1];H[14]=b[2];H[15]=1;d.c.multiply(H,this.projectionMat,H);a.WEBGL_draw_buffers.drawBuffersWEBGL([a.WEBGL_draw_buffers.COLOR_ATTACHMENT0_WEBGL]);this.axesLineHelper.draw(H,!1)}},{key:"zoomByMouse",value:function(a){this.navigationState.zoomBy(a)}},{key:"navigationState",get:function(){return this.viewer.navigationState}},{key:"transparentConfiguration",get:function(){var a=this.transparentConfiguration_;
void 0===a&&(a=this.transparentConfiguration_=this.registerDisposer(new q.a(this.gl,{colorBuffers:b.i(q.b)(this.gl,2,this.gl.RGBA,this.gl.FLOAT)})));return a}}]);return n}(n.a)},function(n,e,b){e.b=function(b,e){return b.low+","+b.high+(e?"_"+e.center.toString()+"_"+e.size.toString():"")};e.a=function(b,e){var m=b.segmentEquivalences;b=$jscomp.makeIterator(b.visibleSegments);for(var a=b.next();!a.done;a=b.next())if(a=a.value,m.disjointSets.isMinElement(a))for(var c=$jscomp.makeIterator(m.setElements(a)),
l=c.next();!l.done;l=c.next())e(l.value,a)}},function(n,e,b){function m(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return w});var u=b(163),r=b(2),a=b(3),c=b(11);n=b(6);var l=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=
b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,f){c&&a(b.prototype,c);f&&a(b,f);return b}}(),p=function g(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),null!==a)return g(a,b,c)}else{if("value"in d)return d.value;b=d.get;return void 0===b?void 0:b.call(c)}};e=this&&this.__decorate||function(a,b,c,e){var d=arguments.length,f=3>d?b:
null===e?e=Object.getOwnPropertyDescriptor(b,c):e,g;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)f=Reflect.decorate(a,b,c,e);else for(var k=a.length-1;0<=k;k--)if(g=a[k])f=(3>d?g(f):3<d?g(b,c,f):g(b,c))||f;return 3<d&&f&&Object.defineProperty(b,c,f),f};var w=function(e){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var b;b=(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
b=!b||"object"!==typeof b&&"function"!==typeof b?this:b;b.disjointSets=new u.a;b.changed=new a.a;return b}m(d,e);l(d,[{key:"disposed",value:function(){this.changed=this.disjointSets=void 0;p(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"disposed",this).call(this)}},{key:"link",value:function(a,b,c){this.disjointSets.link(a,b,void 0===c?!1:c)&&((c=this.rpc)&&c.invoke("DisjointUint64Sets.add",{id:this.rpcId,al:a.low,ah:a.high,bl:b.low,bh:b.high}),this.changed.dispatch())}},{key:"get",value:function(a){return this.disjointSets.get(a)}},
{key:"clear",value:function(){if(this.disjointSets.clear()){var a=this.rpc;a&&a.invoke("DisjointUint64Sets.clear",{id:this.rpcId});this.changed.dispatch()}}},{key:"setElements",value:function(a){return this.disjointSets.setElements(a)}},{key:"toJSON",value:function(){return this.disjointSets.toJSON()}},{key:"restoreState",value:function(a){var d=this;this.clear();if(void 0!==a){var f=[new c.a,new c.a];b.i(r.k)(a,function(a){b.i(r.k)(a,function(a,b){f[b%2].parseString(String(a),10);0!==b&&d.link(f[0],
f[1])})})}this.changed.dispatch()}},{key:"restoreSaved",value:function(a){var d=this;if(void 0!==a){var f=[new c.a,new c.a];b.i(r.k)(a,function(a){b.i(r.k)(a,function(a,b){f[b%2].parseString(String(a),10);0!==b&&d.link(f[0],f[1],!0)})})}this.changed.dispatch()}},{key:"size",get:function(){return this.disjointSets.size}}],[{key:"makeWithCounterpart",value:function(a){var b=new this;b.initializeCounterpart(a);return b}}]);return d}(n.c),w=e([b.i(n.d)("DisjointUint64Sets")],w),v=new c.a,k=new c.a;b.i(n.e)("DisjointUint64Sets.add",
function(a){var b=this.get(a.id);v.low=a.al;v.high=a.ah;k.low=a.bl;k.high=a.bh;b.disjointSets.link(v,k)&&b.changed.dispatch()});b.i(n.e)("DisjointUint64Sets.clear",function(a){a=this.get(a.id);a.disjointSets.clear()&&a.changed.dispatch()})},function(n,e,b){function m(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});
b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function u(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}b.d(e,"a",function(){return r});e.b="single_mesh/SingleMeshLayer";e.d="single_mesh/getSingleMeshInfo";e.c="";var r=function(a){function b(){u(this,b);var a=(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!==typeof a&&
"function"!==typeof a?this:a}m(b,a);return b}(function c(){u(this,c)});r.RPC_ID="single_mesh/SingleMeshSource"},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,
writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function r(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function a(){return new g.b([],function(a){return b.i(q.k)(a,q.e)})}function c(a){return b.i(y.d)(a.dataType,a.numComponents)}function l(a){return a.map(function(a){return b.i(z.b)(new z.c,a.dataType,a.numComponents)})}function p(a,b){return a.memoize.getUncounted({type:"single_mesh:getMeshInfo",parameters:b},
function(){return a.rpc.promiseInvoke(h.d,{chunkManager:a.addCounterpartRef(),parameters:b})})}b.d(e,"a",function(){return S});e.e=c;b.d(e,"c",function(){return X});e.b=function(a,b){return p(a,b).then(function(c){return a.getChunkSource(Q,{parameters:Object.assign({},b,{info:c})})})};var w=b(18);n=b(9);var v=b(41),k=b(30),h=b(141),g=b(7),d=b(28),f=b(1),q=b(2),x=b(20),F=b(37),C=b(29),B=b(92),z=b(53),E=b(26),y=b(5),H=b(6),G=function O(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,
b);if(void 0===d){if(a=Object.getPrototypeOf(a),null!==a)return O(a,b,c)}else{if("value"in d)return d.value;b=d.get;return void 0===b?void 0:b.call(c)}},J=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}();e.d="//NEUROGLANCER_SINGLE_MESH_LAYER_FRAGMENT_MAIN_START";var D=b(60),S=function na(){r(this,na);this.shaderError=
b.i(C.a)();var c=void 0;this.fragmentMain=new g.b(void 0===c?"void main() {\n  emitGray();\n}\n":c,q.h);this.attributeNames=a();this.objectToDataTransform=new v.a};$jscomp.initSymbol();var I=Symbol("SingleMeshShaderManager.vertexAttributeTextureUnit"),P=b.i(z.b)(new z.c,d.b.FLOAT32,3),U=function(){function a(b,c,d){r(this,a);this.attributeNames=b;this.attributeInfo=c;this.fragmentMain=d;this.tempLightVec=new Float32Array(4);this.tempPickID=new Float32Array(4);this.textureAccessHelper=new z.d("vertexData");
this.indexBufferHelper=new B.d("VertexIndex")}J(a,[{key:"defineAttributeAccess",value:function(a,b){var f=this.textureAccessHelper;f.defineShader(a);a.addVertexCode(f.getAccessor("readVertexPosition","uVertexAttributeSampler[0]",d.b.FLOAT32,3));a.addVertexCode(f.getAccessor("readVertexNormal","uVertexAttributeSampler[1]",d.b.FLOAT32,3));var e=2,g="\nvec3 vertexPosition = readVertexPosition("+b+");\nvec3 vertexNormal = readVertexNormal("+b+");\n",h=this.attributeNames;this.attributeInfo.forEach(function(d,
k){if(void 0!==h[k]){var l=c(d);a.addVarying("highp "+l,"vCustom"+k);a.addFragmentCode("\n#define "+h[k]+" vCustom"+k+"\n");a.addVertexCode(f.getAccessor("readAttribute"+k,"uVertexAttributeSampler["+e+"]",d.dataType,d.numComponents));g+="vCustom"+k+" = readAttribute"+k+"("+b+");\n";e+=1}});a.addTextureSampler2D("uVertexAttributeSampler",I,e);a.addVertexMain(g)}},{key:"defineShader",value:function(a){a.require(B.b);this.indexBufferHelper.defineShader(a);a.addVarying("highp float","vLightingFactor");
a.addUniform("highp vec4","uLightDirection");a.addUniform("highp vec4","uColor");a.addUniform("highp mat4","uModelMatrix");a.addUniform("highp mat4","uProjection");a.addUniform("highp vec4","uPickID");a.addVarying("highp vec4","vPickID");a.addVertexCode(y.l);a.addVertexCode(y.n);a.addVertexMain("\nfloat vertexIndex = getVertexIndex();\nuint32_t triangleIndex;\ndivmod(getPrimitiveIndex(), 3.0, triangleIndex);\nuint32_t pickID; pickID.value = uPickID;\nvPickID = add(pickID, triangleIndex).value;\n");
a.addFragmentCode("\nvoid emitPremultipliedRGBA(vec4 color) {\n  emit(vec4(color.rgb * vLightingFactor, color.a), vPickID);\n}\nvoid emitRGBA(vec4 color) {\n  color = clamp(color, 0.0, 1.0);\n  color.xyz *= color.a;\n  emitPremultipliedRGBA(color);\n}\nvoid emitRGB(vec3 color) {\n  emitRGBA(vec4(color, 1.0));\n}\nvoid emitGray() {\n  emitRGB(vec3(1.0, 1.0, 1.0));\n}\n");a.addFragmentCode(D);this.defineAttributeAccess(a,"vertexIndex");a.addVertexMain("\ngl_Position = uProjection * (uModelMatrix * vec4(vertexPosition, 1.0));\nvec3 normal = normalize((uModelMatrix * vec4(vertexNormal, 0.0)).xyz);\nvLightingFactor = abs(dot(normal, uLightDirection.xyz)) + uLightDirection.w;\n");
a.setFragmentMainFunction("//NEUROGLANCER_SINGLE_MESH_LAYER_FRAGMENT_MAIN_START\n"+this.fragmentMain)}},{key:"beginLayer",value:function(a,b,c){var d=c.dataToDevice,e=c.lightDirection,g=c.ambientLighting;c=c.directionalLighting;a.uniformMatrix4fv(b.uniform("uProjection"),!1,d);d=this.tempLightVec;f.a.scale(d,e,c);d[3]=g;a.uniform4fv(b.uniform("uLightDirection"),d)}},{key:"setPickID",value:function(a,c,d){a.uniform4fv(c.uniform("uPickID"),b.i(y.m)(this.tempPickID,d))}},{key:"beginObject",value:function(a,
b,c){a.uniformMatrix4fv(b.uniform("uModelMatrix"),!1,c)}},{key:"getShader",value:function(a,c){var d=this,f={attributeNames:this.attributeNames,attributeInfo:this.attributeInfo,fragmentMain:this.fragmentMain};return a.memoize.get("single_mesh/SingleMeshShaderManager:"+b.i(x.a)(c)+":"+b.i(q.f)(f),function(){var b=new E.a(a);b.require(c);d.defineShader(b);return b.build()})}},{key:"bindVertexData",value:function(a,b,c){this.textureAccessHelper.setupTextureLayout(a,b,c);var d=b.textureUnit(I)+a.TEXTURE0,
f=function(b){a.activeTexture(d++);a.bindTexture(a.TEXTURE_2D,b)};f(c.vertexTexture);f(c.normalTexture);var e=this.attributeNames;c.vertexAttributeTextures.forEach(function(a,b){void 0!==e[b]&&f(a)})}},{key:"disableVertexData",value:function(a,b){for(var c=2,d=this.attributeInfo.length,f=this.attributeNames,e=0;e<d;++e)void 0!==f[e]&&++c;b=b.textureUnit(I)+a.TEXTURE0;for(d=0;d<c;++d)a.activeTexture(b++),a.bindTexture(a.TEXTURE_2D,null)}},{key:"drawFragment",value:function(a,b,c,d){d.ensure(c.numIndices).bind(b);
this.bindVertexData(a,b,c.vertexData);this.indexBufferHelper.bind(c.indexBuffer,b);a.drawArrays(a.TRIANGLES,0,c.numIndices)}},{key:"endLayer",value:function(a,c){b.i(B.c)(a,c);this.indexBufferHelper.disable(c);this.disableVertexData(a,c)}}]);return a}(),V=function(){function a(){r(this,a)}J(a,[{key:"copyToGPU",value:function(a,c){var d=this,f=this.vertexPositions.length/3;b.i(z.a)(this,a,1,f);var e=function(c,f){var e=a.createTexture();a.bindTexture(a.TEXTURE_2D,e);b.i(z.e)(a,d,f,c);return e};this.vertexTexture=
e(this.vertexPositions,P);this.normalTexture=e(this.vertexNormals,P);this.vertexAttributeTextures=this.vertexAttributes.map(function(a,b){return e(a,c[b])});a.bindTexture(a.TEXTURE_2D,null)}},{key:"freeGPUMemory",value:function(a){a.deleteTexture(this.vertexTexture);a.deleteTexture(this.normalTexture);for(var b=this.vertexAttributeTextures,c=$jscomp.makeIterator(b),d=c.next();!d.done;d=c.next())a.deleteTexture(d.value);b.length=0}}]);return a}(),L=function(a){function c(a,b){r(this,c);a=m(this,(c.__proto__||
Object.getPrototypeOf(c)).call(this,a));var d=a.vertexData=new V;d.vertexPositions=b.vertexPositions;d.vertexNormals=b.vertexNormals;d.vertexAttributes=b.vertexAttributes;b=a.indices=b.indices;a.numIndices=b.length;return a}u(c,a);J(c,[{key:"copyToGPU",value:function(a){G(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"copyToGPU",this).call(this,a);this.vertexData.copyToGPU(a,this.source.attributeTextureFormats);this.indexBuffer=b.i(B.e)(a,this.indices)}},{key:"freeGPUMemory",value:function(a){G(c.prototype.__proto__||
Object.getPrototypeOf(c.prototype),"freeGPUMemory",this).call(this,a);this.vertexData.freeGPUMemory(a);this.indexBuffer.dispose()}}]);return c}(n.d),Q=function(a){function b(){r(this,b);var a=m(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));a.attributeTextureFormats=l(a.info.vertexAttributes);return a}u(b,a);J(b,[{key:"getChunk",value:function(a){return new L(this,a)}},{key:"info",get:function(){return this.parameters.info}}]);return b}(b.i(n.e)(n.c,h.a)),W=function(a){function b(){r(this,
b);return m(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}u(b,a);return b}(b.i(F.c)(H.b)),X=function(a){function c(a,d){r(this,c);var f=m(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));f.source=a;f.displayState=d;f.shaders=new Map;f.sharedObject=f.registerDisposer(new W);f.fallbackFragmentMain="void main() {\n  emitGray();\n}\n";f.countingBuffer=f.registerDisposer(b.i(B.a)(f.gl));f.displayState.shaderError.value=void 0;var e=function(){f.shaderManager=void 0;f.displayState.shaderError.value=
void 0;f.disposeShaders();f.redrawNeeded.dispatch()};f.registerDisposer(d.fragmentMain.changed.add(e));f.registerDisposer(d.attributeNames.changed.add(e));f.registerDisposer(d.objectToDataTransform.changed.add(function(){f.redrawNeeded.dispatch()}));f.displayState.shaderError.value=void 0;d=f.sharedObject;d.visibility.add(f.visibility);d.RPC_TYPE_ID=h.b;d.initializeCounterpart(a.chunkManager.rpc,{chunkManager:a.chunkManager.rpcId,source:a.addCounterpartRef()});f.setReady(!0);return f}u(c,a);J(c,[{key:"disposeShaders",
value:function(){for(var a=this.shaders,b=$jscomp.makeIterator(a.values()),c=b.next();!c.done;c=b.next())c=c.value,null!==c&&c.dispose();a.clear()}},{key:"disposed",value:function(){this.disposeShaders();G(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"disposed",this).call(this)}},{key:"makeShaderManager",value:function(a){a=void 0===a?this.displayState.fragmentMain.value:a;return new U(this.displayState.attributeNames.value,this.source.info.vertexAttributes,a)}},{key:"getShader",value:function(a){var b=
this.shaders,c=b.get(a);if(void 0===c){var c=null,d=this.shaderManager;void 0===d&&(d=this.shaderManager=this.makeShaderManager());var f=this.displayState.fragmentMain.value;try{c=d.getShader(this.gl,a),this.fallbackFragmentMain=f,this.displayState.shaderError.value=null}catch(Y){if(this.displayState.shaderError.value=Y,d=this.fallbackFragmentMain,d!==f){d=this.shaderManager=this.makeShaderManager(d);try{c=d.getShader(this.gl,a)}catch(ab){}}}b.set(a,c)}return c}},{key:"draw",value:function(a){if(a.emitColor||
!a.alreadyEmittedPickID){var b=this.source.chunks.get(h.c);if(void 0!==b&&b.state===w.b.GPU_MEMORY){var c=this.getShader(a.emitter);if(null!==c){var d=this.gl,f=this.shaderManager;c.bind();f.beginLayer(d,c,a);var e=a.pickIDs;f.beginObject(d,c,this.displayState.objectToDataTransform.transform);a.emitPickID&&f.setPickID(d,c,e.register(this,b.numIndices/3));f.drawFragment(d,c,b,this.countingBuffer);f.endLayer(d,c)}}}}},{key:"drawPicking",value:function(a){this.draw(a)}},{key:"transformPickedValue",value:function(a,
b){a=this.source.chunks.get(h.c);if(void 0!==a){b*=3;var c=a.indices;if(!(b>=c.length)){var d=c[b],f=[],e=this.displayState.attributeNames.value;a.vertexData.vertexAttributes.forEach(function(a,b){b=e[b];void 0!==b&&f.push(b+"="+a[d].toPrecision(6))});return f.join(", ")}}}},{key:"isTransparent",get:function(){return null!==this.displayState.fragmentMain.value.match(/emitRGBA|emitPremultipliedRGBA/)}},{key:"gl",get:function(){return this.source.gl}}]);return c}(k.a)},function(n,e,b){e.a="skeleton/SkeletonLayer"},
function(n,e,b){b(149);b(146)},function(n,e,b){b.d(e,"a",function(){return r});var m=b(1),u=function(){function a(a,b){for(var c=0;c<b.length;c++){var e=b[c];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(b,e,p){e&&a(b.prototype,e);p&&a(b,p);return b}}(),r=function(){function a(b,e){e=void 0===e?m.h:e;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.size=m.a.clone(b);this.transform=
m.c.clone(e);this.invTransform=m.c.invert(m.c.create(),e)}u(a,[{key:"toObject",value:function(a){a.size=this.size;a.transform=this.transform}},{key:"localSpatialToGlobal",value:function(a,b){return m.a.transformMat4(a,b,this.transform)}},{key:"globalToLocalSpatial",value:function(a,b){return m.a.transformMat4(a,b,this.invTransform)}},{key:"globalToLocalGrid",value:function(a,b){this.globalToLocalSpatial(a,b);m.a.divide(a,a,this.size);return a}},{key:"localSpatialVectorToGlobal",value:function(a,e){return b.i(m.f)(a,
e,this.transform)}},{key:"globalToLocalSpatialVector",value:function(a,e){return b.i(m.f)(a,e,this.invTransform)}},{key:"assignLocalSpatialToGlobalMat4",value:function(a){return m.c.copy(a,this.transform)}}],[{key:"get",value:function(b,e){e=void 0===e?m.h:e;var c=a.cache,l=JSON.stringify([Array.from(b),Array.from(e)]),v=c.get(l);void 0===v&&(v=new a(b,e),c.set(l,v));return v}},{key:"fromObject",value:function(b){return a.get(b.size,b.transform)}}]);return a}();r.cache=new Map},function(n,e,b){function m(a,
b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?
Object.setPrototypeOf(a,b):a.__proto__=b)}var a=b(147),c=b(148);n=b(82);var l=b(4);e=b(14);var p=b(0),w=b(1),v=b(11),k=b(53),h=b(5),g=function z(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),null!==a)return z(a,b,c)}else{if("value"in d)return d.value;b=d.get;return void 0===b?void 0:b.call(c)}},d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in
d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}(),f=function(a){function c(a,d,f,e){m(this,c);var g=u(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));g.chunkDataSize=d;g.subchunkSize=f;b.i(k.a)(g,a,1,e);a=g.subchunkGridSize=w.a.create();for(e=0;3>e;++e)a[e]=Math.ceil(d[e]/f[e]);return g}r(c,a);d(c,null,[{key:"get",value:function(a,d,f,e){return a.memoize.get("sliceview.CompressedSegmentationTextureLayout:"+b.i(w.o)(d)+","+
(b.i(w.o)(f)+","+e),function(){return new c(a,d,f,e)})}}]);return c}(p.b),q=b.i(k.b)(new k.c,l.b.UINT32),x=function(a){function c(a,b,d,f){m(this,c);f=u(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,f));f.dataType=a;f.subchunkSize=b;f.numChannels=d;f.textureAccessHelper=new k.d("chunkData");return f}r(c,a);d(c,[{key:"defineShader",value:function(a){g(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"defineShader",this).call(this,a);var d=this.textureAccessHelper;d.defineShader(a);
var f=function(a){return"compressedSegmentationChunkFormat_"+a};a.addUniform("highp vec3","uSubchunkGridSize");a.addUniform("highp vec3","uSubchunkSize");a.addFragmentCode(h.c);var e=this.dataType,k=b.i(h.d)(e);e===l.b.UINT64&&a.addFragmentCode(h.e);a.addFragmentCode(d.getAccessor(f("readTextureValue"),"uVolumeChunkSampler",l.b.UINT32));a.addFragmentCode(h.f);a.addFragmentCode(h.g);d="\nfloat "+f("getChannelOffset")+"(int channelIndex) {\n  if (channelIndex == 0) {\n    return "+this.numChannels+
".0;\n  }\n  vec4 v = "+f("readTextureValue")+"(float(channelIndex)).value;\n  return uintleToFloat(v.xyz);\n}\n"+k+" getDataValue (int channelIndex) {\n  vec3 chunkPosition = getPositionWithinChunk();\n\n  // TODO: maybe premultiply this and store as uniform.\n  vec3 subchunkGridPosition = floor(chunkPosition / uSubchunkSize);\n  float subchunkGridOffset = getFortranOrderIndex(subchunkGridPosition, uSubchunkGridSize);\n\n  float channelOffset = "+f("getChannelOffset")+"(channelIndex);\n\n  // TODO: Maybe just combine this offset into subchunkGridStrides.\n  float subchunkHeaderOffset = subchunkGridOffset * 2.0 + channelOffset;\n\n  vec4 subchunkHeader0 = "+
f("readTextureValue")+"(subchunkHeaderOffset).value;\n  vec4 subchunkHeader1 = "+f("readTextureValue")+"(subchunkHeaderOffset + 1.0).value;\n\n  float outputValueOffset = uintleToFloat(subchunkHeader0.xyz) + channelOffset;\n  float encodingBits = unnormalizeUint8(subchunkHeader0[3]);\n  if (encodingBits > 0.0) {\n    vec3 subchunkPosition = floor(min(chunkPosition - subchunkGridPosition * uSubchunkSize, uSubchunkSize - 1.0));\n    float subchunkOffset = getFortranOrderIndex(subchunkPosition, uSubchunkSize);\n    highp float encodedValueBaseOffset = uintleToFloat(subchunkHeader1.xyz) + channelOffset;\n    highp float encodedValueOffset = floor(encodedValueBaseOffset + subchunkOffset * encodingBits / 32.0);\n    vec4 encodedValue = "+
f("readTextureValue")+"(encodedValueOffset).value;\n    float wordOffset = mod(subchunkOffset * encodingBits, 32.0);\n    // If the value is in the first byte, then 0 <= wordOffset < 8.\n    // We need to mod by 2**encodedBits\n    float wordShifter = pow(2.0, -wordOffset);\n    float encodedValueMod = pow(2.0, encodingBits);\n    float encodedValueShifted;\n    if (wordOffset < 16.0) {\n      encodedValueShifted = dot(unnormalizeUint8(encodedValue.xy), vec2(1.0, 256.0));\n    } else {\n      encodedValueShifted = dot(unnormalizeUint8(encodedValue.zw), vec2(256.0 * 256.0, 256.0 * 256.0 * 256.0));\n    }\n    encodedValueShifted = floor(encodedValueShifted * wordShifter);\n    float decodedValue = mod(encodedValueShifted, encodedValueMod);\n    outputValueOffset += decodedValue * "+
(this.dataType===l.b.UINT64?"2.0":"1.0")+";\n  }\n  "+k+" result;\n";d=e===l.b.UINT64?d+("\n  result.low = "+f("readTextureValue")+"(outputValueOffset).value;\n  result.high = "+f("readTextureValue")+"(outputValueOffset+1.0).value;\n"):d+("\n  result.value = "+f("readTextureValue")+"(outputValueOffset).value;\n");a.addFragmentCode(d+"\n  return result;\n}\n")}},{key:"setupTextureLayout",value:function(a,b,c){a.uniform3fv(b.uniform("uSubchunkGridSize"),c.subchunkGridSize);this.textureAccessHelper.setupTextureLayout(a,
b,c)}},{key:"setTextureData",value:function(a,c,d){b.i(k.e)(a,c,q,d)}},{key:"getTextureLayout",value:function(a,b,c){return f.get(a,b,this.subchunkSize,c)}},{key:"beginSource",value:function(a,b){g(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"beginSource",this).call(this,a,b);a.uniform3fv(b.uniform("uSubchunkSize"),this.subchunkSize)}}],[{key:"get",value:function(a,d,f,e){var g="sliceview.CompressedSegmentationChunkFormat:"+d+":"+e,h=g+":"+b.i(w.o)(f);return a.memoize.get(h,function(){return new c(d,
f,e,g)})}}]);return c}(n.a),F=function(f){function e(){m(this,e);return u(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}r(e,f);d(e,[{key:"setTextureData",value:function(a){var b=this.data,c=this.chunkFormat,d=this.textureLayout=c.getTextureLayout(a,this.chunkDataSize,b.length);c.setTextureData(a,d,b)}},{key:"getChannelValueAt",value:function(d,f){var e=this.chunkDataSize,g=this.chunkFormat,h=this.data;f=h[f];if(g.dataType===l.b.UINT64){var k=new v.a;b.i(c.a)(k,h,f,e,g.subchunkSize,
d);return k}return b.i(a.a)(h,f,e,g.subchunkSize,d)}}]);return e}(n.b),C=function(a){function b(a,c){m(this,b);var d=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this)),f=c.dataType;if(f!==l.b.UINT64&&f!==l.b.UINT32)throw Error("Unsupported compressed segmentation data type: "+l.b[f]);d.chunkFormat=d.registerDisposer(x.get(a,c.dataType,c.compressedSegmentationBlockSize,c.numChannels));return d}r(b,a);d(b,[{key:"getChunk",value:function(a,b){return new F(a,b)}}]);return b}(p.b);b.i(e.a)(function(a,
b){return null!=b.compressedSegmentationBlockSize?new C(a,b):null})},function(n,e,b){e.a=function(e,r,a,c,l){r=b.i(m.a)(e,r,a,c,l,1)+r;return e[r]};var m=b(81)},function(n,e,b){e.a=function(e,r,a,c,l,p){a=b.i(m.a)(r,a,c,l,p,2)+a;e.low=r[a];e.high=r[a+1];return e};var m=b(81)},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||
"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}n=b(82);var a=b(4);e=b(14);var c=b(0),l=b(1),p=b(11),w=b(53),v=b(5),k=function F(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,
b);if(void 0===d){if(a=Object.getPrototypeOf(a),null!==a)return F(a,b,c)}else{if("value"in d)return d.value;b=d.get;return void 0===b?void 0:b.call(c)}},h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}(),g=function(a){function c(a,d,f,e){m(this,c);var g=u(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));
g.chunkDataSize=d;g.channelStride=d[0]*d[1]*d[2];b.i(w.f)(g,a,f,d[0],d[1],d[2]*e);return g}r(c,a);h(c,null,[{key:"get",value:function(a,d,f,e){return a.memoize.get("sliceview.UncompressedTextureLayout:"+b.i(l.o)(d)+","+(f+","+e),function(){return new c(a,d,f,e)})}}]);return c}(c.b),d=function(a){function c(a,d,f,e){m(this,c);a=u(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,e));a.dataType=d;a.numChannels=f;b.i(w.b)(a,d);a.textureAccessHelper=new w.d("chunkData");return a}r(c,a);h(c,[{key:"defineShader",
value:function(a){k(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"defineShader",this).call(this,a);var d=this.textureAccessHelper;d.defineShader(a);a.addFragmentCode(d.getAccessor("readVolumeData","uVolumeChunkSampler",this.dataType));1<this.numChannels?(a.addUniform("highp float","uChannelStride"),a.addFragmentCode("\nfloat getChannelOffset(int channelIndex) {\n  return float(channelIndex) * uChannelStride;\n}\n")):a.addFragmentCode("float getChannelOffset(int channelIndex) { return 0.0; }");
a.addFragmentCode("\nfloat getIndexIntoChunk (int channelIndex) {\n  vec3 chunkDataPosition = getPositionWithinChunk();\n  return chunkDataPosition.x + uChunkDataSize.x * (chunkDataPosition.y + uChunkDataSize.y * chunkDataPosition.z) + getChannelOffset(channelIndex);\n}\n");d=b.i(v.d)(this.dataType);a.addFragmentCode("\n"+d+" getDataValue (int channelIndex) {\n  return readVolumeData(getIndexIntoChunk(channelIndex));\n}\n")}},{key:"setupTextureLayout",value:function(a,b,c){1<this.numChannels&&a.uniform1f(b.uniform("uChannelStride"),
c.channelStride);this.textureAccessHelper.setupTextureLayout(a,b,c)}},{key:"getTextureLayout",value:function(a,b){return g.get(a,b,this.texelsPerElement,this.numChannels)}},{key:"setTextureData",value:function(a,c,d){b.i(w.e)(a,c,this,d)}}],[{key:"get",value:function(a,b,d){var f="sliceview.UncompressedChunkFormat:"+b+":"+d;return a.memoize.get(f,function(){return new c(a,b,d,f)})}}]);return c}(n.a),f=function(b){function c(){m(this,c);return u(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,
arguments))}r(c,b);h(c,[{key:"setTextureData",value:function(a){var b=this.source,c=b.chunkFormatHandler,d=c.chunkFormat,f;this.textureLayout=this.chunkDataSize===b.spec.chunkDataSize?f=c.textureLayout.addRef():f=d.getTextureLayout(a,this.chunkDataSize);this.chunkFormat.setTextureData(a,f,this.data)}},{key:"getChannelValueAt",value:function(b,c){var d=this.chunkDataSize;c=b[0]+d[0]*(b[1]+d[1]*(b[2]+d[2]*c));d=this.chunkFormat.dataType;b=this.data;switch(d){case a.b.UINT8:case a.b.FLOAT32:case a.b.UINT16:case a.b.UINT32:return b[c];
case a.b.UINT64:return c*=2,new p.a(b[c],b[c+1])}throw Error("Invalid data type: "+d);}}]);return c}(n.b),q=function(a){function b(a,c){m(this,b);var f=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));f.chunkFormat=f.registerDisposer(d.get(a,c.dataType,c.numChannels));f.textureLayout=f.registerDisposer(f.chunkFormat.getTextureLayout(a,c.chunkDataSize));return f}r(b,a);h(b,[{key:"getChunk",value:function(a,b){return new f(a,b)}}]);return b}(c.b);b.i(e.a)(function(a,b){return null==b.compressedSegmentationBlockSize?
new q(a,b):null})},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):
a.__proto__=b)}b.d(e,"a",function(){return d});var r=b(18);n=b(83);var a=b(32),c=b(85),l=b(86),p=b(1),w=b(16),v=b(25),k=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}(),h=function q(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),
null!==a)return q(a,b,c)}else{if("value"in d)return d.value;b=d.get;return void 0===b?void 0:b.call(c)}},g=p.c.create(),d=function(d){function e(d,g){var h=void 0===g?{}:g;g=void 0===h.opacity?b.i(a.a)(.5):h.opacity;var k=void 0===h.lineWidth?b.i(c.a)(10):h.lineWidth,q=void 0===h.color?b.i(l.a)(p.a.fromValues(255,255,255)):h.color,h=void 0===h.sourceOptions?{}:h.sourceOptions;if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");var v=m(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,
d,{sourceOptions:h}));v.opacity=g;v.registerDisposer(g.changed.add(function(){v.redrawNeeded.dispatch()}));v.lineWidth=k;v.registerDisposer(k.changed.add(function(){v.redrawNeeded.dispatch()}));v.color=q;v.registerDisposer(q.changed.add(function(){v.redrawNeeded.dispatch()}));d=v.gl;g=new Float32Array([1,0,0,1,1,0,0,1]);v.vertexIndexBuffer=w.a.fromData(d,g,d.ARRAY_BUFFER,d.STATIC_DRAW);g=new Float32Array([1,1,-1,-1]);v.normalDirectionBuffer=w.a.fromData(d,g,d.ARRAY_BUFFER,d.STATIC_DRAW);return v}
u(e,d);k(e,[{key:"getShaderKey",value:function(){return"vectorgraphics.VectorGraphicsLineRenderLayer"}},{key:"defineShader",value:function(a){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"defineShader",this).call(this,a);a.addUniform("highp float","uOpacity");a.addUniform("highp float","ulineWidth");a.addUniform("highp vec3","uColor");a.addVarying("vec3","vNormal");a.addAttribute("highp float","aNormalDirection");a.addAttribute("highp vec2","aVertexIndex");a.addAttribute("highp vec3",
"aVertexFirst");a.addAttribute("highp vec3","aVertexSecond");a.addUniform("highp mat4","uProjection");a.setFragmentMain("    \nfloat distance = length(vNormal);\n\nfloat antialiasing = 0.5;\n\nif (distance >= 1.0 - antialiasing) {\n  emitRGBA(vec4(uColor, (distance - 1.0) / -antialiasing )); \n}\nelse if (distance < 1.0 - antialiasing) {\n  emitRGB(uColor);\n}\n");a.setVertexMain("\nvec3 direction = vec3(0., 0., 0.); \ndirection.z = aNormalDirection;\n\nvec3 difference = aVertexSecond - aVertexFirst;\ndifference.z = 0.; \n\nvec3 normal = cross(difference, direction);\nnormal = normalize(normal); \nvNormal = normal; \n\nvec4 delta = vec4(normal * ulineWidth, 0.0);\nvec4 pos = vec4(aVertexFirst * aVertexIndex.x + aVertexSecond * aVertexIndex.y, 1.0);\n\ngl_Position = uProjection * (pos + delta);\n")}},
{key:"beginSlice",value:function(a){h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"beginSlice",this).call(this,a);a=this.gl;var b=this.shader;a.uniform1f(b.uniform("uOpacity"),this.opacity.value);a.uniform1f(b.uniform("ulineWidth"),this.lineWidth.value);a.uniform3fv(b.uniform("uColor"),this.color.value);this.vertexIndexBuffer.bindToVertexAttrib(b.attribute("aVertexIndex"),2);this.normalDirectionBuffer.bindToVertexAttrib(b.attribute("aNormalDirection"),1);return b}},{key:"endSlice",value:function(a){var b=
this.gl;b.disableVertexAttribArray(a.attribute("aVertexIndex"));b.disableVertexAttribArray(a.attribute("aNormalDirection"));b.disableVertexAttribArray(a.attribute("aVertexFirst"));b.disableVertexAttribArray(a.attribute("aVertexSecond"))}},{key:"draw",value:function(a){var b=a.visibleLayers.get(this);if(0!==b.length)if(this.initializeShader(),void 0===this.shader)console.log("error: shader undefined");else{for(var c=this.gl,d=this.beginSlice(a),b=$jscomp.makeIterator(b),e=b.next();!e.done;e=b.next()){var h=
e.value,k=h.spec.chunkLayout,l=h.spec.voxelSize,e=h.chunks,q=g;p.c.identity(q);h.vectorGraphicsCoordinatesInVoxels&&p.c.scale(q,q,l);p.c.multiply(q,k.transform,q);c.uniformMatrix4fv(d.uniform("uProjection"),!1,p.c.multiply(g,a.dataToDevice,q));if(h=a.visibleChunks.get(k))for(h=$jscomp.makeIterator(h),k=h.next();!k.done;k=h.next())if((k=e.get(k.value))&&k.state===r.b.GPU_MEMORY){l=k.numPoints/2;q=d.attribute("aVertexFirst");k.vertexBuffer.bindToVertexAttrib(q,3,v.e,!1,24,0);c.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(q,
1);var m=d.attribute("aVertexSecond");k.vertexBuffer.bindToVertexAttrib(m,3,v.e,!1,24,12);c.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(m,1);c.ANGLE_instanced_arrays.drawArraysInstancedANGLE(c.TRIANGLE_STRIP,0,4,l);c.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(q,0);c.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(m,0)}}this.endSlice(d)}}}]);return e}(n.a)},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||
"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function r(a){a=void 0===a?"void main() {\n  emitGrayscale(toNormalized(getDataValue()));\n}\n":a;return b.i(c.b)(a)}e.a=r;b.d(e,"b",function(){return v});
n=b(84);var a=b(32),c=b(29),l=function(){function a(a,b){for(var c=0;c<b.length;c++){var f=b[c];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(a,f.key,f)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}(),p=function h(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),null!==a)return h(a,b,c)}else{if("value"in d)return d.value;b=d.get;return void 0===b?void 0:
b.call(c)}};e.c="//NEUROGLANCER_IMAGE_RENDERLAYER_FRAGMENT_MAIN_START";var w=b(60),v=function(e){function g(d,f){var e=void 0===f?{}:f;f=void 0===e.opacity?b.i(a.a)(.5):e.opacity;var h=void 0===e.fragmentMain?r():e.fragmentMain,l=void 0===e.shaderError?b.i(c.a)():e.shaderError,e=void 0===e.sourceOptions?{}:e.sourceOptions;if(!(this instanceof g))throw new TypeError("Cannot call a class as a function");var p=m(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,d,{shaderError:l,sourceOptions:e}));
p.fragmentMain=h;p.opacity=f;p.registerDisposer(f.changed.add(function(){p.redrawNeeded.dispatch()}));p.registerDisposer(h.changed.add(function(){p.shaderUpdated=!0;p.redrawNeeded.dispatch()}));return p}u(g,e);l(g,[{key:"getShaderKey",value:function(){return"volume.ImageRenderLayer:"+JSON.stringify(this.fragmentMain.value)}},{key:"getValueAt",value:function(a){for(var b=$jscomp.makeIterator(this.sources),c=b.next();!c.done;c=b.next())for(var c=$jscomp.makeIterator(c.value),d=c.next();!d.done;d=c.next())if(d=
d.value.getValueAt(a),null!=d)return d;return null}},{key:"defineShader",value:function(a){p(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"defineShader",this).call(this,a);a.addUniform("highp float","uOpacity");a.addFragmentCode("\nvoid emitRGBA(vec4 rgba) {\n  emit(vec4(rgba.rgb, rgba.a * uOpacity));\n}\nvoid emitRGB(vec3 rgb) {\n  emit(vec4(rgb, uOpacity));\n}\nvoid emitGrayscale(float value) {\n  emit(vec4(value, value, value, uOpacity));\n}\nvoid emitTransparent() {\n  emit(vec4(0.0, 0.0, 0.0, 0.0));\n}\n");
a.addFragmentCode(w);a.setFragmentMainFunction("//NEUROGLANCER_IMAGE_RENDERLAYER_FRAGMENT_MAIN_START\n"+this.fragmentMain.value)}},{key:"beginSlice",value:function(a){a=p(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"beginSlice",this).call(this,a);this.gl.uniform1f(a.uniform("uOpacity"),this.opacity.value);return a}}]);return g}(n.a)},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&
"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function r(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}b.d(e,"a",function(){return d});var a=b(44),c=b(72),l=b(78),p=b(39);
n=b(84);var w=b(5),v=function q(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),null!==a)return q(a,b,c)}else{if("value"in d)return d.value;b=d.get;return void 0===b?void 0:b.call(c)}},k=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}(),
h=new Float32Array(8),g=function(){function b(c){r(this,b);this.disjointSets=c;this.generation=Number.NaN;this.hashMap=new a.a}k(b,[{key:"update",value:function(){var a=this.disjointSets,b=a.generation;if(this.generation!==b){this.generation=b;b=this.hashMap;b.clear();for(var a=$jscomp.makeIterator(a.mappings()),c=a.next();!c.done;c=a.next()){var d=$jscomp.makeIterator(c.value),c=d.next().value,d=d.next().value;b.set(c,d)}}}}]);return b}(),d=function(a){function d(a,e){r(this,d);var h=m(this,(d.__proto__||
Object.getPrototypeOf(d)).call(this,a,{sourceOptions:e.volumeSourceOptions}));h.displayState=e;h.segmentColorShaderManager=new l.b("segmentColorHash");h.hashTableManager=new c.a("visibleSegments");h.gpuHashTable=c.b.get(h.gl,h.displayState.visibleSegments.hashTable);h.equivalencesShaderManager=new c.c("equivalences");h.equivalencesHashMap=new g(h.displayState.segmentEquivalences.disjointSets);h.gpuEquivalencesHashTable=c.b.get(h.gl,h.equivalencesHashMap.hashMap);b.i(p.g)(e,h);h.registerDisposer(e.selectedAlpha.changed.add(function(){h.redrawNeeded.dispatch()}));
h.registerDisposer(e.hideSegmentZero.changed.add(function(){h.redrawNeeded.dispatch();h.shaderUpdated=!0}));h.hasEquivalences=0!==h.displayState.segmentEquivalences.size;e.segmentEquivalences.changed.add(function(){var a=0!==h.displayState.segmentEquivalences.size;a!==h.hasEquivalences&&(h.hasEquivalences=a,h.shaderUpdated=!0)});h.registerDisposer(e.notSelectedAlpha.changed.add(function(){h.redrawNeeded.dispatch()}));return h}u(d,a);k(d,[{key:"getValueAt",value:function(a){for(var b=$jscomp.makeIterator(this.sources),
c=b.next();!c.done;c=b.next())for(var c=$jscomp.makeIterator(c.value),d=c.next();!d.done;d=c.next())if(d=d.value.getValueAt(a),null!=d)return d;return null}},{key:"getShaderKey",value:function(){return"sliceview.SegmentationRenderLayer/"+this.hasEquivalences+"/"+this.displayState.hideSegmentZero.value}},{key:"defineShader",value:function(a){v(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"defineShader",this).call(this,a);this.hashTableManager.defineShader(a);a.addFragmentCode("\nuint64_t getUint64DataValue() {\n  return toUint64(getDataValue());\n}\n");
this.hasEquivalences?(this.equivalencesShaderManager.defineShader(a),a.addFragmentCode("\nuint64_t getMappedObjectId() {\n  uint64_t value = getUint64DataValue();\n  uint64_t mappedValue;\n  if ("+this.equivalencesShaderManager.getFunctionName+"(value, mappedValue)) {\n    return mappedValue;\n  }\n  return value;\n}\n")):a.addFragmentCode("\nuint64_t getMappedObjectId() {\n  return getUint64DataValue();\n}\n");this.segmentColorShaderManager.defineShader(a);a.addUniform("highp vec4","uSelectedSegment",
2);a.addUniform("highp float","uShowAllSegments");a.addUniform("highp float","uSelectedAlpha");a.addUniform("highp float","uNotSelectedAlpha");a.addFragmentCode(w.f);var b="\n  uint64_t value = getMappedObjectId();\n  \n  float alpha = uSelectedAlpha;\n  float saturation = 1.0;\n";this.displayState.hideSegmentZero.value&&(b+="\n  if (value.low == vec4(0,0,0,0) && value.high == vec4(0,0,0,0)) {\n    emit(vec4(vec4(0, 0, 0, 0)));\n    return;\n  }\n");b+="\n  bool has = uShowAllSegments > 0.0 ? true : "+
this.hashTableManager.hasFunctionName+"(value);\n  if (uSelectedSegment[0] == unnormalizeUint8(value.low) &&\n      uSelectedSegment[1] == unnormalizeUint8(value.high)) {\n    saturation = has ? 0.5 : 0.75;\n  } else if (!has) {\n    alpha = uNotSelectedAlpha;\n  }\n  vec3 rgb = segmentColorHash(value);\n  emit(vec4(mix(vec3(1.0,1.0,1.0), rgb, saturation), alpha));\n";a.setFragmentMain(b)}},{key:"beginSlice",value:function(a){a=v(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"beginSlice",
this).call(this,a);var b=this.gl,c=this.displayState,e=this.displayState,g=e.segmentSelectionState,e=e.visibleSegments;if(g.hasSelectedSegment)for(var k=g.selectedSegment,g=k.low,k=k.high,l=0;4>l;++l)h[l]=g>>8*l&255,h[4+l]=k>>8*l&255;else h.fill(0);b.uniform1f(a.uniform("uSelectedAlpha"),this.displayState.selectedAlpha.value);b.uniform1f(a.uniform("uNotSelectedAlpha"),this.displayState.notSelectedAlpha.value);b.uniform4fv(a.uniform("uSelectedSegment"),h);b.uniform1f(a.uniform("uShowAllSegments"),
e.hashTable.size?0:1);this.hashTableManager.enable(b,a,this.gpuHashTable);this.hasEquivalences&&(this.equivalencesHashMap.update(),this.equivalencesShaderManager.enable(b,a,this.gpuEquivalencesHashTable));this.segmentColorShaderManager.enable(b,a,c.segmentColorHash);return a}},{key:"endSlice",value:function(a){this.hashTableManager.disable(this.gl,a);v(d.prototype.__proto__||Object.getPrototypeOf(d.prototype),"endSlice",this).call(this,a)}}]);return d}(n.a)},function(n,e,b){e.a=function(a){a.registerEventListener(document,
"copy",function(c){if(!b.i(m.a)(c)){var e=b.i(r.a)(a.state).value;c.clipboardData.setData("text/plain",JSON.stringify(e,void 0,"  "));c.preventDefault()}})};e.b=function(a){a.registerEventListener(document,"paste",function(c){if(!b.i(m.a)(c)){var e;e=c.clipboardData.getData("text/plain").match(/^[\[\]{}()\s,]*(\d+(?:\.\d+)?)[,\s]+(\d+(?:\.\d+)?)[,\s]+(\d+(?:\.\d+)?)[\[\]{}()\s,]*$/);e=null!==e?u.a.fromValues(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])):void 0;void 0!==e&&a.navigationState.position.setVoxelCoordinates(e);
c.preventDefault()}})};var m=b(88),u=b(1),r=b(51)},function(n,e,b){function m(){if(void 0===l){var a=new c.a;a.set("keyl","recolor");a.set("keyx","clear-segments");a.set("keys","toggle-show-slices");a.set("keyb","toggle-scale-bar");a.set("keya","toggle-axis-lines");for(var b=1;9>=b;++b)a.set("digit"+b,"toggle-layer-"+b);a.set("keyn","add-layer");a.set("keyh","help");a.set("space","toggle-layout");a.set("slash","toggle-edit-mode");l=a}return l}function u(){void 0===p&&(p=c.a.fromObject({arrowleft:"x-",
arrowright:"x+",arrowup:"y-",arrowdown:"y+",comma:"z-",period:"z+",keyz:"snap","control+equal":"zoom-in","control+shift+equal":"zoom-in","control+minus":"zoom-out",keyr:"rotate-relative-z-",keye:"rotate-relative-z+","shift+arrowdown":"rotate-relative-x-","shift+arrowup":"rotate-relative-x+","shift+arrowleft":"rotate-relative-y-","shift+arrowright":"rotate-relative-y+","at:control+wheel":{action:"zoom-via-wheel",preventDefault:!0},"at:wheel":{action:"z+1-via-wheel",preventDefault:!0},"at:shift+wheel":{action:"z+10-via-wheel",
preventDefault:!0},"at:dblclick0":"select","at:control+mousedown0":"annotate","at:mousedown2":"move-to-mouse-position"},{label:"All Data Panels"}));return p}function r(){void 0===w&&(w=c.a.fromObject({"at:mousedown0":{action:"rotate-via-mouse-drag",stopPropagation:!0},"at:shift+mousedown0":{action:"translate-via-mouse-drag",stopPropagation:!0}},{parents:[[u(),Number.NEGATIVE_INFINITY]]}));return w}function a(){void 0===v&&(v=c.a.fromObject({"at:mousedown0":{action:"translate-via-mouse-drag",stopPropagation:!0},
"at:shift+mousedown0":{action:"rotate-via-mouse-drag",stopPropagation:!0}},{parents:[[u(),Number.NEGATIVE_INFINITY]]}));return v}e.a=function(b){b.global.addParent(m(),Number.NEGATIVE_INFINITY);b.sliceView.addParent(a(),Number.NEGATIVE_INFINITY);b.perspectiveView.addParent(r(),Number.NEGATIVE_INFINITY)};var c=b(15),l,p,w,v},function(n,e,b){e.a=function(c){b.i(a.a)();b.i(a.b)();try{var e=new u.a(document.getElementById("neuroglancer-container"));return new r.a(e,c)}catch(p){throw m.a.showMessage("Error: "+
p.message),p;}};b(144);var m=b(24),u=b(71),r=b(175),a=b(157);b(198)},function(n,e,b){e.a=function(){var c=window.viewer=b.i(m.a)();b.i(r.a)(c.inputEventBindings);c.registerDisposer(new a.a(c.state)).updateFromUrlHash();b.i(u.a)(c);b.i(u.b)(c);return c};var m=b(155),u=b(153),r=b(154),a=b(158)},function(n,e,b){e.a=function(){return b.i(m.a)(document,"contextmenu",function(b){b.preventDefault()})};e.b=function(){return b.i(m.a)(document,"wheel",function(b){b.ctrlKey&&b.preventDefault()})};var m=b(0)},
function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,
"a",function(){return w});n=b(22);var r=b.n(n),a=b(7);n=b(0);var c=b(2),l=b(51),p=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}(),w=function(e){function k(b,c){c=void 0===c?200:c;if(!(this instanceof k))throw new TypeError("Cannot call a class as a function");var d=m(this,(k.__proto__||Object.getPrototypeOf(k)).call(this));
d.root=b;d.parseError=new a.a(void 0);d.registerEventListener(window,"hashchange",function(){return d.updateFromUrlHash()});var f=r()(function(){return d.setUrlHash()},c);d.registerDisposer(b.changed.add(f));d.registerDisposer(function(){return f.cancel()});return d}u(k,e);p(k,[{key:"checkLayerChange",value:function(){if(!(this.root instanceof l.b))return!1;var a=this.root.children.get("layers");if(void 0===a)return!1;a=a.changed.count;if(a===this.prevLayerGeneration)return!1;if(void 0===this.prevLayerGeneration)return this.prevLayerGeneration=
a,!1;this.prevLayerGeneration=a;return!0}},{key:"updateHistory",value:function(a){var b=history.replaceState.bind(history);this.checkLayerChange()&&(b=history.pushState.bind(history));"{}"===a?b(null,"","#"):b(null,"","#!"+a)}},{key:"setUrlHash",value:function(){var a=b.i(l.a)(this.root);a.generation!==this.prevStateGeneration&&(this.prevStateGeneration=a.generation,a=b.i(c.b)(a.value),a!==this.prevStateString&&(this.prevStateString=a,this.updateHistory(a)))}},{key:"updateFromUrlHash",value:function(){try{var a=
location.href.replace(/^[^#]+/,"");if(""===a||"#"===a||"#!"===a)a="#!{}";if(a.startsWith("#!+")){var a=a.slice(3),a=decodeURI(a),e=b.i(c.c)(a);b.i(c.a)(e);this.root.restoreState(e);this.prevStateString=void 0}else if(a.startsWith("#!")){a=a.slice(2);a=decodeURI(a);if(a===this.prevStateString)return;this.prevStateString=a;this.root.reset();var d=b.i(c.c)(a);b.i(c.a)(d);this.root.restoreState(d)}else throw Error('URL hash is expected to be of the form "#!{...}" or "#!+{...}".');this.parseError.value=
void 0}catch(f){this.parseError.value=f}}}]);return k}(n.b)},function(n,e,b){function m(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return l});var u=b(44),r=b(3);n=b(6);var a=function(){function a(a,b){for(var c=0;c<b.length;c++){var e=
b[c];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}(),c=function v(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),null!==a)return v(a,b,c)}else{if("value"in d)return d.value;b=d.get;return void 0===b?void 0:b.call(c)}};e=this&&this.__decorate||function(a,b,c,e){var d=arguments.length,f=3>d?b:
null===e?e=Object.getOwnPropertyDescriptor(b,c):e,g;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)f=Reflect.decorate(a,b,c,e);else for(var h=a.length-1;0<=h;h--)if(g=a[h])f=(3>d?g(f):3<d?g(b,c,f):g(b,c))||f;return 3<d&&f&&Object.defineProperty(b,c,f),f};var l=p=function(b){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");var a;a=(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
a=!a||"object"!==typeof a&&"function"!==typeof a?this:a;a.hashTable=new u.c;a.changed=new r.b;return a}m(e,b);$jscomp.initSymbol();$jscomp.initSymbolIterator();a(e,[{key:"disposed",value:function(){c(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disposed",this).call(this);this.changed=this.hashTable=void 0}},{key:"add_",value:function(a){return this.hashTable.add(a)}},{key:"add",value:function(a){if(this.add_(a)){var b=this.rpc;b&&b.invoke("Uint64Set.add",{id:this.rpcId,value:a});this.changed.dispatch(a,
!0)}}},{key:"has",value:function(a){return this.hashTable.has(a)}},{key:Symbol.iterator,value:function(){return this.hashTable.keys()}},{key:"delete_",value:function(a){return this.hashTable.delete(a)}},{key:"delete",value:function(a){if(this.delete_(a)){var b=this.rpc;b&&b.invoke("Uint64Set.delete",{id:this.rpcId,value:a});this.changed.dispatch(a,!1)}}},{key:"clear",value:function(){if(this.hashTable.clear()){var a=this.rpc;a&&a.invoke("Uint64Set.clear",{id:this.rpcId});this.changed.dispatch(null,
!1)}}},{key:"toJSON",value:function(){for(var a=[],b=$jscomp.makeIterator(this),c=b.next();!c.done;c=b.next())a.push(c.value.toString());return a}},{key:"size",get:function(){return this.hashTable.size}}],[{key:"makeWithCounterpart",value:function(a){var b=new p;b.initializeCounterpart(a);return b}}]);return e}(n.c),l=p=e([b.i(n.d)("Uint64Set")],l);b.i(n.e)("Uint64Set.add",function(a){var b=this.get(a.id);b.add_(a.value)&&b.changed.dispatch()});b.i(n.e)("Uint64Set.delete",function(a){var b=this.get(a.id);
b.delete_(a.value)&&b.changed.dispatch()});b.i(n.e)("Uint64Set.clear",function(a){a=this.get(a.id);a.hashTable.clear()&&a.changed.dispatch()});var p},function(n,e,b){e.a=function(b){var e=-1;return Object.assign(function(){-1===e&&(e=requestAnimationFrame(function(){e=-1;b()}))},{flush:function(){-1!==e&&(e=-1,b())},cancel:function(){-1!==e&&(cancelAnimationFrame(e),e=-1)}})}},function(n,e,b){e.a=function(b,e,r,a){e*=6;var c=Math.floor(e),l=e-c;e=a*(1-r);var p=a*(1-r*l);r=a*(1-r*(1-l));switch(c%6){case 0:b[0]=
a;b[1]=r;b[2]=e;break;case 1:b[0]=p;b[1]=a;b[2]=e;break;case 2:b[0]=e;b[1]=a;b[2]=r;break;case 3:b[0]=e;b[1]=p;b[2]=a;break;case 4:b[0]=r;b[1]=e;b[2]=a;break;case 5:b[0]=a,b[1]=e,b[2]=p}return b}},function(n,e,b){e.a=function(b,e){return b===e?!0:1E-6>Math.abs(b-e)/Math.min(Math.abs(b),Math.abs(e))}},function(n,e,b){function m(a){for(var b=a,c=a[l];c!==a;)a=c,c=a[l];for(a=b[l];c!==a;)b[l]=c,b=a,a=b[l];return c}function u(a){function b(b,d){for(;;)switch(c){case 0:g=!0,e=a;case 1:if(!g&&e===a){c=3;
break}c=4;return{value:e,done:!1};case 4:if(void 0===d){c=5;break}c=-1;throw d;case 5:e=e[p];case 2:g=!1;c=1;break;case 3:c=-1;default:return{value:void 0,done:!0}}}var c=0,e,g,h={next:function(a){return b(a,void 0)},throw:function(a){return b(void 0,a)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();h[Symbol.iterator]=function(){return this};return h}b.d(e,"a",function(){return h});var r=b(11),a=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];
d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}();$jscomp.initSymbol();var c=Symbol("disjoint_sets:rank");$jscomp.initSymbol();var l=Symbol("disjoint_sets:parent");$jscomp.initSymbol();var p=Symbol("disjoint_sets:next");$jscomp.initSymbol();var w=Symbol("disjoint_sets:prev");$jscomp.initSymbol();var v=Symbol("disjoint_sets:save");$jscomp.initSymbol();var k=Symbol("disjoint_sets:min"),
h=function(){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");this.map=new Map;this.generation=0}$jscomp.initSymbol();$jscomp.initSymbolIterator();a(b,[{key:"get",value:function(a){var b=this.map.get(a.toString());return void 0===b?a:m(b)[k]}},{key:"isMinElement",value:function(a){var b=this.get(a);return b===a||r.a.equal(b,a)}},{key:"makeSet",value:function(a,b){b=void 0===b?!1:b;var d=a.toString(),f=this.map.get(d);if(void 0===f)return a=f=a.clone(),
a[l]=a,a[c]=0,a[v]=!1,a[p]=a[w]=a,this.saveNode(f,b),f[k]=f,this.map.set(d,f),f;this.saveNode(f,b);return m(f)}},{key:"saveNode",value:function(a,b){a[v]=void 0===b?!1:b}},{key:"isSaved",value:function(a){return a[v]}},{key:"link",value:function(a,b,e){e=void 0===e?!1:e;a=this.makeSet(a,e);b=this.makeSet(b,e);if(a===b)return!1;this.generation++;e=a;var d=b,f=e[c],g=d[c];f>g?d[l]=e:(e[l]=d,f===g&&(d[c]=g+1),e=d);var d=a,f=b,g=d[w],h=f[w];f[w]=g;g[p]=f;d[w]=h;h[p]=d;e[k]=r.a.min(a[k],b[k]);return!0}},
{key:"setElements",value:function(a){function b(b,f){for(;;)switch(c){case 0:h=a.toString();g=k.map.get(h);if(void 0!==g){c=1;break}c=3;return{value:a,done:!1};case 3:if(void 0===f){c=4;break}c=-1;throw f;case 4:c=2;break;case 1:e=$jscomp.makeIterator(u(g));case 5:if((d=e.next(b)).done){c=6;break}c=7;return{value:d.value,done:!1};case 7:if(void 0===f){c=8;break}c=-1;throw f;case 8:c=5;break;case 6:case 2:c=-1;default:return{value:void 0,done:!0}}}var c=0,d,e,g,h,k=this,l={next:function(a){return b(a,
void 0)},throw:function(a){return b(void 0,a)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();l[Symbol.iterator]=function(){return this};return l}},{key:"clear",value:function(){var a=this.map;if(0===a.size)return!1;++this.generation;a.clear();return!0}},{key:"mappings",value:function(a){function b(b,f){for(;;)switch(c){case 0:a=void 0===a?Array(2):a,g=$jscomp.makeIterator(h.map.values()),e=g.next();case 1:if(e.done){c=3;break}d=e.value;a[0]=d;a[1]=m(d)[k];c=
4;return{value:a,done:!1};case 4:if(void 0===f){c=5;break}c=-1;throw f;case 5:case 2:e=g.next();c=1;break;case 3:c=-1;default:return{value:void 0,done:!0}}}var c=0,d,e,g,h=this,l={next:function(a){return b(a,void 0)},throw:function(a){return b(void 0,a)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();l[Symbol.iterator]=function(){return this};return l}},{key:Symbol.iterator,value:function(){return this.mappings()}},{key:"toJSON",value:function(){for(var a=[],
b=$jscomp.makeIterator(this.map.values()),c=b.next();!c.done;c=b.next())if(c=c.value,c[l]===c){for(var e=[],g=$jscomp.makeIterator(u(c)),h=g.next();!h.done;h=g.next())h=h.value,this.isSaved(c)&&this.isSaved(h)||e.push(h);e.length&&(-1===e.indexOf(c)&&e.unshift(c),e.sort(r.a.compare),a.push(e))}a.sort(function(a,b){return r.a.compare(a[0],b[0])});return a.map(function(a){return a.map(function(a){return a.toString()})})}},{key:"size",get:function(){return this.map.size}}]);return b}()},function(n,e,
b){b.d(e,"b",function(){return m});var m;(function(b){b[b.LITTLE=0]="LITTLE";b[b.BIG=1]="BIG"})(m||(m={}));n=function(){var b=Uint16Array.of(4386);return 17===(new Uint8Array(b.buffer))[0]?m.BIG:m.LITTLE}();e.a=n},function(n,e,b){b.d(e,"a",function(){return u});var m=function(){function b(a,b){for(var c=0;c<b.length;c++){var e=b[c];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(a,c,e){c&&b(a.prototype,c);e&&b(a,e);return a}}(),
u=function(){function b(a){a=void 0===a?16:a;if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");this.length=0;this.data=new Float32Array(a)}m(b,[{key:"resize",value:function(a){var b=this.data;if(a>b.length){var e=new Float32Array(Math.max(a,2*b.length));e.set(b.subarray(0,this.length));this.data=e}this.length=a}},{key:"shrinkToFit",value:function(){this.data=new Float32Array(this.view)}},{key:"clear",value:function(){this.length=0}},{key:"appendArray",value:function(a){var b=
this.length;this.resize(b+a.length);this.data.set(a,b)}},{key:"eraseRange",value:function(a,b){this.data.copyWithin(a,b,this.length);this.length-=b-a}},{key:"view",get:function(){var a=this.data;return new Float32Array(a.buffer,a.byteOffset,this.length)}}]);return b}()},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){var c=document.createElement("iframe");c.style.display="none";c.id=a;c.name=a;c.src="https://accounts.google.com/o/oauth2/postmessageRelay?"+
("parent="+encodeURIComponent(location.origin)+"#rpctoken="+b);document.body.appendChild(c)}e.a=function(c,d){d=void 0===d?r.c:d;var f=b.i(l.a)();void 0===h&&(h=new k);var e=h,g=e.makeAuthRequestUrl({state:f,clientId:c.clientId,scopes:c.scopes,approvalPrompt:c.approvalPrompt,loginHint:c.loginHint,immediate:c.immediate,authUser:c.authUser}),p=e.addPendingRequest(f),f=new Promise(function(a,b){p.finished.add(function(c,d){void 0!==c?a(c):b(d)})});p.finished.add(d.add(function(){p.finished.dispatch(void 0,
r.b)}));if(c.immediate)e.relayReadyPromise.then(function(){if(!d.isCanceled){var c=document.createElement("iframe");c.src=g;c.style.display="none";document.body.appendChild(c);p.finished.add(function(){b.i(a.a)(c)})}});else if(!d.isCanceled){var m=open(g);p.finished.add(function(){m.close()})}return f};var r=b(13),a=b(8),c=b(2),l=b(171),p=b(3),w=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,
d.key,d)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}(),v=function d(){m(this,d);this.finished=new p.b},k=function(){function a(){var d=this;m(this,a);this.proxyName="postmessageRelay"+b.i(l.a)();this.rpcToken=""+b.i(l.a)();this.relayReadyService="oauth2relayReady:"+this.rpcToken;this.oauth2CallbackService="oauth2callback:"+this.rpcToken;this.pendingRequests=new Map;u(this.proxyName,this.rpcToken);this.relayReadyPromise=new Promise(function(a){addEventListener("message",function(f){if("https://accounts.google.com"===
f.origin)try{var e=b.i(c.a)(JSON.parse(f.data)),h=b.i(c.h)(e.s);h===d.relayReadyService&&a();if(h===d.oauth2CallbackService){var k=b.i(c.k)(e.a,function(a){return a}),l=b.i(c.h)(k[0]),p=location.origin;if(!l.startsWith(p+"#")&&!l.startsWith(p+"?"))throw Error("oauth2callback: URL "+JSON.stringify(l)+" "+("does not match current origin "+p+"."));for(var q=l.substring(p.length+1).split("&"),m=new Map,v=$jscomp.makeIterator(q),r=v.next();!r.done;r=v.next()){var n=r.value.match("^([a-z_]+)=(.*)$");if(null===
n)throw Error("oauth2callback: URL part "+JSON.stringify(n)+" does not match expected pattern.");m.set(n[1],n[2])}var u=m.get("state");if(void 0===u)throw Error("oauth2callback: State argument is missing.");var w=d.pendingRequests.get(u);if(void 0!==w){var x=m.get("error");if(void 0!==x){var U=m.get("error_subtype"),e=x;void 0!==U&&(e+=": "+U);w.finished.dispatch(void 0,Error("Error obtaining Google OAuth2 token: "+e))}else{var V=m.get("access_token"),L=m.get("token_type"),Q=m.get("expires_in"),W=
m.get("scope");if(void 0===V||void 0===L||void 0===Q||void 0===W)throw Error("oauth2callback: URL lacks expected parameters.");w.finished.dispatch({accessToken:V,tokenType:L,expiresIn:Q,scope:W})}}}}catch(X){throw Error("Invalid message received from https://accounts.google.com: "+JSON.stringify(f.data)+": "+(X.message+"."));}})})}w(a,[{key:"addPendingRequest",value:function(a){var b=this,c=new v;this.pendingRequests.set(a,c);c.finished.add(function(){b.pendingRequests.delete(a)});return c}},{key:"makeAuthRequestUrl",
value:function(a){var b="https://accounts.google.com/o/oauth2/auth?client_id="+encodeURIComponent(a.clientId),b=b+"&redirect_uri=postmessage&response_type=token"+("&origin="+encodeURIComponent(void 0===a.origin?location.origin:a.origin)),b=b+("&proxy="+this.proxyName),b=b+"&include_granted_scopes=true"+("&scope="+encodeURIComponent(a.scopes.join(" ")));a.state&&(b+="&state="+a.state);a.approvalPrompt&&(b+="&approval_prompt="+encodeURIComponent(a.approvalPrompt));a.loginHint&&(b+="&login_hint="+encodeURIComponent(a.loginHint));
a.immediate&&(b+="&immediate=true");void 0!==a.authUser&&(b+="&authuser="+a.authUser);return b}}]);return a}(),h},function(n,e,b){e.a=function(b){for(var e=0,m=b.length,a=0;a<m;++a)e=31*e+b.charCodeAt(a)|0;return e}},function(n,e,b){b.d(e,"a",function(){return u});var m=function(){function b(a,b){for(var c=0;c<b.length;c++){var e=b[c];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(a,c,e){c&&b(a.prototype,c);e&&b(a,e);
return a}}(),u=function(){function b(a){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");this.parents=[];this.parentPriorities=[];this.bindings=new Map;if(void 0!==a){this.parents.push.apply(this.parents,[].concat($jscomp.arrayFromIterable(a.parents)));this.parentPriorities.push.apply(this.parentPriorities,[].concat($jscomp.arrayFromIterable(a.parentPriorities)));a=$jscomp.makeIterator(a.bindings);for(var c=a.next();!c.done;c=a.next()){var e=$jscomp.makeIterator(c.value),
c=e.next().value,e=e.next().value;this.bindings.set(c,e)}}}m(b,[{key:"addParent",value:function(a,b){for(var c=this,e=this.parents,m=this.parentPriorities,v=0,k=e.length;v<k&&b<m[v];)++v;e.splice(v,0,a);m.splice(v,0,b);return function(){c.removeParent(a)}}},{key:"removeParent",value:function(a){a=this.parents.indexOf(a);if(-1===a)throw Error("Attempt to remove non-existent parent map.");this.parents.splice(a,1);this.parentPriorities.splice(a,1)}},{key:"set",value:function(a,b){this.bindings.set(a,
b)}},{key:"delete",value:function(a){this.bindings.delete(a)}},{key:"clear",value:function(){this.bindings.clear();this.parents.length=0;this.parentPriorities.length=0}},{key:"get",value:function(a){for(var b=this.parents,e=this.parentPriorities,p=e.length,m=0,v;m<p&&0<e[m];++m)if(v=b[m].get(a),void 0!==v)return v;v=this.bindings.get(a);if(void 0!==v)return v;for(;m<p;++m)if(v=b[m].get(a),void 0!==v)return v}},{key:"getAll",value:function(a){function b(b,c){for(;;)switch(e){case 0:g=d,h=g.parents,
k=g.parentPriorities,v=k.length,m=0;case 1:if(!(m<v&&0<k[m])){e=2;break}p=h[m].get(a);if(void 0===p){e=3;break}e=4;return{value:p,done:!1};case 4:if(void 0===c){e=5;break}e=-1;throw c;case 5:case 3:e=1;break;case 2:p=d.bindings.get(a);if(void 0===p){e=6;break}e=7;return{value:p,done:!1};case 7:if(void 0===c){e=8;break}e=-1;throw c;case 8:case 6:case 9:if(!(m<v)){e=10;break}p=h[m].get(a);if(void 0===p){e=11;break}e=12;return{value:p,done:!1};case 12:if(void 0===c){e=13;break}e=-1;throw c;case 13:case 11:e=
9;break;case 10:e=-1;default:return{value:void 0,done:!0}}}var e=0,p,m,v,k,h,g,d=this,f={next:function(a){return b(a,void 0)},throw:function(a){return b(void 0,a)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();f[Symbol.iterator]=function(){return this};return f}}]);return b}()},function(n,e,b){var m=function(){function b(b,a){for(var c=0;c<a.length;c++){var e=a[c];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(b,
e.key,e)}}return function(e,a,c){a&&b(e.prototype,a);c&&b(e,c);return e}}();n=function(){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");}m(b,null,[{key:"insertAfter",value:function(b,a){var c=b.next0;a.next0=c;a.prev0=b;b.next0=a;c.prev0=a}},{key:"insertBefore",value:function(b,a){var c=b.prev0;a.prev0=c;a.next0=b;b.prev0=a;c.next0=a}},{key:"front",value:function(b){var a=b.next0;return a===b?null:a}},{key:"back",value:function(b){var a=b.prev0;return a===
b?null:a}},{key:"pop",value:function(b){var a=b.next0,c=b.prev0;a.prev0=c;c.next0=a;b.next0=null;b.prev0=null;return b}},{key:"iterator",value:function(b){function a(a,l){for(;;)switch(c){case 0:e=b.next0;case 1:if(e===b){c=3;break}c=4;return{value:e,done:!1};case 4:if(void 0===l){c=5;break}c=-1;throw l;case 5:case 2:e=e.next0;c=1;break;case 3:c=-1;default:return{value:void 0,done:!0}}}var c=0,e,p={next:function(b){return a(b,void 0)},throw:function(b){return a(void 0,b)},return:function(a){throw Error("Not yet implemented");
}};$jscomp.initSymbolIterator();p[Symbol.iterator]=function(){return this};return p}},{key:"reverseIterator",value:function(b){function a(a,l){for(;;)switch(c){case 0:e=b.prev0;case 1:if(e===b){c=3;break}c=4;return{value:e,done:!1};case 4:if(void 0===l){c=5;break}c=-1;throw l;case 5:case 2:e=e.prev0;c=1;break;case 3:c=-1;default:return{value:void 0,done:!0}}}var c=0,e,p={next:function(b){return a(b,void 0)},throw:function(b){return a(void 0,b)},return:function(a){throw Error("Not yet implemented");
}};$jscomp.initSymbolIterator();p[Symbol.iterator]=function(){return this};return p}},{key:"initializeHead",value:function(b){b.next0=b.prev0=b}}]);return b}();e.a=n},function(n,e,b){e.a=function(b){$jscomp.initSymbol();$jscomp.initSymbolIterator();b=b[Symbol.iterator]();var e=b.next(),m=e.value;if(e.done)return"";for(e=m.length;0<e;){var a=b.next(),c=a.value;if(a.done)break;for(a=0;a<e&&m.charCodeAt(a)===c.charCodeAt(a);++a);e=a}return m.substring(0,e)}},function(n,e,b){e.a=function(b){b=Math.ceil((void 0===
b?128:b)/32);var e=new Uint32Array(b);crypto.getRandomValues(e);for(var m="",a=0;a<b;++a)m+=("00000000"+e[a].toString(16)).slice(-8);return m}},function(n,e,b){e.a=function(b){var e=b.parentElement,m=b.offsetLeft-e.clientLeft,a=b.offsetTop-e.clientTop,c=e.scrollLeft,l=e.scrollTop,a=Math.max(0,a+b.offsetHeight-(l+e.clientHeight))||Math.min(0,a-l);e.scrollLeft+=Math.max(0,m+b.offsetWidth-(c+e.clientWidth))||Math.min(0,m-c);e.scrollTop+=a}},function(n,e,b){e.b=function(b,e){b.remove(e)};e.a=function(b,
e){b.add(e)}},function(n,e,b){e.a=function(b){var e=0;switch(b.deltaMode){case 0:e=.005;break;case 1:e=.1;break;case 2:e=2}return Math.exp(b.deltaY*e)}},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function a(a){var b=I.a.find(function(b){return b[0]===a});if(void 0===b)throw Error("Invalid layout name: "+JSON.stringify(a)+".");return b}function c(b){return a(b)[0]}b.d(e,"a",function(){return X});n=b(22);var l=b.n(n),p=b(18),w=b(9),v=b(68),k=b(19),h=b(135),g=b(10),d=b(73),f=b(136),q=b(12),x=b(74),F=b(75),C=b(27),
B=b(181),z=b(33),E=b(7),y=b(49);n=b(0);var H=b(8),G=b(15),J=b(36),D=b(3),S=b(51),I=b(176),P=b(134),U=b(37),V=b(6),L=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}();b(199);b(58);b(21);var Q=function(a){function b(a){m(this,b);var c=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));c.gl=a;c.worker=
new Worker("chunk_worker.bundle.js");c.chunkQueueManager=c.registerDisposer(new w.a(new V.a(c.worker),c.gl,{gpuMemory:new p.a(1E6,1E9),systemMemory:new p.a(1E7,2E9),download:new p.a(32,Number.POSITIVE_INFINITY)}));c.chunkManager=c.registerDisposer(new w.b(c.chunkQueueManager));c.chunkQueueManager.registerDisposer(function(){return c.worker.terminate()});return c}r(b,a);L(b,[{key:"rpc",get:function(){return this.chunkQueueManager.rpc}}]);return b}(n.b);(function(a){function b(){m(this,b);var a=u(this,
(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments));a.global=new J.a;return a}r(b,a);return b})(I.b);var W={showEditOption:!0,showSaveButton:!0,showHelpButton:!0,showLayerDialog:!0,showLayerPanel:!0,showLocation:!0,resetStateWhenEmpty:!0},X=function(e){function p(a,e){e=void 0===e?{}:e;m(this,p);var f=u(this,(p.__proto__||Object.getPrototypeOf(p)).call(this));f.display=a;f.navigationState=f.registerDisposer(new F.a);f.perspectiveNavigationState=new F.a(new F.b(f.navigationState.position),
1);f.mouseState=new g.a;f.layerManager=f.registerDisposer(new g.b);f.showAxisLines=new z.a(!0,!0);f.showScaleBar=new z.a(!0,!0);f.showPerspectiveSliceViews=new z.a(!0,!0);f.layerSelectedValues=f.registerDisposer(new g.c(f.layerManager,f.mouseState));f.resetInitiated=new D.a;f.layoutName=new E.b(I.a[0][0],c);f.editorState={editor:b.i(P.a)(P.b.keys().next().value),segment:void 0};f.state=new S.b;f.visible=!0;var h=e,n=void 0===h.dataContext?new Q(a.gl):h.dataContext,r=void 0===h.visibility?new U.a(U.a.VISIBLE):
h.visibility,w=void 0===h.inputEventBindings?{global:new J.a,sliceView:new J.a,perspectiveView:new J.a}:h.inputEventBindings,y=void 0===h.element?a.makeCanvasOverlayElement():h.element,h=void 0===h.dataSourceProvider?b.i(k.a)({credentialsManager:v.a}):h.dataSourceProvider;f.registerDisposer(function(){return b.i(H.a)(f.element)});f.registerDisposer(n);f.options=Object.assign({},W,e,{dataContext:n,visibility:r,inputEventBindings:w,element:y,dataSourceProvider:h});f.layerSpecification=new q.a(f.dataSourceProvider,
f.layerManager,f.chunkManager,f.layerSelectedValues,f.navigationState.voxelSize);f.registerDisposer(a.updateStarted.add(function(){f.onUpdateDisplay()}));f.registerDisposer(a.updateFinished.add(function(){f.onUpdateDisplayFinished()}));e=f.state;e.add("layers",f.layerSpecification);e.add("navigation",f.navigationState);e.add("showAxisLines",f.showAxisLines);e.add("showScaleBar",f.showScaleBar);e.add("perspectiveOrientation",f.perspectiveNavigationState.pose.orientation);e.add("perspectiveZoom",f.perspectiveNavigationState.zoomFactor);
e.add("showSlices",f.showPerspectiveSliceViews);e.add("layout",f.layoutName);f.registerDisposer(f.navigationState.changed.add(function(){f.handleNavigationStateChanged()}));f.layerManager.initializePosition(f.navigationState.position);f.registerDisposer(f.layerSpecification.voxelCoordinatesSet.add(function(a){f.navigationState.position.setVoxelCoordinates(a)}));e=f.registerCancellable(l()(function(){!f.wasDisposed&&0===f.layerManager.managedLayers.length&&f.options.resetStateWhenEmpty&&(f.navigationState.reset(),
f.perspectiveNavigationState.pose.orientation.reset(),f.perspectiveNavigationState.zoomFactor.reset(),f.resetInitiated.dispatch(),!C.a&&f.options.showLayerDialog&&f.visibility.visible&&new d.a(f.layerSpecification))}));f.layerManager.layersChanged.add(e);e();f.registerDisposer(f.dataContext.chunkQueueManager.visibleChunksChanged.add(function(){f.layerSelectedValues.handleLayerChange()}));f.registerDisposer(f.dataContext.chunkQueueManager.visibleChunksChanged.add(function(){f.visible&&a.scheduleRedraw()}));
f.makeUI();f.registerActionListeners();f.registerEventActionBindings();return f}r(p,e);L(p,[{key:"makeUI",value:function(){var a=this,b=this.options,c=this.element;c.classList.add("neuroglancer-noselect");var d=[],e=b.showHelpButton,g=b.showLocation,h=b.showSaveButton;if(b.showEditOption||h||e||g){var k=[];b.showLocation&&(k.push(function(b){return a.registerDisposer(new B.a(b,a.navigationState.voxelSize))}),k.push(function(b){return a.registerDisposer(new B.b(b,a.navigationState.position))}),k.push(x.a(1,
function(b){b.style.alignSelf="center";a.registerDisposer(new B.c(b,a.mouseState,a.navigationState.voxelSize))})));b.showEditOption&&k.push(function(b){var c=document.createElement("select");c.id="edit-option";P.b.forEach(function(a,b){var d=document.createElement("option");d.textContent=a;d.value=b.toString();c.appendChild(d)});b.appendChild(c);a.registerEventListener(c,"change",function(){var b=parseInt(c.value,10);a.editorState.editor.restoreState(b)})});b.showSaveButton&&k.push(function(b){var c=
document.createElement("button");c.id="save-button";c.textContent="save";c.title="Save";b.appendChild(c);a.registerEventListener(c,"click",function(){a.saveAllEdits()})});b.showHelpButton&&k.push(function(b){var c=document.createElement("button");c.id="help-button";c.textContent="?";c.title="Help";b.appendChild(c);a.registerEventListener(c,"click",function(){a.showHelpDialog()})});d.push(function(a){a.style.alignItems="stretch";x.b("row",k)(a)})}b.showLayerPanel&&d.push(function(b){a.layerPanel=new f.a(b,
a.layerSpecification)});d.push(x.a(1,function(b){a.createDataDisplayLayout(b);a.layoutName.changed.add(function(){void 0!==a.dataDisplayLayout&&(a.dataDisplayLayout.dispose(),a.createDataDisplayLayout(b))})}));x.b("column",d)(c);this.display.onResize();b=function(){var b=a.visibility.visible;b!==a.visible&&(c.style.visibility=b?"inherit":"hidden",a.visible=b)};b();this.registerDisposer(this.visibility.changed.add(b))}},{key:"registerEventActionBindings",value:function(){var a=this.element;this.registerDisposer(new J.b(a,
this.inputEventMap));this.registerDisposer(new y.a(a))}},{key:"bindAction",value:function(a,c){this.registerDisposer(b.i(G.b)(this.element,a,c))}},{key:"registerActionListeners",value:function(){for(var a=this,b={},c=$jscomp.makeIterator(["recolor","clear-segments"]),d=c.next();!d.done;b={action:b.action},d=c.next())b.action=d.value,this.bindAction(b.action,function(b){return function(){a.layerManager.invokeAction(b.action)}}(b));b={};c=$jscomp.makeIterator(["select","annotate"]);for(d=c.next();!d.done;b=
{action$194:b.action$194},d=c.next())b.action$194=d.value,this.bindAction(b.action$194,function(b){return function(){a.mouseState.updateUnconditionally();a.layerManager.invokeAction(b.action$194,a.editorState)}}(b));this.bindAction("toggle-layout",function(){return a.toggleLayout()});this.bindAction("add-layer",function(){return a.layerPanel.addLayerMenu()});this.bindAction("help",function(){return a.showHelpDialog()});for(d={i:1};9>=d.i;d={i:d.i},++d.i)this.bindAction("toggle-layer-"+d.i,function(b){return function(){var c=
b.i-1,d=a.layerManager.managedLayers;c<d.length&&(c=d[c],c.setVisible(!c.visible))}}(d));this.bindAction("toggle-axis-lines",function(){return a.showAxisLines.toggle()});this.bindAction("toggle-scale-bar",function(){return a.showScaleBar.toggle()});this.bindAction("toggle-show-slices",function(){return a.showPerspectiveSliceViews.toggle()});this.bindAction("toggle-edit-mode",function(){return a.toggleEditor()})}},{key:"createDataDisplayLayout",value:function(b){this.dataDisplayLayout=(0,a(this.layoutName.value)[1])(b,
this)}},{key:"toggleEditor",value:function(){var a=this.editorState.editor;a.restoreState(a.value+1);var b=document.getElementById("edit-option");b&&P.b.has(a.value)&&(b.value=a.value.toString())}},{key:"toggleLayout",value:function(){var b=a(this.layoutName.value),b=I.a.indexOf(b);this.layoutName.value=I.a[(b+1)%I.a.length][0]}},{key:"showHelpDialog",value:function(){var a=this.inputEventBindings;new h.a([["Global",a.global],["Slice View",a.sliceView],["Perspective View",a.perspectiveView]])}},{key:"saveAllEdits",
value:function(){this.layerManager.invokeAction("save")}},{key:"onUpdateDisplay",value:function(){this.visible&&(this.dataContext.chunkQueueManager.chunkUpdateDeadline=null)}},{key:"onUpdateDisplayFinished",value:function(){this.visible&&this.mouseState.updateIfStale()}},{key:"handleNavigationStateChanged",value:function(){if(this.visible){var a=this.dataContext.chunkQueueManager;null===a.chunkUpdateDeadline&&(a.chunkUpdateDeadline=Date.now()+10)}this.mouseState.stale=!0}},{key:"chunkManager",get:function(){return this.dataContext.chunkManager}},
{key:"chunkQueueManager",get:function(){return this.dataContext.chunkQueueManager}},{key:"dataContext",get:function(){return this.options.dataContext}},{key:"visibility",get:function(){return this.options.visibility}},{key:"inputEventBindings",get:function(){return this.options.inputEventBindings}},{key:"inputEventMap",get:function(){return this.inputEventBindings.global}},{key:"element",get:function(){return this.options.element}},{key:"dataSourceProvider",get:function(){return this.options.dataSourceProvider}},
{key:"gl",get:function(){return this.display.gl}}]);return p}(n.b)},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?
Object.setPrototypeOf(a,b):a.__proto__=b)}function r(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function a(a,b){b=void 0===b?a.navigationState:new k.a(new k.b(a.navigationState.pose.position,k.c.makeRelative(a.navigationState.pose.orientation,b)),a.navigationState.zoomFactor);return new g.a(a.chunkManager,a.layerManager,b)}function c(b){var c=[];c.push(a(b,void 0));c.push(a(b,F.k.rotateX(F.k.create(),F.k.create(),Math.PI/2)));c.push(a(b,F.k.rotateY(F.k.create(),
F.k.create(),Math.PI/2)));return c}function l(a){return{mouseState:a.mouseState,layerManager:a.layerManager,showAxisLines:a.showAxisLines,visibility:a.visibility,editorState:a.editorState}}function p(a){return Object.assign({},l(a),{navigationState:a.perspectiveNavigationState,inputEventMap:a.inputEventBindings.perspectiveView})}function w(a){return Object.assign({},l(a),{navigationState:a.navigationState,inputEventMap:a.inputEventBindings.sliceView})}b.d(e,"b",function(){return z});var v=b(74),k=
b(75),h=b(138),g=b(31),d=b(46),f=b(33);n=b(0);var q=b(8),x=b(15),F=b(1),C=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}(),B=function D(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),null!==a)return D(a,b,c)}else{if("value"in d)return d.value;
b=d.get;return void 0===b?void 0:b.call(c)}},z=function S(){r(this,S);this.perspectiveView=new x.a;this.sliceView=new x.a},E=function(a){function e(a,b){r(this,e);var g=m(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));g.rootElement=a;g.viewer=b;var k=c(b),l=b.display,q=Object.assign({},p(b),{showSliceViews:b.showPerspectiveSliceViews,showSliceViewsCheckbox:!0}),n=Object.assign({},w(b),{showScaleBar:b.showScaleBar}),u=Object.assign({},w(b),{showScaleBar:new f.a(!1,!1)});b=[v.a(1,v.b("column",
[v.a(1,v.b("row",[v.a(1,function(a){g.registerDisposer(new d.a(l,a,k[0],n))}),v.a(1,function(a){g.registerDisposer(new d.a(l,a,k[1],u))})])),v.a(1,v.b("row",[v.a(1,function(a){a=g.registerDisposer(new h.a(l,a,q));for(var b=$jscomp.makeIterator(k),c=b.next();!c.done;c=b.next())a.sliceViews.add(c.value.addRef())}),v.a(1,function(a){g.registerDisposer(new d.a(l,a,k[2],u))})]))]))];v.b("row",b)(a);l.onResize();return g}u(e,a);C(e,[{key:"disposed",value:function(){b.i(q.b)(this.rootElement);B(e.prototype.__proto__||
Object.getPrototypeOf(e.prototype),"disposed",this).call(this)}}]);return e}(n.b),y=function(c){function f(b,c,e){r(this,f);var g=m(this,(f.__proto__||Object.getPrototypeOf(f)).call(this));g.rootElement=b;g.viewer=c;g.direction=e;var k=a(c),l=c.display,q=Object.assign({},p(c),{showSliceViews:c.showPerspectiveSliceViews,showSliceViewsCheckbox:!0}),n=Object.assign({},w(c),{showScaleBar:c.showScaleBar});v.a(1,v.b(e,[v.a(1,function(a){g.registerDisposer(new d.a(l,a,k,n))}),v.a(1,function(a){g.registerDisposer(new h.a(l,
a,q)).sliceViews.add(k.addRef())})]))(b);l.onResize();return g}u(f,c);C(f,[{key:"disposed",value:function(){b.i(q.b)(this.rootElement);B(f.prototype.__proto__||Object.getPrototypeOf(f.prototype),"disposed",this).call(this)}}]);return f}(n.b),H=function(c){function f(b,c){r(this,f);var e=m(this,(f.__proto__||Object.getPrototypeOf(f)).call(this));e.rootElement=b;e.viewer=c;var g=a(c),h=Object.assign({},w(c),{showScaleBar:c.showScaleBar});v.b("row",[v.a(1,function(a){e.registerDisposer(new d.a(c.display,
a,g,h))})])(b);c.display.onResize();return e}u(f,c);C(f,[{key:"disposed",value:function(){b.i(q.b)(this.rootElement);B(f.prototype.__proto__||Object.getPrototypeOf(f.prototype),"disposed",this).call(this)}}]);return f}(n.b),G=function(a){function c(a,b){r(this,c);var d=m(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));d.rootElement=a;d.viewer=b;var e=Object.assign({},p(b),{showSliceViews:new f.a(!1,!1)});v.b("row",[v.a(1,function(a){d.registerDisposer(new h.a(b.display,a,e))})])(a);b.display.onResize();
return d}u(c,a);C(c,[{key:"disposed",value:function(){b.i(q.b)(this.rootElement);B(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"disposed",this).call(this)}}]);return c}(n.b);e.a=[["4panel",function(a,b){return new E(a,b)}],["xy-3d",function(a,b){return new y(a,b,"row")}],["xy",function(a,b){return new H(a,b)}],["3d",function(a,b){return new G(a,b)}]]},function(n,e,b){e.a=function(b){var e={antialias:!1,stencil:!0};b=b.getContext("webgl",e)||b.getContext("experimental-webgl",e);if(null==
b)throw Error("WebGL not supported.");b.memoize=new m.b;b.maxTextureSize=b.getParameter(b.MAX_TEXTURE_SIZE);b.maxTextureImageUnits=b.getParameter(b.MAX_TEXTURE_IMAGE_UNITS);b.tempTextureUnit=b.maxTextureImageUnits-1;b.WEBGL_draw_buffers=b.getExtension("WEBGL_draw_buffers");if(!b.WEBGL_draw_buffers)throw Error("WEBGL_draw_buffers extension not available");b.ANGLE_instanced_arrays=b.getExtension("ANGLE_instanced_arrays");if(!b.ANGLE_instanced_arrays)throw Error("ANGLE_instanced_ararys extension not available");
for(var e=$jscomp.makeIterator(["OES_texture_float","OES_element_index_uint"]),a=e.next();!a.done;a=e.next())if(a=a.value,!b.getExtension(a))throw Error(a+" extension not available");return b};var m=b(50)},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function r(a){var b=document.createElement("div");b.textContent=a.value;return b}e.a=function(a){var b=document.createElement("div");b.className="autocomplete-completion-with-description";b.textContent=a.value;var c=document.createElement("div");c.className="autocomplete-completion-description";c.textContent=a.description||
"";b.appendChild(c);return b};b.d(e,"b",function(){return F});n=b(22);var a=b.n(n),c=b(13);n=b(0);var l=b(8),p=b(89),w=b(36),v=b(170),k=b(172),h=b(3),g=b(94),d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}(),f=function B(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===
d){if(a=Object.getPrototypeOf(a),null!==a)return B(a,b,c)}else{if("value"in d)return d.value;b=d.get;return void 0===b?void 0:b.call(c)}};b(200);$jscomp.initSymbol();var q=Symbol("autocompleteIndex"),x=w.a.fromObject({arrowdown:{action:"cycle-next-active-completion"},arrowup:{action:"cycle-prev-active-completion"},tab:{action:"choose-active-completion-or-prefix",preventDefault:!1},enter:{action:"choose-active-completion",preventDefault:!1},escape:{action:"cancel",preventDefault:!1,stopPropagation:!1}}),
F=function(e){function n(d){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");var f=m(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));f.inputChanged=new h.b;f.prevInputValue="";f.completionsVisible=!1;f.activeCompletionPromise=null;f.activeCompletionCancellationToken=void 0;f.hasFocus=!1;f.completionResult=null;f.dropdownContentsStale=!0;f.updateHintScrollPositionTimer=null;f.completionElements=null;f.hasResultForDropdown=!1;f.commonPrefix="";f.activeIndex=
-1;f.dropdownStyleStale=!0;f.completer=d.completer;d=void 0===d.delay?200:d.delay;var e=f.scheduleUpdateCompletions=a()(function(){var a=f.activeCompletionCancellationToken=new c.a,b=f.activeCompletionPromise=f.completer(f.value,a);null!==b&&b.then(function(a){f.activeCompletionPromise===b&&(f.setCompletions(a),f.activeCompletionPromise=null)})},d);f.registerDisposer(function(){e.cancel()});d=f.element=document.createElement("div");d.className="autocomplete";var k=document.createElement("div");k.className=
"autocomplete-dropdown-wrapper";var l=f.dropdownElement=document.createElement("div");l.className="autocomplete-dropdown";var p=f.promptElement=document.createElement("label");p.className="autocomplete-prompt";var q=f.inputWrapperElement=document.createElement("div");q.className="autocomplete-input-wrapper";d.appendChild(p);var v=f.inputElement=document.createElement("input");v.type="text";v.autocomplete="off";v.spellcheck=!1;v.className="autocomplete-input";b.i(g.a)(p,v);p=f.hintElement=document.createElement("input");
p.type="text";p.spellcheck=!1;p.className="autocomplete-hint";p.disabled=!0;q.appendChild(p);q.appendChild(v);k.appendChild(q);k.appendChild(l);d.appendChild(k);f.registerInputHandler();f.handleInputChanged("");f.registerEventListener(f.inputElement,"focus",function(){f.hasFocus||(f.hasFocus=!0,f.dropdownStyleStale=!0,f.updateDropdown())});f.registerEventListener(f.inputElement,"blur",function(){f.hasFocus&&(f.hasFocus=!1,f.updateDropdown())});f.registerEventListener(d.ownerDocument.defaultView,"resize",
function(){f.dropdownStyleStale=!0});f.registerEventListener(d.ownerDocument.defaultView,"scroll",function(){f.dropdownStyleStale=!0});f.registerEventListener(f.dropdownElement,"mousedown",f.handleDropdownMousedown.bind(f));f.registerEventListener(f.inputElement,"keydown",function(){f.hintScrollPositionMayBeStale()});f.registerEventListener(f.inputElement,"mousemove",function(a){0!==a.buttons&&f.hintScrollPositionMayBeStale()});f.registerDisposer(new w.b(v,x)).allShortcutsAreGlobal=!0;b.i(w.c)(v,
"cycle-next-active-completion",function(){f.cycleActiveCompletion(1)});b.i(w.c)(v,"cycle-prev-active-completion",function(){f.cycleActiveCompletion(-1)});b.i(w.c)(v,"choose-active-completion-or-prefix",function(a){f.selectActiveCompletion(!0)&&a.preventDefault()});b.i(w.c)(v,"choose-active-completion",function(a){f.selectActiveCompletion(!1)&&a.preventDefault()});b.i(w.c)(v,"cancel",function(a){a.stopPropagation();f.cancel()&&(a.detail.preventDefault(),a.detail.stopPropagation())});return f}u(n,e);
d(n,[{key:"hintScrollPositionMayBeStale",value:function(){""!==this.hintElement.value&&this.scheduleUpdateHintScrollPosition()}},{key:"handleDropdownMousedown",value:function(a){this.inputElement.focus();for(var b=this.dropdownElement,c=a.target;c instanceof HTMLElement;c=c.parentElement){var d=c[q];if(void 0!==d){this.selectCompletion(d);break}if(c===b)break}a.preventDefault()}},{key:"cycleActiveCompletion",value:function(a){if(null!==this.completionResult){var b=this.activeIndex,c=this.completionResult.completions.length;
this.setActiveIndex(-1===b?0<a?0:c-1:(b+a+c)%c)}}},{key:"registerInputHandler",value:function(){for(var a=this,b=function(b){b=a.inputElement.value;b!==a.prevInputValue&&(a.prevInputValue=b,a.handleInputChanged(b))},c=$jscomp.makeIterator(["input"]),d=c.next();!d.done;d=c.next())this.registerEventListener(this.inputElement,d.value,b,!1)}},{key:"shouldShowDropdown",value:function(){return null!==this.completionResult&&this.hasFocus?this.hasResultForDropdown:!1}},{key:"updateDropdownStyle",value:function(){var a=
this.dropdownElement,c=this.inputElement;b.i(p.a)(a,c,{horizontal:!1});this.dropdownStyleStale=!1}},{key:"updateDropdown",value:function(){if(this.shouldShowDropdown()){var a=this.dropdownElement,c=this.activeIndex;if(this.dropdownContentsStale){var d=this.completionResult,f=void 0===d.makeElement?r:d.makeElement;this.completionElements=d.completions.map(function(b,e){b=f.call(d,b);b[q]=e;b.classList.add("autocomplete-completion");c===e&&b.classList.add("autocomplete-completion-active");a.appendChild(b);
return b});this.dropdownContentsStale=!1}this.dropdownStyleStale&&this.updateDropdownStyle();this.completionsVisible||(a.style.display="block",this.completionsVisible=!0);if(-1!==c){var e=this.completionElements[c];b.i(k.a)(e)}}else this.completionsVisible&&(this.dropdownElement.style.display="none",this.completionsVisible=!1)}},{key:"setCompletions",value:function(a){this.clearCompletions();var c=a.completions;0!==c.length&&(this.completionResult=a,1===c.length?(c=c[0],a.showSingleResult?this.hasResultForDropdown=
!0:c.value.startsWith(this.prevInputValue)?this.hasResultForDropdown=!1:this.hasResultForDropdown=!0,a.selectSingleResult?this.setActiveIndex(0):this.setHintValue(this.getCompletedValueByIndex(0))):(this.hasResultForDropdown=!0,c=b.i(v.a)(function(){function b(b,g){for(;;)switch(c){case 0:e=$jscomp.makeIterator(a.completions),f=e.next();case 1:if(f.done){c=3;break}d=f.value;c=4;return{value:d.value,done:!1};case 4:if(void 0===g){c=5;break}c=-1;throw g;case 5:case 2:f=e.next();c=1;break;case 3:c=-1;
default:return{value:void 0,done:!0}}}var c=0,d,f,e,g={next:function(a){return b(a,void 0)},throw:function(a){return b(void 0,a)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();g[Symbol.iterator]=function(){return this};return g}()),c=this.getCompletedValue(c),c.startsWith(this.prevInputValue)&&(this.commonPrefix=c,this.setHintValue(c))),this.updateDropdown())}},{key:"scheduleUpdateHintScrollPosition",value:function(){var a=this;null===this.updateHintScrollPositionTimer&&
(this.updateHintScrollPositionTimer=setTimeout(function(){a.updateHintScrollPosition()},0))}},{key:"setHintValue",value:function(a){var b=this.prevInputValue;a!==b&&a.startsWith(b)||(a="");this.hintElement.value=a;this.scheduleUpdateHintScrollPosition()}},{key:"setActiveIndex",value:function(a){if(!this.dropdownContentsStale){var c=this.activeIndex;-1!==c&&this.completionElements[c].classList.remove("autocomplete-completion-active");-1!==a&&(c=this.completionElements[a],c.classList.add("autocomplete-completion-active"),
b.i(k.a)(c))}-1!==a&&this.setHintValue(this.getCompletedValueByIndex(a));this.activeIndex=a}},{key:"getCompletedValueByIndex",value:function(a){return this.getCompletedValue(this.completionResult.completions[a].value)}},{key:"getCompletedValue",value:function(a){return this.prevInputValue.substring(0,this.completionResult.offset)+a}},{key:"selectActiveCompletion",value:function(a){var b=this.activeIndex;if(-1===b){if(!a)return!1;a=this.completionResult;if(null!==a&&1===a.completions.length)b=0;else return a=
this.commonPrefix,a.length>this.value.length?(this.value=a,!0):!1}a=this.getCompletedValueByIndex(b);if(this.value===a)return!1;this.value=a;return!0}},{key:"selectCompletion",value:function(a){this.value=this.getCompletedValueByIndex(a)}},{key:"cancel",value:function(){return!1}},{key:"updateHintScrollPosition",value:function(){this.updateHintScrollPositionTimer=null;this.hintElement.scrollLeft=this.inputElement.scrollLeft}},{key:"cancelActiveCompletion",value:function(){var a=this.activeCompletionCancellationToken;
void 0!==a&&a.cancel();this.activeCompletionCancellationToken=void 0;this.activeCompletionPromise=null}},{key:"handleInputChanged",value:function(a){this.cancelActiveCompletion();this.hintElement.value="";this.clearCompletions();this.inputChanged.dispatch(a);this.scheduleUpdateCompletions()}},{key:"clearCompletions",value:function(){null!==this.completionResult&&(this.activeIndex=-1,this.completionElements=this.completionResult=null,this.dropdownStyleStale=this.dropdownContentsStale=!0,this.commonPrefix=
"",b.i(l.b)(this.dropdownElement),this.updateDropdown())}},{key:"disposed",value:function(){b.i(l.a)(this.element);this.cancelActiveCompletion();null!==this.updateHintScrollPositionTimer&&(clearTimeout(this.updateHintScrollPositionTimer),this.updateHintScrollPositionTimer=null);f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"disposed",this).call(this)}},{key:"disabled",get:function(){return this.inputElement.disabled},set:function(a){this.inputElement.disabled=a}},{key:"value",get:function(){return this.prevInputValue},
set:function(a){a!==this.prevInputValue&&(this.prevInputValue=this.inputElement.value=a,this.handleInputChanged(a))}}]);return n}(n.b)},function(n,e,b){e.a=function(){var b=document.createElement("button");b.type="submit";b.className="hidden-submit-button";b.style.margin="0";b.style.border="0";b.style.padding="0";b.style.width="0";b.style.height="0";b.style.overflow="hidden";b.tabIndex=-1;return b}},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return p});n=b(0);var r=b(8),a=b(3),c=function(){function a(a,b){for(var c=0;c<b.length;c++){var e=b[c];e.enumerable=
e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}(),l=function v(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),null!==a)return v(a,b,c)}else{if("value"in d)return d.value;b=d.get;return void 0===b?void 0:b.call(c)}};b(21);b(201);var p=function(e){function k(b,c){if(!(this instanceof k))throw new TypeError("Cannot call a class as a function");
var d=m(this,(k.__proto__||Object.getPrototypeOf(k)).call(this));d.pointList=b;d.selectionIndex=c;d.element=document.createElement("div");d.clearButton=document.createElement("button");d.itemContainer=document.createElement("div");d.generation=-1;d.pointSelected=new a.b;d.visible_=!1;c=d.element;var f=d.clearButton,e=d.itemContainer;c.className="neuroglancer-point-list-widget";f.className="neuroglancer-clear-button";f.textContent="Delete all points";d.registerEventListener(f,"click",function(){d.pointList.reset()});
e.className="neuroglancer-item-container neuroglancer-select-text";c.appendChild(f);c.appendChild(e);d.registerDisposer(b.changed.add(function(){d.maybeUpdate()}));return d}u(k,e);c(k,[{key:"maybeUpdate",value:function(){var a=this;if(this.visible_){var c=this.pointList;if(this.generation!==c.generation){this.generation=c.generation;var d=this.itemContainer;b.i(r.b)(d);for(var f=c.length,c=c.points.data,e={i:0};e.i<f;e={i:e.i},++e.i){var k=document.createElement("div");k.className="neuroglancer-point-list-item";
var l=3*e.i;k.textContent=Math.round(c[l])+" "+Math.round(c[l+1])+" "+Math.round(c[l+2]);k.addEventListener("click",function(b){return function(){a.pointSelected.dispatch(b.i)}}(e));k.addEventListener("mouseenter",function(b){return function(){a.selectionIndex.value=b.i}}(e));k.addEventListener("mouseleave",function(){a.selectionIndex.value=null});d.appendChild(k)}}}}},{key:"disposed",value:function(){b.i(r.a)(this.element);this.clearButton=this.itemContainer=this.element=void 0;l(k.prototype.__proto__||
Object.getPrototypeOf(k.prototype),"disposed",this).call(this)}},{key:"visible",get:function(){return this.visible_},set:function(a){this.visible_!==a&&(this.visible_=a,!0===a&&this.maybeUpdate())}}]);return k}(n.b)},function(n,e,b){function m(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function u(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,
b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"b",function(){return x});b.d(e,"a",function(){return F});b.d(e,"c",function(){return C});var a=b(24),c=b(160),l=b(88);n=b(0);var p=b(8),w=b(15),v=b(1),k=b(36),h=b(90),g=b(95),d=function(){function a(a,
b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}(),f=function z(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),null!==a)return z(a,b,c)}else{if("value"in d)return d.value;b=d.get;return void 0===b?void 0:b.call(c)}};b(202);var q=w.a.fromObject({tab:{action:"tab-forward",
preventDefault:!1},arrowup:{action:"adjust-up"},arrowdown:{action:"adjust-down"},wheel:{action:"adjust-via-wheel"},"shift+tab":{action:"tab-backward",preventDefault:!1},backspace:{action:"delete-backward",preventDefault:!1},escape:{action:"cancel"},mouseup0:{action:"select-all-if-was-not-focused",preventDefault:!1}}),x=function(e){function g(d,f,e){e=void 0===e?6:e;m(this,g);var p=u(this,(g.__proto__||Object.getPrototypeOf(g)).call(this));p.element=d;p.position=f;p.maxNumberWidth=e;p.inputContainer=
document.createElement("div");p.inputElement=document.createElement("input");p.hintElement=document.createElement("input");p.tempPosition=v.a.create();p.updateHintScrollPosition=p.registerCancellable(b.i(c.a)(function(){p.hintElement.scrollLeft=p.inputElement.scrollLeft}));var n=p.inputElement,r=p.hintElement,x=p.inputContainer;x.className="neuroglancer-position-widget-input-container";n.className="neuroglancer-position-widget-input";r.className="neuroglancer-position-widget-hint";p.inputFieldWidth=
3*e+11;e=$jscomp.makeIterator([n,r]);for(var y=e.next();!y.done;y=e.next())y=y.value,y.spellcheck=!1,y.autocomplete="off",y.type="text",y.style.width=p.inputFieldWidth+"ch";r.disabled=!0;e=document.createElement("button");e.textContent="\u29c9";e.className="neuroglancer-copy-button";e.title="Copy position to clipboard";e.addEventListener("click",function(){var c=b.i(l.b)(p.getPositionText());a.a.showTemporaryMessage(c?"Position copied to clipboard":"Failed to copy position to clipboard")});d.appendChild(e);
d.appendChild(x);x.appendChild(r);x.appendChild(n);d.className="neuroglancer-position-widget";p.registerDisposer(f.changed.add(p.registerCancellable(b.i(c.a)(function(){return p.updateView()}))));p.registerDisposer(new k.b(n,q)).allShortcutsAreGlobal=!0;p.registerDisposer(new h.a(n,q));p.registerEventListener(n,"change",function(){return p.updatePosition()});p.registerEventListener(n,"blur",function(){return p.updatePosition()});p.registerEventListener(n,"input",function(){return p.cleanInput()});
p.registerEventListener(n,"keydown",p.updateHintScrollPosition);var z=!1;p.registerEventListener(n,"mousedown",function(){z=document.activeElement===n});p.registerDisposer(b.i(w.b)(n,"select-all-if-was-not-focused",function(a){z||(n.selectionStart=0,n.selectionEnd=n.value.length,n.selectionDirection="forward",a.preventDefault())}));p.registerDisposer(b.i(w.b)(n,"tab-forward",function(a){var b=Math.min(n.selectionStart,n.selectionEnd),c=n.value.substring(b).match(/^([^,\s]*)((?:\s+)|(?:\s*,\s*))?([^,\s]*)/);
null!==c&&void 0!==c[2]&&(n.selectionStart=b+c[1].length+c[2].length,n.selectionEnd=n.selectionStart+c[3].length,n.selectionDirection="forward",a.preventDefault())}));p.registerDisposer(b.i(w.b)(n,"tab-backward",function(a){var b=n.value.substring(0,Math.max(n.selectionStart,n.selectionEnd)).match(/([^,\s]*)((?:\s+)|(?:\s*,\s*))?([^,\s]*)$/);null!==b&&void 0!==b[2]&&(n.selectionStart=b.index,n.selectionEnd=n.selectionStart+b[1].length,n.selectionDirection="forward",a.preventDefault())}));p.registerDisposer(b.i(w.b)(n,
"delete-backward",function(a){if(n.selectionStart===n.selectionEnd&&n.selectionStart===n.value.length){var b=n.value.match(/^(.*)(?![\s])(?:(?:\s+)|(?:\s*,\s*))$/);null!==b&&(n.value=b[1],p.cleanInput(),a.preventDefault())}}));p.registerDisposer(b.i(w.b)(n,"cancel",function(){p.updateView();p.inputElement.blur()}));p.registerDisposer(b.i(w.b)(n,"adjust-via-wheel",function(a){a=a.detail;var b=a.deltaY;0!==b&&p.adjustFromCursor(Math.ceil((n.scrollLeft+a.offsetX-n.clientLeft)/(n.scrollWidth/p.inputFieldWidth)),
-Math.sign(b))}));p.registerDisposer(b.i(w.b)(n,"adjust-up",function(){p.adjustFromCursor(void 0,1)}));p.registerDisposer(b.i(w.b)(n,"adjust-down",function(){p.adjustFromCursor(void 0,-1)}));return p}r(g,e);d(g,[{key:"adjustFromCursor",value:function(a,b){var c=this.inputElement;void 0===a&&(a="forward"===c.selectionDirection?c.selectionEnd:c.selectionStart);void 0!==this.cleanInput()&&(a=c.value.substring(0,a).split(",").length-1,this.updatePosition(),c=this.tempPosition,this.position.getVoxelCoordinates(c)&&
(c[a]+=b,this.position.setVoxelCoordinates(c),this.updateView()))}},{key:"cleanInput",value:function(){var a=this.inputElement.selectionStart,b=/(-?\d+(?:\.(?:\d+)?)?)/.source,c=/((?:\s+(?![\s,]))|(?:\s*,\s*))/.source,d=/([\[\]{}()\s]*)/.source,b=this.inputElement.value.match(new RegExp("^"+d+"(?![\\s])"+b+"?"+("(?:"+c+b+"?(?:"+c+b+"?)?)?")+(d+"$")));if(null!==b){var f="  ",e="x ",g=2,h=b[1].length,c=function(b,c,d){if(void 0!==b){var k=h+b.length;void 0===c&&(c=b,d=" ".repeat(c.length));a>=h&&(g=
a===k?f.length+c.length:f.length+Math.min(c.length,a-h));f+=c;e+=d;h=k}};c(b[2]);c(b[3],",   ","  y ");c(b[4]);c(b[5],",   ","  z ");c(b[6]);this.hintElement.value=e;this.inputElement.value!==f&&(this.inputElement.value=f,this.inputElement.selectionEnd=g,this.inputElement.selectionStart=g);this.updateHintScrollPosition();return void 0!==b[2]&&void 0!==b[4]&&void 0!==b[6]?{position:v.a.set(this.tempPosition,parseFloat(b[2]),parseFloat(b[4]),parseFloat(b[6]))}:{}}this.hintElement.value=""}},{key:"updatePosition",
value:function(){var a=this.cleanInput();void 0!==a&&void 0!==a.position&&this.position.setVoxelCoordinates(a.position)}},{key:"getPositionText",value:function(){var a=this.tempPosition;return this.position.getVoxelCoordinates(a)?Math.floor(a[0])+", "+Math.floor(a[1])+", "+Math.floor(a[2]):"<unspecified position>"}},{key:"updateView",value:function(){var a=this.tempPosition;if(this.position.getVoxelCoordinates(a)){var b=this.inputElement,a="  "+Math.floor(a[0])+",   "+Math.floor(a[1])+",   "+Math.floor(a[2]),
c=a.indexOf(","),d=a.indexOf(",",c+1)-c-4,c="x "+" ".repeat(c-2)+"  y "+" ".repeat(d)+"  z",d=b.selectionStart,f=b.selectionEnd,e=b.selectionDirection;b.value=a;b.setSelectionRange(d,f,e);this.hintElement.value=c+" ".repeat(a.length-c.length);this.updateHintScrollPosition()}else this.inputElement.value="",this.hintElement.value=""}},{key:"disposed",value:function(){b.i(p.a)(this.element);f(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"disposed",this).call(this)}}]);return g}(n.b),F=function(a){function e(a,
d){m(this,e);var f=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));f.element=a;f.voxelSize=d;f.dimensionsContainer=document.createElement("span");f.unitsElement=document.createElement("span");var g=f.dimensionsContainer,h=f.unitsElement;a.className="neuroglancer-voxel-size-widget";a.title="Voxel size";g.className="neuroglancer-voxel-size-dimensions-container";a.appendChild(g);a.appendChild(h);h.className="neuroglancer-voxel-size-units";f.registerDisposer(d.changed.add(f.registerCancellable(b.i(c.a)(function(){return f.updateView()}))));
return f}r(e,a);d(e,[{key:"updateView",value:function(){var a=this.dimensionsContainer,c=this.unitsElement;b.i(p.b)(a);this.element.style.visibility=this.voxelSize.valid?"visible":"hidden";var d=this.voxelSize.size,f=Math.min(d[0],d[1],d[2]),f=b.i(g.a)(f);c.textContent=f.unit;for(c=0;3>c;++c){for(var e=d[c]/f.lengthInNanometers,h="",k=0;2>=k&&(h=e.toFixed(k),parseFloat(h)!==e);++k);e=document.createElement("span");e.className="neuroglancer-voxel-size-dimension";e.textContent=h;a.appendChild(e)}}},
{key:"disposed",value:function(){b.i(p.a)(this.element);f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disposed",this).call(this)}}]);return e}(n.b),C=function(a){function e(a,d,f){m(this,e);var g=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));g.element=a;g.mouseState=d;g.voxelSize=f;g.tempPosition=v.a.create();a.className="neuroglancer-mouse-position-widget";a=g.registerCancellable(b.i(c.a)(function(){return g.updateView()}));g.registerDisposer(d.changed.add(a));g.registerDisposer(f.changed.add(a));
return g}r(e,a);d(e,[{key:"updateView",value:function(){var a="",b=this.mouseState,c=this.voxelSize;b.active&&c.valid&&(a=this.tempPosition,c.voxelFromSpatial(a,b.position),a="x "+Math.floor(a[0])+",  y "+Math.floor(a[1])+",  z "+Math.floor(a[2]));this.element.textContent=a}},{key:"disposed",value:function(){b.i(p.a)(this.element);f(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disposed",this).call(this)}}]);return e}(n.b)},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return l});n=b(0);e=b(11);var r=function(){function a(a,b){for(var c=0;c<b.length;c++){var e=b[c];e.enumerable=
e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}(),a=function w(a,b,c){null===a&&(a=Function.prototype);var e=Object.getOwnPropertyDescriptor(a,b);if(void 0===e){if(a=Object.getPrototypeOf(a),null!==a)return w(a,b,c)}else{if("value"in e)return e.value;b=e.get;return void 0===b?void 0:b.call(c)}};b(21);b(205);var c=new e.a,l=function(b){function e(a){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");
var b=m(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));b.displayState=a;b.element=document.createElement("div");b.clearButton=document.createElement("button");b.itemContainer=document.createElement("span");b.items=new Map;var c=b.element,d=b.clearButton,f=b.itemContainer;c.className="segment-set-widget neuroglancer-noselect";d.className="clear-button";d.title="Remove all segment IDs";b.registerEventListener(d,"click",function(){b.visibleSegments.clear()});f.className="item-container";c.appendChild(f);
f.appendChild(d);b.registerDisposer(a.visibleSegments.changed.add(function(a,c){b.handleSetChanged(a,c)}));b.registerDisposer(a.segmentColorHash.changed.add(function(){b.handleColorChanged()}));a=$jscomp.makeIterator(a.visibleSegments);for(c=a.next();!c.done;c=a.next())b.addElement(c.value.toString());b.updateClearButtonVisibility();return b}u(e,b);r(e,[{key:"updateClearButtonVisibility",value:function(){this.clearButton.style.display=0<this.displayState.visibleSegments.size?"":"none"}},{key:"handleSetChanged",
value:function(a,b){this.updateClearButtonVisibility();var c=this.items;if(null===a){a=this.itemContainer;for(b=this.clearButton;;){var d=a.lastElementChild;if(d===b)break;a.removeChild(d)}c.clear()}else b?this.addElement(a.toString()):(a=a.toString(),b=c.get(a),b.parentElement.removeChild(b),c.delete(a))}},{key:"addElement",value:function(a){var b=document.createElement("button");b.className="segment-button";b.textContent=a;b.title="Remove segment ID "+a;var e=this;b.addEventListener("click",function(){c.tryParseString(this.textContent);
e.visibleSegments.delete(c)});b.addEventListener("mouseenter",function(){c.tryParseString(this.textContent);e.segmentSelectionState.set(c)});b.addEventListener("mouseleave",function(){c.tryParseString(this.textContent);e.segmentSelectionState.set(null)});this.setItemColor(b);this.itemContainer.appendChild(b);this.items.set(a,b)}},{key:"setItemColor",value:function(a){c.tryParseString(a.textContent);a.style.backgroundColor=this.segmentColorHash.computeCssColor(c)}},{key:"handleColorChanged",value:function(){var a=
this;this.items.forEach(function(b){a.setItemColor(b)})}},{key:"disposed",value:function(){var b=this.element,c=b.parentElement;c&&c.removeChild(b);a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disposed",this).call(this)}},{key:"visibleSegments",get:function(){return this.displayState.visibleSegments}},{key:"segmentColorHash",get:function(){return this.displayState.segmentColorHash}},{key:"segmentSelectionState",get:function(){return this.displayState.segmentSelectionState}}]);return e}(n.b)},
function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,
"a",function(){return w});n=b(0);var r=b(8),a=b(3),c=b(11),l=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}(),p=function k(a,b,c){null===a&&(a=Function.prototype);var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),null!==a)return k(a,b,c)}else{if("value"in d)return d.value;
b=d.get;return void 0===b?void 0:b.call(c)}};b(21);b(207);var w=function(e){function h(){if(!(this instanceof h))throw new TypeError("Cannot call a class as a function");var b=m(this,(h.__proto__||Object.getPrototypeOf(h)).call(this));b.element=document.createElement("form");b.label=document.createElement("label");b.input=document.createElement("input");b.value=new c.a;b.valueEntered=new a.b;var d=b.element,e=b.label,k=b.input;d.className="uint64-entry neuroglancer-noselect";d.appendChild(e);e.appendChild(k);
b.registerEventListener(d,"submit",function(a){a.preventDefault();b.validateInput()&&(b.input.value="",b.input.classList.remove("valid-input","invalid-input"),b.valueEntered.dispatch(b.value))});b.registerEventListener(d,"input",function(){""===b.input.value?b.input.classList.remove("valid-input","invalid-input"):b.validateInput()?b.input.classList.remove("invalid-input"):b.input.classList.add("invalid-input")});return b}u(h,e);l(h,[{key:"validateInput",value:function(){return this.value.tryParseString(this.input.value)}},
{key:"disposed",value:function(){b.i(r.a)(this.element);p(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"disposed",this).call(this)}}]);return h}(n.b)},function(n,e,b){function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function u(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&
b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}b.d(e,"a",function(){return w});n=b(0);var r=b(1),a=b(2),c=b(3),l=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}(),p=function k(a,b,c){null===a&&(a=Function.prototype);
var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){if(a=Object.getPrototypeOf(a),null!==a)return k(a,b,c)}else{if("value"in d)return d.value;b=d.get;return void 0===b?void 0:b.call(c)}};b(208);var w=function(e){function h(a){if(!(this instanceof h))throw new TypeError("Cannot call a class as a function");var b=m(this,(h.__proto__||Object.getPrototypeOf(h)).call(this));b.model=a;b.promptElement=document.createElement("span");b.element=document.createElement("label");b.inputx=document.createElement("input");
b.inputy=document.createElement("input");b.inputz=document.createElement("input");b.valueEntered=new c.b;a=b.inputx;var e=b.inputy,g=b.inputz,k=b.element,l=b.promptElement;k.className="vec3-input-row";l.className="vec3-input-label";k.appendChild(l);k.appendChild(a);k.appendChild(e);k.appendChild(g);a.type=e.type=g.type="number";b.updateInput();k=function(){b.model.value=b.getVec3Values()};b.registerEventListener(a,"change",k);b.registerEventListener(e,"change",k);b.registerEventListener(g,"change",
k);b.model.changed.add(function(){b.updateInput()});return b}u(h,e);l(h,[{key:"getVec3Values",value:function(){var a=r.a.create();a[0]=this.verifyValue(this.inputx.valueAsNumber);a[1]=this.verifyValue(this.inputy.valueAsNumber);a[2]=this.verifyValue(this.inputz.valueAsNumber);return a}},{key:"verifyValue",value:function(c){return b.i(a.j)(c)}},{key:"updateInput",value:function(){this.inputx.valueAsNumber=this.model.value[0];this.inputy.valueAsNumber=this.model.value[1];this.inputz.valueAsNumber=this.model.value[2]}},
{key:"disposed",value:function(){var a=this.inputx,b=this.inputy,c=this.inputz,e=this.element;a.parentElement&&a.parentElement.removeChild(a);b.parentElement&&b.parentElement.removeChild(b);c.parentElement&&c.parentElement.removeChild(c);e.parentElement&&e.parentElement.removeChild(e);p(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"disposed",this).call(this)}}]);return h}(n.b)},function(n,e,b){(function(b){function e(a,c){function d(a){if(!e.parentNode)return b.off(document,"mousemove",
d);e.style.top=Math.max(0,a.clientY-e.offsetHeight-5)+"px";e.style.left=a.clientX+5+"px"}var e=document.createElement("div");e.className="CodeMirror-lint-tooltip";e.appendChild(c.cloneNode(!0));document.body.appendChild(e);b.on(document,"mousemove",d);d(a);null!=e.style.opacity&&(e.style.opacity=1);return e}function m(a){a.parentNode&&(null==a.style.opacity&&a.parentNode&&a.parentNode.removeChild(a),a.style.opacity=0,setTimeout(function(){a.parentNode&&a.parentNode.removeChild(a)},600))}function a(a,
c,g){function d(){b.off(g,"mouseout",d);f&&(m(f),f=null)}var f=e(a,c),h=setInterval(function(){if(f)for(var a=g;;a=a.parentNode){a&&11==a.nodeType&&(a=a.host);if(a==document.body)return;if(!a){d();break}}if(!f)return clearInterval(h)},400);b.on(g,"mouseout",d)}function c(b,c,e){this.marked=[];this.options=c;this.timeout=null;this.hasGutter=e;this.onMouseOver=function(c){var d=c.target||c.srcElement;if(/\bCodeMirror-lint-mark-/.test(d.className)){for(var d=d.getBoundingClientRect(),e=b.findMarksAt(b.coordsChar({left:(d.left+
d.right)/2,top:(d.top+d.bottom)/2},"client")),d=[],f=0;f<e.length;++f){var g=e[f].__annotation;g&&d.push(g)}if(d.length){e=c.target||c.srcElement;f=document.createDocumentFragment();for(g=0;g<d.length;g++)f.appendChild(n(d[g]));a(c,f,e)}}};this.waitingFor=0}function l(a){var b=a.state.lint;b.hasGutter&&a.clearGutter("CodeMirror-lint-markers");for(a=0;a<b.marked.length;++a)b.marked[a].clear();b.marked.length=0}function p(c,e,g,h){var d=document.createElement("div"),f=d;d.className="CodeMirror-lint-marker-"+
e;g&&(f=d.appendChild(document.createElement("div")),f.className="CodeMirror-lint-marker-multiple");if(0!=h)b.on(f,"mouseover",function(b){a(b,c,f)});return d}function n(a){var b=a.severity;b||(b="error");var c=document.createElement("div");c.className="CodeMirror-lint-message-"+b;"undefined"!=typeof a.messageHTML?c.innerHTML=a.messageHTML:c.appendChild(document.createTextNode(a.message));return c}function v(a,c,e){function d(){g=-1;a.off("change",d)}var f=a.state.lint,g=++f.waitingFor;a.on("change",
d);c(a.getValue(),function(c,e){a.off("change",d);f.waitingFor==g&&(e&&c instanceof b&&(c=e),h(a,c))},e,a)}function k(a){var c=a.state.lint.options,d=c.options||c,e=c.getAnnotations||a.getHelper(b.Pos(0,0),"lint");e&&(c.async||e.async?v(a,e,d):(c=e(a.getValue(),d,a))&&(c.then?c.then(function(b){h(a,b)}):h(a,c)))}function h(a,b){l(a);for(var c=a.state.lint,d=c.options,e=[],f=0;f<b.length;++f){var g=b[f],h=g.from.line;(e[h]||(e[h]=[])).push(g)}for(f=0;f<e.length;++f)if(g=e[f]){for(var h=null,k=c.hasGutter&&
document.createDocumentFragment(),m=0;m<g.length;++m){var r=g[m],v=r.severity;v||(v="error");"error"!=h&&(h=v);d.formatAnnotation&&(r=d.formatAnnotation(r));c.hasGutter&&k.appendChild(n(r));r.to&&c.marked.push(a.markText(r.from,r.to,{className:"CodeMirror-lint-mark-"+v,__annotation:r}))}c.hasGutter&&a.setGutterMarker(f,"CodeMirror-lint-markers",p(k,h,1<g.length,c.options.tooltips))}if(d.onUpdateLinting)d.onUpdateLinting(b,e,a)}function g(a){var b=a.state.lint;b&&(clearTimeout(b.timeout),b.timeout=
setTimeout(function(){k(a)},b.options.delay||500))}b.defineOption("lint",!1,function(a,e,h){h&&h!=b.Init&&(l(a),!1!==a.state.lint.options.lintOnChange&&a.off("change",g),b.off(a.getWrapperElement(),"mouseover",a.state.lint.onMouseOver),clearTimeout(a.state.lint.timeout),delete a.state.lint);if(e){var d=a.getOption("gutters");h=!1;for(var f=0;f<d.length;++f)"CodeMirror-lint-markers"==d[f]&&(h=!0);d=a.state;e instanceof Function?e={getAnnotations:e}:e&&!0!==e||(e={});h=d.lint=new c(a,e,h);if(!1!==h.options.lintOnChange)a.on("change",
g);if(0!=h.options.tooltips&&"gutter"!=h.options.tooltips)b.on(a.getWrapperElement(),"mouseover",h.onMouseOver);k(a)}});b.defineExtension("performLint",function(){this.state.lint&&k(this)})})(b(96))},function(n,e){},function(n,e){},function(n,e){},function(n,e){},function(n,e){},function(n,e){},function(n,e){},function(n,e){},function(n,e){},function(n,e){},function(n,e){},function(n,e){},function(n,e){},function(n,e){},function(n,e){},function(n,e){},function(n,e){},function(n,e){},function(n,e){},
function(n,e){},function(n,e){},function(n,e){},function(n,e){},function(n,e,b){b(17)},function(n,e,b){b(17)},function(n,e,b){function m(a,b,e){var c=b[0],l=b[1],m=b[2],k=b[3],h=b[4],g=b[5],d=b[6],f=b[7],q=b[8],n=b[9],r=b[10],u=b[11],B=b[12],z=b[13],E=b[14];b=b[15];var y=e[0],H=e[1],G=e[2],J=e[3];a[0]=y*c+H*h+G*q+J*B;a[1]=y*l+H*g+G*n+J*z;a[2]=y*m+H*d+G*r+J*E;a[3]=y*k+H*f+G*u+J*b;y=e[4];H=e[5];G=e[6];J=e[7];a[4]=y*c+H*h+G*q+J*B;a[5]=y*l+H*g+G*n+J*z;a[6]=y*m+H*d+G*r+J*E;a[7]=y*k+H*f+G*u+J*b;y=e[8];
H=e[9];G=e[10];J=e[11];a[8]=y*c+H*h+G*q+J*B;a[9]=y*l+H*g+G*n+J*z;a[10]=y*m+H*d+G*r+J*E;a[11]=y*k+H*f+G*u+J*b;y=e[12];H=e[13];G=e[14];J=e[15];a[12]=y*c+H*h+G*q+J*B;a[13]=y*l+H*g+G*n+J*z;a[14]=y*m+H*d+G*r+J*E;a[15]=y*k+H*f+G*u+J*b;return a}function u(a,b,e){a[0]=b[0]-e[0];a[1]=b[1]-e[1];a[2]=b[2]-e[2];a[3]=b[3]-e[3];a[4]=b[4]-e[4];a[5]=b[5]-e[5];a[6]=b[6]-e[6];a[7]=b[7]-e[7];a[8]=b[8]-e[8];a[9]=b[9]-e[9];a[10]=b[10]-e[10];a[11]=b[11]-e[11];a[12]=b[12]-e[12];a[13]=b[13]-e[13];a[14]=b[14]-e[14];a[15]=
b[15]-e[15];return a}Object.defineProperty(e,"__esModule",{value:!0});e.create=function(){var a=new r.a(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};e.clone=function(a){var b=new r.a(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};e.copy=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=
b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};e.fromValues=function(a,b,e,p,m,n,k,h,g,d,f,q,u,F,C,B){var c=new r.a(16);c[0]=a;c[1]=b;c[2]=e;c[3]=p;c[4]=m;c[5]=n;c[6]=k;c[7]=h;c[8]=g;c[9]=d;c[10]=f;c[11]=q;c[12]=u;c[13]=F;c[14]=C;c[15]=B;return c};e.set=function(a,b,e,p,m,n,k,h,g,d,f,q,r,u,C,B,z){a[0]=b;a[1]=e;a[2]=p;a[3]=m;a[4]=n;a[5]=k;a[6]=h;a[7]=g;a[8]=d;a[9]=f;a[10]=q;a[11]=r;a[12]=u;
a[13]=C;a[14]=B;a[15]=z;return a};e.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};e.transpose=function(a,b){if(a===b){var c=b[1],e=b[2],m=b[3],n=b[6],k=b[7],h=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=c;a[6]=b[9];a[7]=b[13];a[8]=e;a[9]=n;a[11]=b[14];a[12]=m;a[13]=k;a[14]=h}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=
b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a};e.invert=function(a,b){var c=b[0],e=b[1],m=b[2],n=b[3],k=b[4],h=b[5],g=b[6],d=b[7],f=b[8],q=b[9],r=b[10],u=b[11],C=b[12],B=b[13],z=b[14];b=b[15];var E=c*h-e*k,y=c*g-m*k,H=c*d-n*k,G=e*g-m*h,J=e*d-n*h,D=m*d-n*g,S=f*B-q*C,I=f*z-r*C,P=f*b-u*C,U=q*z-r*B,V=q*b-u*B,L=r*b-u*z,Q=E*L-y*V+H*U+G*P-J*I+D*S;if(!Q)return null;Q=1/Q;a[0]=(h*L-g*V+d*U)*Q;a[1]=(m*V-e*L-n*U)*Q;a[2]=(B*D-z*J+b*G)*Q;a[3]=(r*J-q*D-u*G)*Q;a[4]=(g*P-k*L-d*I)*Q;a[5]=(c*L-m*P+n*
I)*Q;a[6]=(z*H-C*D-b*y)*Q;a[7]=(f*D-r*H+u*y)*Q;a[8]=(k*V-h*P+d*S)*Q;a[9]=(e*P-c*V-n*S)*Q;a[10]=(C*J-B*H+b*E)*Q;a[11]=(q*H-f*J-u*E)*Q;a[12]=(h*I-k*U-g*S)*Q;a[13]=(c*U-e*I+m*S)*Q;a[14]=(B*y-C*G-z*E)*Q;a[15]=(f*G-q*y+r*E)*Q;return a};e.adjoint=function(a,b){var c=b[0],e=b[1],m=b[2],n=b[3],k=b[4],h=b[5],g=b[6],d=b[7],f=b[8],q=b[9],r=b[10],u=b[11],C=b[12],B=b[13],z=b[14];b=b[15];a[0]=h*(r*b-u*z)-q*(g*b-d*z)+B*(g*u-d*r);a[1]=-(e*(r*b-u*z)-q*(m*b-n*z)+B*(m*u-n*r));a[2]=e*(g*b-d*z)-h*(m*b-n*z)+B*(m*d-n*g);
a[3]=-(e*(g*u-d*r)-h*(m*u-n*r)+q*(m*d-n*g));a[4]=-(k*(r*b-u*z)-f*(g*b-d*z)+C*(g*u-d*r));a[5]=c*(r*b-u*z)-f*(m*b-n*z)+C*(m*u-n*r);a[6]=-(c*(g*b-d*z)-k*(m*b-n*z)+C*(m*d-n*g));a[7]=c*(g*u-d*r)-k*(m*u-n*r)+f*(m*d-n*g);a[8]=k*(q*b-u*B)-f*(h*b-d*B)+C*(h*u-d*q);a[9]=-(c*(q*b-u*B)-f*(e*b-n*B)+C*(e*u-n*q));a[10]=c*(h*b-d*B)-k*(e*b-n*B)+C*(e*d-n*h);a[11]=-(c*(h*u-d*q)-k*(e*u-n*q)+f*(e*d-n*h));a[12]=-(k*(q*z-r*B)-f*(h*z-g*B)+C*(h*r-g*q));a[13]=c*(q*z-r*B)-f*(e*z-m*B)+C*(e*r-m*q);a[14]=-(c*(h*z-g*B)-k*(e*z-m*
B)+C*(e*g-m*h));a[15]=c*(h*r-g*q)-k*(e*r-m*q)+f*(e*g-m*h);return a};e.determinant=function(a){var b=a[0],e=a[1],p=a[2],m=a[3],n=a[4],k=a[5],h=a[6],g=a[7],d=a[8],f=a[9],q=a[10],r=a[11],u=a[12],C=a[13],B=a[14];a=a[15];return(b*k-e*n)*(q*a-r*B)-(b*h-p*n)*(f*a-r*C)+(b*g-m*n)*(f*B-q*C)+(e*h-p*k)*(d*a-r*u)-(e*g-m*k)*(d*B-q*u)+(p*g-m*h)*(d*C-f*u)};e.multiply=m;e.translate=function(a,b,e){var c=e[0],l=e[1];e=e[2];var m,k,h,g,d,f,q,n,r,u,B,z;b===a?(a[12]=b[0]*c+b[4]*l+b[8]*e+b[12],a[13]=b[1]*c+b[5]*l+b[9]*
e+b[13],a[14]=b[2]*c+b[6]*l+b[10]*e+b[14],a[15]=b[3]*c+b[7]*l+b[11]*e+b[15]):(m=b[0],k=b[1],h=b[2],g=b[3],d=b[4],f=b[5],q=b[6],n=b[7],r=b[8],u=b[9],B=b[10],z=b[11],a[0]=m,a[1]=k,a[2]=h,a[3]=g,a[4]=d,a[5]=f,a[6]=q,a[7]=n,a[8]=r,a[9]=u,a[10]=B,a[11]=z,a[12]=m*c+d*l+r*e+b[12],a[13]=k*c+f*l+u*e+b[13],a[14]=h*c+q*l+B*e+b[14],a[15]=g*c+n*l+z*e+b[15]);return a};e.scale=function(a,b,e){var c=e[0],l=e[1];e=e[2];a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*l;a[5]=b[5]*l;a[6]=b[6]*l;a[7]=b[7]*l;
a[8]=b[8]*e;a[9]=b[9]*e;a[10]=b[10]*e;a[11]=b[11]*e;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};e.rotate=function(a,b,e,p){var c=p[0],l=p[1];p=p[2];var k=Math.sqrt(c*c+l*l+p*p),h,g,d,f,m,n,u,C,B,z,E,y,H,G,J,D,S,I,P,U;if(Math.abs(k)<r.c)return null;k=1/k;c*=k;l*=k;p*=k;h=Math.sin(e);g=Math.cos(e);d=1-g;e=b[0];k=b[1];f=b[2];m=b[3];n=b[4];u=b[5];C=b[6];B=b[7];z=b[8];E=b[9];y=b[10];H=b[11];G=c*c*d+g;J=l*c*d+p*h;D=p*c*d-l*h;S=c*l*d-p*h;I=l*l*d+g;P=p*l*d+c*h;U=c*p*d+l*h;c=l*p*d-c*h;l=p*p*
d+g;a[0]=e*G+n*J+z*D;a[1]=k*G+u*J+E*D;a[2]=f*G+C*J+y*D;a[3]=m*G+B*J+H*D;a[4]=e*S+n*I+z*P;a[5]=k*S+u*I+E*P;a[6]=f*S+C*I+y*P;a[7]=m*S+B*I+H*P;a[8]=e*U+n*c+z*l;a[9]=k*U+u*c+E*l;a[10]=f*U+C*c+y*l;a[11]=m*U+B*c+H*l;b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);return a};e.rotateX=function(a,b,e){var c=Math.sin(e);e=Math.cos(e);var l=b[4],m=b[5],k=b[6],h=b[7],g=b[8],d=b[9],f=b[10],q=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=l*
e+g*c;a[5]=m*e+d*c;a[6]=k*e+f*c;a[7]=h*e+q*c;a[8]=g*e-l*c;a[9]=d*e-m*c;a[10]=f*e-k*c;a[11]=q*e-h*c;return a};e.rotateY=function(a,b,e){var c=Math.sin(e);e=Math.cos(e);var l=b[0],m=b[1],k=b[2],h=b[3],g=b[8],d=b[9],f=b[10],q=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=l*e-g*c;a[1]=m*e-d*c;a[2]=k*e-f*c;a[3]=h*e-q*c;a[8]=l*c+g*e;a[9]=m*c+d*e;a[10]=k*c+f*e;a[11]=h*c+q*e;return a};e.rotateZ=function(a,b,e){var c=Math.sin(e);e=Math.cos(e);var l=
b[0],m=b[1],k=b[2],h=b[3],g=b[4],d=b[5],f=b[6],q=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=l*e+g*c;a[1]=m*e+d*c;a[2]=k*e+f*c;a[3]=h*e+q*c;a[4]=g*e-l*c;a[5]=d*e-m*c;a[6]=f*e-k*c;a[7]=q*e-h*c;return a};e.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=b[0];a[13]=b[1];a[14]=b[2];a[15]=1;return a};e.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=
0;a[5]=b[1];a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=b[2];a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};e.fromRotation=function(a,b,e){var c=e[0],l=e[1];e=e[2];var m=Math.sqrt(c*c+l*l+e*e),k;if(Math.abs(m)<r.c)return null;m=1/m;c*=m;l*=m;e*=m;m=Math.sin(b);b=Math.cos(b);k=1-b;a[0]=c*c*k+b;a[1]=l*c*k+e*m;a[2]=e*c*k-l*m;a[3]=0;a[4]=c*l*k-e*m;a[5]=l*l*k+b;a[6]=e*l*k+c*m;a[7]=0;a[8]=c*e*k+l*m;a[9]=l*e*k-c*m;a[10]=e*e*k+b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};e.fromXRotation=function(a,b){var c=
Math.sin(b);b=Math.cos(b);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=c;a[7]=0;a[8]=0;a[9]=-c;a[10]=b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};e.fromYRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=0;a[2]=-c;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=c;a[9]=0;a[10]=b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};e.fromZRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=c;a[2]=0;a[3]=0;a[4]=-c;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=
0;a[13]=0;a[14]=0;a[15]=1;return a};e.fromRotationTranslation=function(a,b,e){var c=b[0],l=b[1],m=b[2],k=b[3],h=c+c,g=l+l,d=m+m;b=c*h;var f=c*g,c=c*d,q=l*g,l=l*d,m=m*d,h=k*h,g=k*g,k=k*d;a[0]=1-(q+m);a[1]=f+k;a[2]=c-g;a[3]=0;a[4]=f-k;a[5]=1-(b+m);a[6]=l+h;a[7]=0;a[8]=c+g;a[9]=l-h;a[10]=1-(b+q);a[11]=0;a[12]=e[0];a[13]=e[1];a[14]=e[2];a[15]=1;return a};e.getTranslation=function(a,b){a[0]=b[12];a[1]=b[13];a[2]=b[14];return a};e.getScaling=function(a,b){var c=b[0],e=b[1],m=b[2],n=b[4],k=b[5],h=b[6],g=
b[8],d=b[9];b=b[10];a[0]=Math.sqrt(c*c+e*e+m*m);a[1]=Math.sqrt(n*n+k*k+h*h);a[2]=Math.sqrt(g*g+d*d+b*b);return a};e.getRotation=function(a,b){var c=b[0]+b[5]+b[10];0<c?(c=2*Math.sqrt(c+1),a[3]=.25*c,a[0]=(b[6]-b[9])/c,a[1]=(b[8]-b[2])/c,a[2]=(b[1]-b[4])/c):b[0]>b[5]&b[0]>b[10]?(c=2*Math.sqrt(1+b[0]-b[5]-b[10]),a[3]=(b[6]-b[9])/c,a[0]=.25*c,a[1]=(b[1]+b[4])/c,a[2]=(b[8]+b[2])/c):b[5]>b[10]?(c=2*Math.sqrt(1+b[5]-b[0]-b[10]),a[3]=(b[8]-b[2])/c,a[0]=(b[1]+b[4])/c,a[1]=.25*c,a[2]=(b[6]+b[9])/c):(c=2*Math.sqrt(1+
b[10]-b[0]-b[5]),a[3]=(b[1]-b[4])/c,a[0]=(b[8]+b[2])/c,a[1]=(b[6]+b[9])/c,a[2]=.25*c);return a};e.fromRotationTranslationScale=function(a,b,e,p){var c=b[0],l=b[1],k=b[2],h=b[3],g=c+c,d=l+l,f=k+k;b=c*g;var m=c*d,c=c*f,n=l*d,l=l*f,k=k*f,g=h*g,d=h*d,h=h*f,f=p[0],r=p[1];p=p[2];a[0]=(1-(n+k))*f;a[1]=(m+h)*f;a[2]=(c-d)*f;a[3]=0;a[4]=(m-h)*r;a[5]=(1-(b+k))*r;a[6]=(l+g)*r;a[7]=0;a[8]=(c+d)*p;a[9]=(l-g)*p;a[10]=(1-(b+n))*p;a[11]=0;a[12]=e[0];a[13]=e[1];a[14]=e[2];a[15]=1;return a};e.fromRotationTranslationScaleOrigin=
function(a,b,e,p,m){var c=b[0],k=b[1],h=b[2],g=b[3],d=c+c,f=k+k,l=h+h;b=c*d;var n=c*f,c=c*l,r=k*f,k=k*l,h=h*l,d=g*d,f=g*f,g=g*l,l=p[0],u=p[1];p=p[2];var w=m[0],z=m[1];m=m[2];a[0]=(1-(r+h))*l;a[1]=(n+g)*l;a[2]=(c-f)*l;a[3]=0;a[4]=(n-g)*u;a[5]=(1-(b+h))*u;a[6]=(k+d)*u;a[7]=0;a[8]=(c+f)*p;a[9]=(k-d)*p;a[10]=(1-(b+r))*p;a[11]=0;a[12]=e[0]+w-(a[0]*w+a[4]*z+a[8]*m);a[13]=e[1]+z-(a[1]*w+a[5]*z+a[9]*m);a[14]=e[2]+m-(a[2]*w+a[6]*z+a[10]*m);a[15]=1;return a};e.fromQuat=function(a,b){var c=b[0],e=b[1],m=b[2];
b=b[3];var n=c+c,k=e+e,h=m+m,c=c*n,g=e*n,e=e*k,d=m*n,f=m*k,m=m*h,n=b*n,k=b*k;b*=h;a[0]=1-e-m;a[1]=g+b;a[2]=d-k;a[3]=0;a[4]=g-b;a[5]=1-c-m;a[6]=f+n;a[7]=0;a[8]=d+k;a[9]=f-n;a[10]=1-c-e;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};e.frustum=function(a,b,e,m,n,r,k){var c=1/(e-b),g=1/(n-m),d=1/(r-k);a[0]=2*r*c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*r*g;a[6]=0;a[7]=0;a[8]=(e+b)*c;a[9]=(n+m)*g;a[10]=(k+r)*d;a[11]=-1;a[12]=0;a[13]=0;a[14]=k*r*2*d;a[15]=0;return a};e.perspective=function(a,b,e,m,n){b=1/
Math.tan(b/2);var c=1/(m-n);a[0]=b/e;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(n+m)*c;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*n*m*c;a[15]=0;return a};e.perspectiveFromFieldOfView=function(a,b,e,m){var c=Math.tan(b.upDegrees*Math.PI/180),l=Math.tan(b.downDegrees*Math.PI/180),k=Math.tan(b.leftDegrees*Math.PI/180);b=Math.tan(b.rightDegrees*Math.PI/180);var h=2/(k+b),g=2/(c+l);a[0]=h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=g;a[6]=0;a[7]=0;a[8]=-((k-b)*h*.5);a[9]=(c-l)*g*.5;a[10]=m/(e-m);
a[11]=-1;a[12]=0;a[13]=0;a[14]=m*e/(e-m);a[15]=0;return a};e.ortho=function(a,b,e,m,n,r,k){var c=1/(b-e),g=1/(m-n),d=1/(r-k);a[0]=-2*c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*g;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*d;a[11]=0;a[12]=(b+e)*c;a[13]=(n+m)*g;a[14]=(k+r)*d;a[15]=1;return a};e.lookAt=function(a,b,e,m){var c,l,k,h,g,d,f,p,n=b[0],u=b[1];b=b[2];k=m[0];h=m[1];l=m[2];f=e[0];m=e[1];c=e[2];if(Math.abs(n-f)<r.c&&Math.abs(u-m)<r.c&&Math.abs(b-c)<r.c)return mat4.identity(a);e=n-f;m=u-m;f=b-c;p=1/Math.sqrt(e*
e+m*m+f*f);e*=p;m*=p;f*=p;c=h*f-l*m;l=l*e-k*f;k=k*m-h*e;(p=Math.sqrt(c*c+l*l+k*k))?(p=1/p,c*=p,l*=p,k*=p):k=l=c=0;h=m*k-f*l;g=f*c-e*k;d=e*l-m*c;(p=Math.sqrt(h*h+g*g+d*d))?(p=1/p,h*=p,g*=p,d*=p):d=g=h=0;a[0]=c;a[1]=h;a[2]=e;a[3]=0;a[4]=l;a[5]=g;a[6]=m;a[7]=0;a[8]=k;a[9]=d;a[10]=f;a[11]=0;a[12]=-(c*n+l*u+k*b);a[13]=-(h*n+g*u+d*b);a[14]=-(e*n+m*u+f*b);a[15]=1;return a};e.targetTo=function(a,b,e,m){var c=b[0],l=b[1];b=b[2];var k=m[0],h=m[1],g=m[2];m=c-e[0];var d=l-e[1];e=b-e[2];var f=m*m+d*d+e*e;0<f&&
(f=1/Math.sqrt(f),m*=f,d*=f,e*=f);f=h*e-g*d;g=g*m-k*e;k=k*d-h*m;a[0]=f;a[1]=g;a[2]=k;a[3]=0;a[4]=d*k-e*g;a[5]=e*f-m*k;a[6]=m*g-d*f;a[7]=0;a[8]=m;a[9]=d;a[10]=e;a[11]=0;a[12]=c;a[13]=l;a[14]=b;a[15]=1;return a};e.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};e.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],
2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};e.add=function(a,b,e){a[0]=b[0]+e[0];a[1]=b[1]+e[1];a[2]=b[2]+e[2];a[3]=b[3]+e[3];a[4]=b[4]+e[4];a[5]=b[5]+e[5];a[6]=b[6]+e[6];a[7]=b[7]+e[7];a[8]=b[8]+e[8];a[9]=b[9]+e[9];a[10]=b[10]+e[10];a[11]=b[11]+e[11];a[12]=b[12]+e[12];a[13]=b[13]+e[13];a[14]=b[14]+e[14];a[15]=b[15]+e[15];return a};
e.subtract=u;e.multiplyScalar=function(a,b,e){a[0]=b[0]*e;a[1]=b[1]*e;a[2]=b[2]*e;a[3]=b[3]*e;a[4]=b[4]*e;a[5]=b[5]*e;a[6]=b[6]*e;a[7]=b[7]*e;a[8]=b[8]*e;a[9]=b[9]*e;a[10]=b[10]*e;a[11]=b[11]*e;a[12]=b[12]*e;a[13]=b[13]*e;a[14]=b[14]*e;a[15]=b[15]*e;return a};e.multiplyScalarAndAdd=function(a,b,e,m){a[0]=b[0]+e[0]*m;a[1]=b[1]+e[1]*m;a[2]=b[2]+e[2]*m;a[3]=b[3]+e[3]*m;a[4]=b[4]+e[4]*m;a[5]=b[5]+e[5]*m;a[6]=b[6]+e[6]*m;a[7]=b[7]+e[7]*m;a[8]=b[8]+e[8]*m;a[9]=b[9]+e[9]*m;a[10]=b[10]+e[10]*m;a[11]=b[11]+
e[11]*m;a[12]=b[12]+e[12]*m;a[13]=b[13]+e[13]*m;a[14]=b[14]+e[14]*m;a[15]=b[15]+e[15]*m;return a};e.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]&&a[9]===b[9]&&a[10]===b[10]&&a[11]===b[11]&&a[12]===b[12]&&a[13]===b[13]&&a[14]===b[14]&&a[15]===b[15]};e.equals=function(a,b){var c=a[0],e=a[1],m=a[2],n=a[3],k=a[4],h=a[5],g=a[6],d=a[7],f=a[8],q=a[9],u=a[10],F=a[11],C=a[12],B=a[13],z=a[14];a=a[15];var E=
b[0],y=b[1],H=b[2],G=b[3],J=b[4],D=b[5],S=b[6],I=b[7],P=b[8],U=b[9],V=b[10],L=b[11],Q=b[12],W=b[13],X=b[14];b=b[15];return Math.abs(c-E)<=r.c*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(e-y)<=r.c*Math.max(1,Math.abs(e),Math.abs(y))&&Math.abs(m-H)<=r.c*Math.max(1,Math.abs(m),Math.abs(H))&&Math.abs(n-G)<=r.c*Math.max(1,Math.abs(n),Math.abs(G))&&Math.abs(k-J)<=r.c*Math.max(1,Math.abs(k),Math.abs(J))&&Math.abs(h-D)<=r.c*Math.max(1,Math.abs(h),Math.abs(D))&&Math.abs(g-S)<=r.c*Math.max(1,Math.abs(g),
Math.abs(S))&&Math.abs(d-I)<=r.c*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(f-P)<=r.c*Math.max(1,Math.abs(f),Math.abs(P))&&Math.abs(q-U)<=r.c*Math.max(1,Math.abs(q),Math.abs(U))&&Math.abs(u-V)<=r.c*Math.max(1,Math.abs(u),Math.abs(V))&&Math.abs(F-L)<=r.c*Math.max(1,Math.abs(F),Math.abs(L))&&Math.abs(C-Q)<=r.c*Math.max(1,Math.abs(C),Math.abs(Q))&&Math.abs(B-W)<=r.c*Math.max(1,Math.abs(B),Math.abs(W))&&Math.abs(z-X)<=r.c*Math.max(1,Math.abs(z),Math.abs(X))&&Math.abs(a-b)<=r.c*Math.max(1,Math.abs(a),
Math.abs(b))};var r=b(17);e.mul=m;e.sub=u},function(n,e,b){function m(){var a=new l.a(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a}function u(a,b,c){c*=.5;var d=Math.sin(c);a[0]=d*b[0];a[1]=d*b[1];a[2]=d*b[2];a[3]=Math.cos(c);return a}function r(a,b,c){var d=b[0],e=b[1],g=b[2];b=b[3];var h=c[0],k=c[1],l=c[2];c=c[3];a[0]=d*c+b*h+e*l-g*k;a[1]=e*c+b*k+g*h-d*l;a[2]=g*c+b*l+d*k-e*h;a[3]=b*c-d*h-e*k-g*l;return a}function a(a,b,c,d){var e=b[0],g=b[1],h=b[2];b=b[3];var k=c[0],l=c[1],m=c[2];c=c[3];var p,n,r;n=
e*k+g*l+h*m+b*c;0>n&&(n=-n,k=-k,l=-l,m=-m,c=-c);1E-6<1-n?(p=Math.acos(n),r=Math.sin(p),n=Math.sin((1-d)*p)/r,d=Math.sin(d*p)/r):n=1-d;a[0]=n*e+d*k;a[1]=n*g+d*l;a[2]=n*h+d*m;a[3]=n*b+d*c;return a}function c(a,b){var c=b[0]+b[4]+b[8];if(0<c)c=Math.sqrt(c+1),a[3]=.5*c,c=.5/c,a[0]=(b[5]-b[7])*c,a[1]=(b[6]-b[2])*c,a[2]=(b[1]-b[3])*c;else{var d=0;b[4]>b[0]&&(d=1);b[8]>b[3*d+d]&&(d=2);var e=(d+1)%3,h=(d+2)%3,c=Math.sqrt(b[3*d+d]-b[3*e+e]-b[3*h+h]+1);a[d]=.5*c;c=.5/c;a[3]=(b[3*e+h]-b[3*h+e])*c;a[e]=(b[3*
e+d]+b[3*d+e])*c;a[h]=(b[3*h+d]+b[3*d+h])*c}return a}Object.defineProperty(e,"__esModule",{value:!0});e.create=m;e.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};e.setAxisAngle=u;e.getAxisAngle=function(a,b){var c=2*Math.acos(b[3]),d=Math.sin(c/2);0!=d?(a[0]=b[0]/d,a[1]=b[1]/d,a[2]=b[2]/d):(a[0]=1,a[1]=0,a[2]=0);return c};e.multiply=r;e.rotateX=function(a,b,c){c*=.5;var d=b[0],e=b[1],g=b[2];b=b[3];var h=Math.sin(c);c=Math.cos(c);a[0]=d*c+b*h;a[1]=e*c+g*h;a[2]=g*c-e*h;a[3]=b*c-d*h;return a};
e.rotateY=function(a,b,c){c*=.5;var d=b[0],e=b[1],g=b[2];b=b[3];var h=Math.sin(c);c=Math.cos(c);a[0]=d*c-g*h;a[1]=e*c+b*h;a[2]=g*c+d*h;a[3]=b*c-e*h;return a};e.rotateZ=function(a,b,c){c*=.5;var d=b[0],e=b[1],g=b[2];b=b[3];var h=Math.sin(c);c=Math.cos(c);a[0]=d*c+e*h;a[1]=e*c-d*h;a[2]=g*c+b*h;a[3]=b*c-g*h;return a};e.calculateW=function(a,b){var c=b[0],d=b[1];b=b[2];a[0]=c;a[1]=d;a[2]=b;a[3]=Math.sqrt(Math.abs(1-c*c-d*d-b*b));return a};e.slerp=a;e.invert=function(a,b){var c=b[0],d=b[1],e=b[2];b=b[3];
var h=c*c+d*d+e*e+b*b,h=h?1/h:0;a[0]=-c*h;a[1]=-d*h;a[2]=-e*h;a[3]=b*h;return a};e.conjugate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=b[3];return a};e.fromMat3=c;e.fromEuler=function(a,b,c,d){var e=.5*Math.PI/180;b*=e;c*=e;d*=e;e=Math.sin(b);b=Math.cos(b);var g=Math.sin(c);c=Math.cos(c);var h=Math.sin(d);d=Math.cos(d);a[0]=e*c*d-b*g*h;a[1]=b*g*d+e*c*h;a[2]=b*c*h-e*g*d;a[3]=b*c*d+e*g*h;return a};e.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};var l=b(17),p=b(100),
w=b(101);n=b(102);e.clone=n.clone;e.fromValues=n.fromValues;e.copy=n.copy;e.set=n.set;e.add=n.add;e.mul=r;e.scale=n.scale;e.dot=n.dot;e.lerp=n.lerp;b=n.length;e.length=b;e.len=b;b=n.squaredLength;e.squaredLength=b;e.sqrLen=b;var v=n.normalize;e.normalize=v;e.exactEquals=n.exactEquals;e.equals=n.equals;n=function(){var a=w.create(),b=w.fromValues(1,0,0),c=w.fromValues(0,1,0);return function(d,e,g){var f=w.dot(e,g);if(-.999999>f)return w.cross(a,b,e),1E-6>w.len(a)&&w.cross(a,c,e),w.normalize(a,a),u(d,
a,Math.PI),d;if(.999999<f)return d[0]=0,d[1]=0,d[2]=0,d[3]=1,d;w.cross(a,e,g);d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=1+f;return v(d,d)}}();e.rotationTo=n;n=function(){var b=m(),c=m();return function(e,d,f,h,k,l){a(b,d,k,l);a(c,f,h,l);a(e,b,c,2*l*(1-l));return e}}();e.sqlerp=n;n=function(){var a=p.create();return function(b,e,d,f){a[0]=d[0];a[3]=d[1];a[6]=d[2];a[1]=f[0];a[4]=f[1];a[7]=f[2];a[2]=-e[0];a[5]=-e[1];a[8]=-e[2];return v(b,c(b,a))}}();e.setAxes=n},function(n,e,b){function m(){var b=new u.a(2);
b[0]=0;b[1]=0;return b}var u=b(17);(function(){var b=m();return function(a,c,e,m,n,r){c||(c=2);e||(e=0);for(m=m?Math.min(m*c+e,a.length):a.length;e<m;e+=c)b[0]=a[e],b[1]=a[e+1],n(b,b,r),a[e]=b[0],a[e+1]=b[1];return a}})()},function(n,e){n.exports=function(b){function e(a){var b={};a=a.split(" ");for(var e=0;e<a.length;++e)b[a[e]]=!0;return b}b.defineMode("glsl",function(a,b){function c(a,b){var c=a.next();if(F[c]){var e=F[c](a,b);if(!1!==e)return e}if('"'==c||"'"==c)return b.tokenize=m(c),b.tokenize(a,
b);if(/[\[\]{}\(\),;\:\.]/.test(c))return z=c,"bracket";if(/\d/.test(c))return a.eatWhile(/[\w\.]/),"number";if("/"==c){if(a.eat("*"))return b.tokenize=u,u(a,b);if(a.eat("/"))return a.skipToEnd(),"comment"}if("#"==c)return a.eatWhile(/[\S]+/),a.eatWhile(/[\s]+/),a.eatWhile(/[\S]+/),a.eatWhile(/[\s]+/),"comment";if(B.test(c))return a.eatWhile(B),"operator";a.eatWhile(/[\w\$_]/);a=a.current();return d.propertyIsEnumerable(a)?(q.propertyIsEnumerable(a)&&(z="newstatement"),"keyword"):f.propertyIsEnumerable(a)?
"builtin":x.propertyIsEnumerable(a)?"atom":"word"}function m(a){return function(b,d){for(var e=!1,f,g=!1;null!=(f=b.next());){if(f==a&&!e){g=!0;break}e=!e&&"\\"==f}if(g||!e&&!C)d.tokenize=c;return"string"}}function u(a,b){for(var d=!1,e;e=a.next();){if("/"==e&&d){b.tokenize=c;break}d="*"==e}return"comment"}function v(a,b,c,d,e){this.indented=a;this.column=b;this.type=c;this.align=d;this.prev=e}function k(a,b,c){return a.context=new v(a.indented,b,c,null,a.context)}function h(a){var b=a.context.type;
if(")"==b||"]"==b||"}"==b)a.indented=a.context.indented;return a.context=a.context.prev}var g=a.indentUnit,d=b.keywords||e(n),f=b.builtins||e(r),q=b.blockKeywords||e("case do else for if switch while struct"),x=b.atoms||e("null"),F=b.hooks||{},C=b.multiLineStrings,B=/[+\-*&%=<>!?|\/]/,z;return{startState:function(a){return{tokenize:null,context:new v((a||0)-g,0,"top",!1),indented:0,startOfLine:!0}},token:function(a,b){var d=b.context;a.sol()&&(null==d.align&&(d.align=!1),b.indented=a.indentation(),
b.startOfLine=!0);if(a.eatSpace())return null;z=null;var e=(b.tokenize||c)(a,b);if("comment"==e||"meta"==e)return e;null==d.align&&(d.align=!0);if(";"!=z&&":"!=z||"statement"!=d.type)if("{"==z)k(b,a.column(),"}");else if("["==z)k(b,a.column(),"]");else if("("==z)k(b,a.column(),")");else if("}"==z){for(;"statement"==d.type;)d=h(b);for("}"==d.type&&(d=h(b));"statement"==d.type;)d=h(b)}else z==d.type?h(b):("}"==d.type||"top"==d.type||"statement"==d.type&&"newstatement"==z)&&k(b,a.column(),"statement");
else h(b);b.startOfLine=!1;return e},indent:function(a,b){if(a.tokenize!=c&&null!=a.tokenize)return 0;b=b&&b.charAt(0);a=a.context;var d=b==a.type;return"statement"==a.type?a.indented+("{"==b?0:g):a.align?a.column+(d?0:1):a.indented+(d?0:g)},electricChars:"{}"}});var n="attribute const uniform varying break continue do for while if else in out inout float int void bool true false lowp mediump highp precision invariant discard return mat2 mat3 mat4 vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 sampler2D samplerCube struct gl_FragCoord gl_FragColor",
r="radians degrees sin cos tan asin acos atan pow exp log exp2 log2 sqrt inversesqrt abs sign floor ceil fract mod min max clamp mix step smoothstep length distance dot cross normalize faceforward reflect refract matrixCompMult lessThan lessThanEqual greaterThan greaterThanEqual equal notEqual any all not dFdx dFdy fwidth texture2D texture2DProj texture2DLod texture2DProjLod textureCube textureCubeLod require export";b.defineMIME("text/x-glsl",{name:"glsl",keywords:e(n),builtins:e(r),blockKeywords:e("case do else for if switch while struct"),
atoms:e("null"),hooks:{"#":function(a,b){if(!b.startOfLine)return!1;a.skipToEnd();return"meta"}}})}},function(n,e,b){e=b(103);var m=b(217),u=b(218),r=e?e.toStringTag:void 0;n.exports=function(a){return null==a?void 0===a?"[object Undefined]":"[object Null]":r&&r in Object(a)?m(a):u(a)}},function(n,e,b){(function(b){n.exports="object"==typeof b&&b&&b.Object===Object&&b}).call(e,b(225))},function(n,e,b){e=b(103);b=Object.prototype;var m=b.hasOwnProperty,u=b.toString,r=e?e.toStringTag:void 0;n.exports=
function(a){var b=m.call(a,r),e=a[r];try{a[r]=void 0;var n=!0}catch(v){}var w=u.call(a);n&&(b?a[r]=e:delete a[r]);return w}},function(n,e){var b=Object.prototype.toString;n.exports=function(e){return b.call(e)}},function(n,e){n.exports=function(b){return null!=b&&"object"==typeof b}},function(n,e,b){var m=b(215),u=b(219);n.exports=function(b){return"symbol"==typeof b||u(b)&&"[object Symbol]"==m(b)}},function(n,e,b){var m=b(104);n.exports=function(){return m.Date.now()}},function(n,e,b){var m=b(22),
u=b(59);n.exports=function(b,a,c){var e=!0,n=!0;if("function"!=typeof b)throw new TypeError("Expected a function");u(c)&&(e="leading"in c?!!c.leading:e,n="trailing"in c?!!c.trailing:n);return m(b,a,{leading:e,maxWait:a,trailing:n})}},function(n,e,b){var m=b(59),u=b(220),r=0/0,a=/^\s+|\s+$/g,c=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,p=/^0o[0-7]+$/i,w=parseInt;n.exports=function(b){if("number"==typeof b)return b;if(u(b))return r;m(b)&&(b="function"==typeof b.valueOf?b.valueOf():b,b=m(b)?b+"":b);if("string"!=
typeof b)return 0===b?b:+b;b=b.replace(a,"");var e=l.test(b);return e||p.test(b)?w(b.slice(2),e?2:8):c.test(b)?r:+b}},function(n,e,b){var m,u;(function(r){!(m=r,u="function"===typeof m?m.call(e,b,e,n):m,void 0!==u&&(n.exports=u))})(function(){function b(a,b){if(!a||!a.nodeType||1!==a.nodeType)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(a);this.el=a;this.options=b=z({},b);a[Fa]=this;var c={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,
scrollSpeed:10,draggable:/[uo]l/i.test(a.nodeName)?"li":">*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,animation:0,setData:function(a,b){a.setData("Text",b.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0}},d;for(d in c)d in b||(b[d]=c[d]);Pb(b);for(var e in this)"_"===e.charAt(0)&&"function"===
typeof this[e]&&(this[e]=this[e].bind(this));this.nativeDraggable=b.forceFallback?!1:Sa;m(a,"mousedown",this._onTapStart);m(a,"touchstart",this._onTapStart);m(a,"pointerdown",this._onTapStart);this.nativeDraggable&&(m(a,"dragover",this),m(a,"dragenter",this));ra.push(this._onDragOver);b.store&&this.sort(b.store.get(this))}function a(a){J&&J.state!==a&&(k(J,"display",a?"none":""),!a&&J.state&&D.insertBefore(J,y),J.state=a)}function c(a,b,c){if(a){c=c||Y;do if(">*"===b&&a.parentNode===c||C(a,b))return a;
while(a=e(a))}return null}function e(a){var b=a.host;return b&&b.nodeType?b:a.parentNode}function m(a,b,c){a.addEventListener(b,c,!1)}function n(a,b,c){a.removeEventListener(b,c,!1)}function u(a,b,c){if(a)if(a.classList)a.classList[c?"add":"remove"](b);else{var d=(" "+a.className+" ").replace(T," ").replace(" "+b+" "," ");a.className=(d+(c?" "+b:"")).replace(T," ")}}function k(a,b,c){var d=a&&a.style;if(d){if(void 0===c)return Y.defaultView&&Y.defaultView.getComputedStyle?c=Y.defaultView.getComputedStyle(a,
""):a.currentStyle&&(c=a.currentStyle),void 0===b?c:c[b];b in d||(b="-webkit-"+b);d[b]=c+("string"===typeof c?"":"px")}}function h(a,b,c){if(a){a=a.getElementsByTagName(b);b=0;var d=a.length;if(c)for(;b<d;b++)c(a[b],b);return a}return[]}function g(a,b,c,d,e,f,g){a=a||b[Fa];var h=Y.createEvent("Event"),k=a.options,l="on"+c.charAt(0).toUpperCase()+c.substr(1);h.initEvent(c,!0,!0);h.to=b;h.from=e||b;h.item=d||b;h.clone=J;h.oldIndex=f;h.newIndex=g;b.dispatchEvent(h);k[l]&&k[l].call(a,h)}function d(a,
b,c,d,e,f,g){var h,k=a[Fa],l=k.options.onMove,m;h=Y.createEvent("Event");h.initEvent("move",!0,!0);h.to=b;h.from=a;h.dragged=c;h.draggedRect=d;h.related=e||b;h.relatedRect=f||b.getBoundingClientRect();a.dispatchEvent(h);l&&(m=l.call(k,h,g));return m}function f(a){a.draggable=!1}function q(){rb=!1}function x(a){a=a.tagName+a.className+a.src+a.href+a.textContent;for(var b=a.length,c=0;b--;)c+=a.charCodeAt(b);return c.toString(36)}function F(a,b){var c=0;if(!a||!a.parentNode)return-1;for(;a&&(a=a.previousElementSibling);)"TEMPLATE"===
a.nodeName.toUpperCase()||">*"!==b&&!C(a,b)||c++;return c}function C(a,b){if(a){b=b.split(".");var c=b.shift().toUpperCase(),d=new RegExp("\\s("+b.join("|")+")(?=\\s)","g");return(""===c||a.nodeName.toUpperCase()==c)&&(!b.length||((" "+a.className+" ").match(d)||[]).length==b.length)}return!1}function B(a,b){var c,d;return function(){void 0===c&&(c=arguments,d=this,setTimeout(function(){1===c.length?a.call(d,c[0]):a.apply(d,c);c=void 0},b))}}function z(a,b){if(a&&b)for(var c in b)b.hasOwnProperty(c)&&
(a[c]=b[c]);return a}function E(a){return Lb?Lb(a).clone(!0)[0]:Mb&&Mb.dom?Mb.dom(a).cloneNode(!0):a.cloneNode(!0)}if("undefined"==typeof window||!window.document)return function(){throw Error("Sortable.js requires a window with a document");};var y,H,G,J,D,S,I,P,U,V,L,Q,W,X,K,O,na={},sa,ta,Na,T=/\s+/g,Fa="Sortable"+(new Date).getTime(),pa=window,Y=pa.document,ab=pa.parseInt,Lb=pa.jQuery||pa.Zepto,Mb=pa.Polymer,Sa=!!("draggable"in Y.createElement("div")),Nb=function(a){if(navigator.userAgent.match(/Trident.*rv[ :]?11\./))return!1;
a=Y.createElement("x");a.style.cssText="pointer-events:auto";return"auto"===a.style.pointerEvents}(),rb=!1,qa=Math.abs,sb=Math.min,ra=[],Ob=B(function(a,b,c){if(c&&b.scroll){var d,e=b.scrollSensitivity,f=b.scrollSpeed,g=a.clientX,h=a.clientY,k=window.innerWidth,l=window.innerHeight,m,n,p,q;if(P!==c&&(I=b.scroll,P=c,U=b.scrollFn,!0===I)){I=c;do if(I.offsetWidth<I.scrollWidth||I.offsetHeight<I.scrollHeight)break;while(I=I.parentNode)}I&&(d=I,b=I.getBoundingClientRect(),m=(qa(b.right-g)<=e)-(qa(b.left-
g)<=e),n=(qa(b.bottom-h)<=e)-(qa(b.top-h)<=e));m||n||(m=(k-g<=e)-(g<=e),n=(l-h<=e)-(h<=e),(m||n)&&(d=pa));if(na.vx!==m||na.vy!==n||na.el!==d)na.el=d,na.vx=m,na.vy=n,clearInterval(na.pid),d&&(na.pid=setInterval(function(){q=n?n*f:0;p=m?m*f:0;if("function"===typeof U)return U.call(_this,p,q,a);d===pa?pa.scrollTo(pa.pageXOffset+p,pa.pageYOffset+q):(d.scrollTop+=q,d.scrollLeft+=p)},24))}},30),Pb=function(a){function b(a,b){if(void 0===a||!0===a)a=c.name;return"function"===typeof a?a:function(c,d){c=d.options.group.name;
return b?a:a&&(a.join?-1<a.indexOf(c):c==a)}}var c={},d=a.group;d&&"object"==typeof d||(d={name:d});c.name=d.name;c.checkPull=b(d.pull,!0);c.checkPut=b(d.put);a.group=c};b.prototype={constructor:b,_onTapStart:function(a){var b=this,d=this.el,e=this.options,f=a.touches&&a.touches[0],h=(f||a).target,k=a.target.shadowRoot&&a.path[0]||h,l=e.filter,m;if(!(y||"mousedown"===a.type&&0!==a.button||e.disabled||e.handle&&!c(k,e.handle,d))&&(h=c(h,e.draggable,d))){m=F(h,e.draggable);if("function"===typeof l){if(l.call(this,
a,h,this)){g(b,k,"filter",h,d,m);a.preventDefault();return}}else if(l&&(l=l.split(",").some(function(a){if(a=c(k,a.trim(),d))return g(b,a,"filter",h,d,m),!0}))){a.preventDefault();return}this._prepareDragStart(a,f,h,m)}},_prepareDragStart:function(a,b,c,d){var e=this,k=e.el,l=e.options,n=k.ownerDocument;c&&!y&&c.parentNode===k&&(sa=a,D=k,y=c,H=y.parentNode,S=y.nextSibling,K=l.group,W=d,this._lastX=(b||a).clientX,this._lastY=(b||a).clientY,y.style["will-change"]="transform",c=function(){e._disableDelayedDrag();
y.draggable=e.nativeDraggable;u(y,l.chosenClass,!0);e._triggerDragStart(a,b);g(e,D,"choose",y,D,W)},l.ignore.split(",").forEach(function(a){h(y,a.trim(),f)}),m(n,"mouseup",e._onDrop),m(n,"touchend",e._onDrop),m(n,"touchcancel",e._onDrop),m(n,"pointercancel",e._onDrop),l.delay?(m(n,"mouseup",e._disableDelayedDrag),m(n,"touchend",e._disableDelayedDrag),m(n,"touchcancel",e._disableDelayedDrag),m(n,"mousemove",e._disableDelayedDrag),m(n,"touchmove",e._disableDelayedDrag),m(n,"pointermove",e._disableDelayedDrag),
e._dragStartTimer=setTimeout(c,l.delay)):c())},_disableDelayedDrag:function(){var a=this.el.ownerDocument;clearTimeout(this._dragStartTimer);n(a,"mouseup",this._disableDelayedDrag);n(a,"touchend",this._disableDelayedDrag);n(a,"touchcancel",this._disableDelayedDrag);n(a,"mousemove",this._disableDelayedDrag);n(a,"touchmove",this._disableDelayedDrag);n(a,"pointermove",this._disableDelayedDrag)},_triggerDragStart:function(a,b){(b=b||("touch"==a.pointerType?a:null))?(sa={target:y,clientX:b.clientX,clientY:b.clientY},
this._onDragStart(sa,"touch")):this.nativeDraggable?(m(y,"dragend",this),m(D,"dragstart",this._onDragStart)):this._onDragStart(sa,!0);try{Y.selection?setTimeout(function(){Y.selection.empty()}):window.getSelection().removeAllRanges()}catch(Ga){}},_dragStarted:function(){if(D&&y){var a=this.options;u(y,a.ghostClass,!0);u(y,a.dragClass,!1);b.active=this;g(this,D,"start",y,D,W)}},_emulateDragOver:function(){if(ta&&(this._lastX!==ta.clientX||this._lastY!==ta.clientY)){this._lastX=ta.clientX;this._lastY=
ta.clientY;Nb||k(G,"display","none");var a=Y.elementFromPoint(ta.clientX,ta.clientY),b=a,c=ra.length;if(b){do{if(b[Fa]){for(;c--;)ra[c]({clientX:ta.clientX,clientY:ta.clientY,target:a,rootEl:b});break}a=b}while(b=b.parentNode)}Nb||k(G,"display","")}},_onTouchMove:function(a){if(sa){var c=this.options,d=c.fallbackTolerance,e=c.fallbackOffset,c=a.touches?a.touches[0]:a,f=c.clientX-sa.clientX+e.x,e=c.clientY-sa.clientY+e.y,f=a.touches?"translate3d("+f+"px,"+e+"px,0)":"translate("+f+"px,"+e+"px)";if(!b.active){if(d&&
sb(qa(c.clientX-this._lastX),qa(c.clientY-this._lastY))<d)return;this._dragStarted()}this._appendGhost();Na=!0;ta=c;k(G,"webkitTransform",f);k(G,"mozTransform",f);k(G,"msTransform",f);k(G,"transform",f);a.preventDefault()}},_appendGhost:function(){if(!G){var a=y.getBoundingClientRect(),b=k(y),c=this.options;G=y.cloneNode(!0);u(G,c.ghostClass,!1);u(G,c.fallbackClass,!0);u(G,c.dragClass,!0);k(G,"top",a.top-ab(b.marginTop,10));k(G,"left",a.left-ab(b.marginLeft,10));k(G,"width",a.width);k(G,"height",
a.height);k(G,"opacity","0.8");k(G,"position","fixed");k(G,"zIndex","100000");k(G,"pointerEvents","none");c.fallbackOnBody&&Y.body.appendChild(G)||D.appendChild(G);b=G.getBoundingClientRect();k(G,"width",2*a.width-b.width);k(G,"height",2*a.height-b.height)}},_onDragStart:function(a,b){var c=a.dataTransfer,d=this.options;this._offUpEvents();"clone"==K.checkPull(this,this,y,a)&&(J=E(y),k(J,"display","none"),D.insertBefore(J,y),g(this,D,"clone",y));u(y,d.dragClass,!0);b?("touch"===b?(m(Y,"touchmove",
this._onTouchMove),m(Y,"touchend",this._onDrop),m(Y,"touchcancel",this._onDrop),m(Y,"pointermove",this._onTouchMove),m(Y,"pointerup",this._onDrop)):(m(Y,"mousemove",this._onTouchMove),m(Y,"mouseup",this._onDrop)),this._loopId=setInterval(this._emulateDragOver,50)):(c&&(c.effectAllowed="move",d.setData&&d.setData.call(this,c,y)),m(Y,"drop",this),setTimeout(this._dragStarted,0))},_onDragOver:function(e){var f=this.el,g,h,l,m;h=this.options;g=h.group;var n=b.active,p=K===g,r=h.sort;void 0!==e.preventDefault&&
(e.preventDefault(),!h.dragoverBubble&&e.stopPropagation());Na=!0;if(K&&!h.disabled&&(p?r||(m=!D.contains(y)):O===this||K.checkPull(this,n,y,e)&&g.checkPut(this,n,y,e))&&(void 0===e.rootEl||e.rootEl===this.el)&&(Ob(e,h,this.el),!rb))if(g=c(e.target,h.draggable,f),h=y.getBoundingClientRect(),O=this,m)a(!0),H=D,J||S?D.insertBefore(y,J||S):r||D.appendChild(y);else if(!(m=0===f.children.length||f.children[0]===G)&&(m=f===e.target)&&(g=f.lastElementChild,m=g.getBoundingClientRect(),m=g=(5<e.clientY-(m.top+
m.height)||5<e.clientX-(m.right+m.width))&&g),m){if(g){if(g.animated)return;l=g.getBoundingClientRect()}a(p);!1!==d(D,f,y,h,g,l,e)&&(y.contains(f)||(f.appendChild(y),H=f),this._animate(h,y),g&&this._animate(l,g))}else if(g&&!g.animated&&g!==y&&void 0!==g.parentNode[Fa]){V!==g&&(V=g,L=k(g),Q=k(g.parentNode));l=g.getBoundingClientRect();n=l.right-l.left;m=l.bottom-l.top;var u=/left|right|inline/.test(L.cssFloat+L.display)||"flex"==Q.display&&0===Q["flex-direction"].indexOf("row"),r=g.offsetWidth>y.offsetWidth,
v=g.offsetHeight>y.offsetHeight,w=.5<(u?(e.clientX-l.left)/n:(e.clientY-l.top)/m),n=g.nextElementSibling,x=d(D,f,y,h,g,l,e);!1!==x&&(rb=!0,setTimeout(q,30),a(p),1===x||-1===x?e=1===x:u?(p=y.offsetTop,u=g.offsetTop,e=p===u?g.previousElementSibling===y&&!r||w&&r:g.previousElementSibling===y||y.previousElementSibling===g?.5<(e.clientY-l.top)/m:u>p):e=n!==y&&!v||w&&v,y.contains(f)||(e&&!n?f.appendChild(y):g.parentNode.insertBefore(y,e?n:g)),H=y.parentNode,this._animate(h,y),this._animate(l,g))}},_animate:function(a,
b){var c=this.options.animation;if(c){var d=b.getBoundingClientRect();k(b,"transition","none");k(b,"transform","translate3d("+(a.left-d.left)+"px,"+(a.top-d.top)+"px,0)");b.offsetWidth;k(b,"transition","all "+c+"ms");k(b,"transform","translate3d(0,0,0)");clearTimeout(b.animated);b.animated=setTimeout(function(){k(b,"transition","");k(b,"transform","");b.animated=!1},c)}},_offUpEvents:function(){var a=this.el.ownerDocument;n(Y,"touchmove",this._onTouchMove);n(Y,"pointermove",this._onTouchMove);n(a,
"mouseup",this._onDrop);n(a,"touchend",this._onDrop);n(a,"pointerup",this._onDrop);n(a,"touchcancel",this._onDrop)},_onDrop:function(a){var c=this.el,d=this.options;clearInterval(this._loopId);clearInterval(na.pid);clearTimeout(this._dragStartTimer);n(Y,"mousemove",this._onTouchMove);this.nativeDraggable&&(n(Y,"drop",this),n(c,"dragstart",this._onDragStart));this._offUpEvents();if(a&&(Na&&(a.preventDefault(),!d.dropBubble&&a.stopPropagation()),G&&G.parentNode.removeChild(G),y&&(this.nativeDraggable&&
n(y,"dragend",this),f(y),y.style["will-change"]="",u(y,this.options.ghostClass,!1),u(y,this.options.chosenClass,!1),D!==H?(X=F(y,d.draggable),0<=X&&(g(null,H,"add",y,D,W,X),g(this,D,"remove",y,D,W,X),g(null,H,"sort",y,D,W,X),g(this,D,"sort",y,D,W,X))):(J&&J.parentNode.removeChild(J),y.nextSibling!==S&&(X=F(y,d.draggable),0<=X&&(g(this,D,"update",y,D,W,X),g(this,D,"sort",y,D,W,X)))),b.active))){if(null==X||-1===X)X=W;g(this,D,"end",y,D,W,X);this.save()}this._nulling()},_nulling:function(){D=y=H=G=
S=J=I=P=sa=ta=Na=X=V=L=O=K=b.active=null},handleEvent:function(a){var b=a.type;"dragover"===b||"dragenter"===b?y&&(this._onDragOver(a),a.dataTransfer&&(a.dataTransfer.dropEffect="move"),a.preventDefault()):"drop"!==b&&"dragend"!==b||this._onDrop(a)},toArray:function(){for(var a=[],b,d=this.el.children,e=0,f=d.length,g=this.options;e<f;e++)b=d[e],c(b,g.draggable,this.el)&&a.push(b.getAttribute(g.dataIdAttr)||x(b));return a},sort:function(a){var b={},d=this.el;this.toArray().forEach(function(a,e){e=
d.children[e];c(e,this.options.draggable,d)&&(b[a]=e)},this);a.forEach(function(a){b[a]&&(d.removeChild(b[a]),d.appendChild(b[a]))})},save:function(){var a=this.options.store;a&&a.set(this)},closest:function(a,b){return c(a,b||this.options.draggable,this.el)},option:function(a,b){var c=this.options;if(void 0===b)return c[a];c[a]=b;"group"===a&&Pb(c)},destroy:function(){var a=this.el;a[Fa]=null;n(a,"mousedown",this._onTapStart);n(a,"touchstart",this._onTapStart);n(a,"pointerdown",this._onTapStart);
this.nativeDraggable&&(n(a,"dragover",this),n(a,"dragenter",this));Array.prototype.forEach.call(a.querySelectorAll("[draggable]"),function(a){a.removeAttribute("draggable")});ra.splice(ra.indexOf(this._onDragOver),1);this._onDrop();this.el=a=null}};b.utils={on:m,off:n,css:k,find:h,is:function(a,b){return!!c(a,b,a)},extend:z,throttle:B,closest:c,toggleClass:u,clone:E,index:F};b.create=function(a,c){return new b(a,c)};b.version="1.5.0-rc1";return b})},function(n,e){e=function(){return this}();try{e=
e||Function("return this")()||(0,eval)("this")}catch(b){"object"===typeof window&&(e=window)}n.exports=e},function(n,e,b){e=function(b){this._socket=void 0;this._editorLayer=b};e.prototype.open=function(b,e){var m=this._formatPath();try{this._socket=new WebSocket(m),this._socket.onmessage=this.on_message.bind(this),this._socket.onopen=this.on_open.bind(this,b),this._socket.onclose=this.on_close.bind(this,e)}catch(a){e("No open socket.")}};e.prototype.send=function(b,e,n){if(void 0===this._socket){var a=
this.open.bind(this);b=this.send.bind(this,b,e,n);(new Promise(a)).then(b).catch(e)}else try{this._socket.send(n),b("Message sent.")}catch(c){e("Message error.")}};e.prototype.close=function(){this._socket.close()};e.prototype._formatPath=function(){var b=this._editorLayer.editorSource,e=b.host,n=b.key,b=b.channel;return"ws"+location.protocol.substr(4).split(":")[0]+"://"+e+"/ws/"+n+"/"+b};e.prototype.on_message=function(b){this._editorLayer.handleMessage(b.data)};e.prototype.on_open=function(b,e){b("Established websocket.")};
e.prototype.on_close=function(b){this._socket=void 0;b("Websocket dropped.")};n.exports={EditorSocket:e}},function(n,e,b){b(61);b(107);b(108);b(38);b(111);b(62);b(110);b(66);b(115);b(64);b(113);b(65);b(114);b(63);b(112);b(116);b(109);b(117);b(120);b(118);b(119);b(106);n.exports=b(105)}]);
